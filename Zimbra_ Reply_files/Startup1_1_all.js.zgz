
/* Copyright (C) 2005-2009 Zimbra Inc. http://www.zimbra.com/ */
if(AjxPackage.define("Startup1_1")){
if(AjxPackage.define("ajax.core.AjxCore")){
AjxCore=function(){};
AjxCore._objectIds=[null];
AjxCore.assignId=function(e){
var t=AjxCore._objectIds.length;
AjxCore._objectIds[t]=e;
return t
};
AjxCore.unassignId=function(e){
AjxCore._objectIds[e]=null
};
AjxCore.objectWithId=function(e){
return AjxCore._objectIds[e]
};
AjxCore.addListener=function(a,e,t){
a=AjxCore._getEventSource(a);
var o=AjxCore._getListenerStruct(a,e,true);
o.list[o.list.length]=t
};
AjxCore.setEventHandler=function(a,e,t){
a=AjxCore._getEventSource(a);
var o=AjxCore._getListenerStruct(a,e,true);
o.single=t
};
AjxCore.removeListener=function(n,t,o){
n=AjxCore._getEventSource(n);
var s=AjxCore._getListenerStruct(n,t);
if(s){
var r=s.list;
var e=r.length;
for(var a=0;
a<e;
a++){
if(r[a]==o){
r[a]=null
}}}};
AjxCore.removeAllListeners=function(o,t){
o=AjxCore._getEventSource(o);
var n=AjxCore._getListenerStruct(o,t);
if(n){
var s=n.list;
var e=s.length;
for(var a=0;
a<e;
a++){
s[a]=null
}}
AjxCore.unassignId(n.id)
};
AjxCore.notifyListeners=function(a,e,t){
a=AjxCore._getEventSource(a);
var o=AjxCore._getListenerStruct(a,e);
if(o){
a[e](t)
}};
AjxCore._getEventSource=function(e){
if(typeof(e)=="string"){
e=document.getElementById(e)
}
return e
};
AjxCore.getListenerStruct=function(t,e){
return AjxCore._getListenerStruct(t,e)
};
AjxCore._getListenerStruct=function(a,e,t){
var o=null;
if(a[e]){
var n=a[e]._lsListenerStructId;
o=AjxCore.objectWithId(n)
}else{
if(t){
o=AjxCore._setupListener(a,e)
}}
return o
};
AjxCore._setupListener=function(a,e,n){
var o=new Object();
o.list=new Array();
o.single=null;
var n=o.id=AjxCore.assignId(o);
var t=AjxCore._createListenerClosure(n);
a[e]=t;
a[e]._lsListenerStructId=n;
return o
};
AjxCore._createListenerClosure=function(id){
var closure=function(arg1){
var listenerStruct=AjxCore.objectWithId(id);
var listenerList=listenerStruct.list;
var len=listenerList.length;
for(var i=0;
i<len;
i++){
var callback=listenerList[i];
if(callback){
if(typeof(callback)=="string"){
eval(callback)
}else{
if(callback.handleEvent){
callback.handleEvent(arg1,this)
}else{
callback(arg1,this)
}}}}
if(listenerStruct.single){
var callback=listenerStruct.single;
if(typeof(callback)=="string"){
eval(callback)
}else{
return callback.handleEvent?callback.handleEvent(arg1,this):callback(arg1,this)
}}};
return closure
};
AjxCore.addOnloadListener=function(e){
if(window.onload&&(!window.onload._lsListenerStructId)){
var t=window.onload;
window.onload=null;
AjxCore.addListener(window,"onload",t)
}
AjxCore.addListener(window,"onload",e)
};
AjxCore.addOnunloadListener=function(e){
if(window.onunload&&(!window.onunload._lsListenerStructId)){
var t=window.onunload;
window.onunload=null;
AjxCore.addListener(window,"onunload",t)
}
AjxCore.addListener(window,"onunload",e)
}
}
if(AjxPackage.define("ajax.util.AjxUtil")){
AjxUtil=function(){};
AjxUtil.FLOAT_RE=/^[+\-]?((\d+(\.\d*)?)|((\d*\.)?\d+))([eE][+\-]?\d+)?$/;
AjxUtil.NOTFLOAT_RE=/[^\d\.]/;
AjxUtil.NOTINT_RE=/[^0-9]+/;
AjxUtil.LIFETIME_FIELD=/^([0-9])+([dhms]|ms)?$/;
AjxUtil.isSpecified=function(e){
return((e!==void 0)&&(e!==null))
};
AjxUtil.isUndefined=function(e){
return(e===void 0)
};
AjxUtil.isNull=function(e){
return(e===null)
};
AjxUtil.isBoolean=function(e){
return(typeof(e)=="boolean")
};
AjxUtil.isString=function(e){
return(typeof(e)=="string")
};
AjxUtil.isNumber=function(e){
return(typeof(e)=="number")
};
AjxUtil.isObject=function(e){
return((typeof(e)=="object")&&(e!==null))
};
AjxUtil.isArray=function(e){
return AjxUtil.isInstance(e,Array)
};
AjxUtil.isFunction=function(e){
return(typeof(e)=="function")
};
AjxUtil.isDate=function(e){
return AjxUtil.isInstance(e,Date)
};
AjxUtil.isLifeTime=function(e){
return AjxUtil.LIFETIME_FIELD.test(e)
};
AjxUtil.isNumeric=function(e){
return(!isNaN(parseFloat(e))&&AjxUtil.FLOAT_RE.test(e)&&!AjxUtil.NOTFLOAT_RE.test(e))
};
AjxUtil.isLong=function(e){
return(AjxUtil.isNumeric(e)&&!AjxUtil.NOTINT_RE.test(e))
};
AjxUtil.isNonNegativeLong=function(e){
return(AjxUtil.isNumeric(e)&&AjxUtil.isLong(e)&&(parseFloat(e)>=0))
};
AjxUtil.isInt=function(e){
return(AjxUtil.isNumeric(e)&&!AjxUtil.NOTINT_RE.test(e))
};
AjxUtil.isPositiveInt=function(e){
return(AjxUtil.isNumeric(e)&&AjxUtil.isInt(e)&&(parseInt(e)>0))
};
AjxUtil.isEmpty=function(e){
return(AjxUtil.isNull(e)||AjxUtil.isUndefined(e)||(e==="")||(AjxUtil.isArray(e)&&(e.length==0)))
};
AjxUtil.IP_ADDRESS_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?$/;
AjxUtil.IP_ADDRESS_WITH_PORT_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?:\d{1,5}$/;
AjxUtil.SUBNET_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?\/\d{1,2}$/;
AjxUtil.DOMAIN_NAME_SHORT_RE=/^[A-Za-z0-9\-]{2,}$/;
AjxUtil.DOMAIN_NAME_FULL_RE=/^[A-Za-z0-9\-]{1,}(\.[A-Za-z0-9\-]{2,}){1,}$/;
AjxUtil.HOST_NAME_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{1,})*(\.[A-Za-z0-9\-]{2,})*$/;
AjxUtil.HOST_NAME_WITH_PORT_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})*:([0-9])+$/;
AjxUtil.EMAIL_SHORT_RE=/^[^@\s]+$/;
AjxUtil.EMAIL_FULL_RE=/^[^@\s]+@[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})+$/;
AjxUtil.FULL_URL_RE=/^[A-Za-z0-9]{2,}:\/\/[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)*(:([0-9])+)?(\/[\w\.\|\^\*\[\]\{\}\(\)\-<>~,'#_;@:!%]+)*(\/)?(\?[\w\.\|\^\*\+\[\]\{\}\(\)\-<>~,'#_;@:!%&=]*)?$/;
AjxUtil.IP_FULL_URL_RE=/^[A-Za-z0-9]{2,}:\/\/\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?(:([0-9])+)?(\/[\w\.\|\^\*\[\]\{\}\(\)\-<>~,'#_;@:!%]+)*(\/)?(\?[\w\.\|\^\*\+\[\]\{\}\(\)\-<>~,'#_;@:!%&=]*)?$/;
AjxUtil.SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)*(:([0-9])+)?$/;
AjxUtil.IP_SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?(:([0-9])+)?$/;
AjxUtil.isIpAddress=function(e){
return AjxUtil.IP_ADDR_RE.test(e)
};
AjxUtil.isDomain=function(e){
return AjxUtil.DOMAIN_RE.test(e)
};
AjxUtil.isHostName=function(e){
return AjxUtil.HOST_NAME_RE.test(e)
};
AjxUtil.isDomainName=function(t,e){
return e?AjxUtil.DOMAIN_NAME_SHORT_RE.test(t):AjxUtil.DOMAIN_NAME_FULL_RE.test(t)
};
AjxUtil.isEmailAddress=function(t,e){
return e?AjxUtil.EMAIL_SHORT_RE.test(t):AjxUtil.EMAIL_FULL_RE.test(t)
};
AjxUtil.isValidEmailNonReg=function(e){
return((e.indexOf("@")>0)&&(e.lastIndexOf("@")==e.indexOf("@"))&&(e.indexOf(".@")<0))
};
AjxUtil.SIZE_GIGABYTES="GB";
AjxUtil.SIZE_MEGABYTES="MB";
AjxUtil.SIZE_KILOBYTES="KB";
AjxUtil.SIZE_BYTES="B";
AjxUtil.formatSize=function(n,o,s){
if(o==null){
o=true
}
if(s==null){
s=20
}
var t=AjxMsg.sizeBytes;
var a=AjxMsg.SIZE_BYTES;
if(n>=1073741824){
t=AjxMsg.sizeGigaBytes;
a=AjxUtil.SIZE_GIGABYTES
}else{
if(n>=1048576){
t=AjxMsg.sizeMegaBytes;
a=AjxUtil.SIZE_MEGABYTES
}else{
if(n>1023){
t=AjxMsg.sizeKiloBytes;
a=AjxUtil.SIZE_KILOBYTES
}}}
var e=AjxUtil.formatSizeForUnits(n,a,o,s);
return AjxMessageFormat.format(AjxMsg.formatSizeAndUnits,[e,t])
};
AjxUtil.formatSizeForUnits=function(n,a,t,r){
if(a==null){
a=AjxUtil.SIZE_BYTES
}
if(t==null){
t=true
}
if(r==null){
r=20
}
switch(a){
case AjxUtil.SIZE_GIGABYTES:n/=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:n/=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:n/=1024;
break
}
var e=I18nMsg.numberSeparatorDecimal!=""?I18nMsg.numberSeparatorDecimal:".";
var s=I18nMsg.formatNumber.replace(/\..*$/,"");
s=s.replace(/,/,"");
if(!t&&r){
s=s+=e;
for(var o=0;
o<r;
o++){
s+="#"
}}
return AjxNumberFormat.format(s,n)
};
AjxUtil.parseSize=function(t,o){
if(typeof t!=_STRING_){
t=t.toString()
}
var n=parseFloat(t.replace(/^\s*/,""));
var a=/[GMK]?B$/i;
var e=a.exec(t);
if(e){
o=e[0].toUpperCase()
}
switch(o){
case AjxUtil.SIZE_GIGABYTES:n*=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:n*=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:n*=1024;
break
}
return n
};
AjxUtil.isInstance=function(e,t){
return !!(e&&e.constructor&&(e.constructor===t))
};
AjxUtil.assert=function(e,t){
if(!e&&AjxUtil.onassert){
AjxUtil.onassert(t)
}};
AjxUtil.onassert=function(t){
var l=new Object();
l.message=t;
var c=new Array();
if(AjxEnv.isIE5_5up){
var o=arguments.callee.caller;
var n=0;
while(o&&n++<20){
c[c.length]=o;
o=o.caller
}}else{
try{
var o=arguments.callee.caller;
while(o){
c[c.length]=o;
if(c.length>2){
break
}
o=o.caller
}}
catch(h){}}
l.stack=c;
var r="";
var a=170;
for(var n=1;
n<c.length;
n++){
if(n>1){
r+="\n"
}
if(n<11){
var s=c[n].toString();
if(s.length>a){
s=s.substr(0,a)+"...";
s=s.replace(/\n/g,"")
}
r+=n+": "+s
}else{
r+="("+(c.length-11)+" frames follow)";
break
}}
alert("assertion:\n\n"+t+"\n\n---- Call Stack ---\n"+r);
throw l
};
AjxUtil.ELEMENT_NODE=1;
AjxUtil.TEXT_NODE=3;
AjxUtil.DOCUMENT_NODE=9;
AjxUtil.getInnerText=function(e){
if(AjxEnv.isIE){
return e.innerText
}
function t(s){
if(s){
if(s.nodeType==3){
return s.data
}
if(s.nodeType==1){
if(/^br$/i.test(s.tagName)){
return"\r\n"
}
var o="";
for(var a=s.firstChild;
a;
a=a.nextSibling){
o+=t(a)
}
return o
}}
return""
}
return t(e)
};
AjxUtil.createProxy=function(a,r){
var n;
var t=function(){};
t.prototype=a;
if(a instanceof Array){
n=new Array();
var o=a.length;
for(var e=0;
e<o;
e++){
n[e]=a[e]
}}else{
n=new t
}
if(r){
for(var s in a){
if(typeof a[s]=="object"&&a[s]!==null){
n[s]=AjxUtil.createProxy(a[s],r-1)
}}}
n._object_=a;
return n
};
AjxUtil.unProxy=function(t){
var e=t&&t._object_;
if(e){
for(var a in t){
if(t.hasOwnProperty(a)&&a!="_object_"){
e[a]=t[a]
}}
return e
}
return null
};
AjxUtil.collapseList=function(a){
var t=[];
for(var e=0;
e<a.length;
e++){
if(a[e]){
t.push(a[e])
}}
return t
};
AjxUtil.arrayAsHash=function(r,o){
r=AjxUtil.toArray(r);
var s={};
var a=typeof o=="function"&&o;
var n=o||true;
for(var t=0;
t<r.length;
t++){
var e=r[t];
s[e]=a?a(e,s,t,r):n
}
return s
};
AjxUtil.arrayAdd=function(a,t,e){
if(e==null||e<0||e>=a.length){
a.push(t)
}else{
a.splice(e,0,t)
}};
AjxUtil.arrayRemove=function(a,t){
if(a){
for(var e=0;
e<a.length;
e++){
if(a[e]==t){
a.splice(e,1);
return true
}}}
return false
};
AjxUtil.indexOf=function(n,t,e){
if(n){
for(var a=0;
a<n.length;
a++){
var o=n[a];
if((e&&o===t)||(!e&&o==t)){
return a
}}}
return -1
};
AjxUtil.arrayContains=function(a,t,e){
return AjxUtil.indexOf(a,t,e)!=-1
};
AjxUtil.keys=function(t,e){
var a=[];
for(var o in t){
if(e&&!e(o,t)){
continue
}
a.push(o)
}
return a
};
AjxUtil.values=function(a,t){
var e=[];
for(var o in a){
if(t&&!t(o,a)){
continue
}
e.push(a[o])
}
return e
};
AjxUtil.foreach=function(a,t){
if(!t){
return
}
for(var e=0;
e<a.length;
e++){
t(a[e],e)
}};
AjxUtil.map=function(o,a){
var e=new Array(o.length);
for(var t=0;
t<o.length;
t++){
e[t]=a?a(o[t],t):o[t]
}
return e
};
AjxUtil.uniq=function(a){
var e={};
for(var t=0;
t<a.length;
t++){
e[a[t]]=true
}
return AjxUtil.keys(e)
};
AjxUtil.dedup=function(n,t){
if(!t){
t=function(s){
return s
}
}
var e={};
for(var o=0;
o<n.length;
o++){
var a=t(n[o]);
if(a!==undefined&&e[a]){
n.splice(o,1);
o-=1
}
e[a]=true
}};
AjxUtil.concat=function(t){
var a=[];
for(var e=0;
e<arguments.length;
e++){
a.push.apply(a,arguments[e])
}
return a
};
AjxUtil.union=function(e){
var t=[];
return AjxUtil.uniq(t.concat.apply(t,arguments))
};
AjxUtil.intersection=function(t){
var o=AjxUtil.concat.apply(this,arguments);
var e=AjxUtil.arrayAsHash(o,AjxUtil.__intersection_count);
for(var a in e){
if(e[a]==1){
delete e[a]
}}
return AjxUtil.keys(e)
};
AjxUtil.__intersection_count=function(t,a,e,o){
return a[t]!=null?a[t]+1:1
};
AjxUtil.complement=function(o,t){
var a=AjxUtil.arrayAsHash(o);
var e=AjxUtil.arrayAsHash(t);
for(var n in e){
if(n in a){
delete e[n]
}}
return AjxUtil.keys(e)
};
AjxUtil.getFirstElement=function(n,o,a,t){
for(var s=n.firstChild;
s;
s=s.nextSibling){
if(s.nodeType!=AjxUtil.ELEMENT_NODE){
continue
}
if(o&&s.nodeName!=o){
continue
}
if(a){
var e=s.getAttributeNode(a);
if(e.nodeName!=a){
continue
}
if(t&&e.nodeValue!=t){
continue
}}
return s
}
return null
};
AjxUtil.formatUrl=function(s){
s=s||{};
var a=[];
var o=0;
if(!s.relative){
var n=s.protocol||location.protocol;
if(n.indexOf(":")==-1){
n=n+":"
}
a[o++]=n;
a[o++]="//";
a[o++]=s.host||location.hostname;
var t=Number(s.port||location.port);
if(t&&((n==ZmSetting.PROTO_HTTP&&t!=ZmSetting.HTTP_DEFAULT_PORT)||(n==ZmSetting.PROTO_HTTPS&&t!=ZmSetting.HTTPS_DEFAULT_PORT))){
a[o++]=":";
a[o++]=t
}}
a[o++]=s.path||location.pathname;
var e="";
if(s.qsArgs){
e=AjxStringUtil.queryStringSet(s.qsArgs,s.qsReset)
}else{
e=s.qsReset?"":location.search
}
a[o++]=e;
return a.join("")
};
AjxUtil.byNumber=function(t,e){
return Number(t)-Number(e)
};
AjxUtil.byStringProp=function(o,t,e){
return t[o].localeCompare(e[o])
};
AjxUtil.arraySize=function(t){
var o=0;
for(var n in t){
if(t.hasOwnProperty(n)){
o++
}}
return o
};
AjxUtil.mergeArrays=function(h,n,e){
if(!e){
e=AjxUtil.__mergeArrays_orderfunc
}
var l=[];
var o=h.length;
for(var t=0;
t<o;
t++){
l.push(h[t])
}
var s=[];
var a=n.length;
for(var t=0;
t<a;
t++){
s.push(n[t])
}
var r=[];
while(l.length>0&&s.length>0){
if(e(l[0],r[r.length-1])==0){
l.shift();
continue
}
if(e(s[0],r[r.length-1])==0){
s.shift();
continue
}
if(e(l[0],s[0])<0){
r.push(l.shift())
}else{
if(e(l[0],s[0])==0){
r.push(l.shift());
s.shift()
}else{
r.push(s.shift())
}}}
while(l.length>0){
if(e(l[0],r[r.length-1])==0){
l.shift();
continue
}
r.push(l.shift())
}
while(s.length>0){
if(e(s[0],r[r.length-1])==0){
s.shift();
continue
}
r.push(s.shift())
}
return r
};
AjxUtil.__mergeArrays_orderfunc=function(t,e){
if(t>e){
return 1
}
if(t<e){
return -1
}
if(t==e){
return 0
}};
AjxUtil.arraySubstract=function(h,n,e){
if(!e){
e=function(d,c){
if(d>c){
return 1
}
if(d<c){
return -1
}
if(d==c){
return 0
}}
}
var l=[];
var o=h.length;
for(var t=0;
t<o;
t++){
l.push(h[t])
}
var s=[];
var a=n.length;
for(var t=0;
t<a;
t++){
s.push(n[t])
}
s.sort(e);
l.sort(e);
var r=[];
while(l.length>0&&s.length>0){
if(e(l[0],s[0])==0){
l.shift();
s.shift();
continue
}
if(e(l[0],s[0])<0){
r.push(l.shift());
continue
}
if(e(l[0],s[0])>0){
s.shift();
continue
}}
while(l.length>0){
r.push(l.shift())
}
return r
};
AjxUtil.getHashKeys=function(a){
var t=[];
for(var e in a){
t.push(e)
}
t.sort();
return t
};
AjxUtil.arrayCompare=function(t,e){
if((!t||!e)&&(t!=e)){
return false
}
if(t.length!=e.length){
return false
}
for(var a=0;
a<t.length;
a++){
if(t[a]!=e[a]){
return false
}}
return true
};
AjxUtil.hashCompare=function(r,s){
var a=AjxUtil.getHashKeys(r);
var t=AjxUtil.getHashKeys(s);
if(!AjxUtil.arrayCompare(a,t)){
return false
}
for(var n=0,e=a.length;
n<e;
n++){
var o=a[n];
if(r[o]!=s[o]){
return false
}}
return true
};
AjxUtil.hashCopy=function(t){
var a={};
for(var e in t){
a[e]=t[e]
}
return a
};
AjxUtil.hashUpdate=function(o,a,e,n){
for(var t in a){
if((e||!(t in o))&&(!n||AjxUtil.indexOf(n,t)==-1)){
o[t]=a[t]
}}
return o
};
AjxUtil.isArray1=function(e){
return !!(e&&(e.length!=null)&&e.splice&&e.slice)
};
AjxUtil.toArray=function(e){
if(!e){
return[]
}else{
if(AjxUtil.isArray1(e)){
return e
}else{
if(e.isAjxVector){
return e.getArray()
}else{
return[e]
}}}};
AjxUtil.get=function(e){
for(var t=1;
e&&t<arguments.length;
t++){
e=e[arguments[t]]
}
return e
};
AjxUtil.convertToEntities=function(n){
var e="",t,o=0,a=0;
if(!n||!(o=n.length)){
return n
}
for(a;
a<o;
++a){
if(n.charCodeAt(a)>127){
t=n.charCodeAt(a).toString(10);
while(t.length<4){
t="0"+t
}
e+="&#"+t+";"
}else{
e+=n.charAt(a)
}}
return e
}
}
if(AjxPackage.define("ajax.core.AjxException")){
AjxException=function(a,t,o,e){
if(arguments.length==0){
return
}
this.msg=a;
this.code=t;
this.method=o;
this.detail=e
};
AjxException.prototype.toString=function(){
return"AjxException"
};
AjxException.prototype.dump=function(){
return"AjxException: msg="+this.msg+" code="+this.code+" method="+this.method+" detail="+this.detail
};
AjxException.INVALIDPARENT="AjxException.INVALIDPARENT";
AjxException.INVALID_OP="AjxException.INVALID_OP";
AjxException.INTERNAL_ERROR="AjxException.INTERNAL_ERROR";
AjxException.INVALID_PARAM="AjxException.INVALID_PARAM";
AjxException.UNIMPLEMENTED_METHOD="AjxException.UNIMPLEMENTED_METHOD";
AjxException.NETWORK_ERROR="AjxException.NETWORK_ERROR";
AjxException.OUT_OF_RPC_CACHE="AjxException.OUT_OF_RPC_CACHE";
AjxException.UNSUPPORTED="AjxException.UNSUPPORTED";
AjxException.UNKNOWN_ERROR="AjxException.UNKNOWN_ERROR";
AjxException.CANCELED="AjxException.CANCELED";
AjxException.defaultScriptErrorHandler=function(e){
alert(e)
};
AjxException.setScriptErrorHandler=function(e){
AjxException.scriptErrorHandler=e
};
AjxException.reportScriptError=function(e){
if(AjxException.reportScriptErrors&&AjxException.scriptErrorHandler&&!(e instanceof AjxException)){
AjxException.scriptErrorHandler(e)
}
throw e
};
AjxException.reportScriptErrors=false;
AjxException.scriptErrorHandler=AjxException.defaultScriptErrorHandler
}
if(AjxPackage.define("ajax.util.AjxCookie")){
AjxCookie=function(){};
AjxCookie.prototype.toString=function(){
return"AjxCookie"
};
AjxCookie.getCookie=function(h,t){
var l=t+"=";
var o=l.length;
var r=h.cookie.length;
var a=h.cookie;
var s=0;
while(s<r){
var n=s+o;
if(a.substring(s,n)==l){
var e=a.indexOf(";",n);
if(e==-1){
e=a.length
}
return unescape(a.substring(n,e))
}
s=a.indexOf(" ",s)+1;
if(s==0){
break
}}
return null
};
AjxCookie.setCookie=function(r,t,o,e,s,a,n){
r.cookie=t+"="+escape(o)+((e)?"; expires="+e.toGMTString():"")+((s)?"; path="+s:"")+((a)?"; domain="+a:"")+((n)?"; secure":"")
};
AjxCookie.deleteCookie=function(o,e,a,t){
o.cookie=e+"="+((a)?"; path="+a:"")+((t)?"; domain="+t:"")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT"
};
AjxCookie.areCookiesEnabled=function(o){
var e="ZM_COOKIE_TEST";
var a="Zimbra";
AjxCookie.setCookie(o,e,a);
var t=AjxCookie.getCookie(o,e);
AjxCookie.deleteCookie(o,e);
return t==a
}
}
if(AjxPackage.define("ajax.soap.AjxSoapException")){
AjxSoapException=function(a,t,o,e){
AjxException.call(this,a,t,o,e)
};
AjxSoapException.prototype.toString=function(){
return"AjxSoapException"
};
AjxSoapException.prototype=new AjxException;
AjxSoapException.prototype.constructor=AjxSoapException;
AjxSoapException.INTERNAL_ERROR="INTERNAL_ERROR";
AjxSoapException.INVALID_PDU="INVALID_PDU";
AjxSoapException.ELEMENT_EXISTS="ELEMENT_EXISTS"
}
if(AjxPackage.define("ajax.soap.AjxSoapFault")){
AjxSoapFault=function(t){
if(arguments.length==0){
return
}
var r=t.prefix;
var s=r+":Code";
var n=r+":Reason";
var a=r+":Detail";
var h=t.childNodes.length;
for(var o=0;
o<h;
o++){
var e=t.childNodes[o];
if(e.nodeName==s){
var l=e.firstChild.firstChild.nodeValue;
if(l==(r+":VersionMismatch")){
this.faultCode=AjxSoapFault.VERSION_MISMATCH
}else{
if(l==(r+":MustUnderstand")){
this.faultCode=AjxSoapFault.MUST_UNDERSTAND
}else{
if(l==(r+":DataEncodingUnknown")){
this.faultCode=AjxSoapFault.DATA_ENCODING_UNKNOWN
}else{
if(l==(r+":Sender")){
this.faultCode=AjxSoapFault.SENDER
}else{
if(l==(r+":Receiver")){
this.faultCode=AjxSoapFault.RECEIVER
}else{
this.faultCode=AjxSoapFault.UNKNOWN
}}}}}}else{
if(e.nodeName==n){
this.reason=e.firstChild.firstChild.nodeValue
}else{
if(e.nodeName==a){
this.errorCode=e.firstChild.firstChild.firstChild.nodeValue
}}}}};
AjxSoapFault.prototype.toString=function(){
return"AjxSoapFault"
};
AjxSoapFault.SENDER=-1;
AjxSoapFault.RECEIVER=-2;
AjxSoapFault.VERSION_MISMATCH=-3;
AjxSoapFault.MUST_UNDERSTAND=-4;
AjxSoapFault.DATA_ENCODING_UNKNOWN=-5;
AjxSoapFault.UNKNOWN=-6
}
if(AjxPackage.define("ajax.soap.AjxSoapDoc")){
AjxSoapDoc=function(){
this._soapURI=AjxSoapDoc._SOAP_URI
};
AjxSoapDoc.prototype.isAjxSoapDoc=true;
AjxSoapDoc.prototype.toString=function(){
return"AjxSoapDoc"
};
AjxSoapDoc._SOAP_URI="http://www.w3.org/2003/05/soap-envelope";
AjxSoapDoc._XMLNS_URI="http://www.w3.org/2000/xmlns";
AjxSoapDoc.create=function(e,a,h,r){
var s=new AjxSoapDoc();
s._xmlDoc=AjxXmlDoc.create();
var n=s._xmlDoc.getDoc();
if(!r){
r=AjxSoapDoc._SOAP_URI
}
s._soapURI=r;
var t=n.createElementNS&&!AjxEnv.isSafari;
var o=t?n.createElementNS(r,"soap:Envelope"):n.createElement("soap:Envelope");
if(!t){
o.setAttribute("xmlns:soap",r)
}
n.appendChild(o);
var l=t?n.createElementNS(r,"soap:Body"):n.createElement("soap:Body");
o.appendChild(l);
s._methodEl=a&&t?n.createElementNS(a,e):n.createElement(e);
if(a!=null&&!t){
if(h==null){
s._methodEl.setAttribute("xmlns",a)
}else{
s._methodEl.setAttribute("xmlns:"+h,a)
}}
l.appendChild(s._methodEl);
return s
};
AjxSoapDoc.createFromDom=function(t){
var e=new AjxSoapDoc();
e._xmlDoc=AjxXmlDoc.createFromDom(t);
e._methodEl=e._check(e._xmlDoc);
return e
};
AjxSoapDoc.createFromXml=function(e){
var t=new AjxSoapDoc();
t._xmlDoc=AjxXmlDoc.createFromXml(e);
t._methodEl=t._check(t._xmlDoc);
return t
};
AjxSoapDoc.element2FaultObj=function(t){
var e=t.firstChild;
if(!AjxEnv.isSafari){
if(e!=null&&e.namespaceURI!=AjxSoapDoc._SOAP_URI||e.nodeName!=(t.prefix+":Fault")){
return null
}}else{
if(e!=null&&e.nodeName!=(t.prefix+":Fault")){
return null
}}
return new AjxSoapFault(e)
};
AjxSoapDoc.prototype.setMethodAttribute=function(e,t){
this._methodEl.setAttribute(e,t)
};
AjxSoapDoc.prototype.set=function(t,l,c,n){
var h=this.getDoc();
var e=h.createElementNS&&!AjxEnv.isSafari;
var a=t?(n&&e?h.createElementNS(n,t):h.createElement(t)):h.createDocumentFragment();
if((n!==undefined)&&(n!==null)&&!e){
a.setAttribute("xmlns",n)
}
if(l!=null){
if(typeof l=="object"){
for(var r in l){
var o=l[r];
if(r.charAt(0)=="!"){
a.setAttribute(r.substr(1),o)
}else{
if(o instanceof Array){
for(var s=0;
s<o.length;
++s){
this.set(r,o[s],a)
}}else{
this.set(r,o,a)
}}}}else{
a.appendChild(h.createTextNode(l))
}}
if(!c){
c=this._methodEl
}
return c.appendChild(a)
};
AjxSoapDoc.prototype.getMethod=function(){
return this._methodEl
};
AjxSoapDoc.prototype.createHeaderElement=function(){
var a=this._xmlDoc.getDoc();
var t=a.firstChild;
var o=this.getHeader();
if(o!=null){
throw new AjxSoapException("SOAP header already exists",AjxSoapException.ELEMENT_EXISTS,"AjxSoapDoc.prototype.createHeaderElement")
}
var e=a.createElementNS&&!AjxEnv.isSafari;
o=e?a.createElementNS(this._soapURI,"soap:Header"):a.createElement("soap:Header");
t.insertBefore(o,t.firstChild);
return o
};
AjxSoapDoc.prototype.getHeader=function(){
var t=this._xmlDoc.getDoc();
var e=AjxEnv.isIE?(t.getElementsByTagName(t.firstChild.prefix+":Header")):(t.getElementsByTagNameNS(this._soapURI,"Header"));
return e?e[0]:null
};
AjxSoapDoc.prototype.getBody=function(){
var t=this._xmlDoc.getDoc();
var e=AjxEnv.isIE?(t.getElementsByTagName(t.firstChild.prefix+":Body")):(t.getElementsByTagNameNS(this._soapURI,"Body"));
return e?e[0]:null
};
AjxSoapDoc.prototype.getByTagName=function(t){
if(t.indexOf(":")==-1){
t="soap:"+t
}
var e=this.getDoc().getElementsByTagName(t);
if(e.length==1){
return e[0]
}else{
if(e.length>0){
return e
}else{
return null
}}};
AjxSoapDoc.prototype.ensureHeader=function(){
return(this.getHeader()||this.createHeaderElement())
};
AjxSoapDoc.prototype.getDoc=function(){
return this._xmlDoc.getDoc()
};
AjxSoapDoc.prototype.adoptNode=function(t){
if(AjxEnv.isFirefox3up||!AjxEnv.isFirefox){
try{
var a=this.getDoc();
if(a.adoptNode){
return a.adoptNode(t,true)
}}
catch(e){}}
return t.parentNode.removeChild(t)
};
AjxSoapDoc.prototype.getXml=function(){
return AjxEnv.isSafari||AjxEnv.isOpera?(AjxXmlDoc.getXml(this._xmlDoc.getDoc())):AjxXmlDoc.replaceInvalidChars(this._xmlDoc.getDoc().xml)
};
AjxSoapDoc.prototype._check=function(t){
var a=t.getDoc();
if(a.childNodes.length!=1){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:1")
}
var e=a.firstChild;
if(!AjxEnv.isSafari){
if(e.namespaceURI!=AjxSoapDoc._SOAP_URI||e.nodeName!=(e.prefix+":Envelope")||(e.childNodes.length<1||e.childNodes.length>2)){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}else{
if(e.nodeName!=(e.prefix+":Envelope")){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}}
}
if(AjxPackage.define("ajax.net.AjxRpcRequest")){
AjxRpcRequest=function(e){
if(!AjxRpcRequest.__inited){
AjxRpcRequest.__init()
}
this.id=e;
this.__httpReq=AjxRpcRequest.__msxmlVers?(new ActiveXObject(AjxRpcRequest.__msxmlVers)):(new XMLHttpRequest())
};
AjxRpcRequest.prototype.isAjxRpcRequest=true;
AjxRpcRequest.prototype.toString=function(){
return"AjxRpcRequest"
};
AjxRpcRequest.TIMEDOUT=-1000;
AjxRpcRequest.HTTP_GET="get";
AjxRpcRequest.HTTP_POST="post";
AjxRpcRequest.HTTP_PUT="put";
AjxRpcRequest.HTTP_DELETE="delete";
AjxRpcRequest.__inited=false;
AjxRpcRequest.__msxmlVers=null;
AjxRpcRequest.prototype.invoke=function(s,o,l,u,e,c){
var t=(u!=null);
var n=s&&s.match(/.*"(\w+Request)"/);
this.methodName=n?n[1]:o||"";
var a=AjxRpcRequest.HTTP_POST;
if(e){
a=e===true?AjxRpcRequest.HTTP_GET:e
}
this.__httpReq.open(a,o,t);
if(t){
if(c){
var r=new AjxTimedAction(this,this.__handleTimeout,[u]);
u._timedActionId=AjxTimedAction.scheduleAction(r,c)
}
var d=this;
this.__httpReq.onreadystatechange=function(m){
if(window.AjxRpcRequest){
AjxRpcRequest.__handleResponse(d,u)
}}
}else{
this.__httpReq.onreadystatechange=function(m){}
}
if(l){
for(var h in l){
if(l.hasOwnProperty(h)){
this.__httpReq.setRequestHeader(h,l[h])
}}}
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" RPC send: "+this.id);
this.__httpReq.send(s);
if(t){
return this.id
}else{
if(this.__httpReq.status==200||this.__httpReq.status==201){
return{
text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:true}
}else{
return{
text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:false,status:this.__httpReq.status}
}}};
AjxRpcRequest.prototype.cancel=function(){
AjxRpc.freeRpcCtxt(this);
if(AjxEnv.isFirefox3_5up){
this.__httpReq.onreadystatechange=function(){}
}
this.__httpReq.abort()
};
AjxRpcRequest.prototype.__handleTimeout=function(e){
this.cancel();
e.run({
text:null,xml:null,success:false,status:AjxRpcRequest.TIMEDOUT}
)
};
AjxRpcRequest.__handleResponse=function(a,o){
try{
if(!a||!a.__httpReq){
a.cancel();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Async RPC request: Lost request object!!!");
o.run({
text:null,xml:null,success:false,status:500}
);
AjxRpc.freeRpcCtxt(a);
return
}
if(a.__httpReq.readyState==4){
if(o._timedActionId!==null){
AjxTimedAction.cancelAction(o._timedActionId)
}
var e=500;
try{
e=a.__httpReq.status
}
catch(t){}
if(e==200||e==201){
o.run({
text:a.__httpReq.responseText,xml:a.__httpReq.responseXML,success:true,reqId:a.id}
)
}else{
o.run({
text:a.__httpReq.responseText,xml:a.__httpReq.responseXML,success:false,status:e,reqId:a.id}
)
}
AjxRpc.freeRpcCtxt(a)
}}
catch(t){
if(window.AjxException){
AjxException.reportScriptError(t)
}}};
AjxRpcRequest.__init=function(){
if(!window.XMLHttpRequest&&window.ActiveXObject){
var t=["MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];
for(var o=0;
o<t.length;
o++){
try{
var e=new ActiveXObject(t[o]);
AjxRpcRequest.__msxmlVers=t[o];
break
}
catch(a){}}
if(!AjxRpcRequest.__msxmlVers){
throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxRpc._init")
}}
AjxRpcRequest.__inited=true
}
}
if(AjxPackage.define("ajax.net.AjxRpc")){
AjxRpc=function(){};
AjxRpc.__rpcCache=[];
AjxRpc.__rpcOutstanding={};
AjxRpc.__RPC_CACHE_MAX=50;
AjxRpc.__RPC_ID=0;
AjxRpc.__RPC_IN_USE=0;
AjxRpc.__RPC_HIGH_WATER=0;
AjxRpc.__RPC_REAP_AGE=300000;
AjxRpc.__RPC_REAP_INTERVAL=1800000;
AjxRpc.invoke=function(o,a,r,d,e,c){
var t=(d!=null);
var s=AjxRpc.__getFreeRpcCtxt();
try{
var n=s.invoke(o,a,r,d,e,c)
}
catch(h){
var l=new AjxException();
l.method="AjxRpc.prototype._invoke";
if(h instanceof Error){
l.detail=h.message;
l.code=AjxException.NETWORK_ERROR;
l.msg="Network error"
}else{
if(h.code==101){
l.detail=h.message;
l.code=AjxException.NETWORK_ERROR;
l.msg="Network error"
}else{
l.detail=h.toString();
l.code=AjxException.UNKNOWN_ERROR;
l.msg="Unknown Error"
}}
AjxRpc.freeRpcCtxt(s);
throw l
}
if(!t){
AjxRpc.freeRpcCtxt(s)
}
return n
};
AjxRpc.freeRpcCtxt=function(e){
if(AjxRpc.__rpcOutstanding[e.id]){
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" --- freeing rpcCtxt "+e.id);
AjxRpc.__rpcCache.push(e);
delete AjxRpc.__rpcOutstanding[e.id];
AjxRpc.__RPC_IN_USE--
}};
AjxRpc.removeRpcCtxt=function(e){
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" REMOVE rpcCtxt "+e.id);
if(AjxRpc.__rpcOutstanding[e.id]){
delete AjxRpc.__rpcOutstanding[e.id];
AjxRpc.__RPC_IN_USE--
}
AjxUtil.arrayRemove(AjxRpc.__rpcCache,e)
};
AjxRpc.getRpcRequestById=function(e){
return(AjxRpc.__rpcOutstanding[e])
};
AjxRpc.__getFreeRpcCtxt=function(){
var e;
if(AjxRpc.__rpcCache.length>0){
e=AjxRpc.__rpcCache.pop();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" reusing RPC ID "+e.id)
}else{
if(AjxRpc.__RPC_IN_USE<AjxRpc.__RPC_CACHE_MAX){
var n="__RpcCtxt_"+AjxRpc.__RPC_ID;
e=new AjxRpcRequest(n);
AjxRpc.__RPC_ID++;
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Created RPC "+n)
}else{
e=AjxRpc.__reap();
if(!e){
var o=[];
for(var t in AjxRpc.__rpcOutstanding){
var e=AjxRpc.__rpcOutstanding[t];
o.push(e.methodName)
}
var a=o.join("<br>")+"<br>";
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Out of RPC cache!!! Outstanding requests: "+a);
throw new AjxException("Out of RPC cache",AjxException.OUT_OF_RPC_CACHE,"AjxRpc.__getFreeRpcCtxt",a)
}}}
AjxRpc.__rpcOutstanding[e.id]=e;
AjxRpc.__RPC_IN_USE++;
if(AjxRpc.__RPC_IN_USE>AjxRpc.__RPC_HIGH_WATER){
AjxRpc.__RPC_HIGH_WATER=AjxRpc.__RPC_IN_USE;
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" High water mark: "+AjxRpc.__RPC_HIGH_WATER)
}
e.timestamp=(new Date()).getTime();
return e
};
AjxRpc.__reap=function(a){
var e;
var o=(new Date()).getTime();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Running RPC context reaper");
for(var t in AjxRpc.__rpcOutstanding){
e=AjxRpc.__rpcOutstanding[t];
if((e.timestamp+AjxRpc.__RPC_REAP_AGE)<o){
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" AjxRpc.__reap: cleared RPC context "+e.id);
e.cancel();
delete AjxRpc.__rpcOutstanding[t];
AjxRpc.__RPC_IN_USE--;
if(!a){
return e
}}}
return null
};
window.setInterval(AjxRpc.__reap.bind(null,true),AjxRpc.__RPC_REAP_INTERVAL)
}
if(AjxPackage.define("ajax.util.AjxVector")){
AjxVector=function(e){
this._array=e||[]
};
AjxVector.prototype.isAjxVector=true;
AjxVector.prototype.toString=function(n,t){
if(t!==true){
return this._array.join(n)
}
var o=new Array();
for(var s=0;
s<this._array.length;
s++){
var e=this._array[s];
if(e!=undefined&&e!=null&&e!=""){
o.push(e)
}}
return o.join(n)
};
AjxVector.fromArray=function(t){
var e=new AjxVector();
e._array.length=0;
if(AjxUtil.isArray1(t)){
e._array=t
}
return e
};
AjxVector.prototype.size=function(){
return this._array.length
};
AjxVector.prototype.add=function(a,e,t){
if(t&&this.contains(a)){
return
}
AjxUtil.arrayAdd(this._array,a,e)
};
AjxVector.prototype.addList=function(a){
if(!a){
return
}
if(a.length){
this._array=this._array.concat(a)
}else{
if(a.size&&a.size()){
if(AjxEnv.isIE&&(!(a._array instanceof Array))){
var t=[];
for(var e=0;
e<a._array.length;
e++){
t.push(a._array[e])
}
a._array=t
}
this._array=this._array.concat(a._array)
}}};
AjxVector.prototype.remove=function(e){
return AjxUtil.arrayRemove(this._array,e)
};
AjxVector.prototype.removeAt=function(t){
if(t>=this._array.length||t<0){
return null
}
var a=this._array.splice(t,1);
var e=null;
if(a){
e=a[0]
}
return e
};
AjxVector.prototype.removeAll=function(){
for(var e=0;
e<this._array.length;
e++){
this._array[e]=null
}
this._array.length=0
};
AjxVector.prototype.removeLast=function(){
return this._array.length>0?this._array.pop():null
};
AjxVector.prototype.reverse=function(){
this._array.reverse()
};
AjxVector.prototype.replace=function(a,t){
var e=this._array[a];
this._array[a]=t;
return e
};
AjxVector.prototype.replaceObject=function(a,e){
for(var t=0;
t<this._array.length;
t++){
if(this._array[t]==a){
this._array[t]=e;
return a
}}
return null
};
AjxVector.prototype.indexOf=function(t){
if(t==null){
return -1
}
for(var e=0;
e<this._array.length;
e++){
if(this._array[e]==t){
return e
}}
return -1
};
AjxVector.prototype.indexOfLike=function(o,a){
var t=a.call(o);
for(var e=0;
e<this._array.length;
e++){
var n=a.call(this._array[e]);
if(n==t){
return e
}}
return -1
};
AjxVector.prototype.clone=function(){
var e=new AjxVector();
e.addList(this);
return e
};
AjxVector.prototype.contains=function(e){
return AjxUtil.arrayContains(this._array,e)
};
AjxVector.prototype.containsLike=function(o,a){
var t=a.call(o);
for(var e=0;
e<this._array.length;
e++){
var n=a.call(this._array[e]);
if(n==t){
return true
}}
return false
};
AjxVector.prototype.get=function(e){
return e>=this._array.length||e<0?null:this._array[e]
};
AjxVector.prototype.getArray=function(){
return this._array
};
AjxVector.prototype.getLast=function(){
return this._array.length==0?null:this._array[this._array.length-1]
};
AjxVector.prototype.getNext=function(t){
var e=this.indexOf(t);
if(e==-1){
return null
}
return this.get(++e)
};
AjxVector.prototype.getPrev=function(t){
var e=this.indexOf(t);
if(e==-1){
return null
}
return this.get(--e)
};
AjxVector.prototype.sort=function(e){
if(!e){
e=AjxVector._defaultArrayComparator
}
this._array.sort(e)
};
AjxVector.prototype.binarySearch=function(s,r){
if(!r){
r=AjxVector._defaultArrayComparator
}
var a=0;
var e=this._array;
var o=e.length-1;
while(true){
if(o<a){
return -1
}
var n=Math.floor((a+o)/2);
var t=r(s,e[n]);
if(t<0){
o=n-1
}else{
if(t>0){
a=n+1
}else{
return n
}}}};
AjxVector.prototype.merge=function(n,o){
if(n<0){
return
}
var s=o instanceof AjxVector?o.getArray():o;
var e=this._array.length<(n+s.length)?this._array.length:n+s.length;
if(n<this._array.length){
var a=0;
for(var t=n;
t<e;
t++){
this._array[t]=s[a++]
}
if(a<s.length){
this._array=this._array.concat(s.slice(a))
}}else{
this._array=this._array.concat(s)
}};
AjxVector._defaultArrayComparator=function(t,e){
return t<e?-1:(t>e?1:0)
};
AjxVector.prototype.foreach=function(o,n){
var e=this.size(),t=0,a;
if(typeof o=="function"){
while(--e>=0){
o.call(n,this.get(t),t++)
}}else{
while(--e>=0){
a=this.get(t++);
if(a!=null){
a[o].call(a)
}}}};
AjxVector.prototype.map=function(n,s){
var e=[],t=this.size(),o;
if(typeof n=="function"){
while(--t>=0){
e[t]=n.call(s,this.get(t),t)
}}else{
if(n instanceof AjxCallback){
while(--t>=0){
e[t]=n.run(this.get(t),t)
}}else{
while(--t>=0){
o=this.get(t);
if(o!=null){
if(typeof o[n]=="function"){
e.unshift(o[n].call(o))
}else{
e.unshift(o[n])
}}}}}
return AjxVector.fromArray(e)
};
AjxVector.prototype.join=function(e){
return this._array.join(e)
};
AjxVector.prototype.sub=function(s,r){
var t=[],e=this.size(),o=0,n;
while(--e>=0){
n=this.get(o++);
if(!s.call(r,n,o)){
t.push(n)
}}
return AjxVector.fromArray(t)
};
AjxVector.prototype.slice=function(t,e){
return AjxVector.fromArray(this._array.slice(t,e))
}
}
if(AjxPackage.define("ajax.util.AjxStringUtil")){
AjxStringUtil=function(){};
AjxStringUtil.TRIM_RE=/^\s+|\s+$/g;
AjxStringUtil.COMPRESS_RE=/\s+/g;
AjxStringUtil.ELLIPSIS=" ... ";
AjxStringUtil.LIST_SEP=", ";
AjxStringUtil.IMG_SRC_CID_REGEX=/<img([^>]*)\ssrc=["']cid:/gi;
AjxStringUtil.makeString=function(e){
return e?String(e):""
};
AjxStringUtil.capitalize=function(e){
return e.length>0?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""
};
AjxStringUtil.capitalizeWords=function(e){
return AjxUtil.map(e.split(/\s+/g),AjxStringUtil.capitalize).join(" ")
};
AjxStringUtil.toMixed=function(s,e,o){
if(!s||(typeof s!="string")){
return""
}
e=e||/\s+/;
var a=s.split(e);
var n=[];
n.push(o?a[0].toLowerCase():a[0].substring(0,1).toUpperCase()+a[0].substring(1).toLowerCase());
for(var t=1;
t<a.length;
t++){
n.push(a[t].substring(0,1).toUpperCase()+a[t].substring(1).toLowerCase())
}
return n.join("")
};
AjxStringUtil.fromMixed=function(t,e){
e=["$1",e||" ","$2"].join("");
return AjxStringUtil.trim(t.replace(/([a-z])([A-Z]+)/g,e))
};
AjxStringUtil.trim=function(n,e,o){
if(!n){
return""
}
var a=AjxStringUtil.TRIM_RE;
var t=AjxStringUtil.COMPRESS_RE;
if(o){
a=new RegExp("^"+o+"+|"+o+"+$","g");
t=new RegExp(o+"+","g")
}else{
o=" "
}
n=n.replace(a,"");
if(e){
n=n.replace(t,o)
}
return n
};
AjxStringUtil.repeat=function(o,e){
var a="";
for(var t=0;
t<e;
t++){
a+=o
}
return a
};
AjxStringUtil.getUnitsFromSizeString=function(t){
var a="px";
if(typeof(t)=="string"){
var e=Number(parseInt(t,10)).toString();
if(t.length>e.length){
a=t.substr(e.length,(t.length-e.length));
if(!(a=="em"||a=="ex"||a=="px"||a=="in"||a=="cm"==a=="mm"||a=="pt"||a=="pc"||a=="%")){
a="px"
}}}
return a
};
AjxStringUtil.split=function(l,o){
if(!l){
return[]
}
var s=0;
o=o?o:",";
var u=new Object();
if(typeof o=="string"){
u[o]=1
}else{
for(s=0;
s<o.length;
s++){
u[o[s]]=1
}}
var e=false;
var a=0;
var t=0;
var d;
var r=[];
var n=0;
for(s=0;
s<l.length;
s++){
var h=l.charAt(s);
if(h=='"'){
e=!e
}else{
if(h=="("){
a++
}else{
if(h==")"){
a--
}else{
if(u[h]){
if(!e&&!a){
d=l.substring(t,s);
r[n++]=d;
t=s+1
}}}}}}
d=l.substring(t,l.length);
r[n++]=d;
return r
};
AjxStringUtil.splitKeepLeadingWhitespace=function(t){
var o=/\s*\S+/g;
var n=[];
var e;
while(e=o.exec(t)){
var a=e[0];
n.push(a)
}
return n
};
AjxStringUtil.wordWrap=function(M){
if(!(M&&M.text)){
return""
}
var g=M.text;
var y=M.before||"",t=M.after||"";
if(M.htmlMode){
return[y,g,t].join("")
}
var C=M.len||80;
var q=M.pre||"";
var n="\n";
g=AjxStringUtil.trim(g,false,"[\t ]");
g=g.replace(/\r\n/g,n);
var e=g.split(n);
var x=[];
for(var T=0,F=e.length;
T<F;
T++){
var c=e[T];
var j=c.match(/^([\s>\|]+)/);
var O=j?j[1]:"";
if(O){
c=c.substr(O.length)
}
var r=AjxStringUtil.splitKeepLeadingWhitespace(c);
if(r&&r[0]&&r[0].length){
var z=AjxStringUtil.MSG_SEP_RE.test(c)||AjxStringUtil.COLON_RE.test(c)||AjxStringUtil.HDR_RE.test(c)||AjxStringUtil.SIG_RE.test(c);
for(var d=0,f=r.length;
d<f;
d++){
var s=M.preserveReturns&&(d==f-1);
x.push({
w:r[d],p:O,special:(z&&d==0),lastWord:s}
)
}}else{
x.push({
para:true,p:O}
)
}}
var B=M.len||80;
var o=M.pre||"";
var u=o.length;
var h="",a=0,r=[],v=null;
for(var W=0,C=x.length;
W<C;
W++){
var D=x[W];
var d=D.w,k=D.p;
var A=r.length?1:0;
var S=(v===null)?0:v.length;
if(D.para){
if(r.length){
h+=o+(v||"")+r.join("").replace(/^ +/,"")+n
}
h+=o+k+n;
r=[];
a=0;
v=null
}else{
if((u+S+a+A+d.length<=B)&&(k==v||v===null)&&!D.special){
r.push(d);
a+=d.length;
v=k;
if(D.lastWord&&x[W+1]){
x[W+1].special=true
}}else{
if(r.length){
h+=o+(v||"")+r.join("").replace(/^ +/,"")+n
}
r=[d];
a=d.length;
v=k;
if(D.lastWord&&x[W+1]){
x[W+1].special=true
}}}}
if(r.length){
h+=o+v+r.join("").replace(/^ /,"")+n
}
return[y,h,t].join("")
};
AjxStringUtil.quoteText=function(o){
if(!(o&&o.text)){
return""
}
var c=o.text;
var h=o.before||"",e=o.after||"";
if(o.htmlMode||!o.pre){
return[h,c,e].join("")
}
var s=o.len||80;
var a=o.pre||"";
var r="\n";
c=AjxStringUtil.trim(c);
c=c.replace(/\n\r/g,r);
var m=c.split(r);
var u=[];
for(var t=0,n=m.length;
t<n;
t++){
var d=AjxStringUtil.trim(m[t]);
u.push(a+d+r)
}
return h+u.join("")+e
};
AjxStringUtil.SHIFT_CHAR={
48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};
AjxStringUtil.shiftChar=function(e,t){
return t?AjxStringUtil.SHIFT_CHAR[e]||String.fromCharCode(e):String.fromCharCode(e)
};
AjxStringUtil.diffPoint=function(o,a){
if(!(o&&a)){
return 0
}
var e=Math.min(o.length,a.length);
var t=0;
while(t<e&&(o.charAt(t)==a.charAt(t))){
t++
}
return t
};
AjxStringUtil.resolve=function(t,e){
return AjxMessageFormat.format(t,e)
};
AjxStringUtil.urlEncode=function(t){
if(!t){
return""
}
var e=window.encodeURL||window.encodeURI;
return e(t)
};
AjxStringUtil.urlComponentEncode=function(t){
if(!t){
return""
}
var e=window.encodeURLComponent||window.encodeURIComponent;
return e(t)
};
AjxStringUtil.urlDecode=function(o){
if(!o){
return""
}
var t=window.decodeURL||window.decodeURI;
try{
return t(o)
}
catch(a){
return""
}};
AjxStringUtil.urlComponentDecode=function(n){
if(!n){
return""
}
var a=window.decodeURLComponent||window.decodeURIComponent;
var t;
try{
t=a(n)
}
catch(o){
t=unescape(n)
}
return t||n
};
AjxStringUtil.ENCODE_MAP={
">":"&gt;","<":"&lt;","&":"&amp;"};
AjxStringUtil.htmlEncode=function(t,e){
if(!t){
return""
}
if(typeof(t)!="string"){
t=t.toString?t.toString():""
}
if(!AjxEnv.isSafari||AjxEnv.isSafariNightly){
if(e){
return t.replace(/[<>&]/g,function(a){
return AjxStringUtil.ENCODE_MAP[a]
}
).replace(/  /g," &nbsp;")
}else{
return t.replace(/[<>&]/g,function(a){
return AjxStringUtil.ENCODE_MAP[a]
}
)
}}else{
if(e){
return t.replace(/[&]/g,"&amp;").replace(/  /g," &nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}else{
return t.replace(/[&]/g,"&amp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}}};
AjxStringUtil.encodeQuotes=function(e){
return e.replace(/"/g,"&quot;").replace(/'/g,"&#39;")
};
AjxStringUtil.htmlDecode=function(t,e){
if(e){
t=t.replace(/&nbsp;/g," ")
}
return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")
};
AjxStringUtil.__jsEscapeChar=function(t){
var e=t.charCodeAt(0).toString(16);
if(e.length==1){
return"\\u000"+e
}else{
if(e.length==2){
return"\\u00"+e
}else{
if(e.length==3){
return"\\u0"+e
}else{
if(e.length==4){
return"\\u"+e
}}}}
DBG.println(AjxDebug.NONE,"unexpected condition in AjxStringUtil.__jsEscapeChar -- code point 0x"+e+" doesn't fit in 16 bits")
};
AjxStringUtil.jsEncode=function(e){
return e.replace(/[^\u0020-\u007e]/g,AjxStringUtil.__jsEscapeChar)
};
AjxStringUtil.stripTags=function(t,e){
if(!t){
return""
}
if(e){
t=t.replace(/(<(\w+)[^>]*>).*(<\/\2[^>]*>)/,"$1$3")
}
return t.replace(/<\/?[^>]+>/gi,"")
};
AjxStringUtil.convertToHtml=function(r,s){
if(!r){
return""
}
if(s){
var n=/^(>|\|\s+)/;
var t=r.split(/\r?\n/);
var h=0;
for(var a=0;
a<t.length;
a++){
var e=t[a];
if(e.length>0){
var o=0;
while(e.match(n)){
e=e.replace(n,"");
o++
}
while(o>h){
e="<blockquote>"+e;
h++
}
while(o<h){
e=e+"</blockquote>";
h--
}}
t[a]=e
}
while(h>0){
t.push("</blockquote>");
h--
}
r=t.join("\n");
r=r.replace(/&/mg,"&amp;");
r=r.replace(/<(?!\/?blockquote)/mg,"&lt;");
r=r.replace(/(\/?blockquote)?>/mg,function(c,l){
return l?c:"&gt;"
}
)
}else{
r=r.replace(/&/mg,"&amp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;")
}
r=r.replace(/  /mg," &nbsp;").replace(/^ /mg,"&nbsp;").replace(/\t/mg,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\r?\n/mg,"<br>");
return r
};
AjxStringUtil.SPACE_ENCODE_MAP={
" ":"&nbsp;",">":"&gt;","<":"&lt;","&":"&amp;","\n":"<br>"};
AjxStringUtil.htmlEncodeSpace=function(e){
if(!e){
return""
}
return e.replace(/[&]/g,"&amp;").replace(/ /g,"&nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
};
AjxStringUtil.htmlRubyEncode=function(e,t){
if(e&&t){
return["<ruby>","<rb>",AjxStringUtil.htmlEncode(e),"</rb> ","<rp>(</rp><rt>",AjxStringUtil.htmlEncode(t),"</rt><rp>)</rp>","</ruby>"].join("")
}
return AjxStringUtil.htmlEncode(e||t||"")
};
AjxStringUtil.nl2br=function(e){
if(!e){
return""
}
return e.replace(/^ /mg,"&nbsp;").replace(/\t/mg,"<span style='white-space:pre'>\t</span>").replace(/\n/g,"<br>")
};
AjxStringUtil.xmlEncode=function(e){
if(e){
e=""+e;
return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")
}
return""
};
AjxStringUtil.xmlDecode=function(e){
return e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<"):""
};
AjxStringUtil.xmlAttrEncode=function(e){
return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&apos;"):""
};
AjxStringUtil.xmlAttrDecode=function(e){
return e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&apos;/g,"'"):""
};
AjxStringUtil.__RE_META={
" ":" ","\n":"\\n","\r":"\\r","\t":"\\t"};
AjxStringUtil.__reMetaEscape=function(t,e){
return AjxStringUtil.__RE_META[e]||"\\"+e
};
AjxStringUtil.regExEscape=function(e){
return e.replace(/(\W)/g,AjxStringUtil.__reMetaEscape)
};
AjxStringUtil._calcDIV=null;
AjxStringUtil.calcDIV=function(){
if(AjxStringUtil._calcDIV==null){
AjxStringUtil._calcDIV=document.createElement("div");
AjxStringUtil._calcDIV.style.zIndex=0;
AjxStringUtil._calcDIV.style.position=DwtControl.ABSOLUTE_STYLE;
AjxStringUtil._calcDIV.style.visibility="hidden";
document.body.appendChild(AjxStringUtil._calcDIV)
}
return AjxStringUtil._calcDIV
};
AjxStringUtil.clip=function(e,s,n){
var o=AjxStringUtil.calcDIV();
if(arguments.length==3){
o.className=n
}
o.innerHTML=e;
if(o.offsetWidth<=s){
return e
}
for(var a=e.length-1;
a>0;
a--){
var t=e.substr(0,a);
o.innerHTML=t+AjxStringUtil.ELLIPSIS;
if(o.offsetWidth<=s){
return t+AjxStringUtil.ELLIPSIS
}}
return e
};
AjxStringUtil.clipByLength=function(a,t){
var e=a.length;
return(e<=t)?a:[a.substr(0,t/2),"...",a.substring(e-((t/2)-3),e)].join("")
};
AjxStringUtil.wrap=function(s,r,h){
var m=AjxStringUtil.calcDIV();
if(arguments.length==3){
m.className=h
}
var l="";
var n="";
var e=s.split("/n");
for(var o=0;
o<e.length;
o++){
if(o!=0){
l+=n+"<br>";
n=""
}
htmlRows=e[o].split("<br>");
for(var d=0;
d<htmlRows.length;
d++){
if(d!=0){
l+=n+"<br>";
n=""
}
words=htmlRows[d].split(" ");
var u=0;
while(u<words.length){
m.innerHTML=n+" "+words[u];
var a=m.offsetWidth;
if(a>r){
m.innerHTML=words[u];
a=a-m.offsetWidth;
if((a>=r)||(m.offsetWidth<=r)){
l+=n+"<br>";
n=""
}else{
var c=true;
var t=0;
while(c){
t++;
m.innerHTML=n+" "+words[u].substring(0,t);
c=(m.offsetWidth<=r)
}
t--;
l+=n+words[u].substring(0,t)+"<br>";
words[u]=words[u].substr(t);
n=""
}}else{
n+=" "+words[u];
u++
}}}}
l+=n;
return l
};
AjxStringUtil.MSG_SEP_RE=new RegExp("^\\s*--+\\s*("+AjxMsg.origMsg+"|"+AjxMsg.forwardedMessage+")\\s*--+","i");
AjxStringUtil.SIG_RE=/^(- ?-+)|(__+)\r?$/;
AjxStringUtil.SPLIT_RE=/\r\n|\r|\n/;
AjxStringUtil.HDR_RE=/^\s*\w+:/;
AjxStringUtil.COLON_RE=/\S+:$/;
AjxStringUtil.HTML_QUOTE_COLOR="#1010FF";
AjxStringUtil.HTML_QUOTE_STYLE="color:#000;font-weight:normal;font-style:normal;text-decoration:none;font-family:Helvetica,Arial,sans-serif;font-size:12pt;";
AjxStringUtil._NO_LIST=0;
AjxStringUtil._ORDERED_LIST=1;
AjxStringUtil._UNORDERED_LIST=2;
AjxStringUtil._INDENT="    ";
AjxStringUtil._NON_WHITESPACE=/\S+/;
AjxStringUtil._LF=/\n/;
AjxStringUtil.convertHtml2Text=function(o,s,n){
if(!o){
return""
}
if(s&&AjxUtil.isFunction(s._before)){
o=s._before(o)
}
if(typeof o=="string"){
var r=document.createElement("SPAN");
r.innerHTML=o;
o=r
}
var h=[];
var a=0;
var t={};
AjxStringUtil._traverse(o,h,a,AjxStringUtil._NO_LIST,0,0,t,s,n);
var e=h.join("");
if(s&&AjxUtil.isFunction(s._after)){
e=s._after(e)
}
return e
};
AjxStringUtil._traverse=function(e,f,d,l,r,n,s,c,u){
var h=e.nodeName.toLowerCase();
var p=null;
if(c&&c[h]){
p=c[h](e,s)
}
if(p!=null){
f[d++]=p
}else{
if(h=="#text"){
if(e.nodeValue.search(AjxStringUtil._NON_WHITESPACE)!=-1){
if(s.lastNode=="ol"||s.lastNode=="ul"){
f[d++]="\n"
}
if(s.isPreformatted){
f[d++]=AjxStringUtil.trim(e.nodeValue)+" "
}else{
f[d++]=AjxStringUtil.trim(e.nodeValue.replace(AjxStringUtil._LF," "),true)+" "
}}}else{
if(h=="p"){
f[d++]=u?"\n":"\n\n"
}else{
if(l==AjxStringUtil._NO_LIST&&(h=="br"||h=="hr")){
f[d++]="\n"
}else{
if(h=="ol"||h=="ul"){
f[d++]="\n";
if(e.parentNode.nodeName.toLowerCase()!="li"&&s.lastNode!="br"&&s.lastNode!="hr"){
f[d++]="\n"
}
l=(h=="ol")?AjxStringUtil._ORDERED_LIST:AjxStringUtil._UNORDERED_LIST;
r++;
n=0
}else{
if(h=="li"){
for(var a=0;
a<r;
a++){
f[d++]=AjxStringUtil._INDENT
}
if(l==AjxStringUtil._ORDERED_LIST){
f[d++]=n+". "
}else{
f[d++]="\u002A "
}}else{
if(h=="tr"&&e.parentNode.firstChild!=e){
f[d++]="\n"
}else{
if(h=="td"&&e.parentNode.firstChild!=e){
f[d++]="\t"
}else{
if(h=="div"||h=="address"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}}else{
if(h=="blockquote"){
f[d++]="\n\n"
}else{
if(h=="pre"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}
s.isPreformatted=true
}else{
if(h=="#comment"||h=="script"||h=="select"||h=="style"){
return d
}}}}}}}}}}}}
var m=e.childNodes;
var o=m.length;
for(var a=0;
a<o;
a++){
var t=m[a];
if(t.nodeType==1&&t.tagName.toLowerCase()=="li"){
n++
}
d=AjxStringUtil._traverse(t,f,d,l,r,n,s,c,u)
}
if(c&&c["/"+h]){
f[d++]=c["/"+h](e)
}
if(h=="h1"||h=="h2"||h=="h3"||h=="h4"||h=="h5"||h=="h6"||h=="div"||h=="address"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}
s.list=false
}else{
if(h=="pre"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}
s.isPreformatted=false
}else{
if(h=="li"){
if(!s.list){
f[d++]="\n"
}
s.list=false
}else{
if(h=="ol"||h=="ul"){
s.list=true
}else{
if(h!="#text"){
s.list=false
}}}}}
s.lastNode=h;
return d
};
AjxStringUtil.queryStringSet=function(r,l){
var h=l?"":location.search;
if(h.indexOf("?")==0){
h=h.substr(1)
}
var s=h.split("&");
var a={};
for(var o=0;
o<s.length;
o++){
var n=s[o].split("=");
a[n[0]]=n[1]
}
for(var e in r){
a[e]=r[e]
}
var t=[];
var o=0;
for(var e in a){
if(e){
t[o++]=[e,a[e]].join("=")
}}
return"?"+t.join("&")
};
AjxStringUtil.queryStringRemove=function(e,a){
e=e?e:"";
if(e.indexOf("?")==0){
e=e.substr(1)
}
var n=e.split("&");
var t=[];
for(var o=0;
o<n.length;
o++){
if(n[o].indexOf(a)!=0){
t.push(n[o])
}}
return"?"+t.join("&")
};
AjxStringUtil.getAsString=function(e){
return !e?"":(typeof(e)=="object")?e.toString():e
};
AjxStringUtil.isWhitespace=function(e){
return(e.charCodeAt(0)<=32)
};
AjxStringUtil.isDigit=function(t){
var e=t.charCodeAt(0);
return(e>=48&&e<=57)
};
AjxStringUtil.compareRight=function(n,t){
var s=0;
var h=0;
var r=0;
var o;
var e;
for(;
(h<n.length||r<t.length);
h++,r++){
o=n.charAt(h);
e=t.charAt(r);
if(!AjxStringUtil.isDigit(o)&&!AjxStringUtil.isDigit(e)){
return s
}else{
if(!AjxStringUtil.isDigit(o)){
return -1
}else{
if(!AjxStringUtil.isDigit(e)){
return +1
}else{
if(o<e){
if(s==0){
s=-1
}}else{
if(o>e){
if(s==0){
s=+1
}}}}}}}};
AjxStringUtil.natCompare=function(l,h){
var r=0,n=0;
var t=0,e=0;
var s,o;
while(r<l.length||n<h.length){
t=e=0;
s=l.charAt(r);
o=h.charAt(n);
while(AjxStringUtil.isWhitespace(s)||s=="0"){
t=(s=="0")?(t+1):0;
s=l.charAt(++r)
}
while(AjxStringUtil.isWhitespace(o)||o=="0"){
e=(o=="0")?(e+1):0;
o=h.charAt(++n)
}
if(AjxStringUtil.isDigit(s)&&AjxStringUtil.isDigit(o)){
var c=AjxStringUtil.compareRight(l.substring(r),h.substring(n));
if(c&&c!=0){
return c
}}
if(s==0&&o==0){
return t-e
}
if(s<o){
return -1
}else{
if(s>o){
return +1
}}
++r;
++n
}};
AjxStringUtil.clipFile=function(s,t){
var a=s.lastIndexOf(".");
var e=a?(a+1):s.length;
if(e<=t){
return s
}else{
var n=s.substr(0,a);
var o=s.substr(a+1,s.length-1);
return[n.substr(0,t/2),"...",n.substring(e-((t/2)-3),e),".",(o?o:"")].join("")
}};
AjxStringUtil.URL_PARSE_RE=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)?((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?");
AjxStringUtil.parseURL=function(a){
var n=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"];
var o=AjxStringUtil.URL_PARSE_RE.exec(a);
var t={};
for(var e=0;
e<n.length;
e++){
t[n[e]]=(o[e]?o[e]:"")
}
if(t.directoryPath.length>0){
t.directoryPath=t.directoryPath.replace(/\/?$/,"/")
}
return t
};
AjxStringUtil.parseQueryString=function(s){
var a=s||(""+window.location);
var t=a.indexOf("?");
if(t==-1){
return null
}
var e=a.substring(t+1).replace(/#.*$/,"");
var n=e.split("&");
var h={};
for(var o=0;
o<n.length;
o++){
var r=n[o].split("=");
h[r[0]]=r[1]
}
return h
};
AjxStringUtil.prettyPrint=function(o,a,e,t){
AjxStringUtil._visited=new AjxVector();
var n=AjxStringUtil._prettyPrint(o,a,e,t);
AjxStringUtil._visited=null;
return n
};
AjxStringUtil._visited=null;
AjxStringUtil._prettyPrint=function(r,t,y,a){
var d=0;
var o=false;
var u=false;
if(arguments.length>4){
d=arguments[4];
o=arguments[5];
u=arguments[6]
}
if(AjxUtil.isObject(r)){
var p=r.toString?r.toString():"";
if(a&&p&&a[p]){
return"["+p+"]"
}
if(AjxStringUtil._visited.contains(r)){
return"[visited object]"
}else{
AjxStringUtil._visited.add(r)
}}
var s=AjxStringUtil.repeat(" ",d);
var h="";
if(r===undefined){
h+="[undefined]"
}else{
if(r===null){
h+="[null]"
}else{
if(AjxUtil.isBoolean(r)){
h+=r?"true":"false"
}else{
if(AjxUtil.isString(r)){
h+='"'+AjxStringUtil._escapeForHTML(r)+'"'
}else{
if(AjxUtil.isNumber(r)){
h+=r
}else{
if(AjxUtil.isObject(r)){
var n=AjxUtil.isArray(r)||AjxUtil.isArray1(r);
if(u){
h+=n?"[Array]":r.toString()
}else{
u=!t;
var l=new Array();
for(var m in r){
if(r.hasOwnProperty(m)){
l.push(m)
}}
if(n){
l.sort(function(k,v){
return k-v
}
)
}else{
l.sort()
}
if(o){
h+=n?"[":"{"
}
var f=l.length;
for(var m=0;
m<f;
m++){
var w=l[m];
var g=r[w];
var c=null;
if(g==window||g==document||(!AjxEnv.isIE&&g instanceof Node)){
c=g.toString()
}
if((typeof(g)=="function")){
if(y){
c="[function]"
}else{
continue
}}
if(m>0){
h+=","
}
h+="\n"+s;
var e;
if(n){
e="// ["+w+"]:\n"+s
}else{
e=w+": "
}
if(a&&a[w]){
h+=e+"["+w+"]"
}else{
if(c!=null){
h+=e+c
}else{
h+=e+AjxStringUtil._prettyPrint(g,t,y,a,d+2,true,u)
}}}
if(m>0){
h+="\n"+AjxStringUtil.repeat(" ",d-1)
}
if(o){
h+=n?"]":"}"
}}}}}}}}
return h
};
AjxStringUtil._escapeForHTML=function(t){
if(typeof(t)!="string"){
return t
}
var e=t;
e=e.replace(/\&/g,"&amp;");
e=e.replace(/\</g,"&lt;");
e=e.replace(/\>/g,"&gt;");
e=e.replace(/\"/g,"&quot;");
e=e.replace(/\xA0/g,"&nbsp;");
return e
};
AjxStringUtil._testSpan;
AjxStringUtil._testSpanBold;
AjxStringUtil.WIDTH={};
AjxStringUtil.WIDTH_BOLD={};
AjxStringUtil.MAX_CACHE=1000;
AjxStringUtil._cacheSize=0;
AjxStringUtil.getWidth=function(n,o,l){
if(!AjxStringUtil._testSpan){
var a=AjxStringUtil._testSpan=document.createElement("SPAN");
var t=AjxStringUtil._testSpanBold=document.createElement("SPAN");
a.style.position=t.style.position=Dwt.ABSOLUTE_STYLE;
var c=DwtShell.getShell(window).getHtmlElement();
c.appendChild(a);
c.appendChild(t);
Dwt.setLocation(a,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
Dwt.setLocation(t,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
t.style.fontWeight="bold"
}
if(AjxUtil.isString(l)){
l=l.replace(/px$/,"")
}
var s=""+(l||0);
var e=o?AjxStringUtil.WIDTH_BOLD:AjxStringUtil.WIDTH;
if(e[n]&&e[n][s]){
return e[n][s]
}
if(AjxStringUtil._cacheSize>=AjxStringUtil.MAX_CACHE){
AjxStringUtil.WIDTH={};
AjxStringUtil.WIDTH_BOLD={};
AjxStringUtil._cacheSize=0
}
var h=o?AjxStringUtil._testSpanBold:AjxStringUtil._testSpan;
h.innerHTML=n;
h.style.fontSize=l?(l+"px"):null;
if(!e[n]){
e[n]={}
}
var r=e[n][s]=Dwt.getSize(h).x;
AjxStringUtil._cacheSize++;
return r
};
AjxStringUtil.fixCrossDomainReference=function(t,a){
var n=AjxStringUtil.parseURL(t);
if(n.authority==window.location.host){
return t
}
if((a&&t.indexOf(a)>=0)||!a){
var o=n.protocol+"://"+n.authority;
var e=window.location.protocol+"//"+window.location.host;
t=t.replace(o,e)
}
return t
};
AjxStringUtil._dummyDiv=document.createElement("DIV");
AjxStringUtil.htmlPlatformIndependent=function(t){
var a=AjxStringUtil._dummyDiv;
a.innerHTML=t;
var e=a.innerHTML;
a.innerHTML="";
return e
};
AjxStringUtil.equalsHtmlPlatformIndependent=function(t,e){
return AjxStringUtil.htmlPlatformIndependent(t)==AjxStringUtil.htmlPlatformIndependent(e)
};
AjxStringUtil.ORIG_UNKNOWN="UNKNOWN";
AjxStringUtil.ORIG_QUOTED="QUOTED";
AjxStringUtil.ORIG_SEP_STRONG="SEP_STRONG";
AjxStringUtil.ORIG_SEP_WEAK="SEP_WEAK";
AjxStringUtil.ORIG_WROTE_STRONG="WROTE_STRONG";
AjxStringUtil.ORIG_WROTE_WEAK="WROTE_WEAK";
AjxStringUtil.ORIG_HEADER="HEADER";
AjxStringUtil.ORIG_LINE="LINE";
AjxStringUtil.ORIG_SIG_SEP="SIG_SEP";
AjxStringUtil.MSG_REGEXES=[{
type:AjxStringUtil.ORIG_QUOTED,regex:/^\s*(>|\|)/}
,{
type:AjxStringUtil.ORIG_SEP_STRONG,regex:new RegExp("^\\s*--+\\s*("+AjxMsg.origMsg+"|"+AjxMsg.forwardedMessage+"|"+AjxMsg.origAppt+")\\s*--+\\s*$","i")}
,{
type:AjxStringUtil.ORIG_HEADER,regex:new RegExp("^\\s*("+[AjxMsg.from,AjxMsg.to,AjxMsg.subject,AjxMsg.date,AjxMsg.sent,AjxMsg.cc].join("|")+")")}
,{
type:AjxStringUtil.ORIG_LINE,regex:/^\s*_{5,}\s*$/}
];
AjxStringUtil.HTML_SEP_ID="zwchr";
AjxStringUtil.ORIG_EMAIL_RE=/[^@\s]+@[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})+/;
AjxStringUtil.ORIG_DATE_RE=/, 20\d\d/;
AjxStringUtil.ORIG_INTRO_RE=new RegExp("^(-{2,}|"+AjxMsg.on+")","i");
AjxStringUtil._writeToTestIframeDoc=function(t){
var e=AjxStringUtil._htmlContentIframeDoc;
if(!e||AjxEnv.isFirefox||AjxEnv.isIE){
var a=document.createElement("IFRAME");
a.id=Dwt.getNextId();
Dwt.setPosition(a,Dwt.ABSOLUTE_STYLE);
Dwt.setLocation(a,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
document.body.appendChild(a);
e=AjxStringUtil._htmlContentIframeDoc=Dwt.getIframeDoc(a);
AjxStringUtil.__curIframeId=AjxEnv.isFirefox?a.id:null
}
t=t&&t.replace(AjxStringUtil.IMG_SRC_CID_REGEX,'<img pnsrc="cid:');
e.open();
e.write(t);
e.close();
return e.childNodes[0]
};
AjxStringUtil._removeTestIframeDoc=function(){
if(AjxStringUtil.__curIframeId){
var e=document.getElementById(AjxStringUtil.__curIframeId);
if(e){
e.parentNode.removeChild(e)
}
AjxStringUtil.__curIframeId=null
}};
AjxStringUtil.getOriginalContent=function(u,d){
if(!u){
return""
}
if(d){
return AjxStringUtil._getOriginalHtmlContent(u)
}
var m=[];
var e=u.split(AjxStringUtil.SPLIT_RE);
var a,c=[],n={}
,s,p;
for(var y=0;
y<e.length;
y++){
var l=e[y];
var w=AjxStringUtil.trim(l);
if(!AjxStringUtil._NON_WHITESPACE.test(w)){
c.push(l);
continue
}
if((w.indexOf("| DO NOT REPLY")==0)&&(e[y+2].indexOf("bugzilla")!=-1)){
return u
}
var t=AjxStringUtil._getLineType(w);
var k=e[y+1];
var s=false;
if(k&&(t==AjxStringUtil.ORIG_UNKNOWN)&&AjxStringUtil.ORIG_INTRO_RE.test(w)&&k.match(/\w+:$/)){
w=[w,k].join(" ");
t=AjxStringUtil._getLineType(w);
s=true
}
if(t==AjxStringUtil.ORIG_LINE){
var g=y+1;
k=e[g];
while(!AjxStringUtil._NON_WHITESPACE.test(k)&&g<e.length){
k=e[++g]
}
var f=k&&AjxStringUtil._getLineType(k);
if(f==AjxStringUtil.ORIG_HEADER){
t=AjxStringUtil.ORIG_HEADER
}else{
t=AjxStringUtil.ORIG_UNKNOWN
}}
if(a){
if(a!=t){
m.push({
type:a,block:c}
);
p=(a==AjxStringUtil.ORIG_UNKNOWN)?c:p;
n[a]=n[a]?n[a]+1:1;
c=[];
a=t
}}else{
a=t
}
if(s&&(t==AjxStringUtil.ORIG_WROTE_WEAK||t==AjxStringUtil.ORIG_WROTE_STRONG)){
c.push(l);
c.push(k);
y++;
s=false
}else{
c.push(l)
}}
if(c.length){
m.push({
type:a,block:c}
);
p=(a==AjxStringUtil.ORIG_UNKNOWN)?c:p;
n[a]=n[a]?n[a]+1:1
}
if(n[AjxStringUtil.ORIG_SEP_STRONG]>0){
var r=[];
for(var y=0;
y<m.length;
y++){
var h=m[y];
if(h.type==AjxStringUtil.ORIG_SEP_STRONG){
break
}
r=r.concat(h.block)
}
var x=AjxStringUtil._getTextFromBlock(r);
if(x){
return x
}}
var x=AjxStringUtil._checkInlineWrote(n,m,false);
if(x){
return x
}
if(n[AjxStringUtil.ORIG_UNKNOWN]==1&&n[AjxStringUtil.ORIG_QUOTED]>0){
var x=AjxStringUtil._getTextFromBlock(p);
if(x){
return x
}}
var o=m[0],v=m[1];
if(o&&o.type==AjxStringUtil.ORIG_UNKNOWN&&v&&v.type==AjxStringUtil.ORIG_HEADER){
var x=AjxStringUtil._getTextFromBlock(o.block);
if(x){
return x
}}
return u
};
AjxStringUtil._getLineType=function(n){
var s=AjxStringUtil.ORIG_UNKNOWN;
for(var a=0;
a<AjxStringUtil.MSG_REGEXES.length;
a++){
var o=AjxStringUtil.MSG_REGEXES[a];
var r=o.regex;
if(r.test(n.toLowerCase())){
if(o.type==AjxStringUtil.ORIG_QUOTED&&/^\s*\|.*\|\s*$/.test(n)){
continue
}
s=o.type;
break
}}
if(s==AjxStringUtil.ORIG_UNKNOWN){
var t=n.match(/(\w+):$/);
var e=t&&t[1]&&t[1].toLowerCase();
if(e){
var h=0;
h=h+(e==AjxMsg.wrote)?5:(e==AjxMsg.changed)?0:3;
if(AjxStringUtil.ORIG_EMAIL_RE.test(n)){
h+=4
}
if(AjxStringUtil.ORIG_DATE_RE.test(n)){
h+=3
}
var l=new RegExp("^(--|"+AjxMsg.on+")","i");
if(AjxStringUtil.ORIG_INTRO_RE.test(n)){
h+=1
}
if(h>=7){
s=AjxStringUtil.ORIG_WROTE_STRONG
}else{
if(h>=5){
s=AjxStringUtil.ORIG_WROTE_WEAK
}}}}
return s
};
AjxStringUtil._getTextFromBlock=function(t){
if(!(t&&t.length)){
return null
}
var e=t.join("\n")+"\n";
e=e.replace(/\s+$/,"\n");
return(AjxStringUtil._NON_WHITESPACE.test(e))?e:null
};
AjxStringUtil.SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;
AjxStringUtil._getOriginalHtmlContent=function(s){
while(AjxStringUtil.SCRIPT_REGEX.test(s)){
s=s.replace(AjxStringUtil.SCRIPT_REGEX,"")
}
var n=AjxStringUtil._writeToTestIframeDoc(s);
var t={
curType:null,count:{}
,level:0,toRemove:[],done:false,hasQuoted:false,sepNode:null,results:[]};
AjxStringUtil._traverseOriginalHtmlContent(n,t);
AjxStringUtil._checkInlineWrote(t.count,t.results,true,t);
if(!t.done){
if(t.count[AjxStringUtil.ORIG_UNKNOWN]==1&&t.hasQuoted){
for(var a=0;
a<t.toRemove.length;
a++){
var o=t.toRemove[a];
if(o&&o.parentNode){
o.parentNode.removeChild(o)
}}
t.done=true
}}
var e=t.done?"<html>"+n.innerHTML+"</html>":s;
AjxStringUtil._removeTestIframeDoc();
return e
};
AjxStringUtil.IGNORE_NODE_LIST=["#comment","script","select","style"];
AjxStringUtil.IGNORE_NODE=AjxUtil.arrayAsHash(AjxStringUtil.IGNORE_NODE_LIST);
AjxStringUtil._traverseOriginalHtmlContent=function(a,d){
if(d.done||!a){
return
}
var f=a.nodeName.toLowerCase();
var u;
var h=true;
if(f=="#text"){
if(!AjxStringUtil._NON_WHITESPACE.test(a.nodeValue)){
return
}
var l=AjxStringUtil.trim(a.nodeValue);
u=AjxStringUtil._getLineType(l);
if(u==AjxStringUtil.ORIG_SEP_STRONG||u==AjxStringUtil.ORIG_WROTE_STRONG){
d.sepNode=a
}else{
if(u!=AjxStringUtil.ORIG_WROTE_STRONG){
var n=l.match(/(\w+):$/);
if(n&&n[1]&&a.parentNode){
l=AjxStringUtil.trim(AjxStringUtil.htmlDecode(AjxStringUtil.stripTags(a.parentNode.innerHTML)));
u=AjxStringUtil._getLineType(l);
if(u==AjxStringUtil.ORIG_WROTE_STRONG){
var o=a.parentNode,t=o.childNodes,r,y;
for(var s=o.childNodes.length-1;
s>=0;
s--){
var e=o.childNodes[s];
var g=e.nodeValue;
if(!g){
continue
}
if(g.match(/(\w+):$/)){
y=s
}else{
if((y!=null)&&g.match(AjxStringUtil.ORIG_INTRO_RE)){
r=s;
break
}}}
if(r!=null&&y!=null){
var p=document.createElement("span");
for(var s=0;
s<(y-r)+1;
s++){
p.appendChild(t[r])
}
o.insertBefore(p,t[r]);
d.sepNode=p
}}}}}}else{
if(f=="hr"){
if(a.id==AjxStringUtil.HTML_SEP_ID||(a.size=="2"&&a.width=="100%"&&a.align=="center")){
u=AjxStringUtil.ORIG_SEP_STRONG;
d.sepNode=a
}}else{
if(f=="pre"){
var g=AjxStringUtil.htmlDecode(AjxStringUtil.stripTags(a.innerHTML));
u=AjxStringUtil._getLineType(g)
}else{
if(f=="br"){
return
}else{
if(f=="div"){
if(a.className=="OutlookMessageHeader"){
u=AjxStringUtil.ORIG_SEP_STRONG;
d.sepNode=a
}}else{
if(f=="span"){
if(a.id=="OLK_SRC_BODY_SECTION"){
u=AjxStringUtil.ORIG_SEP_STRONG;
d.sepNode=a
}}else{
if(f=="img"){
u=AjxStringUtil.ORIG_UNKNOWN
}else{
if(f=="blockquote"){
u=AjxStringUtil.ORIG_QUOTED;
d.toRemove.push(a);
d.hasQuoted=true;
h=false
}else{
if(f=="script"){
throw new Error("SCRIPT tag found in AjxStringUtil._traverseOriginalHtmlContent")
}else{
if(AjxStringUtil.IGNORE_NODE[f]){
return
}}}}}}}}}}
if(u){
if(d.curType){
if(d.curType!=u){
d.count[d.curType]=d.count[d.curType]?d.count[d.curType]+1:1;
d.results.push({
type:d.curType}
);
d.curType=u;
d.curBlock=[]
}}else{
d.curType=u
}}
if(u==AjxStringUtil.ORIG_SEP_STRONG){
if(d.count[AjxStringUtil.ORIG_UNKNOWN]==1){
d.done=true
}}
if(!h){
return
}
d.level++;
for(var s=0,c=a.childNodes.length;
s<c;
s++){
var e=a.childNodes[s];
AjxStringUtil._traverseOriginalHtmlContent(e,d);
if(d.done){
while(a&&a.lastChild&&a.lastChild!=e){
a.removeChild(a.lastChild)
}
if(a&&a.lastChild==d.sepNode){
a.removeChild(a.lastChild)
}
break
}}
d.level--
};
AjxStringUtil.checkForCleanHtml=function(a,n,h,r){
var s=AjxStringUtil._writeToTestIframeDoc(a);
var t={
tags:AjxUtil.arrayAsHash(n),attrs:h||[],styles:r};
AjxStringUtil._traverseCleanHtml(s,t);
var e=!t.fail&&"<html>"+s.innerHTML+"</html>";
var o=Math.max(s.scrollWidth,s.lastChild.scrollWidth);
AjxStringUtil._removeTestIframeDoc();
return{
html:e,width:o}
};
AjxStringUtil._traverseCleanHtml=function(a,d){
var m=a.nodeName.toLowerCase();
if(m=="style"&&a.innerHTML=="p { margin: 0; }"){
a.doDelete=true
}else{
if(m=="title"&&a.innerHTML==""){}else{
if(d.tags[m]){
if(d.styles){
var t=a.style&&a.style.cssText;
if(t){
t=t.toLowerCase();
for(var n=0;
n<d.styles.length;
n++){
if(t.indexOf(d.styles[n])!=-1){
d.fail=true;
break
}}}}
if(a.removeAttribute&&a.attributes&&a.attributes.length){
for(var s=0;
s<d.attrs.length;
s++){
a.removeAttribute(d.attrs[s])
}
for(var s=0,f=a.attributes,o=f.length;
s<o;
s++){
var c=f.item(s);
var u=c.nodeName&&c.nodeName.toLowerCase();
if(u&&u.indexOf("on")===0){
a.removeAttribute(u);
continue
}
var r=c.nodeValue&&String(c.nodeValue);
if(r){
r=r.toLowerCase();
if(m=="table"&&(u=="cellpadding"||u=="cellspacing"||u=="border")&&r!="0"){
d.fail=true;
break
}}}}}else{
d.fail=true
}}}
if(d.fail){
return
}
for(var s=0,h=a.childNodes.length;
s<h;
s++){
var e=a.childNodes[s];
AjxStringUtil._traverseCleanHtml(e,d);
if(d.fail){
return
}}
for(var s=a.childNodes.length-1;
s>=0;
s--){
var e=a.childNodes[s];
if(e.doDelete){
a.removeChild(e)
}}};
AjxStringUtil._checkInlineWrote=function(l,r,e,c){
if(l[AjxStringUtil.ORIG_WROTE_STRONG]>0){
var m,n=false,t={};
for(var h=0;
h<r.length;
h++){
var f=r[h],d=f.type;
if(d==AjxStringUtil.ORIG_WROTE_STRONG){
n=true
}else{
if(d==AjxStringUtil.ORIG_UNKNOWN&&!n){
if(m){
return null
}else{
m=e?true:f.block
}}else{
if(n){
t[d]=true
}}}}
var u=(t[AjxStringUtil.ORIG_UNKNOWN]&&t[AjxStringUtil.ORIG_QUOTED]);
var o=(l[AjxStringUtil.ORIG_UNKNOWN]==2&&r[r.length-1].type==AjxStringUtil.ORIG_UNKNOWN);
if(m&&(!e||c.sepNode)&&(!u||o)){
if(e){
var a=c.sepNode.parentNode;
while(a&&a.lastChild&&a.lastChild!=c.sepNode){
a.removeChild(a.lastChild)
}
if(a&&a.lastChild==c.sepNode){
a.removeChild(a.lastChild)
}}else{
var s=AjxStringUtil._getTextFromBlock(m);
if(s){
return s
}}}}};
AjxStringUtil.removeTrailingBR=function(a){
if(!a){
return""
}
var e=a&&a.match(/((<br>)+)((<\/\w+>)+)$/i);
if(e&&e.length){
var t=new RegExp(e[1]+e[3]+"$","i");
a=a.replace(t,e[3])
}
return a
};
AjxStringUtil.defangHtmlContent=function(h){
var n=h;
var n=h;
var s=n&&n.match(/<img/i)&&n.split(/<img/i);
if(s&&s.length){
for(var a=0;
a<s.length;
a++){
var r=false;
var o=s[a].match(/dfsrc=[\"|\'](cid:[^\"\']+)/);
if(o&&o.length>1){
o=[o[1]]
}
if(!o){
o=s[a].match(/\s+dfsrc=[\"\'][^\"\']+[\"\']+/);
r=o?true:false
}
if(o&&o.length>0&&!r){
var e=s[a].replace(/\s+src=[\"\'][^\"\']+[\"\']/,' src="'+o[0]+'"');
e=e.replace(/\s+dfsrc=[\"\'][^\"\']+[\"\']+/,"");
n=n.replace(s[a],e)
}else{
if(o&&o.length>0&&r){
var t=s[a].match(/\s+dfsrc=[\"\']([^\"\']+)[\"\']/);
if(t&&t.length>1){
var e=s[a].replace(/\s+dfsrc=[\"\'][^\"\']+[\"\']/,' src="'+t[1]+'"');
n=n.replace(s[a],e)
}}}}}
return n
}
}
if(AjxPackage.define("ajax.xml.AjxXmlDoc")){
AjxXmlDoc=function(){
if(!AjxXmlDoc._inited){
AjxXmlDoc._init()
}};
AjxXmlDoc.prototype.isAjxXmlDoc=true;
AjxXmlDoc.prototype.toString=function(){
return"AjxXmlDoc"
};
AjxXmlDoc.INVALID_CHARS_RE=/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/g;
AjxXmlDoc.REC_AVOID_CHARS_RE=/[\u007F-\u0084\u0086-\u009F\uFDD0-\uFDDF]/g;
AjxXmlDoc._inited=false;
AjxXmlDoc._msxmlVers=null;
AjxXmlDoc.create=function(){
var t=new AjxXmlDoc();
var e=null;
if(AjxEnv.isIE){
e=new ActiveXObject(AjxXmlDoc._msxmlVers);
e.async=true;
if(AjxXmlDoc._msxmlVers=="MSXML2.DOMDocument.4.0"){
e.setProperty("SelectionLanguage","XPath");
e.setProperty("SelectionNamespaces","xmlns:zimbra='urn:zimbra' xmlns:mail='urn:zimbraMail' xmlns:account='urn:zimbraAccount'")
}}else{
if(document.implementation&&document.implementation.createDocument){
e=document.implementation.createDocument("","",null)
}else{
throw new AjxException("Unable to create new Doc",AjxException.INTERNAL_ERROR,"AjxXmlDoc.create")
}}
t._doc=e;
return t
};
AjxXmlDoc.createFromDom=function(t){
var e=new AjxXmlDoc();
e._doc=t;
return e
};
AjxXmlDoc.createFromXml=function(e){
var t=AjxXmlDoc.create();
t.loadFromString(e);
return t
};
AjxXmlDoc.replaceInvalidChars=function(e){
AjxXmlDoc.INVALID_CHARS_RE.lastIndex=0;
return e.replace(AjxXmlDoc.INVALID_CHARS_RE,"?")
};
AjxXmlDoc.getXml=function(t){
var e=new XMLSerializer();
return AjxXmlDoc.replaceInvalidChars(e.serializeToString(t))
};
AjxXmlDoc.prototype.getDoc=function(){
return this._doc
};
AjxXmlDoc.prototype.loadFromString=function(t){
var e=this._doc;
e.loadXML(t);
if(AjxEnv.isIE){
if(e.parseError.errorCode!=0){
throw new AjxException(e.parseError.reason,AjxException.INVALID_PARAM,"AjxXmlDoc.loadFromString")
}}};
AjxXmlDoc.prototype.loadFromUrl=function(e){
if(AjxEnv.isChrome||AjxEnv.isSafari){
var t=new window.XMLHttpRequest();
t.open("GET",e,false);
t.send(null);
var a=t.responseXML;
this._doc=a
}else{
this._doc.load(e)
}};
AjxXmlDoc.prototype.toJSObject=function(a,t,e){
_node=function(){
this.__msh_content=""
};
_node.prototype.toString=function(){
return this.__msh_content
};
rec=function(l,c){
var r={}
,h,d;
for(l=l.firstChild;
l;
l=l.nextSibling){
if(l.nodeType==1){
h=l.tagName;
if(a){
h=h.replace(/^.*?:/,"")
}
if(t){
h=h.toLowerCase()
}
d=new _node();
if(r[h]){
if(r[h]==1){
c[h]=[c[h]];
r[h]=2
}
c[h].push(d)
}else{
c[h]=d;
r[h]=1
}
if(e){
if(l.attributes&&l.attributes.length){
for(var s=0;
s<l.attributes.length;
s++){
attr=l.attributes[s];
d[attr.name]=AjxUtil.isNumeric(attr.value)?attr.value:String(attr.value)
}}}
rec(l,d)
}else{
if(l.nodeType==3){
c.__msh_content+=l.nodeValue
}}}};
var n=new _node();
rec(this._doc.documentElement,n);
return n
};
AjxXmlDoc.prototype.getElementsByTagNameNS=function(t,e){
var a=this.getDoc();
return AjxEnv.isIE?a.getElementsByTagName(t+":"+e):a.getElementsByTagNameNS(t,e)
};
AjxXmlDoc.prototype.getFirstElementByTagNameNS=function(t,e){
return this.getElementsByTagNameNS(t,e)[0]
};
AjxXmlDoc.prototype.getElementsByTagName=function(e){
var t=this.getDoc();
return t.getElementsByTagName(e)
};
AjxXmlDoc._init=function(){
if(AjxEnv.isIE){
var e=["MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XmlDom"];
for(var a=0;
a<e.length;
a++){
try{
new ActiveXObject(e[a]);
AjxXmlDoc._msxmlVers=e[a];
break
}
catch(t){}}
if(!AjxXmlDoc._msxmlVers){
throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxXmlDoc._init")
}}else{
if(AjxEnv.isNav||AjxEnv.isOpera||AjxEnv.isSafari){
Document.prototype.loadXML=function(l){
var h=new DOMParser();
var n=h.parseFromString(l,"text/xml");
while(this.hasChildNodes()){
this.removeChild(this.lastChild)
}
var o=n.childNodes.length;
for(var s=0;
s<o;
s++){
var r=this.importNode(n.childNodes[s],true);
this.appendChild(r)
}};
if(AjxEnv.isNav){
_NodeGetXml=function(){
var o=new XMLSerializer();
return o.serializeToString(this)
};
Node.prototype.__defineGetter__("xml",_NodeGetXml)
}}}
AjxXmlDoc._inited=true
};
AjxXmlDoc.prototype.set=function(e,o,t){
var n=this._doc.createElement(e);
if(o!=null){
var a=this._doc.createTextNode("");
n.appendChild(a);
a.nodeValue=o
}
if(t==null){
this.root.appendChild(n)
}else{
t.appendChild(n)
}
return n
};
AjxXmlDoc.prototype.getDocXml=function(){
if(AjxEnv.isSafari){
return AjxXmlDoc.getXml(this.getDoc())
}else{
return AjxXmlDoc.replaceInvalidChars(this.getDoc().xml)
}};
AjxXmlDoc.createRoot=function(a){
var e=AjxXmlDoc.create();
var t=e.getDoc();
e.root=t.createElement(a);
t.appendChild(e.root);
return e
};
AjxXmlDoc.createElement=function(t,o){
var e=AjxXmlDoc.create();
var n=e.getDoc();
e.root=n.createElement(t);
if(o!=null){
var a=n.createTextNode("");
e.root.appendChild(a);
a.nodeValue=o
}
n.appendChild(e.root);
return e
};
AjxXmlDoc.prototype.appendChild=function(e){
if(this._doc!=e._doc&&(AjxEnv.isChrome||AjxEnv.isSafari)){
this.root.appendChild(this.getDoc().importNode(e.root,true))
}else{
this.root.appendChild(e.root)
}}
}
if(AjxPackage.define("ajax.core.AjxImg")){
AjxImg=function(){};
AjxImg.prototype=new Object;
AjxImg.prototype.constructor=null;
AjxImg._VIEWPORT_ID="AjxImg_VP";
AjxImg.DISABLED=true;
AjxImg.RE_COLOR=/^(.*?),color=(.*)$/;
AjxImg.setImage=function(r,d,u,s){
if(!r){
return
}
var l=d;
var a,t=d&&d.match(AjxImg.RE_COLOR);
if(t){
d=t&&t[1];
a=t&&t[2]
}
var c=AjxImg.getClassForImage(d,s);
if(u){
r.className=c;
return
}
var e=r.firstChild&&r.firstChild.id;
var f=c+"Overlay";
var h=c+"Mask";
if(a&&window.AjxImgData&&AjxImgData[f]&&AjxImgData[h]){
a=(a.match(/^\d$/)?ZmOrganizer.COLOR_VALUES[a]:a)||ZmOrganizer.COLOR_VALUES[ZmOrganizer.ORG_DEFAULT_COLOR];
r.innerHTML=AjxImg.getImageHtml(l,null,e?"id='"+e+"'":null,false,s);
return
}
if(r.firstChild==null||r.firstChild.nodeName.toLowerCase()!="div"){
var n=[],o=0;
n[o++]="<div";
if(e){
n[o++]=" id='";
n[o++]=e;
n[o++]="'"
}
if(c){
n[o++]=" class='";
n[o++]=c;
n[o++]="'"
}
n[o++]="></div>";
r.innerHTML=n.join("");
return
}else{
if(AjxEnv.isIE){
r.firstChild.innerHTML=""
}}
r.firstChild.className=c
};
AjxImg.setDisabledImage=function(t,a,e){
return AjxImg.setImage(t,a,e,true)
};
AjxImg.getClassForImage=function(a,t){
var e=a?"Img"+a:"";
if(t){
e+=" ZDisabledImage"
}
return e
};
AjxImg.getImageClass=function(e){
return e.firstChild?e.firstChild.className:e.className
};
AjxImg.getImageElement=function(e){
return e.firstChild?e.firstChild:e
};
AjxImg.getParentElement=function(e){
return e.parentNode
};
AjxImg.getImageHtml=function(A,h,p,r,n){
h=h||"";
var u=h?" style='"+h+"'":"";
p=p?" "+p:"";
var w=r?"<table style='display:inline' cellpadding=0 cellspacing=0 border=0><tr><td align=center valign=bottom>":"";
var c="";
var T=r?"</td></tr></table>":"";
if(A){
var j,k=A.match(AjxImg.RE_COLOR);
if(k){
A=k&&k[1];
j=k&&k[2]
}
var a=AjxImg.getClassForImage(A,n);
var B=a+"Overlay";
var f=a+"Mask";
if(j&&window.AjxImgData&&AjxImgData[B]&&AjxImgData[f]){
j=(j.match(/^\d$/)?ZmOrganizer.COLOR_VALUES[j]:j)||ZmOrganizer.COLOR_VALUES[ZmOrganizer.ORG_DEFAULT_COLOR];
var W=AjxImgData[B],z=AjxImgData[f];
if(AjxEnv.isIE&&!AjxEnv.isIE9up){
var C="";
var y=["width:",W.w,";","height:",W.h,";"].join("");
var e=["top:",z.t,";","left:",z.l,";"].join("");
if(typeof document.documentMode!="undefined"){
C=["clip:rect(",(-1*z.t)-1,"px,",W.w-1,"px,",(z.t*-1)+W.h-1,"px,",W.l,"px);"].join("")
}
var l="filter:mask(color="+j+");";
c=["<div class='IEImage' style='*display:inline;zoom:1;position:relative;overflow:hidden;",y,h,"' ",p,">","<div class='IEImageMask' style='overflow:hidden;position:relative;",y,"'>","<img src='",z.f,"?v=",window.cacheKillerVersion,"' border=0 style='position:absolute;",e,C,l,"'>","</div>","<div class='IEImageOverlay ",B,"' style='",y,";position:absolute;top:0;left:0;'></div>","</div>"].join("")
}else{
if(AjxEnv.isIE9up){
j=j.replace("#","");
var a=AjxImg.getClassForImage(A+"_"+j,n);
c=["<div class='","Img",A+"_"+j,"'",u,p,"></div>"].join("")
}else{
if(!W[j]){
var v=W.w,g=W.h;
var o=document.createElement("CANVAS");
o.width=v;
o.height=g;
var x=o.getContext("2d");
x.save();
x.clearRect(0,0,v,g);
x.save();
var q=p;
if(!q){
q=Dwt.getNextId("CANVAS_IMG_");
p=" id='"+q+"'"
}else{
var s=p.match(/id=[\"\']([^\"\']+)[\"\']+/);
if(s&&s.length>1){
q=s[1]
}
AjxDebug.println(AjxDebug.TAG_ICON,"imgId = "+q)
}
var t=document.getElementById(f);
var O=document.getElementById(B);
if(!t.complete||!O.complete){
AjxDebug.println(AjxDebug.TAG_ICON,"mask status = "+t.complete+" for "+q);
AjxDebug.println(AjxDebug.TAG_ICON,"overlay status = "+O.complete+" for "+q);
var d=new Image();
d.onload=function(){
AjxDebug.println(AjxDebug.TAG_ICON,"mask image loaded");
var m=new Image();
m.onload=function(){
AjxImg._drawCanvasImage(x,d,m,z,W,j,v,g);
AjxDebug.println(AjxDebug.TAG_ICON,"overlay image loaded");
var D=document.getElementById(q);
if(D){
AjxDebug.println(AjxDebug.TAG_ICON,"element found for id = "+q);
D.src=o.toDataURL();
W[j]=o.toDataURL()
}else{
AjxDebug.println(AjxDebug.TAG_ICON,"no element found for id = "+q)
}};
m.src=document.getElementById(B).src
};
d.src=document.getElementById(f).src
}else{
AjxImg._drawCanvasImage(x,t,O,z,W,j,v,g);
W[j]=o.toDataURL()
}}
c=["<img src='",W[j],"'"," border=0 ",u,p,">"].join("")
}}}else{
c=["<div class='","Img",A,"'",u,p,"></div>"].join("")
}}else{
c=["<div",u,p,"></div>"].join("")
}
return w||T?[w,c,T].join(""):c
};
AjxImg.getImageSpanHtml=function(n,s,t,a,e){
e=e||"inlineIcon";
var o=["<span style='white-space:nowrap'>","<span class='",e,"'>",AjxImg.getImageHtml(n,s,t),(a||""),"</span>","</span>"];
return o.join("")
};
AjxImg._drawCanvasImage=function(a,r,h,t,n,o,s,e){
a.drawImage(r,t.l,t.t);
a.globalCompositeOperation="source-out";
a.fillStyle=o;
a.fillRect(0,0,s,e);
a.restore();
a.drawImage(h,n.l,n.t);
a.restore()
}
}
if(AjxPackage.define("ajax.core.AjxColor")){
AjxColor=function(a,t,e){
if(arguments.length==0){
return
}
this.r=a;
this.g=t;
this.b=e
};
AjxColor.prototype.toString=function(){
return AjxColor.color(this.r,this.g,this.b)
};
AjxColor.components=function(t){
var e=AjxColor.__RE.exec(t);
return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null
};
AjxColor.color=function(a,t,e){
return["#",AjxColor.__pad(Number(Math.round(a)).toString(16),2),AjxColor.__pad(Number(Math.round(t)).toString(16),2),AjxColor.__pad(Number(Math.round(e)).toString(16),2)].join("")
};
AjxColor.lighten=function(e,a){
var t=AjxColor.components(e);
return t?AjxColor.color(AjxColor.__lighten(t[0],a),AjxColor.__lighten(t[1],a),AjxColor.__lighten(t[2],a)):""
};
AjxColor.darken=function(e,a){
var t=AjxColor.components(e);
return t?AjxColor.color(AjxColor.__darken(t[0],a),AjxColor.__darken(t[1],a),AjxColor.__darken(t[2],a)):""
};
AjxColor.deepen=function(e,a){
var s=AjxColor.components(e);
var t=0;
for(var o=1;
o<s.length;
o++){
if(s[o]>s[t]){
t=o
}}
for(var o=0;
o<s.length;
o++){
var n=s[t]?(s[o]/s[t]):1;
s[o]=Math.floor(s[o]*n*(a||1))
}
return AjxColor.color(s[0],s[1],s[2])
};
AjxColor.__RE=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i;
AjxColor.__pad=function(n,a,o){
if(!o){
o="0"
}
var t=String(n);
for(var e=t.length;
e<a;
e++){
t=o+t
}
return t
};
AjxColor.__lighten=function(e,t){
return Math.max(0,Math.min(255,e+(255-e)*t))
};
AjxColor.__darken=function(e,t){
return Math.max(0,Math.min(255,e+(1-e)*t))
}
}
if(AjxPackage.define("ajax.events.AjxEvent")){
AjxEvent=function(){
this.data=null
};
AjxEvent.HISTORY="HISTORY";
AjxEvent.prototype.toString=function(){
return"AjxEvent"
}
}
if(AjxPackage.define("ajax.events.AjxEventMgr")){
AjxEventMgr=function(){
this._listeners=new Object()
};
AjxEventMgr.prototype.toString=function(){
return"AjxEventMgr"
};
AjxEventMgr.prototype.addListener=function(t,a,e){
var o=this._listeners[t];
if(o==null){
o=this._listeners[t]=new AjxVector()
}
if(!o.contains(a)){
if(this._notifyingListeners){
o=this._listeners[t]=o.clone()
}
o.add(a,e);
return true
}
return false
};
AjxEventMgr.prototype.notifyListeners=function(o,r){
this._notifyingListeners=true;
var l=this._listeners[o];
if(l!=null){
var e=l.getArray();
var n=l.size();
var h=null;
var d=null;
for(var t=0;
t<n;
t++){
d=e[t];
if(!(d&&((d instanceof AjxListener)||(typeof d=="function")))){
continue
}
h=d.handleEvent?d.handleEvent(r):d(r);
if(h===false){
break
}}}
this._notifyingListeners=false;
return h
};
AjxEventMgr.prototype.isListenerRegistered=function(e){
var t=this._listeners[e];
return(t!=null&&t.size()>0)
};
AjxEventMgr.prototype.removeListener=function(e,t){
var a=this._listeners[e];
if(a!=null){
if(this._notifyingListeners){
a=this._listeners[e]=a.clone()
}
a.remove(t);
return true
}
return false
};
AjxEventMgr.prototype.removeAll=function(e){
var t=this._listeners[e];
if(t!=null){
if(this._notifyingListeners){
t=this._listeners[e]=t.clone()
}
t.removeAll();
return true
}
return false
};
AjxEventMgr.prototype.clearAllEvents=function(){
var t=this._listeners;
for(var e in t){
this.removeAll(e)
}}
}
if(AjxPackage.define("ajax.util.AjxTimedAction")){
AjxTimedAction=function(a,t,e){
AjxCallback.call(this,a,t,e);
this._tid=-1;
this._id=-1;
this._runResult=null
};
AjxTimedAction.prototype=new AjxCallback();
AjxTimedAction.prototype.constructor=AjxTimedAction;
AjxTimedAction.MAX_TIMEOUT=20*24*60*60*1000;
AjxTimedAction.prototype.toString=function(){
return"AjxTimedAction"
};
AjxTimedAction.prototype.getRunResult=function(){
return this._runResult
};
AjxTimedAction._pendingActions={};
AjxTimedAction._nextActionId=1;
AjxTimedAction.scheduleAction=function(a,t){
if(!a){
return
}
if(a._tid&&a._tid!=-1){
AjxTimedAction.cancelAction(a._id)
}
t=t||0;
if(t>AjxTimedAction.MAX_TIMEOUT){
if(window.DBG){}
t=AjxTimedAction.MAX_TIMEOUT
}
var o=a._id=AjxTimedAction._nextActionId++;
AjxTimedAction._pendingActions[o]=a;
var e="AjxTimedAction._exec("+o+")";
a._tid=window.setTimeout(e,t);
return a._id
};
AjxTimedAction.cancelAction=function(t){
var e=AjxTimedAction._pendingActions[t];
if(e){
window.clearTimeout(e._tid);
delete AjxTimedAction._pendingActions[t];
delete e._tid
}};
AjxTimedAction._exec=function(a){
try{
var t=AjxTimedAction._pendingActions[a];
if(t){
delete AjxTimedAction._pendingActions[a];
delete t._tid;
t._runResult=t.run()
}}
catch(e){
AjxException.reportScriptError(e)
}}
}
if(AjxPackage.define("ajax.net.AjxInclude")){
AjxInclude=function(o,s,n,a){
var t=document.getElementsByTagName("head")[0];
function e(h){
if(AjxEnv.isIE&&h&&!/loaded|complete/.test(h.readyState)){
return
}
if(h){
h[AjxInclude.eventName]=null
}
var r=AjxInclude.dwhack_scripts.length>0?AjxInclude.dwhack_scripts:o;
window.status="";
if(r.length>0){
var l=r.shift();
var d=typeof l=="string"?l:l.src;
var m=d;
if(!/^((https?|ftps?):\x2f\x2f|\x2f)/.test(d)){
if(s){
d=s+d
}
if(cacheKillerVersion){
d+="?v="+cacheKillerVersion
}}else{
if(a&&d.indexOf("/")!=0){
d=a+AjxStringUtil.urlEncode(d)
}}
var h=document.createElement("script");
var c=AjxCallback.simpleClosure(e,null,h);
if(AjxEnv.isIE){
h.attachEvent("onreadystatechange",c);
h.attachEvent("onerror",c)
}else{
h.addEventListener("load",c,true);
h.addEventListener("error",c,true)
}
h.type="text/javascript";
h.src=d;
window.status="Loading script: "+m;
var u=null;
if(l.id){
h.id=l.id;
u=document.getElementById(l.id)
}
if(u){
u.parentNode.replaceChild(h,u)
}else{
t.appendChild(h)
}}else{
if(o.length==0){
h=null;
t=null;
if(n){
n.run()
}}}}
e(null)
};
AjxInclude.dwhack_scripts=[];
document.write=document.writeln=function(){
var e=[];
for(var t=0;
t<arguments.length;
++t){
e[t]=arguments[t]
}
var o=e.join("");
if(/<script[^>]+src=([\x22\x27])(.*?)\1/i.test(o)){
AjxInclude.dwhack_scripts.push(RegExp.$2)
}};
if(AjxEnv.isIE){
AjxInclude._removeWriteln=function(){
document.write=document.writeln=null;
window.detachEvent("onunload",AjxInclude._removeWriteln)
};
window.attachEvent("onunload",AjxInclude._removeWriteln)
}}
if(AjxPackage.define("ajax.events.AjxListener")){
AjxListener=function(t,a,e){
AjxCallback.call(this,t,a,e)
};
AjxListener.prototype=new AjxCallback();
AjxListener.prototype.constructor=AjxListener;
AjxListener.prototype.isAjxListener=true;
AjxListener.prototype.toString=function(){
return"AjxListener"
};
AjxListener.prototype.handleEvent=function(e){
return this.run(e)
}
}
if(AjxPackage.define("ajax.util.AjxText")){
AjxFormat=function(e){
if(arguments.length==0){
return
}
this._pattern=e;
this._segments=[]
};
AjxFormat.prototype.toString=function(){
var t=[];
t.push('pattern="',this._pattern,'"');
if(this._segments.length>0){
t.push(", segments={ ");
for(var e=0;
e<this._segments.length;
e++){
if(e>0){
t.push(", ")
}
t.push(String(this._segments[e]))
}
t.push(" }")
}
return t.join("")
};
AjxFormat.prototype._pattern;
AjxFormat.prototype._segments;
AjxFormat.initialize=function(){
AjxDateFormat.initialize();
AjxNumberFormat.initialize()
};
AjxFormat.prototype.format=function(e){
var a=[];
for(var t=0;
t<this._segments.length;
t++){
a.push(this._segments[t].format(e))
}
return a.join("")
};
AjxFormat.prototype.parse=function(o){
var t=this._createParseObject();
var e=0;
for(var a=0;
a<this._segments.length;
a++){
var n=this._segments[a];
e=n.parse(t,o,e)
}
if(e<o.length){
throw new AjxFormat.ParsingException(this,null,"input too long")
}
return t
};
AjxFormat.prototype.getSegments=function(){
return this._segments
};
AjxFormat.prototype.toPattern=function(){
return this._pattern
};
AjxFormat.prototype.clone=function(){
return new this.constructor(this._pattern)
};
AjxFormat.prototype._createParseObject=function(e){
throw new AjxFormat.ParsingException(this,null,"not implemented")
};
AjxFormat._zeroPad=function(n,r,t,h){
n=typeof n=="string"?n:String(n);
if(n.length>=r){
return n
}
t=t||"0";
var e=[];
for(var o=n.length;
o<r;
o++){
e.push(t)
}
e[h?"unshift":"push"](n);
return e.join("")
};
AjxFormat.FormatException=function(t,e){
this._format=t;
this._message=e
};
AjxFormat.FormatException.prototype.toString=function(){
return this._message
};
AjxFormat.FormatException.prototype._format;
AjxFormat.FormatException.prototype._message;
AjxFormat.FormattingException=function(a,t,e){
AjxFormat.FormatException.call(this,a,e);
this._segment=t
};
AjxFormat.FormattingException.prototype=new AjxFormat.FormatException;
AjxFormat.FormattingException.prototype.constructor=AjxFormat.FormattingException;
AjxFormat.FormattingException.prototype._segment;
AjxFormat.ParsingException=function(a,t,e){
AjxFormat.FormatException.call(this,a,e);
this._segment=t
};
AjxFormat.ParsingException.prototype=new AjxFormat.FormatException;
AjxFormat.ParsingException.prototype.constructor=AjxFormat.ParsingException;
AjxFormat.ParsingException.prototype._segment;
AjxFormat.Segment=function(t,e){
if(arguments.length==0){
return
}
this._parent=t;
this._s=e
};
AjxFormat.Segment.prototype.toString=function(){
return'segment: "'+this._s+'"'
};
AjxFormat.Segment.prototype._parent;
AjxFormat.Segment.prototype._s;
AjxFormat.Segment.prototype.format=function(e){
return this._s
};
AjxFormat.Segment.prototype.parse=function(a,t,e){
throw new AjxFormat.ParsingException(this._parent,this,"not implemented")
};
AjxFormat.Segment.prototype.getFormat=function(){
return this._parent
};
AjxFormat.Segment.prototype.toSubPattern=function(){
return this._s
};
AjxFormat.Segment.prototype._getFixedLength=function(){
var e;
if(this._index+1<this._parent._segments.length){
var t=this._parent._segments[this._index+1];
if(!(t instanceof AjxFormat.TextSegment)){
e=this._s.length
}}
return e
};
AjxFormat.Segment._parseLiteral=function(o,a,e){
if(a.length-e<o.length){
throw new AjxFormat.ParsingException(this._parent,this,"input too short")
}
for(var t=0;
t<o.length;
t++){
if(o.charAt(t)!=a.charAt(e+t)){
throw new AjxFormat.ParsingException(this._parent,this,"input doesn't match")
}}
return e+o.length
};
AjxFormat.Segment._parseLiterals=function(a,h,u,t,p,l){
for(var r=0;
r<t.length;
r++){
try{
var m=t[r];
var n=AjxFormat.Segment._parseLiteral(m,p,l);
if(h){
var d=a||window;
if(typeof h=="function"){
h.call(d,r+u)
}else{
d[h]=r+u
}}
return n
}
catch(c){}}
return -1
};
AjxFormat.Segment._parseInt=function(t,n,p,g,r,e,u){
var h=e||g.length-r;
var d=r;
for(var a=0;
a<h;
a++){
if(!g.charAt(r++).match(/\d/)){
r--;
break
}}
var c=r;
if(d==c){
throw new AjxFormat.ParsingException(this._parent,this,"number not present")
}
if(e&&c-d!=e){
throw new AjxFormat.ParsingException(this._parent,this,"number too short")
}
var m=parseInt(g.substring(d,c),u||10);
if(n){
var l=t||window;
if(typeof n=="function"){
n.call(l,m+p)
}else{
l[n]=m+p
}}
return c
};
AjxDateFormat=function(s){
if(arguments.length==0){
return
}
AjxFormat.call(this,s);
if(s==null){
return
}
if(typeof s=="number"){
switch(s){
case AjxDateFormat.SHORT:s=I18nMsg.formatDateShort;
break;
case AjxDateFormat.MEDIUM:s=I18nMsg.formatDateMedium;
break;
case AjxDateFormat.LONG:s=I18nMsg.formatDateLong;
break;
case AjxDateFormat.FULL:s=I18nMsg.formatDateFull;
break;
case AjxDateFormat.NUMBER:s=I18nMsg.formatDateNumber;
break
}}
for(var a=0;
a<s.length;
a++){
var h=s.charAt(a);
if(h=="'"){
var t=a+1;
for(a++;
a<s.length;
a++){
var h=s.charAt(a);
if(h=="'"){
if(a+1<s.length&&s.charAt(a+1)=="'"){
s=s.substr(0,a)+s.substr(a+1)
}else{
break
}}}
if(a==s.length){}
var e=a;
var n=new AjxFormat.TextSegment(this,s.substring(t,e));
this._segments.push(n);
continue
}
var t=a;
while(a<s.length){
h=s.charAt(a);
if(AjxDateFormat._META_CHARS.indexOf(h)!=-1||h=="'"){
break
}
a++
}
var e=a;
if(t!=e){
var n=new AjxFormat.TextSegment(this,s.substring(t,e));
this._segments.push(n);
a--;
continue
}
var t=a;
while(++a<s.length){
if(s.charAt(a)!=h){
break
}}
var e=a--;
var o=e-t;
var r=s.substr(t,o);
var n=null;
switch(h){
case"G":n=new AjxDateFormat.EraSegment(this,r);
break;
case"y":n=new AjxDateFormat.YearSegment(this,r);
break;
case"M":n=new AjxDateFormat.MonthSegment(this,r);
break;
case"w":n=new AjxDateFormat.WeekSegment(this,r);
break;
case"W":n=new AjxDateFormat.WeekSegment(this,r);
break;
case"D":n=new AjxDateFormat.DaySegment(this,r);
break;
case"d":n=new AjxDateFormat.DaySegment(this,r);
break;
case"F":n=new AjxDateFormat.WeekdaySegment(this,r);
break;
case"E":n=new AjxDateFormat.WeekdaySegment(this,r);
break;
case"a":n=new AjxDateFormat.AmPmSegment(this,r);
break;
case"H":n=new AjxDateFormat.HourSegment(this,r);
break;
case"k":n=new AjxDateFormat.HourSegment(this,r);
break;
case"K":n=new AjxDateFormat.HourSegment(this,r);
break;
case"h":n=new AjxDateFormat.HourSegment(this,r);
break;
case"m":n=new AjxDateFormat.MinuteSegment(this,r);
break;
case"s":n=new AjxDateFormat.SecondSegment(this,r);
break;
case"S":n=new AjxDateFormat.SecondSegment(this,r);
break;
case"z":n=new AjxDateFormat.TimezoneSegment(this,r);
break;
case"Z":n=new AjxDateFormat.TimezoneSegment(this,r);
break
}
if(n!=null){
n._index=this._segments.length;
this._segments.push(n)
}}};
AjxDateFormat.prototype=new AjxFormat;
AjxDateFormat.prototype.constructor=AjxDateFormat;
AjxDateFormat.prototype.toString=function(){
return"[AjxDateFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxDateFormat.SHORT=0;
AjxDateFormat.MEDIUM=1;
AjxDateFormat.LONG=2;
AjxDateFormat.FULL=3;
AjxDateFormat.DEFAULT=AjxDateFormat.MEDIUM;
AjxDateFormat._META_CHARS="GyMwWDdFEaHkKhmsSzZ";
AjxDateFormat.NUMBER=4;
AjxDateFormat.getDateInstance=function(e){
e=e!=null?e:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._DATE_FORMATTERS[e]){
AjxDateFormat._DATE_FORMATTERS[e]=new AjxDateFormat(AjxDateFormat._dateFormats[e])
}
return AjxDateFormat._DATE_FORMATTERS[e]
};
AjxDateFormat.getTimeInstance=function(e){
e=e!=null?e:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._TIME_FORMATTERS[e]){
AjxDateFormat._TIME_FORMATTERS[e]=new AjxDateFormat(AjxDateFormat._timeFormats[e])
}
return AjxDateFormat._TIME_FORMATTERS[e]
};
AjxDateFormat.getDateTimeInstance=function(e,t){
e=e!=null?e:AjxDateFormat.DEFAULT;
t=t!=null?t:AjxDateFormat.DEFAULT;
var o=e*10+t;
if(!AjxDateFormat._DATETIME_FORMATTERS[o]){
var n=I18nMsg.formatDateTime;
var s=[AjxDateFormat._dateFormats[e],AjxDateFormat._timeFormats[t]];
var a=AjxMessageFormat.format(n,s);
AjxDateFormat._DATETIME_FORMATTERS[o]=new AjxDateFormat(a)
}
return AjxDateFormat._DATETIME_FORMATTERS[o]
};
AjxDateFormat.format=function(t,e){
return new AjxDateFormat(t).format(e)
};
AjxDateFormat.parse=function(t,e){
return new AjxDateFormat(t).parse(e)
};
AjxDateFormat.initialize=function(){
AjxDateFormat._dateFormats=[I18nMsg.formatDateShort,I18nMsg.formatDateMedium,I18nMsg.formatDateLong,I18nMsg.formatDateFull,I18nMsg.formatDateNumber];
AjxDateFormat._timeFormats=[I18nMsg.formatTimeShort,I18nMsg.formatTimeMedium,I18nMsg.formatTimeLong,I18nMsg.formatTimeFull];
AjxDateFormat._timeParsers=[];
for(var t=1,e;
e=I18nMsg["parseTime"+t];
t++){
AjxDateFormat._timeParsers.push(new RegExp(e,"i"))
}
AjxDateFormat._DATE_FORMATTERS={};
AjxDateFormat._TIME_FORMATTERS={};
AjxDateFormat._DATETIME_FORMATTERS={};
AjxDateFormat.MonthSegment.initialize();
AjxDateFormat.WeekdaySegment.initialize()
};
AjxDateFormat.parseTime=function(r){
for(var s=0;
s<AjxDateFormat._timeParsers.length;
s++){
var e=AjxDateFormat._timeParsers[s].exec(r);
if(e){
var a=parseInt(e[1],10)||0;
var n=parseInt(e[2],10)||0;
var o=e[3];
if(o){
var t=I18nMsg.parseTimePMChars;
if(a==12){
a=0
}
if(t.indexOf(o)!=-1){
a+=12
}}
if(a<24&&n<60){
date=new Date();
date.setHours(a);
date.setMinutes(n);
date.setSeconds(0);
return date
}}}};
AjxDateFormat.prototype.parse=function(n){
var o=null;
try{
o=AjxFormat.prototype.parse.call(this,n);
var a=new Date(0,0,1,0,0,0,0);
if(o.year!=null){
a.setFullYear(o.year)
}
if(o.month!=null){
a.setMonth(o.month)
}
if(o.dayofmonth!=null){
a.setDate(o.dayofmonth)
}else{
if(o.dayofyear!=null){
a.setMonth(0,o.dayofyear)
}}
if(o.hours!=null){
a.setHours(o.hours)
}
if(o.minutes!=null){
a.setMinutes(o.minutes)
}
if(o.seconds!=null){
a.setSeconds(o.seconds)
}
if(o.milliseconds!=null){
a.setMilliseconds(o.milliseconds)
}
if(o.ampm!=null){
var t=a.getHours();
if(t==12&&o.ampm==0){
t=0
}else{
if(t!=12&&o.ampm==1){
t+=12
}}
a.setHours(t)
}
if(o.timezone!=null){
a.setMinutes(a.getMinutes()-o.timezone)
}
if(isNaN(a.getTime())){
return null
}
o=a
}
catch(r){}
return o
};
AjxDateFormat.prototype._createParseObject=function(){
return{
year:null,month:null,dayofmonth:null,dayofyear:null,hours:null,minutes:null,seconds:null,milliseconds:null,ampm:null,era:null,timezone:null}
};
AjxFormat.TextSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxFormat.TextSegment.prototype=new AjxFormat.Segment;
AjxFormat.TextSegment.prototype.constructor=AjxFormat.TextSegment;
AjxFormat.TextSegment.prototype.toString=function(){
return'text: "'+this._s+'"'
};
AjxFormat.TextSegment.prototype.parse=function(a,t,e){
return AjxFormat.Segment._parseLiteral(this._s,t,e)
};
AjxDateFormat.DateSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.DateSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.DateSegment.prototype.constructor=AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.EraSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment.prototype.constructor=AjxDateFormat.EraSegment;
AjxDateFormat.EraSegment.prototype.toString=function(){
return'dateEra: "'+this._s+'"'
};
AjxDateFormat.EraSegment.prototype.format=function(e){
return I18nMsg.eraAD
};
AjxDateFormat.YearSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.YearSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.YearSegment.prototype.constructor=AjxDateFormat.YearSegment;
AjxDateFormat.YearSegment.prototype.toString=function(){
return'dateYear: "'+this._s+'"'
};
AjxDateFormat.YearSegment.prototype.format=function(e){
var t=String(e.getFullYear());
return this._s.length<4?t.substr(t.length-2):AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.YearSegment.prototype.parse=function(a,c,n){
var e=this._getFixedLength();
var t=AjxFormat.Segment._parseInt(a,"year",0,c,n,e);
if(t-n==2){
if(!AjxDateFormat._2digitStartYear){
AjxDateFormat._2digitStartYear=parseInt(AjxMsg.dateParsing2DigitStartYear)
}
var h=AjxDateFormat._2digitStartYear;
var l=parseInt(c.substr(n,2),10);
var o=(Math.floor(h/100)+(l<(h%100)?1:0))*100;
var r=o+l;
a.year=r
}
return t
};
AjxDateFormat.MonthSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.MonthSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.MonthSegment.prototype.constructor=AjxDateFormat.MonthSegment;
AjxDateFormat.MonthSegment.prototype.toString=function(){
return'dateMonth: "'+this._s+'"'
};
AjxDateFormat.MonthSegment.initialize=function(){
AjxDateFormat.MonthSegment.MONTHS={};
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT]=[AjxMsg.monthJanShort,AjxMsg.monthFebShort,AjxMsg.monthMarShort,AjxMsg.monthAprShort,AjxMsg.monthMayShort,AjxMsg.monthJunShort,AjxMsg.monthJulShort,AjxMsg.monthAugShort,AjxMsg.monthSepShort,AjxMsg.monthOctShort,AjxMsg.monthNovShort,AjxMsg.monthDecShort];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM]=[I18nMsg.monthJanMedium,I18nMsg.monthFebMedium,I18nMsg.monthMarMedium,I18nMsg.monthAprMedium,I18nMsg.monthMayMedium,I18nMsg.monthJunMedium,I18nMsg.monthJulMedium,I18nMsg.monthAugMedium,I18nMsg.monthSepMedium,I18nMsg.monthOctMedium,I18nMsg.monthNovMedium,I18nMsg.monthDecMedium];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG]=[I18nMsg.monthJanLong,I18nMsg.monthFebLong,I18nMsg.monthMarLong,I18nMsg.monthAprLong,I18nMsg.monthMayLong,I18nMsg.monthJunLong,I18nMsg.monthJulLong,I18nMsg.monthAugLong,I18nMsg.monthSepLong,I18nMsg.monthOctLong,I18nMsg.monthNovLong,I18nMsg.monthDecLong]
};
AjxDateFormat.MonthSegment.prototype.format=function(e){
var t=e.getMonth();
switch(this._s.length){
case 1:return String(t+1);
case 2:return AjxFormat._zeroPad(t+1,2);
case 3:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM][t];
case 5:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT][t]
}
return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG][t]
};
AjxDateFormat.MonthSegment.prototype.parse=function(a,n,t){
var e;
switch(this._s.length){
case 3:e=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM];
case 4:e=e||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG];
case 5:e=e||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT];
var o=AjxFormat.Segment._parseLiterals(a,"month",0,e,n,t);
if(o==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
return o
}
var r=this._getFixedLength();
return AjxFormat.Segment._parseInt(a,"month",-1,n,t,r)
};
AjxDateFormat.WeekSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.WeekSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekSegment.prototype.constructor=AjxDateFormat.WeekSegment;
AjxDateFormat.WeekSegment.prototype.toString=function(){
return'weekMonth: "'+this._s+'"'
};
AjxDateFormat.WeekSegment.prototype.format=function(t){
var o=t.getYear();
var s=t.getMonth();
var e=t.getDate();
var r=/w/.test(this._s);
var n=new Date(o,r?0:s,1);
var a=0;
while(true){
a++;
if(n.getMonth()>s||(n.getMonth()==s&&n.getDate()>=e)){
break
}
n.setDate(n.getDate()+7)
}
return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.WeekSegment.prototype.parse=function(t,a,e){
var o=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,a,e,o)
};
AjxDateFormat.DaySegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.DaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.DaySegment.prototype.constructor=AjxDateFormat.DaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){
return'dateDay: "'+this._s+'"'
};
AjxDateFormat.DaySegment.prototype.format=function(t){
var n=t.getMonth();
var e=t.getDate();
if(/D/.test(this._s)&&n>0){
var a=t.getYear();
do{
var o=new Date(a,n,1);
o.setDate(0);
e+=o.getDate();
n--
}
while(n>0)
}
return AjxFormat._zeroPad(e,this._s.length)
};
AjxDateFormat.DaySegment.prototype.parse=function(t,n,e){
var r=this._getFixedLength();
var o=function(s){
if(s>AjxDateUtil.MAX_DAYS_PER_MONTH){
throw new AjxFormat.ParsingException(this._parent,this,"number too long")
}else{
t.dayofmonth=s
}};
var a=/D/.test(this._s)?"dayofyear":o;
return AjxFormat.Segment._parseInt(t,a,0,n,e,r)
};
AjxDateFormat.WeekdaySegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.WeekdaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekdaySegment.prototype.constructor=AjxDateFormat.WeekdaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){
return'dateDay: "'+this._s+'"'
};
AjxDateFormat.WeekdaySegment.initialize=function(){
AjxDateFormat.WeekdaySegment.WEEKDAYS={};
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT]=[AjxMsg.weekdaySunShort,AjxMsg.weekdayMonShort,AjxMsg.weekdayTueShort,AjxMsg.weekdayWedShort,AjxMsg.weekdayThuShort,AjxMsg.weekdayFriShort,AjxMsg.weekdaySatShort];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM]=[I18nMsg.weekdaySunMedium,I18nMsg.weekdayMonMedium,I18nMsg.weekdayTueMedium,I18nMsg.weekdayWedMedium,I18nMsg.weekdayThuMedium,I18nMsg.weekdayFriMedium,I18nMsg.weekdaySatMedium];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG]=[I18nMsg.weekdaySunLong,I18nMsg.weekdayMonLong,I18nMsg.weekdayTueLong,I18nMsg.weekdayWedLong,I18nMsg.weekdayThuLong,I18nMsg.weekdayFriLong,I18nMsg.weekdaySatLong]
};
AjxDateFormat.WeekdaySegment.prototype.format=function(e){
var a=e.getDay();
if(/E/.test(this._s)){
var t;
switch(this._s.length){
case 4:t=AjxDateFormat.LONG;
break;
case 5:t=AjxDateFormat.SHORT;
break;
default:t=AjxDateFormat.MEDIUM
}
return AjxDateFormat.WeekdaySegment.WEEKDAYS[t][a]
}
return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.WeekdaySegment.prototype.parse=function(a,n,t){
var e;
switch(this._s.length){
case 3:e=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM];
case 4:e=e||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG];
case 5:e=e||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT];
var o=AjxFormat.Segment._parseLiterals(null,null,0,e,n,t);
if(o==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
return o
}
var r=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,n,t,r)
};
AjxDateFormat.TimeSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.TimeSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.TimeSegment.prototype.constructor=AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.HourSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment.prototype.constructor=AjxDateFormat.HourSegment;
AjxDateFormat.HourSegment.prototype.toString=function(){
return'timeHour: "'+this._s+'"'
};
AjxDateFormat.HourSegment.prototype.format=function(t){
var e=t.getHours();
if(e>12&&/[hK]/.test(this._s)){
e-=12
}else{
if(e==0&&/[h]/.test(this._s)){
e=12
}}
return AjxFormat._zeroPad(e,this._s.length)
};
AjxDateFormat.HourSegment.prototype.parse=function(t,a,e){
var o=this._getFixedLength();
return AjxFormat.Segment._parseInt(t,"hours",0,a,e,o)
};
AjxDateFormat.MinuteSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.MinuteSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.MinuteSegment.prototype.constructor=AjxDateFormat.MinuteSegment;
AjxDateFormat.MinuteSegment.prototype.toString=function(){
return'timeMinute: "'+this._s+'"'
};
AjxDateFormat.MinuteSegment.prototype.format=function(e){
var t=e.getMinutes();
return AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.MinuteSegment.prototype.parse=function(t,a,e){
var o=this._getFixedLength();
return AjxFormat.Segment._parseInt(t,"minutes",0,a,e,o)
};
AjxDateFormat.SecondSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.SecondSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.SecondSegment.prototype.constructor=AjxDateFormat.SecondSegment;
AjxDateFormat.SecondSegment.prototype.toString=function(){
return'timeSecond: "'+this._s+'"'
};
AjxDateFormat.SecondSegment.prototype.format=function(e){
var t=/s/.test(this._s)?e.getSeconds():e.getMilliseconds();
return AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.SecondSegment.prototype.parse=function(a,n,t){
var e=/s/.test(this._s);
var o=e?"seconds":"milliseconds";
var r=e?this._getFixedLength():0;
return AjxFormat.Segment._parseInt(a,o,0,n,t,r)
};
AjxDateFormat.AmPmSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.AmPmSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.AmPmSegment.prototype.constructor=AjxDateFormat.AmPmSegment;
AjxDateFormat.AmPmSegment.prototype.toString=function(){
return'timeAmPm: "'+this._s+'"'
};
AjxDateFormat.AmPmSegment.prototype.format=function(t){
var e=t.getHours();
return e<12?I18nMsg.periodAm:I18nMsg.periodPm
};
AjxDateFormat.AmPmSegment.prototype.parse=function(t,o,e){
var n=[I18nMsg.periodAm.toLowerCase(),I18nMsg.periodPm.toLowerCase(),I18nMsg.periodAm.toUpperCase(),I18nMsg.periodPm.toUpperCase()];
var a=AjxFormat.Segment._parseLiterals(t,"ampm",0,n,o,e);
if(a==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
t.ampm=t.ampm%2;
return a
};
AjxDateFormat.TimezoneSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.TimezoneSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.TimezoneSegment.prototype.constructor=AjxDateFormat.TimezoneSegment;
AjxDateFormat.TimezoneSegment.prototype.toString=function(){
return'timeTimezone: "'+this._s+'"'
};
AjxDateFormat.TimezoneSegment.prototype.format=function(t){
var e=t.timezone||AjxTimezone.DEFAULT;
if(/Z/.test(this._s)){
return AjxTimezone.getShortName(e)
}
return this._s.length<4?AjxTimezone.getMediumName(e):AjxTimezone.getLongName(e)
};
AjxMessageFormat=function(s){
if(arguments.length==0){
return
}
AjxFormat.call(this,s);
if(s==null){
return
}
for(var t=0;
t<s.length;
t++){
var r=s.charAt(t);
if(r=="'"){
if(t+1<s.length&&s.charAt(t+1)=="'"){
var a=new AjxFormat.TextSegment(this,"'");
this._segments.push(a);
t++;
continue
}
var h=t+1;
for(t++;
t<s.length;
t++){
var r=s.charAt(t);
if(r=="'"){
if(t+1<s.length&&s.charAt(t+1)=="'"){
s=s.substr(0,t)+s.substr(t+1)
}else{
break
}}}
if(t==s.length){}
var n=t;
var a=new AjxFormat.TextSegment(this,s.substring(h,n));
this._segments.push(a);
continue
}
var h=t;
while(t<s.length){
r=s.charAt(t);
if(r=="{"||r=="'"){
break
}
t++
}
var n=t;
if(h!=n){
var a=new AjxFormat.TextSegment(this,s.substring(h,n));
this._segments.push(a);
t--;
continue
}
var h=t+1;
var e=0;
while(++t<s.length){
var r=s.charAt(t);
if(r=="{"){
e++
}else{
if(r=="}"){
if(e==0){
break
}
e--
}}}
var n=t;
var o=n-h;
var l=s.substr(h,o);
var a=new AjxMessageFormat.MessageSegment(this,l);
if(a!=null){
this._segments.push(a)
}}};
AjxMessageFormat.prototype=new AjxFormat;
AjxMessageFormat.prototype.constructor=AjxMessageFormat;
AjxMessageFormat.prototype.toString=function(){
return"[AjxMessageFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxMessageFormat.format=function(e,t){
return new AjxMessageFormat(e).format(t)
};
AjxMessageFormat.prototype.format=function(e){
if(!(e instanceof Array)){
e=[e]
}
return AjxFormat.prototype.format.call(this,e)
};
AjxMessageFormat.prototype.getFormats=function(){
var e=[];
for(var t=0;
t<this._segments.length;
t++){
var a=this._segments[t];
if(a instanceof AjxMessageFormat.MessageSegment){
e.push(a.getSegmentFormat())
}}
return e
};
AjxMessageFormat.prototype.getFormatsByArgumentIndex=function(){
var e=[];
for(var t=0;
t<this._segments.length;
t++){
var a=this._segments[t];
if(a instanceof AjxMessageFormat.MessageSegment){
e[a.getIndex()]=a.getSegmentFormat()
}}
return e
};
AjxMessageFormat.MessageSegment=function(o,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,o,e);
var a=AjxMessageFormat.MessageSegment._split(e,",");
this._index=Number(a[0]);
this._type=a[1]||"string";
this._style=a[2];
if(this._type=="list"){
this._isList=true;
this._type=a[2]||"string";
this._style=a[3]
}
switch(this._type){
case"number":switch(this._style){
case"integer":this._formatter=AjxNumberFormat.getIntegerInstance();
break;
case"currency":this._formatter=AjxNumberFormat.getCurrencyInstance();
break;
case"percent":this._formatter=AjxNumberFormat.getPercentInstance();
break;
default:this._formatter=this._style==null?AjxNumberFormat.getInstance():new AjxNumberFormat(this._style)
}
break;
case"date":case"time":var t=this._type=="date"?AjxDateFormat.getDateInstance:AjxDateFormat.getTimeInstance;
switch(this._style){
case"short":this._formatter=t(AjxDateFormat.SHORT);
break;
case"medium":this._formatter=t(AjxDateFormat.MEDIUM);
break;
case"long":this._formatter=t(AjxDateFormat.LONG);
break;
case"full":this._formatter=t(AjxDateFormat.FULL);
break;
default:this._formatter=this._style==null?t(AjxDateFormat.DEFAULT):new AjxDateFormat(this._style)
}
break;
case"choice":this._formatter=new AjxChoiceFormat(this._style);
break
}
if(this._isList){
this._formatter=new AjxListFormat(this._formatter)
}};
AjxMessageFormat.MessageSegment.prototype=new AjxFormat.Segment;
AjxMessageFormat.MessageSegment.prototype.constructor=AjxMessageFormat.MessageSegment;
AjxMessageFormat.MessageSegment.prototype.toString=function(){
var e=['message: "',this._s,'", index: ',this._index];
if(this._isList){
e.push(", list: ",this._isList)
}
if(this._type){
e.push(", type: ",this._type)
}
if(this._style){
e.push(", style: ",this._style)
}
if(this._formatter){
e.push(", formatter: ",this._formatter.toString())
}
return e.join("")
};
AjxMessageFormat.MessageSegment.prototype._index;
AjxMessageFormat.MessageSegment.prototype._type;
AjxMessageFormat.MessageSegment.prototype._style;
AjxMessageFormat.MessageSegment.prototype._isList=false;
AjxMessageFormat.MessageSegment.prototype._formatter;
AjxMessageFormat.MessageSegment.prototype.format=function(t){
var e=t[this._index];
if(this._formatter instanceof AjxChoiceFormat){
return this._formatter.format(t,this._index)
}
return this._formatter?this._formatter.format(e):String(e)
};
AjxMessageFormat.MessageSegment.prototype.getIndex=function(){
return this._index
};
AjxMessageFormat.MessageSegment.prototype.getType=function(){
return this._type
};
AjxMessageFormat.MessageSegment.prototype.getStyle=function(){
return this._style
};
AjxMessageFormat.MessageSegment.prototype.getSegmentFormat=function(){
return this._formatter
};
AjxMessageFormat.MessageSegment._split=function(o,e){
var n=[];
var a=0;
var t;
var r=0;
for(t=0;
t<o.length;
t++){
var h=o.charAt(t);
if(h=="{"){
r++
}else{
if(h=="}"){
r--
}else{
if(h==e&&r==0){
n.push(o.substring(a,t));
a=t+1
}}}}
if(t>a){
n.push(o.substring(a,t))
}
return n
};
AjxNumberFormat=function(g,y){
if(arguments.length==0){
return
}
AjxFormat.call(this,g);
if(!g){
return
}
var a=g.split(/;/);
var g=a[0];
var f=0;
var u=this.__parseStatic(g,f);
f=u.offset;
var s=u.text!="";
if(s){
this._segments.push(new AjxFormat.TextSegment(this,u.text))
}
var r=f;
while(f<g.length&&AjxNumberFormat._META_CHARS.indexOf(g.charAt(f))!=-1){
f++
}
var n=f;
var t=g.substring(r,n);
var w=t.indexOf("E");
var c=w!=-1?t.substring(w+1):null;
if(c){
t=t.substring(0,w);
this._showExponent=true
}
var d=t.indexOf(I18nMsg.numberSeparatorDecimal!=""?I18nMsg.numberSeparatorDecimal:".");
var v=d!=-1?t.substring(0,d):t;
if(v){
var k=v.lastIndexOf(I18nMsg.numberSeparatorGrouping!=""?I18nMsg.numberSeparatorGrouping:",");
if(k!=-1){
this._groupingOffset=v.length-k-1
}
v=v.replace(/[^#0]/g,"");
var l=v.indexOf("0");
if(l!=-1){
this._minIntDigits=v.length-l
}
this._maxIntDigits=v.length
}
var p=d!=-1?t.substring(d+1):null;
if(p){
var l=p.lastIndexOf("0");
if(l!=-1){
this._minFracDigits=l+1
}
this._maxFracDigits=p.replace(/[^#0]/g,"").length
}
this._segments.push(new AjxNumberFormat.NumberSegment(this,t));
var u=this.__parseStatic(g,f);
f=u.offset;
if(u.text!=""){
this._segments.push(new AjxFormat.TextSegment(this,u.text))
}
if(y){
return
}
if(a.length>1){
var g=a[1];
this._negativeFormatter=new AjxNumberFormat(g,true)
}else{
var m=new AjxNumberFormat("");
m._segments=m._segments.concat(this._segments);
var h=s?1:0;
var o=new AjxFormat.TextSegment(m,I18nMsg.numberSignMinus);
m._segments.splice(h,0,o);
this._negativeFormatter=m
}};
AjxNumberFormat.prototype=new AjxFormat;
AjxNumberFormat.prototype.constructor=AjxNumberFormat;
AjxNumberFormat.prototype.toString=function(){
var e=["[AjxNumberFormat: ","formatter=",AjxFormat.prototype.toString.call(this)];
if(this._negativeFormatter){
e.push(", negativeFormatter=",this._negativeFormatter.toString())
}
e.push("]");
return e.join("")
};
AjxNumberFormat._NUMBER="number";
AjxNumberFormat._INTEGER="integer";
AjxNumberFormat._CURRENCY="currency";
AjxNumberFormat._PERCENT="percent";
AjxNumberFormat._META_CHARS="0#.,E";
AjxNumberFormat.prototype._groupingOffset=Number.MAX_VALUE;
AjxNumberFormat.prototype._maxIntDigits;
AjxNumberFormat.prototype._minIntDigits=1;
AjxNumberFormat.prototype._maxFracDigits;
AjxNumberFormat.prototype._minFracDigits;
AjxNumberFormat.prototype._isCurrency=false;
AjxNumberFormat.prototype._isPercent=false;
AjxNumberFormat.prototype._isPerMille=false;
AjxNumberFormat.prototype._showExponent=false;
AjxNumberFormat.prototype._negativeFormatter;
AjxNumberFormat.getInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]=new AjxNumberFormat(I18nMsg.formatNumber)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]
};
AjxNumberFormat.getNumberInstance=AjxNumberFormat.getInstance;
AjxNumberFormat.getCurrencyInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]=new AjxNumberFormat(I18nMsg.formatNumberCurrency)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]
};
AjxNumberFormat.getIntegerInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]=new AjxNumberFormat(I18nMsg.formatNumberInteger)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]
};
AjxNumberFormat.getPercentInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]=new AjxNumberFormat(I18nMsg.formatNumberPercent)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]
};
AjxNumberFormat.format=function(t,e){
return new AjxNumberFormat(t).format(e)
};
AjxNumberFormat.initialize=function(){
AjxNumberFormat._FORMATTERS={}
};
AjxNumberFormat.prototype.format=function(e){
if(e<0&&this._negativeFormatter){
return this._negativeFormatter.format(e)
}
return AjxFormat.prototype.format.call(this,e)
};
AjxNumberFormat.prototype.__parseStatic=function(a,t){
var o=[];
while(t<a.length){
var r=a.charAt(t++);
if(AjxNumberFormat._META_CHARS.indexOf(r)!=-1){
t--;
break
}
switch(r){
case"'":var n=t;
while(t<a.length&&a.charAt(t++)!="'"){}
var e=t;
r=e-n==0?"'":a.substring(n,e);
break;
case"%":r=I18nMsg.numberSignPercent;
this._isPercent=true;
break;
case"\u2030":r=I18nMsg.numberSignPerMill;
this._isPerMille=true;
break;
case"\u00a4":r=a.charAt(t)=="\u00a4"?I18nMsg.currencyCode:I18nMsg.currencySymbol;
this._isCurrency=true;
break
}
o.push(r)
}
return{
text:o.join(""),offset:t}
};
AjxNumberFormat.NumberSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxNumberFormat.NumberSegment.prototype=new AjxFormat.Segment;
AjxNumberFormat.NumberSegment.prototype.constructor=AjxNumberFormat.NumberSegment;
AjxNumberFormat.NumberSegment.prototype.toString=function(){
return'number: "'+this._s+'"'
};
AjxNumberFormat.NumberSegment.prototype.format=function(t){
if(isNaN(t)){
return I18nMsg.numberNaN
}
if(t===Number.NEGATIVE_INFINITY||t===Number.POSITIVE_INFINITY){
return I18nMsg.numberInfinity
}
if(typeof t!="number"){
t=Number(t)
}
t=Math.abs(t);
if(this._parent._isPercent){
t*=100
}else{
if(this._parent._isPerMille){
t*=1000
}}
var e=this._parent._showExponent?t.toExponential(this._parent._maxFracDigits).toUpperCase().replace(/E\+/,"E"):t.toFixed(this._parent._maxFracDigits||0);
e=this._normalize(e);
return e
};
AjxNumberFormat.NumberSegment.prototype._normalize=function(r){
var o=r.split(/[\.Ee]/);
var h=o.shift();
if(h.length<this._parent._minIntDigits){
h=AjxFormat._zeroPad(h,this._parent._minIntDigits,I18nMsg.numberZero)
}
if(h.length>this._parent._groupingOffset){
var t=[];
var n=h.length-this._parent._groupingOffset;
while(n>0){
t.unshift(h.substr(n,this._parent._groupingOffset));
t.unshift(I18nMsg.numberSeparatorGrouping);
n-=this._parent._groupingOffset
}
t.unshift(h.substring(0,n+this._parent._groupingOffset));
h=t.join("")
}
var l="0";
var c;
if(r.match(/\./)){
l=o.shift()
}else{
if(r.match(/\e/)||r.match(/\E/)){
c=o.shift()
}}
l=l.replace(/0+$/,"");
if(l.length<this._parent._minFracDigits){
l=AjxFormat._zeroPad(l,this._parent._minFracDigits,I18nMsg.numberZero,true)
}
var t=[h];
if(l.length>0){
var e=this._parent._isCurrency?I18nMsg.numberSeparatorMoneyDecimal:I18nMsg.numberSeparatorDecimal;
t.push(e,l)
}
if(c){
t.push("E",c.replace(/^\+/,""))
}
return t.join("")
};
AjxChoiceFormat=function(s){
if(arguments.length==0){
return
}
AjxFormat.call(this,s);
if(s==null){
return
}
var l=s.split("|");
if(arguments.length==1){
this._limits=new Array(l.length);
this._lessThan=new Array(l.length);
this._formats=new Array(l.length);
var r=new RegExp("^([^#<\u2264]+)([#<\u2264])(.*)$");
for(var a=0;
a<l.length;
a++){
var t=l[a];
var o=r.exec(t);
var e=o[1];
var n=o[2];
var h=o[3];
if(e=="\u221E"){
this._limits[a]=Number.POSITIVE_INFINITY
}else{
if(e=="-\u221E"){
this._limits[a]=Number.NEGATIVE_INFINITY
}else{
this._limits[a]=parseFloat(e)
}}
this._lessThan[a]=n=="#"||n=="\u2264";
this._formats[a]=new AjxMessageFormat(h)
}}else{
this._limits=arguments[0];
this._lessThan=new Array(arguments[0].length);
this._formats=arguments[1];
this._pattern=[];
for(var a=0;
a<this._formats.length;
a++){
if(a>0){
this._pattern.push("|")
}
this._pattern.push(this._limits[a],"#",this._formats[a]);
this._lessThan[a]=false;
this._formats[a]=new AjxMessageFormat(this._formats[a])
}
this._pattern=this._pattern.join("")
}};
AjxChoiceFormat.prototype=new AjxFormat;
AjxChoiceFormat.prototype.constructor=AjxChoiceFormat;
AjxChoiceFormat.prototype.toString=function(){
return["[AjxChoiceFormat: ","limits={ ",this._limits.join(", ")," }, ","formats={ ",this._formats.join(", ")," }, ","lessThan={ ",this._lessThan.join(", ")," }]"].join("")
};
AjxChoiceFormat.prototype._limits;
AjxChoiceFormat.prototype._lessThan;
AjxChoiceFormat.prototype._formats;
AjxChoiceFormat.prototype.getLimits=function(){
return this._limits
};
AjxChoiceFormat.prototype.getFormats=function(){
return this._formats
};
AjxChoiceFormat.prototype.format=function(e,n){
var o=e instanceof Array?e[n]:e;
var l;
if(isNaN(o)||o<this._limits[0]){
l=this._formats[0]
}else{
for(var t=0;
t<this._limits.length-1;
t++){
var h=this._limits[t];
var r=this._limits[t+1];
var c=o>=h;
var s=this._lessThan[t+1]?o<r:o<=r;
if(c&&s){
l=this._formats[t];
break
}}
if(!l){
l=this._formats[this._formats.length-1]
}}
return l.format(e)
};
AjxListFormat=function(t,o,a,e){
AjxFormat.call(this,t?t.toPattern():"");
this._formatter=t;
this._separator=o||AjxMsg.listSeparator;
this._lastSeparator=a||AjxMsg.listSeparatorLast;
this._twoSeparator=e||AjxMsg.listSeparatorTwo
};
AjxListFormat.prototype=new AjxFormat;
AjxListFormat.prototype.constructor=AjxListFormat;
AjxListFormat.prototype._formatter;
AjxListFormat.prototype._separator;
AjxListFormat.prototype._lastSeparator;
AjxListFormat.prototype.format=function(n){
n=n instanceof Array?n:[n];
var o=[];
var e=n.length;
for(var t=0;
t<e;
t++){
if(t>0){
o.push((t<e-1)?this._separator:(e==2)?this._twoSeparator:this._lastSeparator)
}
var a=n[t];
o.push(this._formatter?this._formatter.format(a):String(a))
}
return o.join("")
};
AjxFormat.initialize()
}
if(AjxPackage.define("ajax.util.AjxDateUtil")){
AjxDateUtil=function(){};
AjxDateUtil.YEAR=1;
AjxDateUtil.MONTH=2;
AjxDateUtil.WEEK=3;
AjxDateUtil.DAY=4;
AjxDateUtil.TWO_WEEKS=5;
AjxDateUtil.MSEC_PER_MINUTE=60000;
AjxDateUtil.MSEC_PER_FIFTEEN_MINUTES=900000;
AjxDateUtil.MSEC_PER_HALF_HOUR=1800000;
AjxDateUtil.MSEC_PER_HOUR=3600000;
AjxDateUtil.MSEC_PER_DAY=24*AjxDateUtil.MSEC_PER_HOUR;
AjxDateUtil.MINUTES_PER_DAY=60*24;
AjxDateUtil.SECONDS_PER_DAY=60*60*24;
AjxDateUtil.WEEKDAY_SHORT=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT];
AjxDateUtil.WEEKDAY_MEDIUM=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM];
AjxDateUtil.WEEKDAY_LONG=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG];
AjxDateUtil.MONTH_SHORT=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT];
AjxDateUtil.MONTH_MEDIUM=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM];
AjxDateUtil.MONTH_LONG=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG];
AjxDateUtil._daysPerMonth={
0:31,1:29,2:31,3:30,4:31,5:30,6:31,7:31,8:30,9:31,10:30,11:31};
AjxDateUtil.MAX_DAYS_PER_MONTH=31;
AjxDateUtil.WEEK_ONE_JAN_DATE=1;
AjxDateUtil._init=function(){
AjxDateUtil._dateFormat=AjxDateFormat.getDateInstance(AjxDateFormat.SHORT).clone();
var e=AjxDateUtil._dateFormat.getSegments();
for(var t=0;
t<e.length;
t++){
if(e[t] instanceof AjxDateFormat.YearSegment){
e[t]=new AjxDateFormat.YearSegment(AjxDateUtil._dateFormat,"yyyy")
}}
AjxDateUtil._dateTimeFormat=new AjxDateFormat(AjxDateUtil._dateFormat.toPattern()+" "+AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT));
AjxDateUtil._dateFormatNoYear=new AjxDateFormat(AjxMsg.formatDateMediumNoYear)
};
AjxDateUtil._init();
AjxDateUtil.validDate=function(n,e,o){
var t=new Date(n,e,o);
var a=n>999?t.getFullYear():t.getYear();
return t.getMonth()==e&&t.getDate()==o&&a==n
};
AjxDateUtil.daysInMonth=function(a,e){
var t=new Date(a,e,1,12);
t.setMonth(t.getMonth()+1);
t.setDate(t.getDate()-1);
return t.getDate()
};
AjxDateUtil.isLeapYear=function(e){
return(new Date(e,1,29)).getMonth()==1
};
AjxDateUtil.isLocale24Hour=function(){
var t=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
var e=t._segments.length;
for(var a=0;
a<e;
a++){
if(t._segments[a]._s=="a"){
return false
}}
return true
};
AjxDateUtil.roll=function(t,a,n){
var o=t.getDate();
if(a==AjxDateUtil.MONTH){
t.setDate(1);
t.setMonth(t.getMonth()+n);
var e=AjxDateUtil.daysInMonth(t.getFullYear(),t.getMonth());
t.setDate(Math.min(o,e))
}else{
if(a==AjxDateUtil.YEAR){
t.setDate(1);
t.setFullYear(t.getFullYear()+n);
var e=AjxDateUtil.daysInMonth(t.getFullYear(),t.getMonth());
t.setDate(Math.min(o,e))
}else{
if(a==AjxDateUtil.WEEK){
t.setDate(t.getDate()+7*n)
}else{
if(a==AjxDateUtil.DAY){
t.setDate(t.getDate()+n)
}else{
if(a==AjxDateUtil.TWO_WEEKS){
t.setDate(t.getDate()+14*n)
}else{
return t
}}}}}
return t
};
AjxDateUtil.isDayShifted=function(e){
var t=new Date(e.getTime());
t.setDate(t.getDate()+1);
t.setHours(0,0,0,0);
return t.getTime()==e.getTime()
};
AjxDateUtil.rollToNextDay=function(e){
e.setHours(0,0,0,0);
e.setTime(e.getTime()+AjxDateUtil.MSEC_PER_DAY)
};
AjxDateUtil.computeDateDelta=function(e){
var t=(new Date()).getTime()-e;
var a=AjxDateUtil.computeDuration(t);
return a?(a+" "+AjxMsg.ago):null
};
AjxDateUtil.agoTime=function(e){
var t=(new Date()).getTime()-e;
var a=AjxDateUtil.computeDuration(t,false,true);
return a?(a+" "+AjxMsg.ago):null
};
AjxDateUtil.computeDuration=function(a,c,s){
if(a<0){
return null
}
var n=Math.floor(a/(AjxDateUtil.MSEC_PER_DAY*365));
if(n!=0){
a-=n*AjxDateUtil.MSEC_PER_DAY*365
}
var t=Math.floor(a/(AjxDateUtil.MSEC_PER_DAY*30.42));
if(t>0){
a-=Math.floor(t*AjxDateUtil.MSEC_PER_DAY*30.42)
}
var l=Math.floor(a/AjxDateUtil.MSEC_PER_DAY);
if(l>0){
a-=l*AjxDateUtil.MSEC_PER_DAY
}
var r=Math.floor(a/AjxDateUtil.MSEC_PER_HOUR);
if(r>0){
a-=r*AjxDateUtil.MSEC_PER_HOUR
}
var e=Math.floor(a/60000);
if(e>0){
a-=e*60000
}
var o=Math.floor(a/1000);
var h=c?AjxDurationFormatConcise:AjxDurationFormatVerbose;
if(n>0){
return s?h.formatYears(n):h.formatYears(n,t)
}else{
if(t>0){
return s?h.formatMonths(t):h.formatMonths(t,l)
}else{
if(l>0){
return s?h.formatDays(l):h.formatDays(l,r)
}else{
if(r>0){
return s?h.formatHours(r):h.formatHours(r,e)
}else{
if(e>0){
return s?h.formatMinutes(e):h.formatMinutes(e,o)
}else{
return h.formatSeconds(o)
}}}}}};
AjxDateUtil.simpleComputeDateStr=function(t,a){
var e=AjxDateUtil._dateFormat.format(t);
return a?a+e:e
};
AjxDateUtil.simpleParseDateStr=function(e){
return AjxDateUtil._dateFormat.parse(e)
};
AjxDateUtil.simpleComputeDateTimeStr=function(t,a){
var e=AjxDateUtil._dateTimeFormat.format(t);
return a?a+e:e
};
AjxDateUtil.simpleParseDateTimeStr=function(e){
return AjxDateUtil._dateTimeFormat.parse(e)
};
AjxDateUtil.longComputeDateStr=function(e){
var t=AjxDateFormat.getDateInstance(AjxDateFormat.FULL);
return t.format(e)
};
AjxDateUtil.computeDateStr=function(a,t){
if(t==null){
return""
}
var e=new Date(t);
if(a.getTime()-t<AjxDateUtil.MSEC_PER_DAY&&a.getDay()==e.getDay()){
return AjxDateUtil.computeTimeString(e)
}
if(a.getFullYear()==e.getFullYear()){
return AjxDateUtil._dateFormatNoYear.format(e)
}
return AjxDateUtil.simpleComputeDateStr(e)
};
AjxDateUtil.computeDateStrNoYear=function(e){
return AjxDateUtil._dateFormatNoYear.format(e)
};
AjxDateUtil.computeWordyDateStr=function(a,t){
if(t==null){
return""
}
var e=new Date(t);
if(a.getTime()-t<AjxDateUtil.MSEC_PER_DAY&&a.getDay()==e.getDay()){
if(!AjxDateUtil._wordyDateToday){
AjxDateUtil._wordyDateToday=new AjxDateFormat(AjxMsg.formatWordyDateToday)
}
return AjxDateUtil._wordyDateToday.format(e)
}else{
if((a.getTime()-t)<(2*AjxDateUtil.MSEC_PER_DAY)&&(a.getDay()-1)==e.getDay()){
if(!AjxDateUtil._wordyDateYesterday){
AjxDateUtil._wordyDateYesterday=new AjxDateFormat(AjxMsg.formatWordyDateYesterday)
}
return AjxDateUtil._wordyDateYesterday.format(e)
}else{
if(!AjxDateUtil._wordyDate){
AjxDateUtil._wordyDate=new AjxDateFormat(AjxMsg.formatWordyDate)
}
return AjxDateUtil._wordyDate.format(e)
}}};
AjxDateUtil.isValidSimpleDateStr=function(a){
if(!a){
return false
}
var t=AjxDateUtil.getSimpleDateFormat().parse(a);
if(!t){
return false
}
var e=AjxDateUtil.simpleComputeDateStr(t);
return(a==e)
};
AjxDateUtil.computeTimeString=function(e){
var t=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
return t.format(e)
};
AjxDateUtil.computeDateTimeString=function(e){
var t=AjxDateFormat.getDateTimeInstance(AjxDateFormat.LONG);
return t.format(e)
};
AjxDateUtil._getHoursStr=function(t,a,e){
var o=t.getHours();
if(!e){
o%=12;
if(o==0){
o=12
}}
return a?AjxDateUtil._pad(o):o
};
AjxDateUtil._getMinutesStr=function(e){
return AjxDateUtil._pad(e.getMinutes())
};
AjxDateUtil._getSecondsStr=function(e){
return AjxDateUtil._pad(e.getSeconds())
};
AjxDateUtil._getAMPM=function(t,a){
var e=t.getHours();
return(e<12)?(a?"AM":"am"):(a?"PM":"pm")
};
AjxDateUtil._getMonthName=function(e,t){
return t?AjxDateUtil.MONTH_MEDIUM[e.getMonth()]:AjxDateUtil.MONTH_LONG[e.getMonth()]
};
AjxDateUtil._getMonth=function(e,a){
var t=e.getMonth()+1;
if(a){
return AjxDateUtil._pad(t)
}else{
return t
}};
AjxDateUtil._getDate=function(e,t){
var a=e.getDate();
return t?AjxDateUtil._pad(a):a
};
AjxDateUtil._getWeekday=function(e){
var t=e.getDay();
return AjxDateUtil.WEEKDAY_LONG[t]
};
AjxDateUtil._getWeekdayMedium=function(e){
var t=e.getDay();
return AjxDateUtil.WEEKDAY_MEDIUM[t]
};
AjxDateUtil._getFullYear=function(e){
return e.getFullYear()
};
AjxDateUtil.getFirstDayOfWeek=function(o,e){
e=e||0;
var t=o.getDay();
var a=(t-e+7)%7;
o.setDate(o.getDate()-a);
return o
};
AjxDateUtil.getLastDayOfWeek=function(o,e){
e=e||0;
var t=o.getDay();
var a=(t-e+7)%7;
o.setDate(o.getDate()-a+6);
o.setHours(23,59,59,999);
return o
};
AjxDateUtil.getWeekNumber=function(g,c,q,v){
c=c||0;
q=q||AjxDateUtil.WEEK_ONE_JAN_DATE;
g=g||new Date();
g.setHours(12,0,0,0);
var n=g,x,h;
if(n.getDay()===c){
x=n
}else{
x=AjxDateUtil.getFirstDayOfWeek(n,c)
}
var u=x.getFullYear(),l=x.getTime();
h=new Date(x.getTime()+6*AjxDateUtil.MSEC_PER_DAY);
var e;
if(!v){
if(u!==h.getFullYear()&&h.getDate()>=q){
e=1
}else{
var s=(new Date(u,0,q));
s.setHours(12,0,0,0);
var o=AjxDateUtil.getFirstDayOfWeek(s,c);
var f=Math.round((n.getTime()-o.getTime())/AjxDateUtil.MSEC_PER_DAY);
var t=f%7;
var k=(f-t)/7;
e=k+1
}
return e
}else{
var y=new Date(g.getFullYear(),0,1);
var m=y.getDay()-1;
m=(m>=0?m:m+7);
var a=Math.floor((g.getTime()-y.getTime()-(g.getTimezoneOffset()-y.getTimezoneOffset())*60000)/AjxDateUtil.MSEC_PER_DAY)+1;
if(m<4){
e=Math.floor((a+m-1)/7)+1;
if(e>52){
var w=new Date(g.getFullYear()+1,0,1);
var p=w.getDay()-1;
p=p>=0?p:p+7;
e=p<4?1:53
}}else{
e=Math.floor((a+m-1)/7);
if(e==0){
var r=new Date(g.getFullYear()-1,0,1);
var d=r.getDay()-1;
d=(d>=0?d:d+7);
e=(d==3||(AjxDateUtil.isLeapYear(r.getFullYear())&&d==2))?53:52
}}
return e
}};
AjxDateUtil.getTimeStr=function(e,a){
var t=a;
t=t.replace(/%d/g,AjxDateUtil._getDate(e,true));
t=t.replace(/%D/g,AjxDateUtil._getDate(e,false));
t=t.replace(/%w/g,AjxDateUtil._getWeekday(e));
t=t.replace(/%M/g,AjxDateUtil._getMonthName(e));
t=t.replace(/%t/g,AjxDateUtil._getMonthName(e,true));
t=t.replace(/%n/g,AjxDateUtil._getMonth(e,true));
t=t.replace(/%Y/g,AjxDateUtil._getFullYear(e));
t=t.replace(/%h/g,AjxDateUtil._getHoursStr(e,false,false));
t=t.replace(/%H/g,AjxDateUtil._getHoursStr(e,true,false));
t=t.replace(/%m/g,AjxDateUtil._getMinutesStr(e));
t=t.replace(/%s/g,AjxDateUtil._getSecondsStr(e));
t=t.replace(/%P/g,AjxDateUtil._getAMPM(e,true));
t=t.replace(/%p/g,AjxDateUtil._getAMPM(e,false));
return t
};
AjxDateUtil.getRoundedMins=function(e,a){
var t=e.getMinutes();
if(t!=0&&a){
t=(Math.ceil((t/a)))*a
}
return t
};
AjxDateUtil.roundTimeMins=function(t,o){
var a=t.getMinutes();
var e=t.getHours();
if(a!=0&&o){
a=(Math.ceil((a/o)))*o;
if(a==60){
a=0;
e++
}
t.setMinutes(a);
t.setHours(e)
}
return t
};
AjxDateUtil.isInRange=function(o,t,a,e){
return(o<e&&t>a)
};
AjxDateUtil.getSimpleDateFormat=function(){
return AjxDateUtil._dateFormat
};
AjxDateUtil.getServerDate=function(e){
if(!AjxDateUtil._serverDateFormatter){
AjxDateUtil._serverDateFormatter=new AjxDateFormat("yyyyMMdd")
}
return AjxDateUtil._serverDateFormatter.format(e)
};
AjxDateUtil.getServerDateTime=function(t,o){
var e=t;
var a=null;
if(o){
if(!AjxDateUtil._serverDateTimeFormatterUTC){
AjxDateUtil._serverDateTimeFormatterUTC=new AjxDateFormat("yyyyMMdd'T'HHmmss'Z'")
}
a=AjxDateUtil._serverDateTimeFormatterUTC;
e=new Date(t.getTime());
e.setMinutes(e.getMinutes()+e.getTimezoneOffset())
}else{
if(!AjxDateUtil._serverDateTimeFormatter){
AjxDateUtil._serverDateTimeFormatter=new AjxDateFormat("yyyyMMdd'T'HHmmss")
}
a=AjxDateUtil._serverDateTimeFormatter
}
return a.format(e)
};
AjxDateUtil.parseServerTime=function(n,e,o){
if(n.charAt(8)=="T"){
var a=parseInt(n.substr(9,2),10);
var s=parseInt(n.substr(11,2),10);
var t=parseInt(n.substr(13,2),10);
if(!o&&n.charAt(15)=="Z"){
s+=AjxTimezone.getOffset(AjxTimezone.DEFAULT,e)
}
e.setHours(a,s,t,0)
}
return e
};
AjxDateUtil.parseISO8601Date=function(o){
var t=AjxDateUtil.__ISO8601_formats;
if(!t){
t=AjxDateUtil.__ISO8601_formats=[new AjxDateUtil.TZDFormat("yyyy-MM-dd'T'HH:mm:ss.SZ"),new AjxDateUtil.TZDFormat("yyyy-MM-dd'T'HH:mm:ssZ"),new AjxDateUtil.TZDFormat("yyyy-MM-dd'T'HH:mmZ"),new AjxDateFormat("yyyy-MM-dd"),new AjxDateFormat("yyyy-MM"),new AjxDateFormat("yyyy")]
}
for(var a=0;
a<t.length;
a++){
var e=t[a].parse(o);
if(e){
return e
}}
return null
};
AjxDateUtil.TZDFormat=function(o){
if(arguments.length==0){
return
}
AjxDateFormat.apply(this,arguments);
var e=this._segments||[];
for(var t=0;
t<e.length;
t++){
var a=e[t];
if(a instanceof AjxDateFormat.TimezoneSegment){
e[t]=new AjxDateUtil.TZDSegment(a.toSubPattern())
}}};
AjxDateUtil.TZDFormat.prototype=new AjxDateFormat;
AjxDateUtil.TZDFormat.prototype.constructor=AjxDateUtil.TZDFormat;
AjxDateUtil.TZDFormat.prototype.toString=function(){
return"TZDFormat"
};
AjxDateUtil.TZDSegment=function(e){
if(arguments.length==0){
return
}
AjxDateFormat.TimezoneSegment.apply(this,arguments)
};
AjxDateUtil.TZDSegment.prototype=new AjxDateFormat.TimezoneSegment;
AjxDateUtil.TZDSegment.prototype.constructor=AjxDateUtil.TZDSegment;
AjxDateUtil.TZDSegment.prototype.toString=function(){
return"TZDSegment"
};
AjxDateUtil.TZDSegment.prototype.parse=function(l,n,a){
var e=/^(Z)|^(\+|\-)(\d\d):(\d\d)/.exec(n.substr(a));
if(e){
var h=new Date().getTimezoneOffset();
if(e[1]){
l.timezone=h
}else{
var t=parseInt(e[3],10),r=parseInt(e[4],10);
l.timezone=t*60+r;
if(e[2]!="-"){
l.timezone*=-1
}
l.timezone-=h
}}
return a+(e?e[0].length:0)
};
AjxDateUtil.parseServerDateTime=function(a,t){
if(a==null){
return null
}
var o=new Date();
var s=parseInt(a.substr(0,4),10);
var n=parseInt(a.substr(4,2),10);
var e=parseInt(a.substr(6,2),10);
o.setFullYear(s);
o.setMonth(n-1);
o.setMonth(n-1);
o.setDate(e);
AjxDateUtil.parseServerTime(a,o,t);
return o
};
AjxDateUtil._pad=function(e){
return e<10?("0"+e):e
};
AjxDurationFormatVerbose=function(){};
AjxDurationFormatVerbose.formatYears=function(a,e){
var t=a+" ";
t+=(a>1)?AjxMsg.years:AjxMsg.year;
if(a<=3&&e>0){
t+=" "+e;
t+=" "+((e>1)?AjxMsg.months:AjxMsg.months)
}
return t
};
AjxDurationFormatVerbose.formatMonths=function(e,a){
var t=e+" ";
t+=(e>1)?AjxMsg.months:AjxMsg.month;
if(e<=3&&a>0){
t+=" "+a;
t+=" "+((a>1)?AjxMsg.days:AjxMsg.day)
}
return t
};
AjxDurationFormatVerbose.formatDays=function(a,e){
var t=a+" ";
t+=(a>1)?AjxMsg.days:AjxMsg.day;
if(a<=2&&e>0){
t+=" "+e;
t+=" "+((e>1)?AjxMsg.hours:AjxMsg.hour)
}
return t
};
AjxDurationFormatVerbose.formatHours=function(e,a){
var t=e+" ";
t+=(e>1)?AjxMsg.hours:AjxMsg.hour;
if(e<5&&a>0){
t+=" "+a;
t+=" "+((a>1)?AjxMsg.minutes:AjxMsg.minute)
}
return t
};
AjxDurationFormatVerbose.formatMinutes=function(a,t){
var e=a+" ";
e+=((a>1)?AjxMsg.minutes:AjxMsg.minute);
if(a<5&&t>0){
e+=" "+t;
e+=" "+((t>1)?AjxMsg.seconds:AjxMsg.second)
}
return e
};
AjxDurationFormatVerbose.formatSeconds=function(e){
return(e+" "+((e>1)?AjxMsg.seconds:AjxMsg.second))
};
AjxDurationFormatConcise=function(){};
AjxDurationFormatConcise.formatYears=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatMonths=function(e,t){
return this._format(e,t)
};
AjxDurationFormatConcise.formatDays=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatHours=function(e,t){
return this._format(e,t)
};
AjxDurationFormatConcise.formatMinutes=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatSeconds=function(e){
return this._format(0,e)
};
AjxDurationFormatConcise._format=function(o,t){
var n=0;
var e=[];
e[n++]=o;
e[n++]=":";
if(t<10){
e[n++]="0"
}
e[n++]=t;
return e.join("")
};
AjxDateUtil.SUNDAY=0;
AjxDateUtil.MONDAY=1;
AjxDateUtil.TUESDAY=2;
AjxDateUtil.WEDNESDAY=3;
AjxDateUtil.THURSDAY=4;
AjxDateUtil.FRIDAY=5;
AjxDateUtil.SATURDAY=6;
AjxDateUtil.getDateForNextDay=function(t,n,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForNextWeekday(a,n);
if(e<o-1){
a.setDate(a.getDate()+1)
}}
return a
};
AjxDateUtil.getDateForNextWorkWeekDay=function(t,o){
o=o?o:1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForNextWorkWeekday(a);
if(e<o-1){
a.setDate(a.getDate()+1)
}}
return a
};
AjxDateUtil.getDateForThisDay=function(e,a,t){
if(t<0){
return AjxDateUtil.getDateForPrevDay(e,a,-t)
}else{
return AjxDateUtil.getDateForNextDay(e,a,t)
}};
AjxDateUtil.getDateForThisWorkWeekDay=function(e,t){
if(t<0){
return AjxDateUtil.getDateForPrevWorkWeekDay(e,-t)
}else{
return AjxDateUtil.getDateForNextWorkWeekDay(e,t)
}};
AjxDateUtil.getDateForPrevDay=function(t,n,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForPrevWeekday(a,n);
if(e<o-1){
a.setDate(a.getDate()-1)
}}
return a
};
AjxDateUtil.getDateForPrevWorkWeekDay=function(t,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForPrevWorkWeekday(a);
if(e<o-1){
a.setDate(a.getDate()-1)
}}
return a
};
AjxDateUtil.dateLocal2GMT=function(c){
if(!c){
return""
}
var u,t,m,d,r,h;
u=parseInt(c.substr(0,4),10);
t=parseInt(c.substr(4,2),10);
m=parseInt(c.substr(6,2),10);
d=parseInt(c.substr(8,2),10);
r=parseInt(c.substr(10,2),10);
h=parseInt(c.substr(12,2),10);
var o=new Date(u,t-1,m,d,r,h,0);
u=o.getUTCFullYear();
t=o.getUTCMonth()+1;
m=o.getUTCDate();
d=o.getUTCHours();
r=o.getUTCMinutes();
h=o.getUTCSeconds();
var l=[u,t,m,d,r,h];
for(var s=l.length;
--s>0;
){
var e=l[s];
if(e<10){
l[s]="0"+e
}}
return(l.join("")+"Z")
};
AjxDateUtil.dateGMT2Local=function(c){
if(!c){
return""
}
var u,t,m,d,r,h;
u=parseInt(c.substr(0,4),10);
t=parseInt(c.substr(4,2),10);
m=parseInt(c.substr(6,2),10);
d=parseInt(c.substr(8,2),10);
r=parseInt(c.substr(10,2),10);
h=parseInt(c.substr(12,2),10);
var o=new Date();
o.setUTCMilliseconds(0);
o.setUTCSeconds(h);
o.setUTCMinutes(r);
o.setUTCHours(d);
o.setUTCDate(m);
o.setUTCMonth(t-1);
o.setUTCFullYear(u);
u=o.getFullYear();
t=o.getMonth()+1;
m=o.getDate();
d=o.getHours();
r=o.getMinutes();
h=o.getSeconds();
var l=[u,t,m,d,r,h];
for(var s=l.length;
--s>0;
){
var e=l[s];
if(e<10){
l[s]="0"+e
}}
return(l.join("")+"Z")
};
AjxDateUtil._getDateForNextWeekday=function(a,n){
var e=new Date(a);
var t=a.getDay();
if(t==n){
return e
}
var o=(n-t);
if(o>0){
e.setDate(a.getDate()+o)
}else{
e.setDate(a.getDate()+(7+o))
}
return e
};
AjxDateUtil._getDateForNextWorkWeekday=function(a){
var e=new Date(a);
var t=a.getDay();
if(t==AjxDateUtil.SUNDAY){
e.setDate(a.getDate()+1)
}else{
if(t==AjxDateUtil.SATURDAY){
e.setDate(a.getDate()+2)
}}
return e
};
AjxDateUtil._getDateForPrevWeekday=function(a,n){
var e=new Date(a);
var t=a.getDay();
if(t==n){
return e
}
var o=(t-n);
if(o>0){
e.setDate(a.getDate()-o)
}else{
e.setDate(a.getDate()-(7+o))
}
return e
};
AjxDateUtil._getDateForPrevWorkWeekday=function(a){
var e=new Date(a);
var t=a.getDay();
if(t==AjxDateUtil.SUNDAY){
e.setDate(a.getDate()-2)
}else{
if(t==AjxDateUtil.SATURDAY){
e.setDate(a.getDate()-1)
}}
return e
};
AjxDateUtil.calculate=function(u,n){
if(!AjxDateUtil.__calculate_initialized){
AjxDateUtil.__calculate_initialized=true;
AjxDateUtil.__calculate_init()
}
var e=n||new Date;
u=u.replace(/^\s*|\s*$/,"").replace(/\s*=\s*/g,"=").replace(/\s*,\s*/g,",");
var f=u.split(/\s+/g);
var g,r,o,h,d,c,p,t;
for(var l=0;
l<f.length;
l++){
g=f[l];
if(g.match(AjxDateUtil.RE_COMMENT)){
break
}
if(g.match(AjxDateUtil.RE_NOW)){
n=new Date(e.getTime());
continue
}
if(r=g.match(AjxDateUtil.RE_ADD_NUMBER)){
o=r[1];
h=AjxDateUtil.__calculate_parseInt(r[2]);
d=f[++l];
c=o=="+"?h:h*-1;
AjxDateUtil.__calculate_add(n,d,c);
continue
}
if(r=g.match(AjxDateUtil.RE_SET)){
AjxDateUtil.__calculate_set(n,r[1],r[2]);
continue
}
n=AjxDateFormat.parse("yyyyy-MM-dd",g);
if(!n&&(n=AjxDateFormat.parse("yyyy-MM-dd'T'hh:mm:ss'Z'",g))){
n.setMinutes(n.getMinutes()-n.getTimezoneOffset())
}
if(!n){
n=AjxDateFormat.parse("yyyy-MM-dd'T'HH:mm:ss",g)
}
if(!n){
throw'invalid date pattern: "'+g+'"'
}}
return n
};
AjxDateUtil.S_DAYNAME=[AjxMsg["calc.dayname.sunday"],AjxMsg["calc.dayname.monday"],AjxMsg["calc.dayname.tuesday"],AjxMsg["calc.dayname.wednesday"],AjxMsg["calc.dayname.thursday"],AjxMsg["calc.dayname.friday"],AjxMsg["calc.dayname.saturday"]].join("|");
AjxDateUtil.S_MONTHNAME=[AjxMsg["calc.monthname.january"],AjxMsg["calc.monthname.february"],AjxMsg["calc.monthname.march"],AjxMsg["calc.monthname.april"],AjxMsg["calc.monthname.may"],AjxMsg["calc.monthname.june"],AjxMsg["calc.monthname.july"],AjxMsg["calc.monthname.august"],AjxMsg["calc.monthname.september"],AjxMsg["calc.monthname.october"],AjxMsg["calc.monthname.november"],AjxMsg["calc.monthname.december"]].join("|");
AjxDateUtil.S_WEEKORD=[AjxMsg["calc.ordinal.first"],AjxMsg["calc.ordinal.second"],AjxMsg["calc.ordinal.third"],AjxMsg["calc.ordinal.fourth"],AjxMsg["calc.ordinal.fifth"],AjxMsg["calc.ordinal.last"]].join("|");
AjxDateUtil.WEEKORD_RE=[new RegExp("(first|"+AjxMsg["calc.ordinal.first"]+")","i"),new RegExp("(second|"+AjxMsg["calc.ordinal.second"]+")","i"),new RegExp("(third|"+AjxMsg["calc.ordinal.third"]+")","i"),new RegExp("(fourth|"+AjxMsg["calc.ordinal.fourth"]+")","i"),new RegExp("(last|"+AjxMsg["calc.ordinal.last"]+")","i")];
AjxMsg["calc.now"]="now";
AjxMsg["calc.date"]="date";
AjxMsg["calc.duration.year"]="year|years";
AjxMsg["calc.duration.month"]="mons|month|months";
AjxMsg["calc.duration.day"]="day|days";
AjxMsg["calc.duration.hour"]="hour|hours";
AjxMsg["calc.duration.minute"]="min|mins|minute|minutes";
AjxMsg["calc.duration.week"]="week";
AjxMsg["calc.duration.second"]="sec|secs|second|seconds";
AjxMsg["calc.duration.millisecond"]="milli|millis|millisecond|milliseconds";
AjxDateUtil.S_DURATION=[AjxMsg["calc.duration.year"],AjxMsg["calc.duration.month"],AjxMsg["calc.duration.week"],AjxMsg["calc.duration.day"],AjxMsg["calc.duration.hour"],AjxMsg["calc.duration.minute"],AjxMsg["calc.duration.second"],AjxMsg["calc.duration.millisecond"]].join("|");
AjxDateUtil.__calculate_init=function(){
AjxDateUtil.WEEKDAYS={};
var t=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];
for(var o=0;
o<t.length;
o++){
var n=AjxMsg["calc.dayname."+t[o]].split("|");
for(var a=0;
a<n.length;
a++){
AjxDateUtil.WEEKDAYS[n[a].toLowerCase()]=o
}}
AjxDateUtil.MONTHNAME2MONTHNUM={};
var e=["january","february","march","april","may","june","july","august","september","october","november","december"];
for(var o=0;
o<e.length;
o++){
var s=AjxMsg["calc.monthname."+e[o]].split("|");
for(var a=0;
a<s.length;
a++){
AjxDateUtil.MONTHNAME2MONTHNUM[s[a].toLowerCase()]=o
}}
AjxDateUtil.RE_YEAR=new RegExp("^("+AjxMsg["calc.duration.year"]+")$","i");
AjxDateUtil.RE_MONTH=new RegExp("^("+AjxMsg["calc.duration.month"]+")$","i");
AjxDateUtil.RE_WEEK=new RegExp("^("+AjxMsg["calc.duration.week"]+")$","i");
AjxDateUtil.RE_DAY=new RegExp("^("+AjxMsg["calc.duration.day"]+")$","i");
AjxDateUtil.RE_HOUR=new RegExp("^("+AjxMsg["calc.duration.hour"]+")$","i");
AjxDateUtil.RE_MINUTE=new RegExp("^("+AjxMsg["calc.duration.minute"]+")$","i");
AjxDateUtil.RE_SECOND=new RegExp("^("+AjxMsg["calc.duration.second"]+")$","i");
AjxDateUtil.RE_MILLISECOND=new RegExp("^("+AjxMsg["calc.duration.millisecond"]+")$","i");
AjxDateUtil.RE_DATE=new RegExp("^("+AjxMsg["calc.date"]+")$","i");
AjxDateUtil.RE_DAYNAME=new RegExp("^("+AjxDateUtil.S_DAYNAME+")$","i");
AjxDateUtil.RE_MONTHNAME=new RegExp("^("+AjxDateUtil.S_MONTHNAME+")$","i");
AjxDateUtil.RE_WEEKORD=new RegExp("^("+AjxDateUtil.S_WEEKORD+")$","i");
AjxDateUtil.RE_COMMENT=/^#/;
AjxDateUtil.RE_NOW=new RegExp("^("+AjxMsg["calc.now"]+")$","i");
AjxDateUtil.RE_ADD_NUMBER=new RegExp("^([+\\-])(\\d+)$","i");
AjxDateUtil.RE_SET=new RegExp("^("+AjxDateUtil.S_DURATION+"|"+AjxMsg["calc.date"]+")=(.*)$","i")
};
AjxDateUtil.__calculate_normalizeFullWidthDigit=function(t){
var e="0".charCodeAt(0)+t.charCodeAt(0)-"\uff10".charCodeAt(0);
return String.fromCharCode(e)
};
AjxDateUtil.__calculate_replaceFullWidthDigit=function(e,t){
return AjxDateUtil.__calculate_normalizeFullWidthDigit(t)
};
AjxDateUtil.__calculate_parseInt=function(e){
e=e.replace(/([\uFF10-\uFF19])/g,AjxDateUtil.__calculate_normalizeFullWidthDigit);
return parseInt(e,10)
};
AjxDateUtil.__calculate_add=function(a,n,o){
if(n.match(AjxDateUtil.RE_YEAR)){
a.setFullYear(a.getFullYear()+o);
return
}
if(n.match(AjxDateUtil.RE_MONTH)){
var s=a.getMonth();
a.setMonth(s+o);
if(Math.abs(s+o)%12!=a.getMonth()){
a.setDate(0)
}
return
}
if(n.match(AjxDateUtil.RE_WEEK)){
a.setDate(a.getDate()+o*7);
return
}
if(n.match(AjxDateUtil.RE_DAY)){
a.setDate(a.getDate()+o);
return
}
if(n.match(AjxDateUtil.RE_HOUR)){
a.setHours(a.getHours()+o);
return
}
if(n.match(AjxDateUtil.RE_MINUTE)){
a.setMinutes(a.getMinutes()+o);
return
}
if(n.match(AjxDateUtil.RE_SECOND)){
a.setSeconds(a.getSeconds()+o);
return
}
if(n.match(AjxDateUtil.RE_MILLISECOND)){
a.setMilliseconds(a.getMilliseconds()+o);
return
}
if(n.match(AjxDateUtil.RE_MONTHNAME)){
var e=AjxDateUtil.MONTHNAME2MONTHNUM[n.toLowerCase()];
if(e<a.getMonth()){
o+=o>0?0:1
}else{
if(e>a.getMonth()){
o+=o>0?-1:0
}}
a.setFullYear(a.getFullYear()+o,e,1);
return
}
if(n.match(AjxDateUtil.RE_DAYNAME)){
var t=AjxDateUtil.WEEKDAYS[n.toLowerCase()];
if(t<a.getDay()){
o+=o>0?0:1
}else{
if(t>a.getDay()){
o+=o>0?-1:0
}}
a.setDate(a.getDate()+(t-a.getDay())+7*o);
return
}
throw"unknown type: "+n
};
AjxDateUtil.__calculate_add_ordinal=function(){
throw"TODO: not implemented"
};
AjxDateUtil.__calculate_set=function(o,h,c){
var s=c.split(/,/);
if(s[0].indexOf("H")==0){
s[0]=parseInt(s[0].replace("H",""))+1988
}
if(h.match(AjxDateUtil.RE_YEAR)){
s[0]=AjxDateUtil.__calculate_fullYear(s[0]);
if(s[1]!=null){
s[1]=AjxDateUtil.__calculate_month(s[1])
}
if(s[2]!=null){
s[2]=parseInt(s[2],10)
}
o.setFullYear.apply(o,s);
return
}
if(h.match(AjxDateUtil.RE_MONTH)){
s[0]=AjxDateUtil.__calculate_month(s[0]);
if(s[1]!=null){
s[1]=parseInt(s[1],10)
}
o.setMonth.apply(o,s);
return
}
if(h.match(AjxDateUtil.RE_WEEK)){
var t=AjxDateUtil.__calculate_week(s[0]);
var l=s[1]?AjxDateUtil.__calculate_day(s[1]):o.getDay();
var n;
if(t!=-1){
var e=new Date(o.getFullYear(),o.getMonth(),1,12,0,0,0);
var a=e.getDay();
var d=a-l;
n=new Date(e.getTime());
n.setDate(1-d);
if(d>0){
n.setDate(n.getDate()+7)
}
n.setDate(n.getDate()+7*t)
}else{
var r=new Date(o.getFullYear(),o.getMonth()+1,0,12,0,0,0);
n=new Date(r.getTime());
n.setDate(n.getDate()-(n.getDay()-l));
if(n.getMonth()!=r.getMonth()){
n.setDate(n.getDate()-7)
}}
if(n&&(o.getMonth()==n.getMonth())){
o.setTime(n.getTime())
}
return
}
if(h.match(AjxDateUtil.RE_DATE)){
s[0]=parseInt(s[0],10);
o.setDate.apply(o,s);
return
}
if(h.match(AjxDateUtil.RE_HOUR)){
s[0]=parseInt(s[0],10);
if(s[1]!=null){
s[1]=parseInt(s[1],10)
}
if(s[2]!=null){
s[2]=parseInt(s[2],10)
}
if(s[3]!=null){
s[3]=parseInt(s[3],10)
}
o.setHours.apply(o,s);
return
}
if(h.match(AjxDateUtil.RE_MINUTE)){
s[0]=parseInt(s[0],10);
if(s[1]!=null){
s[1]=parseInt(s[1],10)
}
if(s[2]!=null){
s[2]=parseInt(s[2],10)
}
o.setMinutes.apply(o,s);
return
}
if(h.match(AjxDateUtil.RE_SECOND)){
s[0]=parseInt(s[0],10);
if(s[1]!=null){
s[1]=parseInt(s[1],10)
}
o.setSeconds.apply(o,s);
return
}
if(h.match(AjxDateUtil.RE_MILLISECOND)){
o.setMilliseconds.apply(o,s);
return
}
throw"unknown type: "+h
};
AjxDateUtil.__calculate_fullYear=function(t){
if(t.length==2){
var a=new Date;
a.setYear(parseInt(t,10));
var e=a.getFullYear();
if(e<=AjxMsg.dateParsing2DigitStartYear){
t=String(e+100)
}else{
t=String(e).substr(0,2)+t
}}
return parseInt(t,10)
};
AjxDateUtil.__calculate_month=function(t){
var e=AjxDateUtil.MONTHNAME2MONTHNUM[t.toLowerCase()];
return e!=null?e:parseInt(t,10)-1
};
AjxDateUtil.__calculate_week=function(t){
for(var e=0;
e<AjxDateUtil.WEEKORD_RE.length;
e++){
if(t.match(AjxDateUtil.WEEKORD_RE[e])){
if(e==AjxDateUtil.WEEKORD_RE.length-1){
return -1
}
return e
}}
return 0
};
AjxDateUtil.__calculate_day=function(t){
var e=AjxDateUtil.WEEKDAYS[t.toLowerCase()];
return e!=null?e:parseInt(t,10)
}
}
if(AjxPackage.define("ajax.util.AjxTimezoneData")){
AjxTimezoneData={};
AjxTimezoneData.TRANSITION_YEAR=2014;
AjxTimezoneData.TIMEZONE_RULES=[{
serverId:"Etc/GMT+12",clientId:"Etc/GMT+12",score:100,standard:{
offset:-720,tzname:"GMT+12"}}
,{
serverId:"Pacific/Midway",clientId:"Pacific/Midway",score:100,standard:{
offset:-660,tzname:"SST"}}
,{
serverId:"Pacific/Honolulu",clientId:"Pacific/Honolulu",score:200,standard:{
offset:-600,tzname:"HST"}}
,{
serverId:"America/Anchorage",clientId:"America/Anchorage",score:200,standard:{
offset:-540,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"AKST"}
,daylight:{
offset:-480,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"AKDT"}}
,{
serverId:"America/Los_Angeles",clientId:"America/Los_Angeles",score:200,standard:{
offset:-480,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"PST"}
,daylight:{
offset:-420,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"PDT"}}
,{
serverId:"America/Tijuana",clientId:"America/Tijuana",score:100,standard:{
offset:-480,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"PST"}
,daylight:{
offset:-420,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"PDT"}}
,{
serverId:"America/Chihuahua",clientId:"America/Chihuahua",score:100,standard:{
offset:-420,mon:10,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,26],tzname:"MST"}
,daylight:{
offset:-360,mon:4,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,4,6],tzname:"MDT"}}
,{
serverId:"America/Denver",clientId:"America/Denver",score:200,standard:{
offset:-420,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"MST"}
,daylight:{
offset:-360,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"MDT"}}
,{
serverId:"America/Phoenix",clientId:"America/Phoenix",score:200,standard:{
offset:-420,tzname:"MST"}}
,{
serverId:"America/Chicago",clientId:"America/Chicago",score:200,standard:{
offset:-360,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"CST"}
,daylight:{
offset:-300,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"CDT"}}
,{
serverId:"America/Guatemala",clientId:"America/Guatemala",score:100,standard:{
offset:-360}}
,{
serverId:"America/Mexico_City",clientId:"America/Mexico_City",score:100,standard:{
offset:-360,mon:10,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,26],tzname:"CST"}
,daylight:{
offset:-300,mon:4,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,4,6],tzname:"CDT"}}
,{
serverId:"America/Regina",clientId:"America/Regina",score:200,standard:{
offset:-360,tzname:"CST"}}
,{
serverId:"America/Bogota",clientId:"America/Bogota",score:100,standard:{
offset:-300}}
,{
serverId:"America/Indiana/Indianapolis",clientId:"America/Indiana/Indianapolis",score:100,standard:{
offset:-300,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"EST"}
,daylight:{
offset:-240,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"EDT"}}
,{
serverId:"America/New_York",clientId:"America/New_York",score:200,standard:{
offset:-300,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"EST"}
,daylight:{
offset:-240,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"EDT"}}
,{
serverId:"America/Caracas",clientId:"America/Caracas",score:100,standard:{
offset:-270,tzname:"VET"}}
,{
serverId:"America/Asuncion",clientId:"America/Asuncion",score:100,standard:{
offset:-240,mon:4,week:2,wkday:1,hour:0,min:0,sec:0,trans:[2014,4,13],tzname:"PYT"}
,daylight:{
offset:-180,mon:10,week:1,wkday:1,hour:0,min:0,sec:0,trans:[2014,10,5],tzname:"PYST"}}
,{
serverId:"America/Cuiaba",clientId:"America/Cuiaba",score:100,standard:{
offset:-240,mon:2,week:3,wkday:1,hour:0,min:0,sec:0,trans:[2014,2,16],tzname:"AMT"}
,daylight:{
offset:-180,mon:10,week:3,wkday:1,hour:0,min:0,sec:0,trans:[2014,10,19],tzname:"AMST"}}
,{
serverId:"America/Guyana",clientId:"America/Guyana",score:100,standard:{
offset:-240,tzname:"GYT"}}
,{
serverId:"America/Halifax",clientId:"America/Halifax",score:100,standard:{
offset:-240,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"AST"}
,daylight:{
offset:-180,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"ADT"}}
,{
serverId:"America/Santiago",clientId:"America/Santiago",score:100,standard:{
offset:-240,mon:3,week:2,wkday:1,hour:0,min:0,sec:0,trans:[2014,3,9],tzname:"CLT"}
,daylight:{
offset:-180,mon:10,week:2,wkday:1,hour:0,min:0,sec:0,trans:[2014,10,12],tzname:"CLST"}}
,{
serverId:"America/St_Johns",clientId:"America/St_Johns",score:100,standard:{
offset:-210,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,11,2],tzname:"NST"}
,daylight:{
offset:-150,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"NDT"}}
,{
serverId:"America/Argentina/Buenos_Aires",clientId:"America/Argentina/Buenos_Aires",score:100,standard:{
offset:-180}}
,{
serverId:"America/Cayenne",clientId:"America/Cayenne",score:100,standard:{
offset:-180,tzname:"GFT"}}
,{
serverId:"America/Godthab",clientId:"America/Godthab",score:100,standard:{
offset:-180,mon:10,week:-1,wkday:1,hour:1,min:0,sec:0,trans:[2014,10,26],tzname:"WGT"}
,daylight:{
offset:-120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,30],tzname:"WGST"}}
,{
serverId:"America/Montevideo",clientId:"America/Montevideo",score:100,standard:{
offset:-180,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,9],tzname:"UYT"}
,daylight:{
offset:-120,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,5],tzname:"UYST"}}
,{
serverId:"America/Sao_Paulo",clientId:"America/Sao_Paulo",score:100,standard:{
offset:-180,mon:2,week:3,wkday:1,hour:0,min:0,sec:0,trans:[2014,2,16],tzname:"BRT"}
,daylight:{
offset:-120,mon:10,week:3,wkday:1,hour:0,min:0,sec:0,trans:[2014,10,19],tzname:"BRST"}}
,{
serverId:"Atlantic/South_Georgia",clientId:"Atlantic/South_Georgia",score:100,standard:{
offset:-120,tzname:"GST"}}
,{
serverId:"Atlantic/Azores",clientId:"Atlantic/Azores",score:100,standard:{
offset:-60,mon:10,week:-1,wkday:1,hour:1,min:0,sec:0,trans:[2014,10,26],tzname:"AZOT"}
,daylight:{
offset:0,mon:3,week:-1,wkday:1,hour:0,min:0,sec:0,trans:[2014,3,30],tzname:"AZOST"}}
,{
serverId:"Atlantic/Cape_Verde",clientId:"Atlantic/Cape_Verde",score:100,standard:{
offset:-60,tzname:"CVT"}}
,{
serverId:"Africa/Casablanca",clientId:"Africa/Casablanca",score:100,standard:{
offset:0,mon:9,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,9,28],tzname:"WET"}
,daylight:{
offset:60,mon:4,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,4,27],tzname:"WEST"}}
,{
serverId:"Africa/Monrovia",clientId:"Africa/Monrovia",score:100,standard:{
offset:0,tzname:"GMT"}}
,{
serverId:"Europe/London",clientId:"Europe/London",score:100,standard:{
offset:0,mon:10,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,26],tzname:"GMT/BST"}
,daylight:{
offset:60,mon:3,week:-1,wkday:1,hour:1,min:0,sec:0,trans:[2014,3,30],tzname:"GMT/BST"}}
,{
serverId:"UTC",clientId:"UTC",score:100,standard:{
offset:0,tzname:"UTC"}}
,{
serverId:"Africa/Algiers",clientId:"Africa/Algiers",score:100,standard:{
offset:60,tzname:"CET"}}
,{
serverId:"Africa/Windhoek",clientId:"Africa/Windhoek",score:100,standard:{
offset:60,mon:4,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,4,6],tzname:"WAT"}
,daylight:{
offset:120,mon:9,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,9,7],tzname:"WAST"}}
,{
serverId:"Europe/Belgrade",clientId:"Europe/Belgrade",score:100,standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,10,26],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,30],tzname:"CEST"}}
,{
serverId:"Europe/Berlin",clientId:"Europe/Berlin",score:200,standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,10,26],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,30],tzname:"CEST"}}
,{
serverId:"Europe/Brussels",clientId:"Europe/Brussels",score:100,standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,10,26],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,30],tzname:"CEST"}}
,{
serverId:"Europe/Warsaw",clientId:"Europe/Warsaw",score:100,standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,10,26],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,3,30],tzname:"CEST"}}
,{
serverId:"Africa/Cairo",clientId:"Africa/Cairo",score:100,standard:{
offset:120}}
,{
serverId:"Africa/Harare",clientId:"Africa/Harare",score:200,standard:{
offset:120,tzname:"CAT"}}
,{
serverId:"Asia/Amman",clientId:"Asia/Amman",score:100,standard:{
offset:120,mon:10,week:-1,wkday:6,hour:1,min:0,sec:0,trans:[2014,10,31],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:5,hour:23,min:59,sec:59,trans:[2014,3,27],tzname:"EEST"}}
,{
serverId:"Asia/Beirut",clientId:"Asia/Beirut",score:100,standard:{
offset:120,mon:10,week:-1,wkday:1,hour:0,min:0,sec:0,trans:[2014,10,26],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:0,min:0,sec:0,trans:[2014,3,30],tzname:"EEST"}}
,{
serverId:"Asia/Damascus",clientId:"Asia/Damascus",score:100,standard:{
offset:120,mon:10,week:-1,wkday:6,hour:0,min:0,sec:0,trans:[2014,10,31],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:6,hour:0,min:0,sec:0,trans:[2014,3,28],tzname:"EEST"}}
,{
serverId:"Asia/Jerusalem",clientId:"Asia/Jerusalem",score:100,standard:{
offset:120,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,5],tzname:"IST"}
,daylight:{
offset:180,mon:3,week:-1,wkday:6,hour:2,min:0,sec:0,trans:[2014,3,28],tzname:"IDT"}}
,{
serverId:"Europe/Athens",clientId:"Europe/Athens",score:200,standard:{
offset:120,mon:10,week:-1,wkday:1,hour:4,min:0,sec:0,trans:[2014,10,26],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,3,30],tzname:"EEST"}}
,{
serverId:"Europe/Helsinki",clientId:"Europe/Helsinki",score:100,standard:{
offset:120,mon:10,week:-1,wkday:1,hour:4,min:0,sec:0,trans:[2014,10,26],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,3,30],tzname:"EEST"}}
,{
serverId:"Europe/Istanbul",clientId:"Europe/Istanbul",score:100,standard:{
offset:120,mon:10,week:-1,wkday:1,hour:4,min:0,sec:0,trans:[2014,10,26],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2014,3,30],tzname:"EEST"}}
,{
serverId:"Africa/Nairobi",clientId:"Africa/Nairobi",score:200,standard:{
offset:180,tzname:"EAT"}}
,{
serverId:"Asia/Baghdad",clientId:"Asia/Baghdad",score:100,standard:{
offset:180}}
,{
serverId:"Asia/Kuwait",clientId:"Asia/Kuwait",score:100,standard:{
offset:180,tzname:"AST"}}
,{
serverId:"Europe/Kaliningrad",clientId:"Europe/Kaliningrad",score:100,standard:{
offset:180,tzname:"FET"}}
,{
serverId:"Europe/Minsk",clientId:"Europe/Minsk",score:100,standard:{
offset:180,tzname:"FET"}}
,{
serverId:"Asia/Tehran",clientId:"Asia/Tehran",score:100,standard:{
offset:210,mon:9,week:4,wkday:1,hour:0,min:0,sec:0,trans:[2014,9,28],tzname:"IRST"}
,daylight:{
offset:270,mon:3,week:4,wkday:6,hour:0,min:0,sec:0,trans:[2014,3,28],tzname:"IRDT"}}
,{
serverId:"Asia/Baku",clientId:"Asia/Baku",score:100,standard:{
offset:240,mon:10,week:-1,wkday:1,hour:5,min:0,sec:0,trans:[2014,10,26],tzname:"AZT"}
,daylight:{
offset:300,mon:3,week:-1,wkday:1,hour:4,min:0,sec:0,trans:[2014,3,30],tzname:"AZST"}}
,{
serverId:"Asia/Muscat",clientId:"Asia/Muscat",score:100,standard:{
offset:240,tzname:"GST"}}
,{
serverId:"Asia/Tbilisi",clientId:"Asia/Tbilisi",score:200,standard:{
offset:240,tzname:"GET"}}
,{
serverId:"Asia/Yerevan",clientId:"Asia/Yerevan",score:100,standard:{
offset:240,tzname:"AMT"}}
,{
serverId:"Europe/Moscow",clientId:"Europe/Moscow",score:100,standard:{
offset:240,tzname:"MSK"}}
,{
serverId:"Indian/Mauritius",clientId:"Indian/Mauritius",score:100,standard:{
offset:240}}
,{
serverId:"Asia/Kabul",clientId:"Asia/Kabul",score:100,standard:{
offset:270,tzname:"AFT"}}
,{
serverId:"Asia/Karachi",clientId:"Asia/Karachi",score:200,standard:{
offset:300}}
,{
serverId:"Asia/Tashkent",clientId:"Asia/Tashkent",score:100,standard:{
offset:300,tzname:"UZT"}}
,{
serverId:"Asia/Colombo",clientId:"Asia/Colombo",score:100,standard:{
offset:330,tzname:"IST"}}
,{
serverId:"Asia/Kolkata",clientId:"Asia/Kolkata",score:200,standard:{
offset:330,tzname:"IST"}}
,{
serverId:"Asia/Almaty",clientId:"Asia/Almaty",score:100,standard:{
offset:360,tzname:"ALMT"}}
,{
serverId:"Asia/Dhaka",clientId:"Asia/Dhaka",score:100,standard:{
offset:360}}
,{
serverId:"Asia/Yekaterinburg",clientId:"Asia/Yekaterinburg",score:100,standard:{
offset:360,tzname:"YEKT"}}
,{
serverId:"Asia/Rangoon",clientId:"Asia/Rangoon",score:100,standard:{
offset:390,tzname:"MMT"}}
,{
serverId:"Asia/Bangkok",clientId:"Asia/Bangkok",score:100,standard:{
offset:420,tzname:"ICT"}}
,{
serverId:"Asia/Novosibirsk",clientId:"Asia/Novosibirsk",score:100,standard:{
offset:420,tzname:"NOVT"}}
,{
serverId:"Asia/Hong_Kong",clientId:"Asia/Hong_Kong",score:200,standard:{
offset:480}}
,{
serverId:"Asia/Krasnoyarsk",clientId:"Asia/Krasnoyarsk",score:100,standard:{
offset:480,tzname:"KRAT"}}
,{
serverId:"Asia/Kuala_Lumpur",clientId:"Asia/Kuala_Lumpur",score:100,standard:{
offset:480,tzname:"MYT"}}
,{
serverId:"Asia/Taipei",clientId:"Asia/Taipei",score:100,standard:{
offset:480}}
,{
serverId:"Asia/Ulaanbaatar",clientId:"Asia/Ulaanbaatar",score:100,standard:{
offset:480}}
,{
serverId:"Australia/Perth",clientId:"Australia/Perth",score:100,standard:{
offset:480,tzname:"WST"}}
,{
serverId:"Asia/Irkutsk",clientId:"Asia/Irkutsk",score:100,standard:{
offset:540,tzname:"IRKT"}}
,{
serverId:"Asia/Seoul",clientId:"Asia/Seoul",score:100,standard:{
offset:540}}
,{
serverId:"Asia/Tokyo",clientId:"Asia/Tokyo",score:200,standard:{
offset:540}}
,{
serverId:"Australia/Adelaide",clientId:"Australia/Adelaide",score:100,standard:{
offset:570,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2014,4,6],tzname:"CST"}
,daylight:{
offset:630,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,5],tzname:"CST"}}
,{
serverId:"Australia/Darwin",clientId:"Australia/Darwin",score:100,standard:{
offset:570,tzname:"CST"}}
,{
serverId:"Asia/Yakutsk",clientId:"Asia/Yakutsk",score:100,standard:{
offset:600,tzname:"YAKT"}}
,{
serverId:"Australia/Brisbane",clientId:"Australia/Brisbane",score:200,standard:{
offset:600,tzname:"EST"}}
,{
serverId:"Australia/Hobart",clientId:"Australia/Hobart",score:100,standard:{
offset:600,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2014,4,6],tzname:"EST"}
,daylight:{
offset:660,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,5],tzname:"EST"}}
,{
serverId:"Australia/Sydney",clientId:"Australia/Sydney",score:200,standard:{
offset:600,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2014,4,6],tzname:"EST"}
,daylight:{
offset:660,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,5],tzname:"EST"}}
,{
serverId:"Pacific/Guam",clientId:"Pacific/Guam",score:100,standard:{
offset:600,tzname:"ChST"}}
,{
serverId:"Asia/Vladivostok",clientId:"Asia/Vladivostok",score:100,standard:{
offset:660,tzname:"VLAT"}}
,{
serverId:"Pacific/Guadalcanal",clientId:"Pacific/Guadalcanal",score:100,standard:{
offset:660,tzname:"SBT"}}
,{
serverId:"Asia/Magadan",clientId:"Asia/Magadan",score:100,standard:{
offset:720,tzname:"MAGT"}}
,{
serverId:"Pacific/Auckland",clientId:"Pacific/Auckland",score:100,standard:{
offset:720,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2014,4,6],tzname:"NZST"}
,daylight:{
offset:780,mon:9,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2014,9,28],tzname:"NZDT"}}
,{
serverId:"Pacific/Fiji",clientId:"Pacific/Fiji",score:100,standard:{
offset:720,mon:1,week:3,wkday:1,hour:3,min:0,sec:0,trans:[2014,1,19],tzname:"FJT"}
,daylight:{
offset:780,mon:10,week:3,wkday:1,hour:2,min:0,sec:0,trans:[2014,10,19],tzname:"FJST"}}
,{
serverId:"Pacific/Tongatapu",clientId:"Pacific/Tongatapu",score:100,standard:{
offset:780}}
]
}
if(AjxPackage.define("ajax.util.AjxTimezone")){
AjxTimezone=function(){};
AjxTimezone.convertTimezone=function(t,e,n){
if(e==n){
return t
}
var o=AjxTimezone.getOffset(n,t);
var a=AjxTimezone.getOffset(e,t);
return new Date(t.getTime()+(o-a)*60*1000)
};
AjxTimezone.getTransition=function(o,a){
var t=[a||new Date().getFullYear(),o.mon,1];
if(o.mday){
t[2]=o.mday
}else{
if(o.wkday){
var e=new Date(a,o.mon-1,1,o.hour,o.min,o.sec);
if(o.week==-1){
var s=new Date(new Date(e.getTime()).setMonth(o.mon,0));
var n=s.getDate();
var h=s.getDay()+1;
var r=h>=o.wkday?h-o.wkday:7-o.wkday-h;
t[2]=n-r
}else{
var h=e.getDay()+1;
var r=o.wkday==h?1:0;
t[2]=o.wkday+7*(o.week-r)-h+1
}}}
return t
};
AjxTimezone.createMDayTransition=function(e,a){
if(e instanceof Date){
a=a!=null?a:e.getTimezoneOffset();
e=[e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()]
}
var t={
offset:a,trans:e};
return AjxTimezone.addMDayTransition(t)
};
AjxTimezone.addMDayTransition=function(t){
var e=t.trans;
t.mon=e[1];
t.mday=e[2];
t.hour=e[3];
t.min=e[4];
t.sec=e[5];
return t
};
AjxTimezone.createWkDayTransition=function(e,a){
if(e instanceof Date){
a=a!=null?a:e.getTimezoneOffset();
e=[e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()]
}
var t={
offset:a,trans:e};
return AjxTimezone.addWkDayTransition(t)
};
AjxTimezone.addWkDayTransition=function(n){
var a=n.trans;
var o=a[1];
var h=a[2];
var t=Math.floor((h-1)/7);
var e=new Date(a[0],a[1]-1,a[2],12,0,0);
var r=new Date(new Date(e.getTime()).setMonth(o-1,0)).getDate();
var s=r-h<7;
n.mon=o;
n.week=s?-1:t+1;
n.wkday=e.getDay()+1;
n.hour=a[3];
n.min=a[4];
n.sec=a[5];
return n
};
AjxTimezone.createTransitionDate=function(o){
var e=new Date(AjxTimezoneData.TRANSITION_YEAR,o.mon-1,1,12,0,0);
if(o.mday){
e.setDate(o.mday)
}else{
if(o.week==-1){
e.setMonth(e.getMonth()+1,0);
for(var a=0;
a<7;
a++){
if(e.getDay()+1==o.wkday){
break
}
e.setDate(e.getDate()-1)
}}else{
for(var a=0;
a<7;
a++){
if(e.getDay()+1==o.wkday){
break
}
e.setDate(e.getDate()+1)
}
e.setDate(e.getDate()+7*(o.week-1))
}}
var t=[e.getFullYear(),e.getMonth()+1,e.getDate()];
return t
};
AjxTimezone.getZonePreferences=function(){
if(AjxTimezone._PREF_ZONE_DISPLAY){
var a=AjxTimezone._PREF_ZONE_DISPLAY.length;
var t=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(a!=t){
AjxTimezone._PREF_ZONE_DISPLAY=null
}}
if(!AjxTimezone._PREF_ZONE_DISPLAY){
AjxTimezone._PREF_ZONE_DISPLAY=[];
AjxTimezone.getAbbreviatedZoneChoices();
for(var e=0;
e<AjxTimezone._ABBR_ZONE_OPTIONS.length;
e++){
AjxTimezone._PREF_ZONE_DISPLAY.push(AjxTimezone._ABBR_ZONE_OPTIONS[e].displayValue)
}}
return AjxTimezone._PREF_ZONE_DISPLAY
};
AjxTimezone.getZonePreferencesOptions=function(){
if(AjxTimezone._PREF_ZONE_OPTIONS){
var a=AjxTimezone._PREF_ZONE_OPTIONS.length;
var t=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(a!=t){
AjxTimezone._PREF_ZONE_OPTIONS=null
}}
if(!AjxTimezone._PREF_ZONE_OPTIONS){
AjxTimezone._PREF_ZONE_OPTIONS=[];
AjxTimezone.getAbbreviatedZoneChoices();
for(var e=0;
e<AjxTimezone._ABBR_ZONE_OPTIONS.length;
e++){
AjxTimezone._PREF_ZONE_OPTIONS.push(AjxTimezone._ABBR_ZONE_OPTIONS[e].value)
}}
return AjxTimezone._PREF_ZONE_OPTIONS
};
AjxTimezone.getServerId=function(e){
return AjxTimezone._CLIENT2SERVER[e]||e
};
AjxTimezone.getClientId=function(e){
return AjxTimezone._SERVER2CLIENT[e]||e
};
AjxTimezone.getShortName=function(t){
var a=AjxTimezone.getRule(t);
if(a&&a.shortName){
return a.shortName
}
var e=["GMT",AjxTimezone._SHORT_NAMES[t]].join("");
if(a){
a.shortName=e
}
return e
};
AjxTimezone.getMediumName=function(e){
var a=AjxTimezone.getRule(e);
if(a&&a.mediumName){
return a.mediumName
}
var t=AjxMsg[e]||["(",AjxTimezone.getShortName(e),") ",e].join("");
if(a){
a.mediumName=t
}
return t
};
AjxTimezone.getLongName=AjxTimezone.getMediumName;
AjxTimezone.addRule=function(a){
var t=a.serverId;
var e=a.clientId;
AjxTimezone._CLIENT2SERVER[e]=t;
AjxTimezone._SERVER2CLIENT[t]=e;
AjxTimezone._SHORT_NAMES[e]=AjxTimezone._generateShortName(a.standard.offset);
AjxTimezone._CLIENT2RULE[e]=a;
var o=a.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
o.push(a)
};
AjxTimezone.getRule=function(e,o){
var c=AjxTimezone._CLIENT2RULE[e];
if(!c){
e=AjxTimezone._SERVER2CLIENT[e];
c=AjxTimezone._CLIENT2RULE[e]
}
if(!c&&o){
var l=["standard","daylight"];
var d=o.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
for(var s=0;
s<d.length;
s++){
c=d[s];
var u=true;
for(var n=0;
n<l.length;
n++){
var t=l[n];
var r=c[t];
if(!r){
continue
}
var h=false;
for(var a in o[t]){
if(o[t][a]!=r[a]){
u=false;
h=true;
break
}}
if(h){
break
}}
if(u){
return c
}}
return null
}
return c
};
AjxTimezone.getOffset=function(e,n){
var m=AjxTimezone.getRule(e||AjxTimezone.DEFAULT);
if(m&&m.daylight){
var d=n.getFullYear();
var r=m.standard,t=m.daylight;
var c=AjxTimezone.getTransition(r,d);
var p=AjxTimezone.getTransition(t,d);
var l=n.getMonth()+1,u=n.getDate();
var s=c[1],f=c[2];
var h=p[1],o=p[2];
var a=false;
if(h<s){
a=l>h&&l<s;
a=a||(l==h&&u>=o);
a=a||(l==s&&u<f)
}else{
a=l<s||l>h;
a=a||(l==h&&u>=o);
a=a||(l==s&&u<f)
}
return a?t.offset:r.offset
}
return m?m.standard.offset:-(new Date().getTimezoneOffset())
};
AjxTimezone.guessMachineTimezone=function(){
return AjxTimezone._guessMachineTimezone().clientId
};
AjxTimezone.getAbbreviatedZoneChoices=function(){
if(AjxTimezone._ABBR_ZONE_OPTIONS){
var n=AjxTimezone._ABBR_ZONE_OPTIONS.length;
var o=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(n!=o){
AjxTimezone._ABBR_ZONE_OPTIONS=null
}}
if(!AjxTimezone._ABBR_ZONE_OPTIONS){
AjxTimezone._ABBR_ZONE_OPTIONS=[];
for(var e in AjxTimezone._CLIENT2SERVER){
var s=AjxTimezone._CLIENT2RULE[e];
var t=s.serverId;
var a={
displayValue:AjxTimezone.getMediumName(e),value:t,standard:s.standard,serverId:t,clientId:e};
AjxTimezone._ABBR_ZONE_OPTIONS.push(a)
}
AjxTimezone._ABBR_ZONE_OPTIONS.sort(AjxTimezone._BY_OFFSET)
}
return AjxTimezone._ABBR_ZONE_OPTIONS
};
AjxTimezone.getMatchingTimezoneChoices=function(){
if(AjxTimezone._MATCHING_ZONE_OPTIONS){
var s=AjxTimezone._MATCHING_ZONE_OPTIONS.length;
var n=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(s!=n){
AjxTimezone._MATCHING_ZONE_OPTIONS=null
}}
if(!AjxTimezone._MATCHING_ZONE_OPTIONS){
AjxTimezone._MATCHING_ZONE_OPTIONS=[];
for(var a in AjxTimezone.MATCHING_RULES){
var r=AjxTimezone.MATCHING_RULES[a];
var e=r.clientId;
var t=r.serverId;
if(e==AjxTimezone.AUTO_DETECTED){
continue
}
var o={
displayValue:AjxTimezone.getMediumName(e),value:t,standard:r.standard,serverId:t,clientId:e};
AjxTimezone._MATCHING_ZONE_OPTIONS.push(o)
}
AjxTimezone._MATCHING_ZONE_OPTIONS.sort(AjxTimezone._BY_OFFSET)
}
return AjxTimezone._MATCHING_ZONE_OPTIONS
};
AjxTimezone._BY_OFFSET=function(a,t){
var n=a.standard.offset-t.standard.offset;
if(n==0){
var e=a.serverId;
var o=t.serverId;
if(e<o){
n=-1
}else{
if(e>o){
n=1
}}}
return n
};
AjxTimezone.GMT="Europe/London";
AjxTimezone.GMT_NO_DST="UTC";
AjxTimezone.AUTO_DETECTED="Auto-Detected";
AjxTimezone.DEFAULT;
AjxTimezone.DEFAULT_RULE;
AjxTimezone._CLIENT2SERVER={};
AjxTimezone._SERVER2CLIENT={};
AjxTimezone._SHORT_NAMES={};
AjxTimezone._CLIENT2RULE={};
AjxTimezone.STANDARD_RULES=[];
AjxTimezone.DAYLIGHT_RULES=[];
(function(){
for(var e=0;
e<AjxTimezoneData.TIMEZONE_RULES.length;
e++){
var t=AjxTimezoneData.TIMEZONE_RULES[e];
var a=t.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
a.push(t)
}}
)();
AjxTimezone._guessMachineTimezone=function(f){
var u=new Date(AjxTimezoneData.TRANSITION_YEAR,11,1,0,0,0);
var v=new Date(AjxTimezoneData.TRANSITION_YEAR,5,1,0,0,0);
var t=-u.getTimezoneOffset();
var g=-v.getTimezoneOffset();
AjxTimezone.MATCHING_RULES=[];
AjxTimezone.TIMEZONE_CONFLICT=false;
var c=[];
var s={};
var r=[];
var p=false;
if(g==t){
var m=AjxTimezone.STANDARD_RULES;
for(var y=0;
y<m.length;
++y){
var h=m[y];
if(h.standard.offset==g){
if(!s[h.serverId]){
c.push(h);
s[h.serverId]=true
}
AjxTimezone.MATCHING_RULES.push(h)
}}}else{
var m=AjxTimezone.DAYLIGHT_RULES;
var q=Math.max(t,g);
var k=Math.min(t,g);
var o=new Date();
var w=-o.getTimezoneOffset();
for(var y=0;
y<m.length;
++y){
var h=m[y];
if(h.standard.offset==k&&h.daylight.offset==q){
var l=h.standard.trans;
var d=h.daylight.trans;
var n=new Date(l[0],l[1]-1,l[2]-1);
var a=new Date(l[0],l[1]-1,l[2]+2);
var e=new Date(d[0],d[1]-1,d[2]-1);
var x=new Date(d[0],d[1]-1,d[2]+2);
if(-a.getTimezoneOffset()==k&&-x.getTimezoneOffset()==q&&-n.getTimezoneOffset()==q&&-e.getTimezoneOffset()==k){
if(!s[h.serverId]){
c.push(h);
s[h.serverId]=true
}
p=true
}}
if(h.standard.offset==w||h.daylight.offset==w){
AjxTimezone.MATCHING_RULES.push(h)
}}}
if((c.length>0)&&f!=null){
var m=c;
for(var y in m){
if(m[y].serverId==f){
return m[y]
}}}
if(c.length>0){
if(c.length>1){
c.sort(AjxTimezone.__BY_SCORE);
if(c[0].score!=c[1].score){
c.length=1
}}
AjxTimezone.TIMEZONE_CONFLICT=(c.length>1);
return c[0]
}
if((AjxTimezone.MATCHING_RULES.length>0)&&f!=null){
var m=AjxTimezone.MATCHING_RULES;
for(var y in m){
if(m[y].serverId==f){
return m[y]
}}}
return AjxTimezone._generateDefaultRule()
};
AjxTimezone.__BY_SCORE=function(t,e){
return e.score-t.score
};
AjxTimezone._generateDefaultRule=function(){
var c=0;
var a=1;
var o=2;
var r=3;
var n=4;
function d(m,u,v,k){
var p=u.getTime();
var w=new Date();
w.setTime(m.getTime());
var y=new Date();
y.setTime(w.getTime());
var x=m.getTimezoneOffset()*-1;
if(!k){
k={
clientId:AjxTimezone.AUTO_DETECTED,autoDetected:true}
}
while(w.getTime()<=p){
if(v==c){
w.setUTCMonth(w.getUTCMonth()+1)
}else{
if(v==a){
w.setUTCDate(w.getUTCDate()+1)
}else{
if(v==o){
w.setUTCHours(w.getUTCHours()+1)
}else{
if(v==r){
w.setUTCMinutes(w.getUTCMinutes()+1)
}else{
if(v==n){
w.setUTCSeconds(w.getUTCSeconds()+1)
}else{
return k
}}}}}
var f=w.getTimezoneOffset()*-1;
if(f!=x){
if(v<n){
k=d(y,w,v+1,k)
}else{
var q=new Date();
q.setUTCFullYear(y.getFullYear(),y.getMonth(),y.getDate());
q.setUTCHours(y.getHours(),y.getMinutes(),y.getSeconds()+1);
var g=k[x<f?"daylight":"standard"]={
offset:f,trans:[q.getUTCFullYear(),q.getUTCMonth()+1,q.getUTCDate(),q.getUTCHours(),q.getUTCMinutes(),q.getUTCSeconds()]};
AjxTimezone.addWkDayTransition(g);
return k
}}
y.setTime(w.getTime());
x=f
}
return k
}
var t=new Date();
var e=new Date();
var h=t.getFullYear();
t.setUTCFullYear(h,t.getMonth(),t.getDate()-1);
t.setUTCHours(0,0,0,0);
e.setTime(t.getTime());
e.setUTCFullYear(h+1,t.getMonth(),t.getDate()+1);
var l=d(t,e,c);
if(!l.daylight||!l.standard){
l.standard={
offset:t.getTimezoneOffset()*-1};
delete l.daylight
}
l.serverId=["(GMT",AjxTimezone._generateShortName(l.standard.offset,true),") ",AjxTimezone.AUTO_DETECTED].join("");
if(l.daylight&&l.daylight.offset<l.standard.offset){
var s=l.daylight;
l.daylight=l.standard;
l.standard=s
}
return l
};
AjxTimezone._generateShortName=function(s,n){
if(s==0){
return""
}
var t=s<0?"-":"+";
var a=Math.abs(s);
var e=Math.floor(a/60);
var o=a%60;
e=e<10?"0"+e:e;
o=o<10?"0"+o:o;
return[t,e,n?".":"",o].join("")
};
AjxTimezone.DEFAULT_RULE=AjxTimezone._guessMachineTimezone();
(function(){
AjxTimezoneData.TIMEZONE_RULES.sort(AjxTimezone._BY_OFFSET);
for(var e=0;
e<AjxTimezoneData.TIMEZONE_RULES.length;
e++){
var t=AjxTimezoneData.TIMEZONE_RULES[e];
AjxTimezone.addRule(t)
}}
)();
AjxTimezone.DEFAULT=AjxTimezone.getClientId(AjxTimezone.DEFAULT_RULE.serverId)
}
if(AjxPackage.define("ajax.util.AjxEmailAddress")){
AjxEmailAddress=function(e,o,t,a,n){
this.address=e;
this.name=this._setName(t);
this.dispName=a;
this.type=o||AjxEmailAddress.TO;
this.isGroup=n;
this.canExpand=false
};
AjxEmailAddress.prototype.isAjxEmailAddress=true;
AjxEmailAddress.customInvalidEmailPats=[];
AjxEmailAddress.FROM="FROM";
AjxEmailAddress.TO="TO";
AjxEmailAddress.CC="CC";
AjxEmailAddress.BCC="BCC";
AjxEmailAddress.REPLY_TO="REPLY_TO";
AjxEmailAddress.SENDER="SENDER";
AjxEmailAddress.READ_RECEIPT="READ_RECEIPT";
AjxEmailAddress.RESENT_FROM="RESENT_FROM";
AjxEmailAddress.TYPE_STRING={};
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.FROM]="from";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.TO]="to";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.CC]="cc";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.BCC]="bcc";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.REPLY_TO]="replyTo";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.SENDER]="sender";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.READ_RECEIPT]="readReceipt";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.RESENT_FROM]="resentFrom";
AjxEmailAddress.fromSoapType={};
AjxEmailAddress.fromSoapType.f=AjxEmailAddress.FROM;
AjxEmailAddress.fromSoapType.t=AjxEmailAddress.TO;
AjxEmailAddress.fromSoapType.c=AjxEmailAddress.CC;
AjxEmailAddress.fromSoapType.b=AjxEmailAddress.BCC;
AjxEmailAddress.fromSoapType.r=AjxEmailAddress.REPLY_TO;
AjxEmailAddress.fromSoapType.s=AjxEmailAddress.SENDER;
AjxEmailAddress.fromSoapType.n=AjxEmailAddress.READ_RECEIPT;
AjxEmailAddress.fromSoapType.rf=AjxEmailAddress.RESENT_FROM;
AjxEmailAddress.toSoapType={};
AjxEmailAddress.toSoapType[AjxEmailAddress.FROM]="f";
AjxEmailAddress.toSoapType[AjxEmailAddress.TO]="t";
AjxEmailAddress.toSoapType[AjxEmailAddress.CC]="c";
AjxEmailAddress.toSoapType[AjxEmailAddress.BCC]="b";
AjxEmailAddress.toSoapType[AjxEmailAddress.REPLY_TO]="r";
AjxEmailAddress.toSoapType[AjxEmailAddress.SENDER]="s";
AjxEmailAddress.toSoapType[AjxEmailAddress.READ_RECEIPT]="n";
AjxEmailAddress.SEPARATOR="; ";
AjxEmailAddress.DELIMS=[";",",","\n"," "];
AjxEmailAddress.IS_DELIM={};
for(var i=0;
i<AjxEmailAddress.DELIMS.length;
i++){
AjxEmailAddress.IS_DELIM[AjxEmailAddress.DELIMS[i]]=true
}
AjxEmailAddress.addrAnglePat=/(\s*<(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))>\s*)/;
AjxEmailAddress.addrAngleQuotePat=/(\s*<'(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))'>\s*)/;
AjxEmailAddress.addrPat=/(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))/;
AjxEmailAddress.addrPat1=/(^|"|\s)(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))/;
AjxEmailAddress.accountPat=/((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))/;
AjxEmailAddress.commentPat=/\((.*)\)/g;
AjxEmailAddress.phrasePat=/(((\s*[^\x00-\x1F\x7F()<>\[\]:;@\"\s]+\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))+)/;
AjxEmailAddress.boundAddrPat=/(\s*<?(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))>?\s*)$/;
AjxEmailAddress.parse=function(s){
var r,t;
var s=AjxStringUtil.trim(s);
var o=AjxEmailAddress._prelimCheck(s);
if(!(o&&s.match(AjxEmailAddress.addrPat))){
return null
}
var n=s.match(AjxEmailAddress.addrAngleQuotePat)||s.match(AjxEmailAddress.addrAnglePat);
if(n&&n.length){
r=n[2];
s=s.replace(AjxEmailAddress.addrAnglePat,"")
}else{
n=s.match(AjxEmailAddress.addrPat1);
if(n&&n.length){
if(n[1]=='"'){
return null
}
r=s.match(AjxEmailAddress.addrPat);
r=(r&&r.length&&r[0]!="")?AjxStringUtil.trim(r[0]):n[0];
if(r&&r.indexOf("..")!=-1){
return null
}
s=s.replace(AjxEmailAddress.addrPat,"")
}}
if(!r){
return null
}
for(var a=0;
a<AjxEmailAddress.customInvalidEmailPats.length;
a++){
var e=r.match(AjxEmailAddress.customInvalidEmailPats[a]);
if(e){
return null
}}
n=s.match(AjxEmailAddress.phrasePat);
if(n){
t=AjxStringUtil.trim(n[0]);
t=t.replace(/\\"/g,"&quot;");
t=AjxStringUtil.trim(t,null,'"');
t=t.replace(/&quot;/g,'"')
}
return new AjxEmailAddress(r,null,t)
};
AjxEmailAddress.parseEmailString=function(a,d,u){
var n=new AjxVector();
var t=new AjxVector();
var m=new AjxVector();
var h=AjxEmailAddress.split(a);
for(var r=0;
r<h.length;
r++){
var l=AjxStringUtil.trim(h[r]);
if(l){
var c=AjxEmailAddress.parse(l);
if(!c&&!u){
var f=l;
var s=f.match(AjxEmailAddress.addrAnglePat);
if(s&&s.length){
var e=f.replace(AjxEmailAddress.addrAnglePat,"");
var o=['"',e,'" ',s[0]].join("");
c=AjxEmailAddress.parse(o);
if(c){
c.name=e
}}}
if(c){
c.type=d;
n.add(c);
m.add(c)
}else{
t.add(l);
m.add(new AjxEmailAddress(l))
}}}
return{
good:n,bad:t,all:m}
};
AjxEmailAddress.isValid=function(e){
return AjxEmailAddress.parse(e)!=null
};
AjxEmailAddress._prelimCheck=function(a){
var e=a.indexOf("@");
var t=a.lastIndexOf(".");
return((e!=-1)&&(t!=-1)&&(t>e)&&(t!=a.length-1))
};
AjxEmailAddress.split=function(p){
p=AjxStringUtil.trim(p);
var f=[];
var g=0,u=0;
var y="",s="";
var r=false;
while(g<p.length){
var a=p.charAt(g);
if((a=='"'||a=="(")&&y!="\\"){
r=true;
s=a;
u=g;
g++;
while(r&&g<p.length){
var a=p.charAt(g);
if(((s=='"'&&a=='"')||(s=="("&&a==")"))&&(y!="\\")){
f.push({
start:u,end:g}
);
r=false
}
g++;
y=a
}}else{
g++
}
y=a
}
if(f.length){
AjxEmailAddress.IS_DELIM[" "]=false
}
u=0;
var d=[];
while(u<p.length){
var t=p.substring(u,p.length);
g=0;
var n=t.length;
while((n==t.length)&&(g<t.length)){
var a=t.charAt(g);
if(AjxEmailAddress.IS_DELIM[a]){
var o=false;
if(a!="\n"){
for(var l=0;
l<f.length;
l++){
var c=f[l];
var e=u+g;
o=(e>=c.start&&e<=c.end);
if(o){
break
}}}
if(!o){
var h=true;
var m=t.substring(0,g);
if(a==","||a==" "){
h=m.match(AjxEmailAddress.boundAddrPat)
}
if(h){
d.push(AjxStringUtil.trim(m));
n=g;
u+=m.length+1
}}
a=p.charAt(u);
while((u<p.length)&&AjxEmailAddress.IS_DELIM[a]){
u++;
a=p.charAt(u)
}
g++
}else{
g++
}}
if(n==t.length){
d.push(AjxStringUtil.trim(t));
u+=t.length+1
}}
AjxEmailAddress.IS_DELIM[" "]=true;
return d
};
AjxEmailAddress.prototype.toString=function(a,o){
if(this.name){
var t=this.name;
if(!a&&!o){
t=t.replace(/\\+"/g,'"');
t=t.replace(/"/g,'\\"')
}
var e=(a||o)?[t]:['"',t,'"'];
if(this.address&&!a){
e.push(" <",this.address,">")
}
return e.join("")
}else{
return this.address
}};
AjxEmailAddress.prototype.getAddress=function(){
return this.address
};
AjxEmailAddress.prototype.setAddress=function(e){
this.address=e
};
AjxEmailAddress.prototype.getType=function(){
return this.type
};
AjxEmailAddress.prototype.setType=function(e){
this.type=e
};
AjxEmailAddress.prototype.getTypeAsString=function(){
return AjxEmailAddress.TYPE_STRING[this.type]
};
AjxEmailAddress.prototype.getName=function(){
return this.name
};
AjxEmailAddress.prototype.getDispName=function(){
return this.dispName
};
AjxEmailAddress.prototype.clone=function(){
var e=new AjxEmailAddress(this.address,this.type,this.name,this.dispName);
e.icon=this.icon;
e.isGroup=this.isGroup;
e.canExpand=this.canExpand;
return e
};
AjxEmailAddress.copy=function(e){
var t=new AjxEmailAddress(e.address,e.type,e.name,e.dispName);
t.icon=e.icon;
t.isGroup=e.isGroup;
t.canExpand=e.canExpand;
return t
};
AjxEmailAddress.prototype._setName=function(e){
if(!e){
return""
}
if(e&&e.charAt(0)=="'"&&e.charAt(e.length-1)=="'"){
e=e.substring(1,e.length-1)
}
return e
};
AjxEmailAddress.sortCompareByAddress=function(o,t){
var e=o.getAddress()||"";
var n=t.getAddress()||"";
if(e.toLowerCase()>n.toLowerCase()){
return 1
}
if(e.toLowerCase()<n.toLowerCase()){
return -1
}
return 0
};
AjxEmailAddress.dedup=function(a){
var o=[],t={};
if(a&&a.length){
for(var e=0;
e<a.length;
e++){
var n=a[e];
if(!t[n.address]){
o.push(n)
}
t[n.address]=true
}}
return o
}
}
if(AjxPackage.define("ajax.util.AjxHistoryMgr")){
AjxHistoryMgr=function(){
this.currentLocation=null;
this.listener=null;
this.iframe=null;
this.ignoreLocationChange=null;
this.WAIT_TIME=AjxEnv.isIE?400:200;
this.currentWaitTime=0;
this.ieAtomicLocationChange=null;
this._eventMgr=new AjxEventMgr();
this._evt=new AjxEvent();
this._initialize()
};
AjxHistoryMgr.BLANK_FILE="blankHistory.html";
AjxHistoryMgr.IFRAME_ID="DhtmlHistoryFrame";
AjxHistoryMgr.prototype.addListener=function(e){
return this._eventMgr.addListener(AjxEvent.HISTORY,e)
};
AjxHistoryMgr.prototype.removeListener=function(e){
return this._eventMgr.removeListener(AjxEvent.HISTORY,e)
};
AjxHistoryMgr.prototype.add=function(a){
var e=this;
var t=function(){
if(e.currentWaitTime>0){
e.currentWaitTime=e.currentWaitTime-e.WAIT_TIME
}
a=e._removeHash(a);
if(AjxEnv.isIE){
if(document.getElementById(a)){
throw new DwtException("AjxHistoryMgr: location has same ID as DOM element")
}}
e.ignoreLocationChange=true;
this.ieAtomicLocationChange=true;
e.currentLocation=a;
window.location.hash=a;
if(AjxEnv.isIE){
e.iframe.src=AjxHistoryMgr.BLANK_FILE+"?"+a
}
this.ieAtomicLocationChange=false
};
window.setTimeout(t,this.currentWaitTime);
this.currentWaitTime=this.currentWaitTime+e.WAIT_TIME
};
AjxHistoryMgr.prototype.getCurrentLocation=function(){
return this._removeHash(window.location.hash)
};
AjxHistoryMgr.prototype._initialize=function(){
var e=this.getCurrentLocation();
this.currentLocation=e;
if(AjxEnv.isIE){
var n=[];
var o=0;
n[o++]="<iframe style='border: 0px; width: 1px; ";
n[o++]="height: 1px; position: absolute; bottom: 0px; ";
n[o++]="right: 0px; visibility: visible;' ";
n[o++]="id='"+AjxHistoryMgr.IFRAME_ID+"' ";
n[o++]="src='"+AjxHistoryMgr.BLANK_FILE+"?"+e+"'>";
n[o++]="</iframe>";
var s=document.createElement("div");
document.body.appendChild(s);
s.innerHTML=n.join("")
}
if(AjxEnv.isIE){
this.iframe=document.getElementById(AjxHistoryMgr.IFRAME_ID)
}
var t=this;
var a=function(){
t._checkLocation()
};
window.onhashchange=a
};
AjxHistoryMgr.prototype._checkLocation=function(){
if(!AjxEnv.isIE&&this.ignoreLocationChange){
this.ignoreLocationChange=false;
return
}
if(!AjxEnv.isIE&&this.ieAtomicLocationChange){
return
}
var e=this.getCurrentLocation();
if(e==this.currentLocation){
return
}
this.ieAtomicLocationChange=true;
if(AjxEnv.isIE&&this._getIFrameHash()!=e){
this.iframe.src=AjxHistoryMgr.BLANK_FILE+"?"+e
}else{
if(AjxEnv.isIE){
return
}}
this.currentLocation=e;
this.ieAtomicLocationChange=false;
this._evt.data=e;
this._eventMgr.notifyListeners(AjxEvent.HISTORY,this._evt)
};
AjxHistoryMgr.prototype._getIFrameHash=function(){
var e=document.getElementById(AjxHistoryMgr.IFRAME_ID);
var a=e.contentWindow.document;
var t=new String(a.location.search);
if(t.length==1&&t.charAt(0)=="?"){
t=""
}else{
if(t.length>=2&&t.charAt(0)=="?"){
t=t.substring(1)
}}
return t
};
AjxHistoryMgr.prototype._removeHash=function(e){
if(e==null||e==undefined){
return null
}else{
if(e==""){
return""
}else{
if(e.length==1&&e.charAt(0)=="#"){
return""
}else{
if(e.length>1&&e.charAt(0)=="#"){
return e.substring(1)
}else{
return e
}}}}};
AjxHistoryMgr.prototype.iframeLoaded=function(e){
if(this.ignoreLocationChange){
this.ignoreLocationChange=false;
return
}
var t=new String(e.search);
if(t.length==1&&t.charAt(0)=="?"){
t=""
}else{
if(t.length>=2&&t.charAt(0)=="?"){
t=t.substring(1)
}}
window.location.hash=t;
this._evt.data=t;
this._eventMgr.notifyListeners(AjxEvent.HISTORY,this._evt)
}
}
if(AjxPackage.define("ajax.xml.AjxSerializer")){
AjxSerializer=function(){
if(arguments.length==0){
return
}};
AjxSerializer.prototype.serialize=function(e){
throw"NOT IMPLEMENTED"
};
AjxJsonSerializer=function(e){
AjxSerializer.call(this,null);
this._minimize=Boolean(e)
};
AjxJsonSerializer.prototype=new AjxSerializer;
AjxJsonSerializer.prototype.constructor=AjxJsonSerializer;
AjxJsonSerializer.E_ATTRS="_attrs";
AjxJsonSerializer.A_CONTENT="_content";
AjxJsonSerializer.A_NAMESPACE="_jsns";
AjxJsonSerializer.prototype.serialize=function(r){
var t={};
var f=0;
var d=null;
for(var o=r.firstChild;
o;
o=o.nextSibling){
var u=o.nodeType;
if(u==1){
var e=o.nodeName;
if(!t[e]){
t[e]=[];
f++
}
t[e].push(o);
continue
}
if(u==3||u==4){
if(!d){
d=[]
}
d.push(o.nodeValue);
continue
}}
var g={};
var s=0;
if(r.attributes){
for(var l=0;
l<r.attributes.length;
l++){
var c=r.attributes[l];
var e=c.nodeName;
var p=this.quote(c.nodeValue);
if(t[e]){
g[e]=p;
s++
}else{
t[e]=p;
f++
}}}
d=d&&d.join("");
if(d&&d.match(/^\s*$/)){
d=null
}
if(d){
d=this.quote(d);
if(s==0&&f==0){
return d
}}
if(d==null&&f==0&&s==0){
return"{}"
}
var m=["{"];
if(d){
m.push(this.quote(AjxJsonSerializer.A_CONTENT),":",d);
if(s>0||f>0){
m.push(",")
}}
if(s>0){
m.push(this.quote(AjxJsonSerializer.E_ATTRS),": { ");
var l=0;
for(var e in g){
if(l>0){
m.push(",")
}
m.push(this.quote(e),":",g[e]);
l++
}
m.push("}");
if(f>0){
m.push(", ")
}}
var h=0;
for(var e in t){
if(h>0){
m.push(",")
}
var n=t[e];
if(typeof n=="string"){
m.push(this.quote(e),":",n);
h++;
continue
}
m.push(this.quote(e),":");
if(!this._minimize||n.length>1){
m.push("[")
}
for(var l=0;
l<n.length;
l++){
if(l>0){
m.push(",")
}
m.push(this.serialize(n[l]))
}
if(!this._minimize||n.length>1){
m.push("]")
}
h++
}
m.push("}");
return m.join("")
};
AjxJsonSerializer.prototype.quote=function(e){
return['"',this.escape(e),'"'].join("")
};
AjxJsonSerializer.prototype.escape=function(e){
return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n")
}
}
if(AjxPackage.define("ajax.debug.AjxDebug")){
AjxDebug=function(e){
if(arguments.length==0){
e={}
}else{
if(typeof arguments[0]=="number"){
e={
level:arguments[0],name:arguments[1],showTime:arguments[2]}
}}
this._showTime=e.showTime;
this._target=e.target||AjxDebug.TGT_WINDOW;
this._showTiming=false;
this._startTimePt=this._lastTimePt=0;
this._dbgWindowInited=false;
this._msgQueue=[];
this._isPrevWinOpen=false;
this.setDebugLevel(e.level)
};
AjxDebug.NONE=0;
AjxDebug.DBG1=1;
AjxDebug.DBG2=2;
AjxDebug.DBG3=3;
AjxDebug.TGT_WINDOW="window";
AjxDebug.TGT_CONSOLE="console";
AjxDebug.BUFFER={};
AjxDebug.BUFFER_MAX={};
AjxDebug.DEFAULT_TYPE="debug";
AjxDebug.RPC="rpc";
AjxDebug.NOTIFY="notify";
AjxDebug.EXCEPTION="exception";
AjxDebug.CALENDAR="calendar";
AjxDebug.REPLY="reply";
AjxDebug.SCROLL="scroll";
AjxDebug.BAD_JSON="bad_json";
AjxDebug.PREFS="prefs";
AjxDebug.PROGRESS="progress";
AjxDebug.REMINDER="reminder";
AjxDebug.TAG_ICON="tagIcon";
AjxDebug.DATA_URI="dataUri";
AjxDebug.MSG_DISPLAY="msgDisplay";
AjxDebug.BUFFER_MAX[AjxDebug.DEFAULT_TYPE]=0;
AjxDebug.BUFFER_MAX[AjxDebug.RPC]=200;
AjxDebug.BUFFER_MAX[AjxDebug.NOTIFY]=400;
AjxDebug.BUFFER_MAX[AjxDebug.EXCEPTION]=100;
AjxDebug.BUFFER_MAX[AjxDebug.CALENDAR]=400;
AjxDebug.BUFFER_MAX[AjxDebug.REPLY]=400;
AjxDebug.BUFFER_MAX[AjxDebug.SCROLL]=100;
AjxDebug.BUFFER_MAX[AjxDebug.BAD_JSON]=200;
AjxDebug.BUFFER_MAX[AjxDebug.PREFS]=200;
AjxDebug.BUFFER_MAX[AjxDebug.REMINDER]=200;
AjxDebug.BUFFER_MAX[AjxDebug.TAG_ICON]=200;
AjxDebug.BUFFER_MAX[AjxDebug.PROGRESS]=200;
AjxDebug.BUFFER_MAX[AjxDebug.DATA_URI]=200;
AjxDebug.BUFFER_MAX[AjxDebug.MSG_DISPLAY]=200;
AjxDebug.MAX_OUT=25000;
AjxDebug._CONTENT_FRAME_ID="AjxDebug_CF";
AjxDebug._LINK_FRAME_ID="AjxDebug_LF";
AjxDebug._BOTTOM_FRAME_ID="AjxDebug_BFI";
AjxDebug._BOTTOM_FRAME_NAME="AjxDebug_BFN";
AjxDebug.prototype.toString=function(){
return"AjxDebug"
};
AjxDebug.prototype.setTitle=function(e){
if(this._document&&!AjxEnv.isIE){
this._document.title=e
}};
AjxDebug.prototype.setDebugLevel=function(e){
this._level=parseInt(e)||e;
this._enable(this._level!=AjxDebug.NONE)
};
AjxDebug.prototype.getDebugLevel=function(){
return this._level
};
AjxDebug.prototype.println=function(s,n,o){
if(!this._isWriteable()){
return
}
try{
var e=this._handleArgs(arguments);
if(!e){
return
}
n=e.args.join("");
var a=(this._target!=AjxDebug.TGT_CONSOLE)?"<br>":"";
this._add({
msg:this._timestamp()+n+a,linkName:e.linkName,level:s}
)
}
catch(t){}};
AjxDebug.prototype.isDisabled=function(){
return !this._enabled
};
AjxDebug.prototype.dumpObj=function(n,a,t,o){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
a=e.args[0];
if(!a){
return
}
t=e.args[1];
this._add({
obj:a,linkName:e.linkName,showFuncs:t,level:n}
)
};
AjxDebug.prototype.printRaw=function(o,a,t){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
this._add({
obj:e.args[0],isRaw:true,linkName:e.linkName,level:o}
)
};
AjxDebug.prototype.printXML=function(o,a,t){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
a=e.args[0];
if(!a){
return
}
if(a.length>AjxDebug.MAX_OUT){
this.printRaw(a);
return
}
this._add({
obj:a,isXml:true,linkName:e.linkName,level:o}
)
};
AjxDebug.prototype.display=function(o,a,t){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
a=e.args[0];
a=a.replace(/\r?\n/g,"[crlf]");
a=a.replace(/ /g,"[space]");
a=a.replace(/\t/g,"[tab]");
this.printRaw(o,a,t)
};
AjxDebug.prototype.showTiming=function(t,n){
this._showTiming=t;
if(t){
this._enable(true)
}
var a=t?"on":"off";
var o="Turning timing info "+a;
if(n){
o=o+": "+n
}
var e=new DebugMessage({
msg:o}
);
this._addMessage(e);
this._startTimePt=this._lastTimePt=new Date().getTime()
};
AjxDebug.prototype.timePt=function(h,a){
if(!this._showTiming||!this._isWriteable()){
return
}
if(a){
this._startTimePt=this._lastTimePt=new Date().getTime()
}
var n=new Date().getTime();
var e=n-this._startTimePt;
var t=n-this._lastTimePt;
this._lastTimePt=n;
var o=a?"<br/>":"";
h=h?" "+h:"";
var r=[o,"[",e," / ",t,"]",h].join("");
var s="<div>"+r+"</div>";
this._addMessage(new DebugMessage({
msg:s}
));
return t
};
AjxDebug.prototype.getContentFrame=function(){
if(this._contentFrame){
return this._contentFrame
}
if(this._debugWindow&&this._debugWindow.document){
return this._debugWindow.document.getElementById(AjxDebug._CONTENT_FRAME_ID)
}
return null
};
AjxDebug.prototype.getLinkFrame=function(e){
if(this._linkFrame){
return this._linkFrame
}
if(this._debugWindow&&this._debugWindow.document){
return this._debugWindow.document.getElementById(AjxDebug._LINK_FRAME_ID)
}
if(!e){
this._openDebugWindow();
return this.getLinkFrame(true)
}
return null
};
AjxDebug.prototype._enable=function(e){
this._enabled=e;
if(this._target==AjxDebug.TGT_WINDOW){
if(e){
if(!this._dbgName){
this._dbgName="AjxDebugWin_"+location.hostname.replace(/\./g,"_")
}
if(this._debugWindow==null||this._debugWindow.closed){
this._openDebugWindow()
}}else{
if(this._debugWindow){
this._debugWindow.close();
this._debugWindow=null
}}}};
AjxDebug.prototype._isWriteable=function(){
if(this.isDisabled()){
return false
}
if(this._target==AjxDebug.TGT_WINDOW){
return(!this._isPaused&&this._debugWindow&&!this._debugWindow.closed)
}
return true
};
AjxDebug.prototype._getHtmlForObject=function(n,s){
s=s||{};
var a=[];
var t=0;
if(n===undefined){
a[t++]="<span>Undefined</span>"
}else{
if(n===null){
a[t++]="<span>NULL</span>"
}else{
if(AjxUtil.isBoolean(n)){
a[t++]="<span>"+n+"</span>"
}else{
if(AjxUtil.isNumber(n)){
a[t++]="<span>"+n+"</span>"
}else{
if(s.isRaw){
a[t++]=this._timestamp();
a[t++]="<textarea rows='25' style='width:100%' readonly='true'>";
a[t++]=n;
a[t++]="</textarea><p></p>"
}else{
if(s.isXml){
var e=new AjxDebugXmlDocument;
var o=e.create();
if(o&&("loadXML" in o)){
o.loadXML(n);
a[t++]="<div style='border-width:2px; border-style:inset; width:100%; height:300px; overflow:auto'>";
a[t++]=this._createXmlTree(o,0,{
authToken:true}
);
a[t++]="</div>"
}else{
a[t++]="<span>Unable to create XmlDocument to show XML</span>"
}}else{
a[t++]="<div style='border-width:2px; border-style:inset; width:100%; height:300px; overflow:auto'><pre>";
a[t++]=this._dump(n,true,s.showFuncs,{
ZmAppCtxt:true,authToken:true}
);
a[t++]="</div></pre>"
}}}}}}
return a.join("")
};
AjxDebug.prototype._dump=function(o,a,e,t){
return AjxStringUtil.prettyPrint(o,a,e,t)
};
AjxDebug.prototype._handleArgs=function(n){
if(this._level==AjxDebug.NONE||this._showTiming||n.length==0){
return
}
var e=new Array(n.length);
for(var a=0;
a<n.length;
a++){
e[a]=n[a]
}
var l={
args:null,linkName:null};
var r=e.length;
if(e.length>1){
var h=e[e.length-1];
if(h&&h.indexOf&&(h.indexOf("DebugWarn")!=-1||((h.indexOf(" ")==-1)&&(/Request|Response$/.test(h))))){
l.linkName=h;
e.pop()
}}
var s=null;
var t=e[0];
var o=(typeof t=="number"||((r>1)&&t.length<=8&&/^[a-z0-9]+$/.test(t)));
if(o){
s=t;
e.shift()
}
if(s&&(AjxDebug.BUFFER_MAX[s]==null)){
if(typeof this._level=="number"){
if(typeof s!="number"||(s>this._level)){
return
}}else{
if(s!=this._level){
return
}}}
l.args=e;
return l
};
AjxDebug.prototype._openDebugWindow=function(o){
var t=AjxEnv.isIE?"_blank":this._dbgName;
this._debugWindow=window.open("",t,"width=600,height=400,resizable=yes,scrollbars=yes");
if(this._debugWindow==null){
this._enabled=false;
return
}
this._enabled=true;
this._isPrevWinOpen=this._debugWindow.debug;
this._debugWindow.debug=true;
try{
this._document=this._debugWindow.document;
this.setTitle("Debug");
if(!this._isPrevWinOpen){
this._document.write("<html>","<head>","<script>","function blank() {return [","'<html><head><style type=\"text/css\">',","'P, TD, DIV, SPAN, SELECT, INPUT, TEXTAREA, BUTTON {',","'font-family: Tahoma, Arial, Helvetica, sans-serif;',","'font-size:11px;}',","'.Content {display:block;margin:0.25em 0em;}',","'.Link {cursor: pointer;color:blue;text-decoration:underline;white-space:nowrap;width:100%;}',","'.DebugWarn {color:red;font-weight:bold;}',","'.Run {color:black; background-color:red;width:100%;font-size:18px;font-weight:bold;}',","'.RunLink {display:block;color:black;background-color:red;font-weight:bold;white-space:nowrap;width:100%;}',","'</style></head><body></body></html>'].join(\"\");}","<\/script>","</head>","<frameset cols='125, *'>","<frameset rows='*,40'>","<frame name='",AjxDebug._LINK_FRAME_ID,"' id='",AjxDebug._LINK_FRAME_ID,"' src='javascript:parent.parent.blank();'>","<frame name='",AjxDebug._BOTTOM_FRAME_NAME,"' id='",AjxDebug._BOTTOM_FRAME_ID,"' src='javascript:parent.parent.blank();' scrolling=no frameborder=0>","</frameset>","<frame name='",AjxDebug._CONTENT_FRAME_ID,"' id='",AjxDebug._CONTENT_FRAME_ID,"' src='javascript:parent.blank();'>","</frameset>","</html>");
this._document.close();
var e=new AjxTimedAction(this,AjxDebug.prototype._finishInitWindow);
AjxTimedAction.scheduleAction(e,2500)
}else{
this._finishInitWindow();
this._contentFrame=this._document.getElementById(AjxDebug._CONTENT_FRAME_ID);
this._linkFrame=this._document.getElementById(AjxDebug._LINK_FRAME_ID);
this._createLinkNContent("RunLink","NEW RUN","Run","NEW RUN");
this._attachHandlers();
this._dbgWindowInited=true;
this._showMessages()
}}
catch(a){
if(this._debugWindow){
this._debugWindow.close()
}
this._openDebugWindow(true)
}};
AjxDebug.prototype._finishInitWindow=function(){
try{
this._contentFrame=this._debugWindow.document.getElementById(AjxDebug._CONTENT_FRAME_ID);
this._linkFrame=this._debugWindow.document.getElementById(AjxDebug._LINK_FRAME_ID);
var n=this._debugWindow.document.getElementById(AjxDebug._BOTTOM_FRAME_ID);
var o=n.contentWindow.document;
var a=[];
var t=0;
a[t++]="<table><tr><td><button id='";
a[t++]=AjxDebug._BOTTOM_FRAME_ID;
a[t++]="_clear'>Clear</button></td><td><button id='";
a[t++]=AjxDebug._BOTTOM_FRAME_ID;
a[t++]="_pause'>Pause</button></td></tr></table>";
o.body.innerHTML=a.join("")
}
catch(e){}
if(o){
this._clearBtn=o.getElementById(AjxDebug._BOTTOM_FRAME_ID+"_clear");
this._pauseBtn=o.getElementById(AjxDebug._BOTTOM_FRAME_ID+"_pause")
}
this._attachHandlers();
this._dbgWindowInited=true;
this._showMessages()
};
AjxDebug.prototype._attachHandlers=function(){
var e=AjxCallback.simpleClosure(this._unloadHandler,this);
if(AjxEnv.isIE){
this._unloadHandler=e;
this._debugWindow.attachEvent("onunload",e)
}else{
this._debugWindow.onunload=e
}
if(this._clearBtn){
this._clearBtn.onclick=AjxCallback.simpleClosure(this._clear,this)
}
if(this._pauseBtn){
this._pauseBtn.onclick=AjxCallback.simpleClosure(this._pause,this)
}};
AjxDebug.prototype._scrollToBottom=function(){
var t=this.getContentFrame();
var e=t?t.contentWindow.document.body:null;
var o=this.getLinkFrame();
var a=o?o.contentWindow.document.body:null;
if(e&&a){
e.scrollTop=e.scrollHeight;
a.scrollTop=a.scrollHeight
}};
AjxDebug.prototype._timestamp=function(){
return this._showTime?this._getTimeStamp()+": ":""
};
AjxDebug.prototype.setShowTimestamps=function(e){
this._showTime=e
};
AjxDebug.prototype._createXmlTree=function(o,a,e){
if(o==null){
return""
}
var h="";
var r;
switch(o.nodeType){
case 1:h+="<div style='color: blue; padding-left: 16px;'>&lt;<span style='color: DarkRed;'>"+o.nodeName+"</span>";
if(e&&e[o.nodeName]){
return h+"/&gt;</div>"
}
var l=o.attributes;
r=l.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlAttribute(l[n])
}
if(!o.hasChildNodes()){
return h+"/&gt;</div>"
}
h+="&gt;<br />";
var s=o.childNodes;
r=s.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlTree(s[n],a+3,e)
}
h+="&lt;/<span style='color: DarkRed;'>"+o.nodeName+"</span>&gt;</div>";
break;
case 9:var s=o.childNodes;
r=s.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlTree(s[n],a,e)
}
break;
case 3:if(!/^\s*$/.test(o.nodeValue)){
var t=o.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");
h+="<span style='color: WindowText; padding-left: 16px;'>"+t+"</span><br />"
}
break;
case 7:h+="&lt;?"+o.nodeName;
var l=o.attributes;
r=l.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlAttribute(l[n])
}
h+="?&gt;<br />";
break;
case 4:h="<div style=''>&lt;![CDATA[<span style='color: WindowText; font-family: \"Courier New\"; white-space: pre; display: block; border-left: 1px solid Gray; padding-left: 16px;'>"+o.nodeValue+"</span>]]></div>";
break;
case 8:h="<div style='color: blue; padding-left: 16px;'>&lt;!--<span style='white-space: pre; font-family: \"Courier New\"; color: Gray; display: block;'>"+o.nodeValue+"</span>--></div>";
break;
case 10:h="<div style='color: blue; padding-left: 16px'>&lt;!DOCTYPE "+o.name;
if(o.publicId){
h+=' PUBLIC "'+o.publicId+'"';
if(o.systemId){
h+=' "'+o.systemId+'"'
}}else{
if(o.systemId){
h+=' SYSTEM "'+o.systemId+'"'
}}
h+="&gt;</div>";
break;
default:this._inspect(o)
}
return h
};
AjxDebug.prototype._createXmlAttribute=function(e){
return[" <span style='color: red'>",e.nodeName,"</span><span style='color: blue'>=\"",e.nodeValue,'"</span>'].join("")
};
AjxDebug.prototype._inspect=function(t){
var a="";
for(var e in t){
a+="obj."+e+" = "+t[e]+"\n"
}
window.alert(a)
};
AjxDebug.prototype._add=function(e){
e.extraHtml=e.obj&&this._getHtmlForObject(e.obj,e);
this._addMessage(new DebugMessage(e))
};
AjxDebug.prototype._addMessage=function(e){
this._msgQueue.push(e);
this._showMessages()
};
AjxDebug.prototype._showMessages=function(){
switch(this._target){
case AjxDebug.TGT_WINDOW:this._showMessagesInWindow();
break;
case AjxDebug.TGT_CONSOLE:this._showMessagesInConsole()
}
this._addMessagesToBuffer();
this._msgQueue=[]
};
AjxDebug.prototype._showMessagesInWindow=function(){
if(!this._dbgWindowInited){
return
}
try{
if(this._msgQueue.length>0){
var e=this.getContentFrame();
var o=this.getLinkFrame();
if(!e||!o){
return
}
var c=e.contentWindow.document;
var r=o.contentWindow.document;
var t=new Date();
for(var n=0,s=this._msgQueue.length;
n<s;
++n){
var a=this._msgQueue[n];
var d=a.linkName;
var l=[a.message,a.extraHtml].join("");
this._createLinkNContent("Link",d,"Content",l,t)
}}
this._scrollToBottom()
}
catch(h){}};
AjxDebug.prototype._addMessagesToBuffer=function(){
var a=(this._target==AjxDebug.TGT_CONSOLE)?"<br>":"";
for(var t=0,e=this._msgQueue.length;
t<e;
++t){
var o=this._msgQueue[t];
AjxDebug._addMessageToBuffer(o.type,o.message+o.extraHtml+a)
}};
AjxDebug._addMessageToBuffer=function(a,o){
a=a||AjxDebug.DEFAULT_TYPE;
var e=AjxDebug.BUFFER_MAX[a];
if(e>0){
var t=AjxDebug.BUFFER[a]=AjxDebug.BUFFER[a]||[];
while(t.length>=e){
t.shift()
}
t.push(o)
}};
AjxDebug.prototype._showMessagesInConsole=function(){
if(!window.console){
return
}
var t=new Date();
for(var a=0,e=this._msgQueue.length;
a<e;
++a){
var o=this._msgQueue[a];
if(window.console&&window.console.log){
window.console.log(AjxStringUtil.stripTags(o.message+o.extraHtml))
}}};
AjxDebug.prototype._getTimeStamp=function(e){
if(!AjxDebug._timestampFormatter){
AjxDebug._timestampFormatter=new AjxDateFormat("HH:mm:ss.SSS")
}
e=e||new Date();
return AjxStringUtil.htmlEncode(AjxDebug._timestampFormatter.format(e),true)
};
AjxDebug.prototype._createLinkNContent=function(r,m,o,l,a){
var n=this.getLinkFrame();
if(!n){
return
}
a=a||new Date();
var s=["[",this._getTimeStamp(a),"]"].join("");
var t="Lnk_"+a.getTime();
if(m){
var h=n.contentWindow.document;
var u=h.createElement("DIV");
u.className=r;
u.innerHTML=[m,s].join(" - ");
u._targetId=t;
u._dbg=this;
u.onclick=AjxDebug._linkClicked;
var d=h.body;
d.appendChild(u)
}
var c=this.getContentFrame().contentWindow.document;
var e=c.createElement("DIV");
e.className=o;
e.id=t;
e.innerHTML=l;
c.body.appendChild(e);
this._scrollToBottom()
};
AjxDebug._linkClicked=function(){
var t=this._dbg.getContentFrame();
var e=t.contentWindow.document.getElementById(this._targetId);
var a=0;
while(e){
a+=e.offsetTop;
e=e.offsetParent
}
t.contentWindow.scrollTo(0,a)
};
AjxDebug.prototype._clear=function(){
this.getContentFrame().contentWindow.document.body.innerHTML="";
this.getLinkFrame().contentWindow.document.body.innerHTML=""
};
AjxDebug.prototype._pause=function(){
this._isPaused=!this._isPaused;
this._pauseBtn.innerHTML=this._isPaused?"Resume":"Pause"
};
AjxDebug.prototype._unloadHandler=function(){
if(!this._debugWindow){
return
}
if(AjxEnv.isIE){
this._debugWindow.detachEvent("onunload",this._unloadHandler)
}else{
this._debugWindow.onunload=null
}};
AjxDebug.println=function(e,t){
AjxDebug._addMessageToBuffer(e,t+"<br>")
};
AjxDebug.dumpObj=function(e,t){
AjxDebug._addMessageToBuffer(e,"<pre>"+AjxStringUtil.prettyPrint(t,true)+"</pre>")
};
AjxDebug.logSoapMessage=function(n){
if(n.methodNameStr=="NoOpRequest"||n.methodNameStr=="NoOpResponse"){
return
}
var t=AjxDebug._getTimeStamp();
var o=["<b>",n.methodNameStr,n.asyncMode?"":" (SYNCHRONOUS)"," - ",t,"</b>"].join("");
for(var e in AjxDebug.BUFFER){
if(e==AjxDebug.DEFAULT_TYPE){
continue
}
AjxDebug.println(e,o)
}
if(window.DBG){
var a=n.methodNameStr;
if(!n.asyncMode){
a="<span class='DebugWarn'>SYNCHRONOUS </span>"+a
}
window.DBG.println(window.DBG._level,o,a)
}};
AjxDebug._getTimeStamp=function(e){
return AjxDebug.prototype._getTimeStamp.apply(null,arguments)
};
AjxDebug.getDebugLog=function(t){
t=t||AjxDebug.DEFAULT_TYPE;
var e=AjxDebug.BUFFER[t];
return e?e.join(""):""
};
DebugMessage=function(e){
e=e||{};
this.message=e.msg||"";
this.type=e.type||null;
this.category=e.category||"";
this.time=e.time||(new Date().getTime());
this.extraHtml=e.extraHtml||"";
this.linkName=e.linkName;
this.type=(e.level&&typeof(e.level)=="string")?e.level:AjxDebug.DEFAULT_TYPE
}
}
if(AjxPackage.define("ajax.debug.AjxDebugXmlDocument")){
AjxDebugXmlDocument=function(){};
getDomDocumentPrefix=function(){
if(getDomDocumentPrefix.prefix){
return getDomDocumentPrefix.prefix
}
var n=["MSXML2","Microsoft","MSXML","MSXML3"];
var s;
var e=n.length;
for(var a=0;
a<e;
a++){
try{
s=new ActiveXObject(n[a]+".DomDocument");
return getDomDocumentPrefix.prefix=n[a]
}
catch(t){}}
throw new Error("Could not find an installed XML parser")
};
AjxDebugXmlDocument.prototype.create=function(){
try{
if(document.implementation&&document.implementation.createDocument){
var t=document.implementation.createDocument("","",null);
if(t.readyState==null){
t.readyState=1;
t.addEventListener("load",function(){
t.readyState=4;
if(typeof t.onreadystatechange=="function"){
t.onreadystatechange()
}}
,false)
}
return t
}
if(window.ActiveXObject){
return new ActiveXObject(getDomDocumentPrefix()+".DomDocument")
}}
catch(e){}
throw new Error("Your browser does not support XmlDocument objects")
};
if(window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__){
if(AjxEnv.isSafari){
Document.prototype.loadXML=function(a){
var o=(new DOMParser()).parseFromString(a,"text/xml");
while(this.hasChildNodes()){
this.removeChild(this.lastChild)
}
var e=o.childNodes.length;
for(var t=0;
t<e;
t++){
this.appendChild(this.importNode(o.childNodes[t],true))
}};
Document.prototype.__defineGetter__("xml",function(){
return(new XMLSerializer()).serializeToString(this)
}
)
}else{
AjxDebugXmlDocument.prototype.loadXML=function(a){
var o=(new DOMParser()).parseFromString(a,"text/xml");
while(this.hasChildNodes()){
this.removeChild(this.lastChild)
}
var e=o.childNodes.length;
for(var t=0;
t<e;
t++){
this.appendChild(this.importNode(o.childNodes[t],true))
}};
AjxDebugXmlDocument.prototype.__defineGetter__("xml",function(){
return(new XMLSerializer()).serializeToString(this)
}
)
}}}
if(AjxPackage.define("ajax.dwt.core.DwtId")){
DwtId=function(){};
DwtId.SEP="__";
DwtId.WIDGET_LIST_VIEW="zl";
DwtId.WIDGET_HDR="zlh";
DwtId.WIDGET_HDR_TABLE="zlht";
DwtId.WIDGET_HDR_ICON="zlhi";
DwtId.WIDGET_HDR_LABEL="zlhl";
DwtId.WIDGET_HDR_ARROW="zlha";
DwtId.WIDGET_HDR_SASH="zlhs";
DwtId.WIDGET_ITEM="zli";
DwtId.WIDGET_ITEM_ROW="zlir";
DwtId.WIDGET_ITEM_CELL="zlic";
DwtId.WIDGET_ITEM_FIELD="zlif";
DwtId.LIST_VIEW_HEADERS="headers";
DwtId.LIST_VIEW_ROWS="rows";
DwtId.IFRAME="iframe";
DwtId.DND_PLUS_ID="z__roundPlus";
DwtId.makeId=function(){
var a=[];
for(var t=0;
t<arguments.length;
t++){
var e=arguments[t];
if(e!=null&&e!=""){
a.push(e)
}}
return a.join(DwtId.SEP)
};
DwtId._makeId=DwtId.makeId;
DwtId.getListViewId=function(t,e){
return DwtId.makeId(DwtId.WIDGET_LIST_VIEW,t,e)
};
DwtId.getListViewHdrId=function(t,e,a){
return DwtId.makeId(t,e,a)
};
DwtId.getListViewItemId=function(t,e,o,a){
return DwtId.makeId(t,e,o,a)
};
DwtId.getIframeId=function(e){
return DwtId.makeId(e,DwtId.IFRAME)
}
}
if(AjxPackage.define("ajax.dwt.core.Dwt")){
Dwt=function(){};
Dwt.STATIC_STYLE="static";
Dwt.ABSOLUTE_STYLE="absolute";
Dwt.RELATIVE_STYLE="relative";
Dwt.FIXED_STYLE="fixed";
Dwt.NO_REPEAT="no-repeat";
Dwt.REPEAT="repeat";
Dwt.REPEAT_X="repeat-x";
Dwt.REPEAT_Y="repeat-y";
Dwt.DISPLAY_INLINE="inline";
Dwt.DISPLAY_BLOCK="block";
Dwt.DISPLAY_NONE="none";
Dwt.DISPLAY_TABLE_ROW=AjxEnv.isIE?Dwt.DISPLAY_BLOCK:"table-row";
Dwt.DISPLAY_TABLE_CELL=AjxEnv.isIE?Dwt.DISPLAY_BLOCK:"table-cell";
Dwt.CLIP=1;
Dwt.VISIBLE=2;
Dwt.SCROLL=3;
Dwt.FIXED_SCROLL=4;
Dwt.SCROLL_Y=5;
Dwt.SCROLL_X=6;
Dwt.Z_HIDDEN=100;
Dwt.Z_CURTAIN=200;
Dwt.Z_VIEW=300;
Dwt.Z_MENU=500;
Dwt.Z_VEIL=600;
Dwt.Z_DIALOG=700;
Dwt.Z_DIALOG_MENU=750;
Dwt.Z_TOOLTIP=775;
Dwt.Z_DND=800;
Dwt.Z_BUSY=900;
Dwt.Z_TOAST=950;
Dwt.Z_SPLASH=1000;
Dwt.DEFAULT=-123456789;
Dwt.CLEAR=-20000;
Dwt.LOC_NOWHERE=-10000;
Dwt.DND_DROP_NONE=0;
Dwt.DND_DROP_COPY=1;
Dwt.DND_DROP_MOVE=2;
Dwt.SCROLLBAR_WIDTH=22;
Dwt.KEY_OBJECT="_object_";
Dwt.KEY_ID="_id_";
Dwt._Z_INC=1;
Dwt.__nextId={};
Dwt.getNextId=function(e){
e=e||"DWT";
if(!Dwt.__nextId[e]){
Dwt.__nextId[e]=1
}
return e+Dwt.__nextId[e]++
};
Dwt.associateElementWithObject=function(a,e,t){
a[t||"dwtObj"]=e.__internalId=AjxCore.assignId(e)
};
Dwt.disassociateElementFromObject=function(a,e,t){
if(a){
a.removeAttribute(t||"dwtObj")
}
if(e.__internalId){
AjxCore.unassignId(e.__internalId)
}};
Dwt.getObjectFromElement=function(t,e){
return AjxCore.objectWithId(t[e||"dwtObj"])
};
Dwt.getElement=function(e){
return(typeof(e)=="string")?document.getElementById(e):e
};
Dwt.findAncestor=function(a,t){
var e=Dwt.getAttr(a,t);
while(a&&(e==null||e=="")){
a=a.parentNode;
e=Dwt.getAttr(a,t)
}
return a
};
Dwt.isAncestor=function(t,e){
if(t==e){
return true
}
var a=e;
while(a){
a=a.parentNode;
if(a==t){
return true
}}
return false
};
Dwt.setHandler=function(a,t,e){
if(!(a=Dwt.getElement(a))){
return
}
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
Dwt.clearHandler(a,t)
}
a[t]=e;
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
a.addEventListener("DOMMouseScroll",e,true)
}};
Dwt.clearHandler=function(a,t){
if(!(a=Dwt.getElement(a))){
return
}
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
if(a[t]){
var e=a[t];
a.removeEventListener("DOMMouseScroll",e,true)
}}
a[t]=null
};
Dwt.getBackgroundRepeat=function(e){
if(!(e=Dwt.getElement(e))){
return
}
return DwtCssStyle.getProperty(e,"background-repeat")
};
Dwt.setBackgroundRepeat=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.backgroundRepeat=e
};
Dwt.getBounds=function(n,a){
if(!(n=Dwt.getElement(n))){
return null
}
var o=DwtPoint.tmp;
Dwt.getLocation(n,o);
var t=o.x;
var e=o.y;
Dwt.getSize(n,o);
if(!a){
return new DwtRectangle(t,e,o.x,o.y)
}else{
a.set(t,e,o.x,o.y);
return a
}};
Dwt.setBounds=function(o,t,n,a,e){
if(!(o=Dwt.getElement(o))){
return
}
Dwt.setLocation(o,t,n);
Dwt.setSize(o,a,e)
};
Dwt.getCursor=function(e){
if(!(e=Dwt.getElement(e))){
return""
}
return DwtCssStyle.getProperty(e,"cursor")
};
Dwt.setCursor=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.cursor=e
};
Dwt.getLocation=function(t,e){
if(!(t=Dwt.getElement(t))){
return null
}
e=e||new DwtPoint(0,0);
if(t.style.position==Dwt.ABSOLUTE_STYLE){
e.set(parseInt(DwtCssStyle.getProperty(t,"left")),parseInt(DwtCssStyle.getProperty(t,"top")));
return e
}
return Dwt.toWindow(t,0,0,null,null,e)
};
Dwt.setLocation=function(a,t,o){
if(!(a=Dwt.getElement(a))){
return
}
var e=a.style.position;
if(e!=Dwt.ABSOLUTE_STYLE&&e!=Dwt.RELATIVE_STYLE&&e!=Dwt.FIXED_STYLE){
throw new DwtException("Static widgets may not be positioned",DwtException.INVALID_OP,"Dwt.setLocation")
}
if(t=Dwt.__checkPxVal(t)){
a.style.left=t
}
if(o=Dwt.__checkPxVal(o)){
a.style.top=o
}};
Dwt.getPosition=function(e){
if(!(e=Dwt.getElement(e))){
return
}
return e.style.position
};
Dwt.setPosition=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.position=e
};
Dwt.getScrollStyle=function(a){
if(!(a=Dwt.getElement(a))){
return""
}
var o=DwtCssStyle.getProperty(a,"overflow");
if(o=="hidden"){
return Dwt.CLIP
}
if(o=="auto"){
return Dwt.SCROLL
}
if(o=="scroll"){
return Dwt.FIXED_SCROLL
}
if(o==""){
var t=DwtCssStyle.getProperty(a,"overflowX");
var e=DwtCssStyle.getProperty(a,"overflowY");
if(t=="scroll"){
return Dwt.SCROLL_X
}
if(e=="scroll"){
return Dwt.SCROLL_Y
}}
return Dwt.VISIBLE
};
Dwt.setScrollStyle=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
if(e==Dwt.CLIP){
t.style.overflow="hidden"
}else{
if(e==Dwt.SCROLL){
t.style.overflow="auto"
}else{
if(e==Dwt.FIXED_SCROLL){
t.style.overflow="scroll"
}else{
if(e==Dwt.SCROLL_Y){
t.style.overflowX="hidden";
t.style.overflowY="auto"
}else{
if(e==Dwt.SCROLL_X){
t.style.overflowY="hidden";
t.style.overflowX="auto"
}else{
t.style.overflow="visible"
}}}}}};
Dwt.getSize=function(o,e,t){
if(!(o=Dwt.getElement(o))){
return
}
var a;
if(!e){
a=new DwtPoint(0,0)
}else{
a=e;
a.set(0,0)
}
if(!o){
return a
}
if(t){
if(o.style.width){
a.x=parseInt(o.style.width)
}
if(o.style.height){
a.y=parseInt(o.style.height)
}
return a
}
a.x=o.offsetWidth;
if(a.x!=null){
a.y=o.offsetHeight
}else{
if(o.clip&&o.clip.width!=null){
a.x=parseInt(o.clip.width);
a.y=parseInt(o.clip.height)
}else{
if(o.style&&o.style.pixelWidth!=null){
a.x=parseInt(o.style.pixelWidth);
a.y=parseInt(o.style.pixelHeight)
}}}
return a
};
Dwt.setSize=function(a,t,e){
if(!(a=Dwt.getElement(a))){
return
}
if(!a.style){
return
}
if(t==Dwt.CLEAR){
a.style.width=null
}else{
if(t=Dwt.__checkPxVal(t,true)){
a.style.width=t
}}
if(e==Dwt.CLEAR){
a.style.height=null
}else{
if(e=Dwt.__checkPxVal(e,true)){
a.style.height=e
}}};
Dwt.getHtmlExtent=function(e){
var t=AjxStringUtil.calcDIV();
t.innerHTML=e;
return Dwt.getSize(t)
};
Dwt.toDocumentFragment=function(a,s){
var n=AjxStringUtil.calcDIV();
n.innerHTML=a;
var t=document.createDocumentFragment();
var e=s&&document.getElementById(s);
if(e){
t.appendChild(e)
}else{
for(var o=n.firstChild;
o;
o=n.firstChild){
t.appendChild(o)
}}
return t
};
Dwt.getAttr=function(a,e,t){
if(!t){
return a&&a.tagName?(a.getAttribute(e)||a[e]):null
}else{
while(a){
if(Dwt.getAttr(a,e)!=null){
return a
}
a=a.parentNode
}
return null
}};
Dwt.getVisible=function(t){
if(!(t=Dwt.getElement(t))){
return
}
var e=DwtCssStyle.getProperty(t,"display");
return(e!=Dwt.DISPLAY_NONE)
};
Dwt.setVisible=function(t,a){
if(!(t=Dwt.getElement(t))){
return
}
if(a){
if(t.nodeName.match(/tr/i)){
t.style.display=Dwt.DISPLAY_TABLE_ROW
}else{
if(t.nodeName.match(/td|th/i)){
t.style.display=Dwt.DISPLAY_TABLE_CELL
}else{
t.style.display=t.getAttribute("x-display")||Dwt.DISPLAY_BLOCK
}}}else{
var e=DwtCssStyle.getComputedStyleObject(t).display;
if(e!="none"){
t.setAttribute("x-display",e)
}
t.style.display=Dwt.DISPLAY_NONE
}};
Dwt.getVisibility=function(t){
if(!(t=Dwt.getElement(t))){
return
}
var e=DwtCssStyle.getProperty(t,"visibility");
return(e=="visible")
};
Dwt.setVisibility=function(e,t){
if(!(e=Dwt.getElement(e))){
return
}
e.style.visibility=t?"visible":"hidden"
};
Dwt.__MSIE_OPACITY_RE=/alpha\(opacity=(\d+)\)/;
Dwt.getOpacity=function(a){
if(!(a=Dwt.getElement(a))){
return
}
if(AjxEnv.isIE){
var t=Dwt.getIEFilter(a,"alpha");
var e=Dwt.__MSIE_OPACITY_RE.exec(t)||[t,"100"];
return Number(e[1])
}
return Number(a.style.opacity||1)*100
};
Dwt.setOpacity=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
if(AjxEnv.isIE){
Dwt.alterIEFilter(t,"alpha","alpha(opacity="+e+")")
}else{
t.style.opacity=e/100
}};
Dwt.getZIndex=function(e){
if(!(e=Dwt.getElement(e))){
return
}
return DwtCssStyle.getProperty(e,"z-index")
};
Dwt.setZIndex=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.zIndex=e
};
Dwt.getDisplay=function(e){
DwtCssStyle.getProperty(e,"display")
};
Dwt.setDisplay=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.display=e
};
Dwt.getWindowSize=function(e){
var t=(!e)?new DwtPoint(0,0):e;
if(window.innerWidth){
t.x=window.innerWidth;
t.y=window.innerHeight
}else{
if(AjxEnv.isIE6CSS){
t.x=document.body.parentElement.clientWidth;
t.y=document.body.parentElement.clientHeight
}else{
if(document.body&&document.body.clientWidth){
t.x=document.body.clientWidth;
t.y=document.body.clientHeight
}}}
return t
};
Dwt.toWindow=function(o,r,s,c,h,l){
var t;
if(!l){
t=new DwtPoint(r,s)
}else{
t=l;
t.set(r,s)
}
o=Dwt.getElement(o);
var e=o;
while(e&&e!=c){
t.x+=e.offsetLeft-e.scrollLeft;
t.y+=e.offsetTop;
if(!h){
var a=AjxEnv.isOpera?e.pageYOffset:e.scrollTop;
if(a){
t.y-=a
}
var n=e.parentNode;
while(n!=e.offsetParent&&n!=c){
a=AjxEnv.isOpera?n.pageYOffset:n.scrollTop;
if(a){
t.y-=a
}
n=n.parentNode
}}
e=e.offsetParent
}
return t
};
Dwt.getInsets=function(o){
if(!(o=Dwt.getElement(o))){
return
}
var t=DwtCssStyle.getComputedStyleObject(o);
var a=parseInt(t.borderLeftWidth)||0;
var h=parseInt(t.borderTopWidth)||0;
var l=parseInt(t.borderRightWidth)||0;
var s=parseInt(t.borderBottomWidth)||0;
var n=parseInt(t.paddingLeft)||0;
var c=parseInt(t.paddingTop)||0;
var e=parseInt(t.paddingRight)||0;
var r=parseInt(t.paddingBottom)||0;
return{
left:a+n,top:h+c,right:l+e,bottom:s+r}
};
Dwt.insetBounds=function(t,e){
if(isNaN(t.x)||isNaN(e.left)){
return t
}
t.x+=e.left;
t.y+=e.top;
t.width-=e.left+e.right;
t.height-=e.top+e.bottom;
return t
};
Dwt.setStatus=function(e){
window.status=e
};
Dwt.getTitle=function(){
return window.document.title
};
Dwt.setTitle=function(e){
window.document.title=e
};
Dwt.getIframeDoc=function(e){
if(e){
return AjxEnv.isIE?e.contentWindow.document:e.contentDocument
}
return null
};
Dwt.getIframeWindow=function(e){
return e.contentWindow
};
Dwt.parseHtmlFragment=function(o,a){
if(!Dwt._div){
Dwt._div=document.createElement("div")
}
if(a){
o="<table style='table-layout:fixed'>"+o+"</table>"
}
Dwt._div.innerHTML=o;
if(a){
var e=document.createDocumentFragment();
var n=Dwt._div.firstChild.rows;
for(var t=n.length-1;
t>=0;
t--){
e.appendChild(n[0])
}
return e.childNodes.length>1?e:e.firstChild
}
return Dwt._div.firstChild
};
Dwt.contains=function(a,t){
var o=false;
if(a.compareDocumentPosition){
var e=a.compareDocumentPosition(t);
if((e==(document.DOCUMENT_POSITION_CONTAINED_BY|document.DOCUMENT_POSITION_FOLLOWING))){
o=true
}}else{
if(a.contains){
o=a.contains(t)
}}
return o
};
Dwt.removeChildren=function(e){
while(e.hasChildNodes()){
e.removeChild(e.firstChild)
}};
Dwt.getCellIndex=function(t){
if(AjxEnv.isOpera){
if(t.tagName&&t.tagName.toLowerCase()=="td"){
var a=t.parentNode.cells;
var e=a.length;
for(var o=0;
o<e;
o++){
if(a[o]==t){
return o
}}}}else{
return t.cellIndex
}
return -1
};
Dwt.delClass=function(a,e,o){
if(a==null){
return
}
if(!e&&!o){
return
}
if(typeof e=="string"&&e.length){
e=Dwt._DELCLASS_CACHE[e]||(Dwt._DELCLASS_CACHE[e]=new RegExp("\\b"+e+"\\b","ig"))
}
var t=a.className||"";
t=t.replace(e," ");
a.className=o?t+" "+o:t
};
Dwt._DELCLASS_CACHE={};
Dwt.addClass=function(e,t){
Dwt.delClass(e,t,t)
};
Dwt.condClass=function(o,n,t,e){
if(!!n){
if(e){
Dwt.delClass(o,e)
}
Dwt.addClass(o,t)
}else{
Dwt.delClass(o,t);
if(e){
Dwt.addClass(o,e)
}}};
Dwt.hasClass=function(t,e){
if(!t||!e){
return false
}
return t.className.match(new RegExp("\\b"+e+"\\b"))
};
Dwt.setSelectionRange=function(a,o,e){
if(AjxEnv.isGeckoBased||AjxEnv.isSafari){
a.focus();
a.setSelectionRange(o,e)
}else{
if(AjxEnv.isIE){
var t=a.createTextRange();
t.collapse(true);
t.moveStart("character",o);
t.moveEnd("character",e-o);
t.select()
}else{
a.select()
}}};
Dwt.getSelectionStart=function(o){
if(AjxEnv.isGeckoBased){
return o.selectionStart
}
if(AjxEnv.isIE){
var a=document.selection.createRange();
var t=a.compareEndPoints("StartToEnd",a)==0;
if(!t){
a.collapse(true)
}
var e=a.getBookmark();
return e.charCodeAt(2)-2
}
return o.value.length
};
Dwt.getSelectionEnd=function(o){
if(AjxEnv.isGeckoBased){
return o.selectionEnd
}
if(AjxEnv.isIE){
var a=document.selection.createRange();
var t=a.compareEndPoints("StartToEnd",a)==0;
if(!t){
a.collapse(false)
}
var e=a.getBookmark();
return e.charCodeAt(2)-2
}
return o.value.length
};
Dwt.setSelectionText=function(t,n){
var s=Dwt.getSelectionStart(t);
var e=Dwt.getSelectionEnd(t);
var o=t.value;
var a=[o.substr(0,s),n,o.substr(e)].join("");
if(typeof t.setValue=="function"){
t.setValue(a)
}else{
t.value=a
}
Dwt.setSelectionRange(t,s,s+n.length)
};
Dwt.instanceOf=function(t,e){
if(typeof t=="string"){
return window[t]&&(t==e||window[t].prototype instanceof window[e])
}
return(window[e]&&t instanceof window[e])
};
Dwt.getParams=function(e,n,a){
if(!(e&&e.length)){
return{}
}
if(e.length>1||e[0]._eventMgr||a){
var o={};
for(var t=0;
t<e.length;
t++){
o[n[t]]=e[t]
}
return o
}
if(e.length==1){
return e[0]
}
return{}
};
Dwt.__checkPxVal=function(t,e){
if(t==Dwt.DEFAULT){
return false
}
if(isNaN(parseInt(t))){
return false
}
if(e&&t<0&&t!=Dwt.LOC_NOWHERE){
t=0
}
if(typeof(t)=="number"){
t=t+"px"
}
return t
};
Dwt.byId=function(o,t){
if(!t){
return(typeof o=="string"?document.getElementById(o):o)
}
if(t==o||t.id==o){
return t
}
for(var e=0;
e<t.childNodes.length;
e++){
if(t.childNodes[e].nodeType==1){
var a=Dwt.byId(o,t.childNodes[e]);
if(a){
return a
}}}
return null
};
Dwt.byTag=function(e){
return document.getElementsByTagName(e)
};
Dwt.show=function(t){
var e=Dwt.byId(t);
if(e){
Dwt.setVisible(e,true)
}};
Dwt.hide=function(t){
var e=Dwt.byId(t);
if(e){
Dwt.setVisible(e,false)
}};
Dwt.toggle=function(t,e){
t=Dwt.byId(t);
if(e==null){
e=(Dwt.getVisible(t)!=true)
}
Dwt.setVisible(t,e)
};
Dwt.setText=function(e,t){
e.appendChild(document.createTextNode(t))
};
Dwt.populateText=function(){
if(arguments.length==0){
return
}
var a,e=0,t=arguments.length;
while(e<t){
a=document.getElementById(arguments[e]);
if(a){
Dwt.setText(a,arguments[e+1])
}
e+=2
}};
Dwt.setInnerHtml=function(t,e){
t.innerHTML=e
};
Dwt.setFavIcon=function(r){
var e=null;
if(Dwt._favIconId){
e=document.getElementById(Dwt._favIconId)
}else{
var h=document.getElementsByTagName("head")[0];
var t=h.getElementsByTagName("link");
for(var o=0;
o<t.length;
o++){
var s=t[o];
if(s.rel.toUpperCase()=="SHORTCUT ICON"){
if(!s.id){
s.id=Dwt._favIconId=Dwt.getNextId()
}
e=s;
break
}}}
if(e){
e.href=r;
e.type="image/x-icon";
var n=e.parentNode;
n.removeChild(e);
n.appendChild(e)
}else{
var a=document.createElement("link");
a.id=Dwt._favIconId=Dwt.getNextId();
a.rel="SHORTCUT ICON";
a.href=r;
a.type="image/x-icon";
h=h||document.getElementsByTagName("head")[0];
h.appendChild(a)
}};
Dwt.enableDesignMode=function(a,e){
if(!AjxEnv.isIE){
a.designMode=e?"on":"off"
}else{
var t=a.body;
if(!t||t.contentEditable===undefined){
a.designMode=e?"on":"off"
}else{
t.contentEditable=e?true:false
}}};
Dwt.ffScrollbarCheck=function(a){
if(AjxEnv.isFirefox3_6up||AjxEnv.isDesktop2up){
var e=a.target;
if(e&&(e.clientHeight&&e.scrollHeight&&(e.clientHeight!=e.scrollHeight))||(e.clientWidth&&e.scrollWidth&&(e.clientWidth!=e.scrollWidth))){
a._dontCallPreventDefault=true;
a._stopPropagation=false;
a._returnValue=true;
return true
}}
return false
};
Dwt.selectText=function(t){
if(!t){
Dwt.deselectText();
return
}
if(document.selection){
var e=t.parentTextEdit.createTextRange();
e.moveToElementText(t);
e.select()
}else{
if(window.getSelection){
var e=document.createRange();
e.selectNode(t);
var a=window.getSelection();
a.addRange(e)
}}};
Dwt.deselectText=function(){
if(document.selection){
document.selection.empty()
}else{
if(window.getSelection){
window.getSelection().removeAllRanges()
}}};
Dwt.doOverlap=function(s,n){
if(!s||!n){
return false
}
var h=Dwt.getLocation(s),r=Dwt.getLocation(n);
var u=Dwt.getSize(s),d=Dwt.getSize(n);
var f=h.x,m=r.x,c=h.y,l=r.y;
var o=f+u.x,t=m+d.x;
var a=c+u.y,e=l+d.y;
return !(f>t||o<m||c>e||a<l)
};
Dwt.scrollIntoView=function(a,t){
if(!a||!t){
return
}
var e=Dwt.toWindow(a,0,0,null,null,DwtPoint.tmp).y;
var r=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y+t.scrollTop;
var s=e-r;
if(s<0){
t.scrollTop+=s
}else{
var n=Dwt.getSize(t,DwtPoint.tmp).y;
var o=Dwt.getSize(a,DwtPoint.tmp).y;
s=(e+o)-(r+n);
if(s>0){
t.scrollTop+=s
}}};
Dwt.setLoadingTime=function(a,e){
if(!window.isPerfMetric){
return
}
e=e||new Date();
a+="_loading";
var t=document.getElementById(a);
if(!t){
t=document.createElement("div");
t.id=a;
t.style.display="none";
document.body.appendChild(t)
}
t.innerHTML=e.getTime()
};
Dwt.setLoadedTime=function(a,e){
if(!window.isPerfMetric){
return
}
e=e||new Date();
a+="_loaded";
var t=document.getElementById(a);
if(!t){
t=document.createElement("div");
t.id=a;
t.style.display="none";
document.body.appendChild(t)
}
t.innerHTML=e.getTime()
};
Dwt.createLinearGradientCss=function(n,t,o){
var e=null;
var a=this.createLinearGradientInfo(n,t,o);
if(a.field){
e=a.field+":"+a.css+";"
}
return e
};
Dwt.createLinearGradientInfo=function(s,t,n){
var e;
var o={};
if(AjxEnv.isIE){
e=(n=="v")?0:1;
o.field="filter";
o.name="DXImageTransform.Microsoft.Gradient";
o.css="progid:"+o.name+"(GradientType="+e+",startColorstr="+s+",endColorstr="+t+"); zoom:1;"
}else{
if(AjxEnv.isFirefox3_6up){
e=(n=="v")?"top":"left";
o.field="background";
o.css="-moz-linear-gradient("+e+","+s+", "+t+")"
}else{
if((AjxEnv.isSafari&&AjxEnv.isSafari5_1up)||AjxEnv.isChrome10up){
e=(n=="v")?"top":"left";
o.field="background";
o.css="-webkit-linear-gradient("+e+","+s+", "+t+")"
}else{
if((AjxEnv.isSafari&&AjxEnv.isSafari4up)||AjxEnv.isChrome2up){
var r="left top";
var a=(n=="v")?"left bottom":"right top";
o.field="background";
o.css="-webkit-gradient(linear, "+r+", "+a+", color-stop(0%, "+s+"), color-stop(100%, "+t+"))"
}}}}
return o
};
Dwt.setLinearGradient=function(n,o,e,a){
var t=Dwt.createLinearGradientInfo(o,e,a);
if(AjxEnv.isIE){
Dwt.alterIEFilter(n,t.name,t.css)
}else{
n.style[t.field]=t.css
}};
Dwt.alterIEFilter=function(s,t,o){
if(s.style.filter){
var n=false;
var a=s.style.filter.split(" ");
for(var e=0;
e<a.length;
e++){
if(a[e].indexOf(t)!=-1){
a[e]=o;
n=true;
break
}}
if(!n){
a[a.length]=o
}
s.style.filter=a.join(" ")
}else{
s.style.filter=o
}};
Dwt.getIEFilter=function(n,t){
var a="";
if(n.style.filter){
var o=n.style.filter.split(" ");
for(var e=0;
e<o.length;
e++){
if(o[e].indexOf(t)!=-1){
a=o[e];
break
}}}
return a
};
Dwt.getDescendant=function(a,n){
var t=null;
for(var e=0;
e<a.childNodes.length;
e++){
var o=a.childNodes[e];
if(o.id==n){
t=o
}else{
t=Dwt.getDescendant(o,n)
}
if(t!=null){
break
}}
return t
};
Dwt.moveCursorToEnd=function(e){
if(AjxEnv.isIE){
var a=e.createTextRange();
a.moveStart("character",e.value.length);
a.collapse();
a.select()
}else{
e.focus();
var t=e.value.length;
e.setSelectionRange(t,t)
}}
}
if(AjxPackage.define("ajax.dwt.core.DwtException")){
DwtException=function(a,t,o,e){
if(arguments.length===0){
return
}
AjxException.call(this,a,t,o,e)
};
DwtException.prototype=new AjxException();
DwtException.prototype.constructor=DwtException;
DwtException.prototype.toString=function(){
return"DwtException"
};
DwtException.INVALIDPARENT=-1;
DwtException.INVALID_OP=-2;
DwtException.INTERNAL_ERROR=-3;
DwtException.INVALID_PARAM=-4
}
if(AjxPackage.define("ajax.dwt.core.DwtDraggable")){
DwtDraggable=function(){};
DwtDraggable.dragEl=null;
DwtDraggable.init=function(o,m,s,t,n,e,h,d,u,l,r,c,a){
o.onmousedown=DwtDraggable.__start;
o.__hMode=l?false:true;
o.__vMode=r?false:true;
o.__root=(m&&m!=null)?m:o;
if(o.__hMode&&isNaN(parseInt(o.__root.style.left))){
o.__root.style.left="0px"
}
if(o.__vMode&&isNaN(parseInt(o.__root.style.top))){
o.__root.style.top="0px"
}
if(!o.__hMode&&isNaN(parseInt(o.__root.style.right))){
o.__root.style.right="0px"
}
if(!o.__vMode&&isNaN(parseInt(o.__root.style.bottom))){
o.__root.style.bottom="0px"
}
o.__minX=(typeof s!="undefined")?s:null;
o.__minY=(typeof n!="undefined")?n:null;
o.__maxX=(typeof t!="undefined")?t:null;
o.__maxY=(typeof e!="undefined")?e:null;
o.__xMapper=c?c:null;
o.__yMapper=a?a:null;
o.__root.onDragStart=h;
o.__root.onDragEnd=u;
o.__root.onDrag=d
};
DwtDraggable.setDragBoundaries=function(t,e,o,n,a){
if(t!=null){
if(e!=null){
t.__minX=e
}
if(o!=null){
t.__maxX=o
}
if(n!=null){
t.__minY=n
}
if(a!=null){
t.__maxY=a
}}};
DwtDraggable.__start=function(o){
var a=DwtDraggable.dragEl=this;
o=DwtDraggable.__fixE(o);
var t=parseInt(a.__hMode?a.__root.style.left:a.__root.style.right);
var n=parseInt(a.__vMode?a.__root.style.top:a.__root.style.bottom);
if(a.__root.onDragStart){
a.__root.onDragStart.run([t,n])
}
a.__lastMouseX=o.clientX;
a.__lastMouseY=o.clientY;
if(a.__hMode){
if(a.__minX!=null){
a.__minMouseX=o.clientX-t+a.__minX
}
if(a.__maxX!=null){
a.__maxMouseX=a.__minMouseX+a.__maxX-a.__minX
}}else{
if(a.__minX!=null){
a.__maxMouseX=-a.__minX+o.clientX+t
}
if(a.__maxX!=null){
a.__minMouseX=-a.__maxX+o.clientX+t
}}
if(a.__vMode){
if(a.__minY!=null){
a.__minMouseY=o.clientY-n+a.__minY
}
if(a.__maxY!=null){
a.__maxMouseY=a.__minMouseY+a.__maxY-a.__minY
}}else{
if(a.__minY!=null){
a.__maxMouseY=-a.__minY+o.clientY+n
}
if(a.__maxY!=null){
a.__minMouseY=-a.__maxY+o.clientY+n
}}
document.onmousemove=DwtDraggable.__drag;
document.onmouseup=DwtDraggable.__end;
return false
};
DwtDraggable.__drag=function(r){
r=DwtDraggable.__fixE(r);
var o=DwtDraggable.dragEl;
var n=r.clientY;
var s=r.clientX;
var a=parseInt(o.__hMode?o.__root.style.left:o.__root.style.right);
var l=parseInt(o.__vMode?o.__root.style.top:o.__root.style.bottom);
var t,h;
if(!o.__xMapper){
if(o.__minX!=null){
s=o.__hMode?Math.max(s,o.__minMouseX):Math.min(s,o.__maxMouseX)
}
if(o.__maxX!=null){
s=o.__hMode?Math.min(s,o.__maxMouseX):Math.max(s,o.__minMouseX)
}
t=a+((s-o.__lastMouseX)*(o.__hMode?1:-1))
}else{
t=o.__xMapper(a,s)
}
if(!o.__yMapper){
if(o.__minY!=null){
n=o.__vMode?Math.max(n,o.__minMouseY):Math.min(n,o.__maxMouseY)
}
if(o.__maxY!=null){
n=o.__vMode?Math.min(n,o.__maxMouseY):Math.max(n,o.__minMouseY)
}
h=l+((n-o.__lastMouseY)*(o.__vMode?1:-1))
}else{
h=o.__yMapper(l,n)
}
DwtDraggable.dragEl.__root.style[o.__hMode?"left":"right"]=t+"px";
DwtDraggable.dragEl.__root.style[o.__vMode?"top":"bottom"]=h+"px";
DwtDraggable.dragEl.__lastMouseX=s;
DwtDraggable.dragEl.__lastMouseY=n;
if(DwtDraggable.dragEl.__root.onDrag){
DwtDraggable.dragEl.__root.onDrag.run([t,h])
}
return false
};
DwtDraggable.__end=function(){
document.onmousemove=null;
document.onmouseup=null;
if(DwtDraggable.dragEl.__root.onDragEnd){
DwtDraggable.dragEl.__root.onDragEnd.run([parseInt(DwtDraggable.dragEl.__root.style[DwtDraggable.dragEl.__hMode?"left":"right"]),parseInt(DwtDraggable.dragEl.__root.style[DwtDraggable.dragEl.__vMode?"top":"bottom"])])
}
DwtDraggable.dragEl=null
};
DwtDraggable.__fixE=function(t){
if(typeof t=="undefined"){
t=window.event
}
if(!AjxEnv.isWebKitBased){
if(typeof t.layerX=="undefined"){
t.layerX=t.offsetX
}
if(typeof t.layerY=="undefined"){
t.layerY=t.offsetY
}}
return t
}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtCssStyle")){
DwtCssStyle=function(){};
DwtCssStyle.HOVER="hover";
DwtCssStyle.ACTIVE="active";
DwtCssStyle.SELECTED="selected";
DwtCssStyle.DISABLED="disabled";
DwtCssStyle.FOCUSED="focused";
DwtCssStyle.ACTIONED="actioned";
DwtCssStyle.MATCHED="matched";
DwtCssStyle.DRAG_OVER="dragOver";
DwtCssStyle.DROPPABLE="droppable";
DwtCssStyle.NOT_DROPPABLE="notDroppable";
DwtCssStyle.DRAG_PROXY="dragProxy";
DwtCssStyle.LINUX="linux";
DwtCssStyle.getProperty=function(h,t){
var e;
if(h.ownerDocument==null){
for(var a=h.parentNode;
a.parentNode!=null;
a=a.parentNode){}
var r=a
}else{
var r=h.ownerDocument
}
if(r.defaultView&&r.defaultView.getComputedStyle){
var s=r.defaultView.getComputedStyle(h,"");
if(s&&s.length>0){
return s.getPropertyValue(t)
}}
var n=t.split("-");
var o=n.shift()+AjxUtil.map(n,AjxStringUtil.capitalize).join("");
if(h.currentStyle){
return h.currentStyle[o]
}else{
if(h.style){
return h.style[o]
}}};
DwtCssStyle.getComputedStyleObject=function(o){
if(o.ownerDocument==null){
for(var t=o.parentNode;
t.parentNode!=null;
t=t.parentNode){}
var a=t
}else{
var a=o.ownerDocument
}
if(a.defaultView){
var e=a.defaultView.getComputedStyle(o,null);
if(!e&&o.style){
o.style.display="";
e=a.defaultView.getComputedStyle(o,null)
}
return e||{}
}else{
if(o.currentStyle){
return o.currentStyle
}else{
if(o.style){
return o.style
}}}};
DwtCssStyle.removeProperty=function(t,a){
if(a instanceof Array){
for(var e=a.length;
--e>=0;
){
DwtCssStyle.removeProperty(t,a[e])
}}else{
if(AjxEnv.isIE){
t.style.removeAttribute(a,true)
}else{
a=a.replace(/([A-Z])/g,"-$1");
t.style.removeProperty(a)
}}};
DwtCssStyle.addRule=function(a,e,o,t){
if(a.addRule){
a.addRule(e,o,t);
return(t==null)?(a.rules.length-1):t
}else{
a.insertRule(e+"{"+o+"}",t||0);
return(t==null)?(a.cssRules.length-1):t
}};
DwtCssStyle.removeRule=function(t,e){
if(t.removeRule){
t.removeRule(e)
}else{
t.deleteRule(e)
}}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtPoint")){
DwtPoint=function(e,t){
this.x=e||0;
this.y=t||0
};
DwtPoint.tmp=new DwtPoint(0,0);
DwtPoint.prototype.toString=function(){
return"DwtPoint"
};
DwtPoint.prototype.set=function(e,t){
this.x=e;
this.y=t
}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtRectangle")){
DwtRectangle=function(t,o,a,e){
this.x=t;
this.y=o;
this.width=a;
this.height=e
};
DwtRectangle.prototype.toString=function(){
return"DwtRectangle"
};
DwtRectangle.prototype.set=function(t,o,a,e){
this.x=t;
this.y=o
}
}
if(AjxPackage.define("ajax.dwt.events.DwtEvent")){
DwtEvent=function(e){
if(arguments.length==0){
return
}
this.dwtObj=null
};
DwtEvent.prototype.toString=function(){
return"DwtEvent"
};
DwtEvent.ONCHANGE="onchange";
DwtEvent.ONCLICK="onclick";
DwtEvent.ONCONTEXTMENU="oncontextmenu";
DwtEvent.ONDBLCLICK="ondblclick";
DwtEvent.ONFOCUS="onfocus";
DwtEvent.ONBLUR="onblur";
DwtEvent.ONKEYDOWN="onkeydown";
DwtEvent.ONKEYPRESS="onkeypress";
DwtEvent.ONKEYUP="onkeyup";
DwtEvent.ONMOUSEDOWN="onmousedown";
DwtEvent.ONMOUSEENTER="onmouseenter";
DwtEvent.ONMOUSELEAVE="onmouseleave";
DwtEvent.ONMOUSEMOVE="onmousemove";
DwtEvent.ONMOUSEOUT="onmouseout";
DwtEvent.ONMOUSEOVER="onmouseover";
DwtEvent.ONMOUSEUP="onmouseup";
DwtEvent.ONMOUSEWHEEL="onmousewheel";
DwtEvent.ONSELECTSTART="onselectstart";
DwtEvent.ONSCROLL="onscroll";
DwtEvent.ONPASTE="onpaste";
DwtEvent.ONCUT="oncut";
DwtEvent.ACTION="ACTION";
DwtEvent.CONTROL="CONTROL";
DwtEvent.DATE_RANGE="DATE_RANGE";
DwtEvent.DISPOSE="DISPOSE";
DwtEvent.ENTER="ENTER";
DwtEvent.HOVEROVER="HOVEROVER";
DwtEvent.HOVEROUT="HOVEROUT";
DwtEvent.POPDOWN="POPDOWN";
DwtEvent.POPUP="POPUP";
DwtEvent.SELECTION="SELECTION";
DwtEvent.TREE="TREE";
DwtEvent.STATE_CHANGE="STATE_CHANGE";
DwtEvent.TAB="TAB";
DwtEvent.XFORMS_READY="xforms-ready";
DwtEvent.XFORMS_DISPLAY_UPDATED="xforms-display-updated";
DwtEvent.XFORMS_VALUE_CHANGED="xforms-value-changed";
DwtEvent.XFORMS_FORM_DIRTY_CHANGE="xforms-form-dirty-change";
DwtEvent.XFORMS_CHOICES_CHANGED="xforms-choices-changed";
DwtEvent.XFORMS_VALUE_ERROR="xforms-value-error";
DwtEvent.XFORMS_INSTANCE_CHANGED="xforms-instance-cahnged";
DwtEvent.KEY_EVENTS=[DwtEvent.ONKEYDOWN,DwtEvent.ONKEYPRESS,DwtEvent.ONKEYUP];
DwtEvent.MOUSE_EVENTS=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]
}
if(AjxPackage.define("ajax.dwt.events.DwtEventManager")){
DwtEventManager=function(){};
DwtEventManager._instance=new AjxEventMgr();
DwtEventManager._domEventToDwtMap={
ondblclick:DwtEvent.ONDBLCLICK,onmousedown:DwtEvent.ONMOUSEDOWN,onmouseup:DwtEvent.ONMOUSEUP,onmousemove:DwtEvent.ONMOUSEMOVE,onmouseout:DwtEvent.ONMOUSEOUT,onmouseover:DwtEvent.ONMOUSEOVER,onselectstart:DwtEvent.ONSELECTSTART,onchange:DwtEvent.ONCHANGE};
DwtEventManager.addListener=function(e,t){
DwtEventManager._instance.addListener(e,t)
};
DwtEventManager.notifyListeners=function(e,t){
DwtEventManager._instance.notifyListeners(e,t)
};
DwtEventManager.removeListener=function(e,t){
DwtEventManager._instance.removeListener(e,t)
}
}
if(AjxPackage.define("ajax.dwt.events.DwtUiEvent")){
DwtUiEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtUiEvent.prototype=new DwtEvent;
DwtUiEvent.prototype.constructor=DwtUiEvent;
DwtUiEvent.prototype.isDwtUiEvent;
DwtUiEvent.prototype.toString=function(){
return"DwtUiEvent"
};
DwtUiEvent.prototype.reset=function(){
this.dwtObj=null;
this.altKey=false;
this.ctrlKey=false;
this.metaKey=false;
this.shiftKey=false;
this.target=null;
this.type=null;
this.docX=-1;
this.docY=-1;
this.elementX=-1;
this.elementY=-1;
this.ersatz=false;
this._stopPropagation=false;
this._returnValue=true;
this._dontCallPreventDefault=false
};
DwtUiEvent.getEvent=function(t,a){
t=t||window.event;
if(t){
return t
}
if(a){
var e=(a.ownerDocument||a.document||a).parentWindow;
return e?e.event:null
}};
DwtUiEvent.getTarget=function(e,t){
e=DwtUiEvent.getEvent(e);
if(!e){
return null
}
if(!t){
if(e.target){
return(e.target.nodeType==3)?e.target.parentNode:e.target
}else{
if(e.srcElement){
return e.srcElement
}}}else{
if(e.relatedTarget){
return e.relatedTarget
}else{
if(e.toElement){
return e.toElement
}else{
if(e.fromElement){
return e.fromElement
}}}}
return null
};
DwtUiEvent.getTargetWithProp=function(t,s,n,o){
var a=DwtUiEvent.getTarget(t,n);
while(a){
var e=Dwt.getAttr(a,s);
if(e!=null&&e!==""&&(!o||(e==o))){
return a
}
a=a.parentNode
}
return null
};
DwtUiEvent.getTargetWithProps=function(o,a){
var n=DwtUiEvent.getTarget(o);
while(n){
var t=true;
for(var e in a){
var s=Dwt.getAttr(n,a[e]);
if(s==null||s===""){
n=n.parentNode;
t=false;
break
}}
if(t){
return n
}}
return null
};
DwtUiEvent.copy=function(e,t){
e.altKey=t.altKey;
e.ctrlKey=t.ctrlKey;
e.metaKey=t.metaKey;
e.shiftKey=t.shiftKey;
e.target=t.target;
e.type=t.type;
e.dwtObj=t.dwtObj;
e.docX=t.docX;
e.docY=t.docY;
e.elementX=t.elementX;
e.elementY=t.elementY;
e.ersatz=t.ersatz;
e._stopPropagation=t._stopPropagation;
e._returnValue=t._returnValue
};
DwtUiEvent.prototype.setFromDhtmlEvent=function(t,a){
t=DwtUiEvent.getEvent(t);
if(!t){
return
}
this.altKey=t.altKey;
this.ctrlKey=t.ctrlKey;
this.metaKey=t.metaKey;
this.shiftKey=t.shiftKey;
this.type=t.type;
this.target=DwtUiEvent.getTarget(t);
this.dwtObj=(a===true)?DwtControl.getTargetControl(t):a;
if(t.pageX!=null){
this.docX=t.pageX;
this.docY=t.pageY
}else{
if(t.clientX!=null){
this.docX=t.clientX+document.body.scrollLeft-document.body.clientLeft;
this.docY=t.clientY+document.body.scrollTop-document.body.clientTop;
if(document.body.parentElement){
var e=document.body.parentElement;
this.docX+=e.scrollLeft-e.clientLeft;
this.docY+=e.scrollTop-e.clientTop
}}}
if(t.offsetX!=null){
this.elementX=t.offsetX;
this.elementY=t.offsetY
}else{
if(!AjxEnv.isWebKitBased&&t.layerX!=null){
this.elementX=t.layerX;
this.elementY=t.layerY
}else{
this.elementX=Dwt.DEFAULT;
this.elementY=Dwt.DEFAULT
}}
this.ersatz=false;
return t
};
DwtUiEvent.prototype.setToDhtmlEvent=function(e){
DwtUiEvent.setBehaviour(e,this._stopPropagation,this._returnValue,this._dontCallPreventDefault)
};
DwtUiEvent.setBehaviour=function(n,e,t,a){
var o=DwtUiEvent.getEvent(n);
DwtUiEvent.setDhtmlBehaviour(o,e,t,a)
};
DwtUiEvent.setDhtmlBehaviour=function(o,e,t,a){
o=DwtUiEvent.getEvent(o);
if(!o){
return
}
if(o.stopPropagation!=null){
if(e){
o.stopPropagation()
}
if(!t&&!a){
o.preventDefault()
}}else{
o.returnValue=t;
o.cancelBubble=e
}};
DwtUiEvent.getDwtObjFromEvent=function(e,a){
var t=DwtUiEvent.getTargetWithProp(e,"dwtObj",a);
return t?Dwt.getObjectFromElement(t):null
};
DwtUiEvent.getDwtObjWithProp=function(e,a){
var t=DwtUiEvent.getTargetWithProps(e,["dwtObj",a]);
return t?Dwt.getObjectFromElement(t):null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtDisposeEvent")){
DwtDisposeEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true)
};
DwtDisposeEvent.prototype=new DwtEvent;
DwtDisposeEvent.prototype.constructor=DwtDisposeEvent;
DwtDisposeEvent.prototype.toString=function(){
return"DwtDisposeEvent"
}
}
if(AjxPackage.define("ajax.dwt.events.DwtControlEvent")){
DwtControlEvent=function(){
this.reset()
};
DwtControlEvent.prototype=new DwtEvent;
DwtControlEvent.prototype.constructor=DwtControlEvent;
DwtControlEvent.RESIZE=1;
DwtControlEvent.MOVE=2;
DwtControlEvent.prototype.toString=function(){
return"DwtControlEvent"
};
DwtControlEvent.prototype.reset=function(e){
this.oldX=Dwt.DEFAULT;
this.oldY=Dwt.DEFAULT;
this.oldWidth=Dwt.DEFAULT;
this.oldHeight=Dwt.DEFAULT;
this.newX=Dwt.DEFAULT;
this.newY=Dwt.DEFAULT;
this.newWidth=Dwt.DEFAULT;
this.newHeight=Dwt.DEFAULT;
this.type=e||null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtFocusEvent")){
DwtFocusEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtFocusEvent.prototype=new DwtEvent;
DwtFocusEvent.prototype.constructor=DwtFocusEvent;
DwtFocusEvent.FOCUS=1;
DwtFocusEvent.BLUR=2;
DwtFocusEvent.prototype.toString=function(){
return"DwtFocusEvent"
};
DwtFocusEvent.prototype.reset=function(){
this.dwtObj=null;
this.state=DwtFocusEvent.FOCUS
}
}
if(AjxPackage.define("ajax.dwt.events.DwtKeyEvent")){
DwtKeyEvent=function(){
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtKeyEvent.KEY_END_OF_TEXT=3;
DwtKeyEvent.KEY_TAB=9;
DwtKeyEvent.KEY_RETURN=13;
DwtKeyEvent.KEY_ENTER=13;
DwtKeyEvent.KEY_ESCAPE=27;
DwtKeyEvent.MAC_FF_CODE={};
DwtKeyEvent.MAC_FF_CODE["~"]=192;
DwtKeyEvent.MAC_FF_CODE["!"]=49;
DwtKeyEvent.MAC_FF_CODE["@"]=50;
DwtKeyEvent.MAC_FF_CODE["#"]=51;
DwtKeyEvent.MAC_FF_CODE["$"]=52;
DwtKeyEvent.MAC_FF_CODE["%"]=53;
DwtKeyEvent.MAC_FF_CODE["^"]=54;
DwtKeyEvent.MAC_FF_CODE["&"]=55;
DwtKeyEvent.MAC_FF_CODE["*"]=56;
DwtKeyEvent.MAC_FF_CODE["("]=57;
DwtKeyEvent.MAC_FF_CODE[")"]=48;
DwtKeyEvent.MAC_FF_CODE["-"]=189;
DwtKeyEvent.MAC_FF_CODE._=189;
DwtKeyEvent.MAC_FF_CODE["+"]=187;
DwtKeyEvent.MAC_FF_CODE["|"]=220;
DwtKeyEvent.MAC_FF_CODE[":"]=186;
DwtKeyEvent.MAC_FF_CODE["<"]=188;
DwtKeyEvent.MAC_FF_CODE[">"]=190;
DwtKeyEvent.MAC_FF_CODE["?"]=191;
DwtKeyEvent.prototype=new DwtUiEvent;
DwtKeyEvent.prototype.constructor=DwtKeyEvent;
DwtKeyEvent.prototype.toString=function(){
return"DwtKeyEvent"
};
DwtKeyEvent.isKeyEvent=function(e){
return(e.type.search(/^key/i)!=-1)
};
DwtKeyEvent.isKeyPressEvent=function(e){
return(AjxEnv.isIE&&e.type=="keydown")||(e.type=="keypress")
};
DwtKeyEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.keyCode=0;
this.charCode=0
};
DwtKeyEvent.prototype.isCommand=function(e){
return AjxEnv.isMac&&this.metaKey||this.ctrlKey
};
DwtKeyEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
if(!e){
return
}
this.charCode=e.charCode||e.keyCode;
this.keyCode=e.keyCode
};
DwtKeyEvent.getCharCode=function(t){
t=DwtUiEvent.getEvent(t);
var e=AjxEnv.isSafari?t.keyCode:(t.charCode||t.keyCode);
if(e==0&&AjxEnv.isMac&&AjxEnv.isGeckoBased&&t.type=="keyup"&&DwtKeyEvent._geckoCode){
e=DwtKeyEvent._geckoCode;
DwtKeyEvent._geckoCode=null
}
return e
};
DwtKeyEvent.copy=function(e,t){
DwtUiEvent.copy(e,t);
e.charCode=t.charCode;
e.keyCode=t.keyCode
};
DwtKeyEvent.geckoCheck=function(t){
t=DwtUiEvent.getEvent(t);
if(t.type=="keypress"){
DwtKeyEvent._geckoCode=null;
if(AjxEnv.isMac&&AjxEnv.isGeckoBased){
var e=String.fromCharCode(t.charCode);
DwtKeyEvent._geckoCode=DwtKeyEvent.MAC_FF_CODE[e]
}}}
}
if(AjxPackage.define("ajax.dwt.events.DwtMouseEvent")){
DwtMouseEvent=function(){
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtMouseEvent.prototype=new DwtUiEvent;
DwtMouseEvent.prototype.constructor=DwtMouseEvent;
DwtMouseEvent.prototype.toString=function(){
return"DwtMouseEvent"
};
DwtMouseEvent.NONE=0;
DwtMouseEvent.LEFT=1;
DwtMouseEvent.MIDDLE=2;
DwtMouseEvent.RIGHT=3;
DwtMouseEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.button=0
};
DwtMouseEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
if(!e){
return
}
if(e.which){
switch(e.which){
case 1:this.button=DwtMouseEvent.LEFT;
break;
case 2:this.button=DwtMouseEvent.MIDDLE;
break;
case 3:this.button=DwtMouseEvent.RIGHT;
break;
default:this.button=DwtMouseEvent.NONE
}}else{
if(e.button){
if((e.button&1)!=0){
this.button=DwtMouseEvent.LEFT
}else{
if((e.button&2)!=0){
this.button=DwtMouseEvent.RIGHT
}else{
if((e.button&4)!=0){
this.button=DwtMouseEvent.MIDDLE
}else{
this.button=DwtMouseEvent.NONE
}}}}}
if(AjxEnv.isMac&&this.button){
if(this.ctrlKey&&(this.button==DwtMouseEvent.LEFT||this.button==DwtMouseEvent.RIGHT)){
this.button=DwtMouseEvent.RIGHT;
this.ctrlKey=false
}
if(this.altKey){
this.ctrlKey=true;
this.altKey=false
}}}
}
if(AjxPackage.define("ajax.dwt.events.DwtMouseEventCapture")){
DwtMouseEventCapture=function(e){
e=Dwt.getParams(arguments,DwtMouseEventCapture.PARAMS);
this.targetObj=e.targetObj;
this._id=e.id;
this._mouseOverHdlr=e.mouseOverHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseDownHdlr=e.mouseDownHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseMoveHdlr=e.mouseMoveHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseUpHdlr=e.mouseUpHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseOutHdlr=e.mouseOutHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseWheelHdlr=e.mouseWheelHdlr||DwtMouseEventCapture.emptyHdlr;
this._hardCapture=(e.hardCapture!==false)
};
DwtMouseEventCapture.PARAMS=["targetObj","id","mouseOverHdlr","mouseDownHdlr","mouseMoveHdlr","mouseUpHdlr","mouseOutHdlr","mouseWheelHdlr","hardCapture"];
DwtMouseEventCapture._capturing=false;
DwtMouseEventCapture.getCaptureObj=function(){
return window._mouseEventCaptureObj
};
DwtMouseEventCapture.getTargetObj=function(){
return window._mouseEventCaptureObj?window._mouseEventCaptureObj.targetObj:null
};
DwtMouseEventCapture.getId=function(){
return window._mouseEventCaptureObj?window._mouseEventCaptureObj._id:null
};
DwtMouseEventCapture.prototype.toString=function(){
return"DwtMouseEventCapture"
};
DwtMouseEventCapture.prototype.capturing=function(){
return DwtMouseEventCapture._capturing
};
DwtMouseEventCapture.prototype.capture=function(){
if(window._mouseEventCaptureObj){
window._mouseEventCaptureObj.release()
}
if(document.body!=null&&document.body.addEventListener!=null){
document.body.addEventListener("mouseover",this._mouseOverHdlr,true);
document.body.addEventListener("mousedown",this._mouseDownHdlr,true);
document.body.addEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.addEventListener("mouseup",this._mouseUpHdlr,true);
document.body.addEventListener("mouseout",this._mouseOutHdlr,true);
document.body.addEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{
this._savedMouseOverHdlr=document.onmouseover;
this._savedMouseDownHdlr=document.onmousedown;
this._savedMouseMoveHdlr=document.onmousemove;
this._savedMouseUpHdlr=document.onmouseup;
this._savedMouseOutHdlr=document.onmouseout;
this._savedMouseWheelHdlr=document.onmousewheel;
document.onmouseover=this._mouseOverHdlr;
document.onmousedown=this._mouseDownHdlr;
document.onmousemove=this._mouseMoveHdlr;
document.onmouseup=this._mouseUpHdlr;
document.onmouseout=this._mouseOutHdlr;
document.onmousewheel=this._mouseWheelHdlr
}
if(this._hardCapture&&document.body&&document.body.setCapture){
document.body.setCapture()
}
window._mouseEventCaptureObj=this;
DwtMouseEventCapture._capturing=true
};
DwtMouseEventCapture.prototype.release=function(){
if(window._mouseEventCaptureObj==null){
return
}
var e=window._shellCaptureObj;
if(document.body&&document.body.addEventListener){
document.body.removeEventListener("mouseover",this._mouseOverHdlr,true);
document.body.removeEventListener("mousedown",this._mouseDownHdlr,true);
document.body.removeEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.removeEventListener("mouseup",this._mouseUpHdlr,true);
document.body.removeEventListener("mouseout",this._mouseOutHdlr,true);
document.body.removeEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{
document.onmouseover=this._savedMouseOverHdlr;
document.onmousedown=this._savedMouseDownHdlr;
document.onmousemove=this._savedMouseMoveHdlr;
document.onmouseup=this._savedMouseUpHdlr;
document.onmouseout=this._savedMouseOutHdlr;
document.onmousewheel=this._savedMouseWheelHdlr
}
if(this._hardCapture&&document.body&&document.body.releaseCapture){
document.body.releaseCapture()
}
window._mouseEventCaptureObj=null;
DwtMouseEventCapture._capturing=false
};
DwtMouseEventCapture.emptyHdlr=function(t){
var a=DwtMouseEventCapture.getCaptureObj();
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(a._hardCapture){
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}else{
e._stopPropagation=false;
e._returnValue=true;
e.setToDhtmlEvent(t);
return true
}}
}
if(AjxPackage.define("ajax.dwt.events.DwtListViewActionEvent")){
DwtListViewActionEvent=function(){
DwtMouseEvent.call(this);
this.reset(true)
};
DwtListViewActionEvent.prototype=new DwtMouseEvent;
DwtListViewActionEvent.prototype.constructor=DwtListViewActionEvent;
DwtListViewActionEvent.prototype.toString=function(){
return"DwtListViewActionEvent"
};
DwtListViewActionEvent.prototype.reset=function(e){
if(!e){
DwtMouseEvent.prototype.reset.call(this)
}
this.field=null;
this.item=null;
this.detail=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtSelectionEvent")){
DwtSelectionEvent=function(e){
if(arguments.length==0){
return
}
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtSelectionEvent.prototype=new DwtUiEvent;
DwtSelectionEvent.prototype.constructor=DwtSelectionEvent;
DwtSelectionEvent.prototype.toString=function(){
return"DwtSelectionEvent"
};
DwtSelectionEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.button=0;
this.detail=null;
this.item=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtHtmlEditorStateEvent")){
DwtHtmlEditorStateEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtHtmlEditorStateEvent.prototype=new DwtEvent;
DwtHtmlEditorStateEvent.prototype.constructor=DwtHtmlEditorStateEvent;
DwtHtmlEditorStateEvent.prototype.toString=function(){
return"DwtHtmlEditorStateEvent"
};
DwtHtmlEditorStateEvent.prototype.reset=function(){
this.isBold=null;
this.isItalic=null;
this.isUnderline=null;
this.isStrikeThru=null;
this.isSuperscript=null;
this.isSubscript=null;
this.isOrderedList=null;
this.isNumberedList=null;
this.fontName=null;
this.fontSize=null;
this.style=null;
this.backgroundColor=null;
this.color=null;
this.justification=null;
this.direction=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtTreeEvent")){
DwtTreeEvent=function(){
DwtSelectionEvent.call(this,true)
};
DwtTreeEvent.prototype=new DwtSelectionEvent;
DwtTreeEvent.prototype.constructor=DwtTreeEvent;
DwtTreeEvent.prototype.toString=function(){
return"DwtTreeEvent"
};
DwtTreeEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtSelectionEvent.prototype.setFromDhtmlEvent.apply(this,arguments)
}
}
if(AjxPackage.define("ajax.dwt.events.DwtHoverEvent")){
DwtHoverEvent=function(o,a,t,e,n){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.type=o;
this.delay=a;
this.object=t;
this.x=e||-1;
this.y=n||-1
};
DwtHoverEvent.prototype=new DwtEvent;
DwtHoverEvent.prototype.constructor=DwtHoverEvent;
DwtHoverEvent.prototype.toString=function(){
return"DwtHoverEvent"
};
DwtHoverEvent.prototype.reset=function(){
this.type=0;
this.delay=0;
this.object=null;
this.x=-1;
this.y=-1
}
}
if(AjxPackage.define("ajax.dwt.events.DwtOutsideMouseEventMgr")){
DwtOutsideMouseEventMgr=function(){
this._reset();
this._mouseEventListener=DwtOutsideMouseEventMgr._mouseEventHdlr.bind();
DwtOutsideMouseEventMgr.INSTANCE=this;
this.id="DwtOutsideMouseEventMgr"
};
DwtOutsideMouseEventMgr.prototype.isDwtOutsideMouseEventMgr=true;
DwtOutsideMouseEventMgr.prototype.toString=function(){
return"DwtOutsideMouseEventMgr"
};
DwtOutsideMouseEventMgr.EVENTS=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEWHEEL];
DwtOutsideMouseEventMgr.EVENTS_HASH=AjxUtil.arrayAsHash(DwtOutsideMouseEventMgr.EVENTS);
DwtOutsideMouseEventMgr.prototype.startListening=function(o){
if(!(o&&o.outsideListener)){
return
}
var e=o.id;
if(!this._menuCapObj){
var a={
id:this.id,hardCapture:false,mouseDownHdlr:DwtOutsideMouseEventMgr._mouseEventHdlr,mouseWheelHdlr:DwtOutsideMouseEventMgr._mouseEventHdlr};
this._menuCapObj=new DwtMouseEventCapture(a)
}
var s=o.elementId||(o.obj&&o.obj.getHTMLElId&&o.obj.getHTMLElId());
var t=this._byId[e];
if(t){
if(s){
t.elementIds.push(s)
}
return
}else{
t=this._byId[e]={
id:e,obj:o.obj,elementIds:[s],outsideListener:o.outsideListener}
}
if(this._numIds==0){
if(AjxEnv.isIE){
var r=DwtShell.getShell(window);
var l=DwtOutsideMouseEventMgr.EVENTS;
r._setEventHdlrs(l);
for(var n=0;
n<l.length;
n++){
var h=l[n];
r.addListener(h,this._mouseEventListener);
DwtEventManager.addListener(h,this._mouseEventListener)
}}
if(!AjxEnv.isIE&&!o.noWindowBlur){
this._savedWindowBlurHandler=window.onblur;
window.onblur=DwtOutsideMouseEventMgr._mouseEventHdlr
}
this._menuCapObj.capture();
this._capturing=true
}
this._numIds++
};
DwtOutsideMouseEventMgr.prototype.stopListening=function(o){
if(typeof o=="string"){
o={
id:o}
}
var e=o.id;
var a=this._byId[e];
if(!a){
return
}
var t=a.elementIds;
var s=o.elementId||(o.obj&&o.obj.getHTMLElId());
if(s){
AjxUtil.arrayRemove(t,s);
if(t.length>0){
return
}}
delete this._byId[e];
this._numIds--;
if(this._numIds==0){
if(AjxEnv.isIE){
var r=DwtShell.getShell(window);
var l=DwtOutsideMouseEventMgr.EVENTS;
r._setEventHdlrs(l,true);
for(var n=0;
n<l.length;
n++){
var h=l[n];
r.removeListener(h,this._mouseEventListener);
DwtEventManager.removeListener(h,this._mouseEventListener)
}}
if(!AjxEnv.isIE&&!o.noWindowBlur){
window.onblur=this._savedWindowBlurHandler
}
this._reset()
}};
DwtOutsideMouseEventMgr.prototype._reset=function(){
if(this._capturing&&(DwtMouseEventCapture.getId()==this.id)){
this._menuCapObj.release();
this._capturing=false
}
this._byId={};
this._numIds=0
};
DwtOutsideMouseEventMgr.forwardEvent=function(a){
if(!a){
return
}
var t=DwtOutsideMouseEventMgr.INSTANCE;
if(!t._numIds){
return
}
var e="on"+a.type;
if(DwtOutsideMouseEventMgr.EVENTS_HASH[e]){
DwtOutsideMouseEventMgr._mouseEventHdlr(a)
}};
DwtOutsideMouseEventMgr._mouseEventHdlr=function(r){
r=DwtUiEvent.getEvent(r);
if(!r){
return
}
var h=DwtOutsideMouseEventMgr.INSTANCE;
var l=DwtUiEvent.getTarget(r);
if(AjxEnv.isGeckoBased&&r&&(r.type=="blur")&&r.target&&r.explicitOriginalTarget&&(r.target!=r.explicitOriginalTarget)){
DwtUiEvent.setBehaviour(r,false,true);
return true
}
for(var e in h._byId){
var s=true;
var t=h._byId[e];
var n=t.elementIds;
for(var o=0;
o<n.length;
o++){
var a=document.getElementById(n[o]);
if(a&&l&&Dwt.isAncestor(a,l)){
s=false;
break
}}
if(s){
t.outsideListener.run(r,t)
}}
DwtUiEvent.setBehaviour(r,false,true);
return true
};
new DwtOutsideMouseEventMgr()
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroupEvent")){
DwtTabGroupEvent=function(){
this.tabGroup=null;
this.newFocusMember=null
};
DwtTabGroupEvent.prototype.toString=function(){
return"DwtTabGroupEvent"
};
DwtTabGroupEvent.prototype.reset=function(){
this.tabGroup=null;
this.newFocusMember=null
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyMap")){
DwtKeyMap=function(e){
if(e){
return
}
this._map={};
this._args={};
this._checkedMap={};
this._load(this._map,AjxKeys);
DwtKeyMap.MOD_ORDER[DwtKeyMap.ALT]=1;
DwtKeyMap.MOD_ORDER[DwtKeyMap.CTRL]=2;
DwtKeyMap.MOD_ORDER[DwtKeyMap.META]=3;
DwtKeyMap.MOD_ORDER[DwtKeyMap.SHIFT]=4
};
DwtKeyMap.prototype.isDwtKeyMap=true;
DwtKeyMap.prototype.toString=function(){
return"DwtKeyMap"
};
DwtKeyMap.deserialize=function(e){
alert("DwtKeyMap.deserialize: NOT IMPLEMENTED")
};
DwtKeyMap.serialize=function(e){
alert("DwtKeyMap.serialize: NOT IMPLEMENTED")
};
DwtKeyMap.MAP_DIALOG="dialog";
DwtKeyMap.MAP_BUTTON="button";
DwtKeyMap.MAP_LIST="list";
DwtKeyMap.MAP_MENU="menu";
DwtKeyMap.MAP_EDITOR="editor";
DwtKeyMap.MAP_TOOLBAR_HORIZ="toolbarHorizontal";
DwtKeyMap.MAP_TOOLBAR_VERT="toolbarVertical";
DwtKeyMap.MAP_TAB_VIEW="tabView";
DwtKeyMap.MAP_TREE="tree";
DwtKeyMap.IS_MODIFIER={};
DwtKeyMap.MOD_ORDER={};
DwtKeyMap.ARROW_DOWN="ArrowDown";
DwtKeyMap.ARROW_LEFT="ArrowLeft";
DwtKeyMap.ARROW_RIGHT="ArrowRight";
DwtKeyMap.ARROW_UP="ArrowUp";
DwtKeyMap.BACKSLASH="Backslash";
DwtKeyMap.BACKSPACE="Backspace";
DwtKeyMap.COMMA="Comma";
DwtKeyMap.SEMICOLON="Semicolon";
DwtKeyMap.DELETE="Del";
DwtKeyMap.END="End";
DwtKeyMap.ENTER="Enter";
DwtKeyMap.ESC="Esc";
DwtKeyMap.HOME="Home";
DwtKeyMap.PGDOWN="PgDown";
DwtKeyMap.PGUP="PgUp";
DwtKeyMap.SPACE="Space";
DwtKeyMap.TAB="Tab";
DwtKeyMap.ACTION="ContextMenu";
DwtKeyMap.SELECT_CURRENT="SelectCurrent";
DwtKeyMap.ADD_SELECT_NEXT="AddNext";
DwtKeyMap.ADD_SELECT_PREV="AddPrevious";
DwtKeyMap.CANCEL="Cancel";
DwtKeyMap.COLLAPSE="Collapse";
DwtKeyMap.DBLCLICK="DoubleClick";
DwtKeyMap.EXPAND="Expand";
DwtKeyMap.GOTO_TAB="GoToTab";
DwtKeyMap.HEADER1="Header1";
DwtKeyMap.HEADER2="Header2";
DwtKeyMap.HEADER3="Header3";
DwtKeyMap.HEADER4="Header4";
DwtKeyMap.HEADER5="Header5";
DwtKeyMap.HEADER6="Header6";
DwtKeyMap.JUSTIFY_CENTER="CenterJustify";
DwtKeyMap.JUSTIFY_LEFT="LeftJustify";
DwtKeyMap.JUSTIFY_RIGHT="RightJustify";
DwtKeyMap.NEXT="Next";
DwtKeyMap.NEXT_TAB="NextTab";
DwtKeyMap.NO="No";
DwtKeyMap.PAGE_UP="PageUp";
DwtKeyMap.PAGE_DOWN="PageDown";
DwtKeyMap.PARENTMENU="ParentMenu";
DwtKeyMap.PREV="Previous";
DwtKeyMap.PREV_TAB="PreviousTab";
DwtKeyMap.SELECT_ALL="SelectAll";
DwtKeyMap.SELECT="Select";
DwtKeyMap.SELECT_FIRST="SelectFirst";
DwtKeyMap.SELECT_LAST="SelectLast";
DwtKeyMap.SELECT_NEXT="SelectNext";
DwtKeyMap.SELECT_PREV="SelectPrevious";
DwtKeyMap.SUBMENU="SubMenu";
DwtKeyMap.SWITCH_MODE="SwitchMode";
DwtKeyMap.TEXT_BOLD="Bold";
DwtKeyMap.TEXT_ITALIC="Italic";
DwtKeyMap.TEXT_UNDERLINE="Underline";
DwtKeyMap.TEXT_STRIKETHRU="Strikethru";
DwtKeyMap.INSERT_LINK="InsertLink";
DwtKeyMap.YES="Yes";
DwtKeyMap.DELETE="Delete";
DwtKeyMap.GOTO_TAB_RE=new RegExp(DwtKeyMap.GOTO_TAB+"(\\d+)");
DwtKeyMap.JOIN="+";
DwtKeyMap.SEP=",";
DwtKeyMap.INHERIT="INHERIT";
DwtKeyMap.prototype.getMap=function(){
return this._map
};
DwtKeyMap.prototype._load=function(w,h){
var m=AjxEnv.platform.toLowerCase();
for(var r in h){
var d=r.split(".");
var s=d[d.length-1];
if(s=="win"||s=="mac"||s=="linux"){
if(s==m){
var g=d.slice(0,d.length-1).join(".");
h[g]=h[r]
}
h[r]=null
}}
for(var r in h){
var n=AjxStringUtil.trim(h[r]);
if(!n||(typeof h[r]!="string")){
continue
}
var d=r.split(".");
var e=d[d.length-1];
var t=(d.length==2);
var u=t?null:d[1];
if(d[0]=="keys"){
this._processKeyDef(u,e,n);
continue
}
if(e!=DwtKeyMap.INHERIT&&e!="keycode"){
continue
}
var c=d[0];
if((this._checkedMap[c]===false)||(!this._checkedMap[c]&&!this._checkMap(c))){
continue
}
if(!w[c]){
w[c]={}
}
if(!this._checkAction(c,u)){
continue
}
var o=n.split(/\s*;\s*/);
for(var f=0;
f<o.length;
f++){
var v=this._canonicalize(o[f]);
if(e==DwtKeyMap.INHERIT){
var y=v.split(/\s*,\s*/);
var a=[];
for(var l=0;
l<y.length;
l++){
a[l]=y[l]
}
w[c][d[1]]=a.join(",")
}else{
if(e=="keycode"){
w[c][v]=u
}}}}};
DwtKeyMap.prototype._checkMap=function(t){
var e=true;
this._checkedMap[t]=e;
return e
};
DwtKeyMap.prototype._checkAction=function(e,t){
return true
};
DwtKeyMap.prototype._processKeyDef=function(e,a,t){
if(!e||!a||!t){
return
}
if(a=="display"){
DwtKeyMap[e.toUpperCase()]=t
}else{
if(a=="keycode"){
DwtKeyMap.IS_MODIFIER[t]=true
}}};
DwtKeyMap.prototype._canonicalize=function(r){
var n=r.split(DwtKeyMap.SEP);
var e=[];
for(var a=0;
a<n.length;
a++){
var t=n[a];
var s=t.split(DwtKeyMap.JOIN);
if(s.length>2){
var o=s.slice(0,s.length-1);
o.sort(function(d,l){
var c=DwtKeyMap.MOD_ORDER[d]||0;
var h=DwtKeyMap.MOD_ORDER[l]||0;
return Number(c-h)
}
);
o.push(s[s.length-1]);
e.push(o.join(DwtKeyMap.JOIN))
}else{
e.push(t)
}}
return e.join(",")
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyMapMgr")){
DwtKeyMapMgr=function(a){
var t=this._map=a.getMap();
this._args=a._args;
this._fsas={};
for(var e in t){
this._fsas[e]=DwtKeyMapMgr.__buildFSA({}
,t[e],e)
}};
DwtKeyMapMgr.NOT_A_TERMINAL=-999;
DwtKeyMapMgr.TAB_KEYCODE=9;
DwtKeyMapMgr.prototype.toString=function(){
return"DwtKeyMapMgr"
};
DwtKeyMapMgr.prototype.getActionCode=function(a,r,h){
var e=this._fsas[r];
if(!e){
return null
}
var s=a.length;
var c=e;
var l;
for(var t=0;
t<s&&c;
t++){
l=a[t];
if(!c||!c[l]){
break
}
if(t<s-1){
c=c[l].subMap
}}
if(c&&c[l]){
var n=c[l];
if(!n.subMap||h){
var o=this.__getInheritedActionCode(a,e,h);
return o==DwtKeyMapMgr.NOT_A_TERMINAL?DwtKeyMapMgr.NOT_A_TERMINAL:(n.actionCode||o)
}else{
return DwtKeyMapMgr.NOT_A_TERMINAL
}}else{
return this.__getInheritedActionCode(a,e,h)
}};
DwtKeyMapMgr.prototype.getAction=function(t,e){
return this._map[t][e]
};
DwtKeyMapMgr.prototype.getKeySequences=function(t,a){
var e=[];
for(var o in this._map[t]){
if(this._map[t][o]==a){
e.push(o)
}}
return e
};
DwtKeyMapMgr.prototype.setMapping=function(t,e,a){
this._map[t][e]=a
};
DwtKeyMapMgr.prototype.removeMapping=function(t,e){
delete this._map[t][e]
};
DwtKeyMapMgr.prototype.replaceMapping=function(a,e,t){
var o=this._map[a][e];
if(!o){
return
}
this.removeMapping(a,e);
this.setMapping(a,t,o)
};
DwtKeyMapMgr.prototype.setArg=function(t,a,e){
if(!this._args[t]){
this._args[t]={}
}
this._args[t][a]=e
};
DwtKeyMapMgr.prototype.removeArg=function(e,t){
delete this._args[e][t]
};
DwtKeyMapMgr.prototype.getArg=function(e,t){
return this._args[e]?this._args[e][t]:null
};
DwtKeyMapMgr.prototype.reloadMap=function(e){
this._fsas[e]=DwtKeyMapMgr.__buildFSA({}
,this._map[e],e)
};
DwtKeyMapMgr.prototype.getAncestors=function(o,n){
n=n||[];
var e=this._fsas[o];
var t=e&&e.inherit;
if(t&&t.length){
for(var a=0;
a<t.length;
a++){
n.push(t[a]);
n=this.getAncestors(t[a],n)
}}
return n
};
DwtKeyMapMgr.isInputElement=function(a){
if(!a){
return false
}
var t=a.ownerDocument?a.ownerDocument.designMode:null;
if(t&&(t.toLowerCase()=="on")){
return true
}
var e=a.tagName.toUpperCase();
return(e=="INPUT"||e=="TEXTAREA")
};
DwtKeyMapMgr.__buildFSA=function(l,e,n){
for(var a in e){
if(a==DwtKeyMap.INHERIT){
l.inherit=e[a].split(/\s*,\s*/);
continue
}
var o=a.split(DwtKeyMap.SEP);
var s=o.length;
var h=l;
for(var t=0;
t<s;
t++){
var r=o[t];
if(!h[r]){
h[r]={}
}
if(t==s-1){
h[r].actionCode=e[a]
}else{
if(!h[r].subMap){
h[r].subMap={}
}
h=h[r].subMap
}}}
return l
};
DwtKeyMapMgr.prototype.__getInheritedActionCode=function(s,t,n){
if(t.inherit&&t.inherit.length){
var o=null;
var e=t.inherit.length;
for(var a=0;
a<e;
a++){
o=this.getActionCode(s,t.inherit[a],n);
if(o!=null){
return o
}}}
return null
};
DwtKeyMapMgr.hasModifier=function(e){
return(e.altKey||e.ctrlKey||e.metaKey)
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyboardMgr")){
DwtKeyboardMgr=function(e){
DwtKeyboardMgr.__shell=e;
this.__tabGrpStack=[];
this.__defaultHandlerStack=[];
this.__tabGroupChangeListenerObj=new AjxListener(this,this.__tabGrpChangeListener);
this.__kbEventStatus=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
this.__keyTimeout=750;
this.__currTabGroup=null;
this.__currDefaultHandler=null;
this._evtMgr=new AjxEventMgr()
};
DwtKeyboardMgr.prototype.isDwtKeyboardMgr=true;
DwtKeyboardMgr.prototype.toString=function(){
return"DwtKeyboardMgr"
};
DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED=1;
DwtKeyboardMgr.__KEYSEQ_HANDLED=2;
DwtKeyboardMgr.__KEYSEQ_PENDING=3;
DwtKeyboardMgr.FOCUS_FIELD_ID="kbff";
DwtKeyboardMgr.isPossibleInputShortcut=function(e){
var t=DwtUiEvent.getTarget(e);
return(!DwtKeyMap.IS_MODIFIER[e.keyCode]&&(e.keyCode==27||DwtKeyMapMgr.hasModifier(e))||(t&&t.nodeName.toUpperCase()=="INPUT"&&(e.keyCode==13||e.keyCode==3)))
};
DwtKeyboardMgr.prototype.pushTabGroup=function(t){
if(!this.__keyboardHandlingInited||!t){
return
}
this.__tabGrpStack.push(t);
this.__currTabGroup=t;
var e=t.getFocusMember();
if(!e){
e=t.resetFocusMember(true)
}
if(!e){
return
}
t.addFocusChangeListener(this.__tabGroupChangeListenerObj);
this.grabFocus(e)
};
DwtKeyboardMgr.prototype.popTabGroup=function(r){
if(!this.__keyboardHandlingInited){
return
}
if(!r){
return
}
if(this.__tabGrpStack.length<=1){
return null
}
if(r&&this.__tabGrpStack[this.__tabGrpStack.length-1]!=r){
var t=this.__tabGrpStack;
var e=t.length;
for(var s=e-1;
s>=0;
s--){
if(r==t[s]){
t[s].dump();
break
}}
if(s<0){
return null
}else{
if(s!=e-1){
t.splice(s,1);
return r
}}}
var r=this.__tabGrpStack.pop();
r.removeFocusChangeListener(this.__tabGroupChangeListenerObj);
var n=null;
if(this.__tabGrpStack.length>0){
n=this.__tabGrpStack[this.__tabGrpStack.length-1];
var o=n.getFocusMember();
if(!o){
o=n.resetFocusMember(true)
}
if(o){
this.grabFocus(o)
}}
this.__currTabGroup=n;
return r
};
DwtKeyboardMgr.prototype.setTabGroup=function(t){
var e=this.popTabGroup();
this.pushTabGroup(t);
return e
};
DwtKeyboardMgr.prototype.getCurrentTabGroup=function(){
return this.__currTabGroup
};
DwtKeyboardMgr.prototype.pushDefaultHandler=function(e){
if(!this.__enabled||!this.__keyboardHandlingInited||!e){
return
}
this.__defaultHandlerStack.push(e);
this.__currDefaultHandler=e
};
DwtKeyboardMgr.prototype.popDefaultHandler=function(){
if(!this.__keyboardHandlingInited||(this.__defaultHandlerStack.length<=1)){
return
}
var e=this.__defaultHandlerStack.pop();
this.__currDefaultHandler=this.__defaultHandlerStack[this.__defaultHandlerStack.length-1];
return e
};
DwtKeyboardMgr.prototype.grabFocus=function(e){
if(typeof e=="string"){
e=document.getElementById(e)
}
if(!e){
return
}
if(this.__currTabGroup){
this.__currTabGroup.setFocusMember(e,false,true)
}
this.__doGrabFocus(e)
};
DwtKeyboardMgr.prototype.inputGotFocus=function(e){
this.__focusObj=e;
this.__dwtInputCtrl=true;
this.__dwtCtrlHasFocus=false;
if(this.__currTabGroup){
this.__currTabGroup.setFocusMember(e.getTabGroupMember(),false,true)
}};
DwtKeyboardMgr.prototype.getFocusObj=function(e){
return this.__focusObj
};
DwtKeyboardMgr.prototype.dwtControlHasFocus=function(e){
return(this.__dwtCtrlHasFocus&&this.__focusObj==e)
};
DwtKeyboardMgr.prototype.registerDefaultKeyActionHandler=function(e){
if(!this.__enabled){
return
}
this.__defaultKeyActionHdlr=e
};
DwtKeyboardMgr.prototype.registerKeyMap=function(e){
if(!this.__checkStatus()){
return
}
this.__keyMapMgr=new DwtKeyMapMgr(e)
};
DwtKeyboardMgr.prototype.setKeyTimeout=function(e){
this.__keyTimeout=e
};
DwtKeyboardMgr.prototype.clearKeySeq=function(){
this.__killKeySeqTimedActionId=-1;
this.__keySequence=[]
};
DwtKeyboardMgr.prototype.enable=function(e){
this.__enabled=e;
if(e){
this.__checkStatus();
Dwt.setHandler(document,DwtEvent.ONKEYDOWN,DwtKeyboardMgr.__keyDownHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYUP,DwtKeyboardMgr.__keyUpHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYPRESS,DwtKeyboardMgr.__keyPressHdlr)
}else{
Dwt.clearHandler(document,DwtEvent.ONKEYDOWN);
Dwt.clearHandler(document,DwtEvent.ONKEYUP);
Dwt.clearHandler(document,DwtEvent.ONKEYPRESS)
}};
DwtKeyboardMgr.prototype.isEnabled=function(){
return this.__enabled
};
DwtKeyboardMgr.prototype.addListener=function(e,t){
this._evtMgr.addListener(e,t)
};
DwtKeyboardMgr.prototype.removeListener=function(e,t){
this._evtMgr.removeListener(e,t)
};
DwtKeyboardMgr.prototype.__initKeyboardHandling=function(){
var e=this._kbFocusField=document.createElement("textarea");
e.id=DwtKeyboardMgr.FOCUS_FIELD_ID;
e.tabIndex=0;
e.style.position=Dwt.ABSOLUTE_STYLE;
e.style.top=e.style.left=Dwt.LOC_NOWHERE;
e.onblur=DwtKeyboardMgr.__onBlurHdlr;
e.onfocus=DwtKeyboardMgr.__onFocusHdlr;
document.body.appendChild(e);
this.__killKeySeqTimedAction=new AjxTimedAction(this,this.__killKeySequenceAction);
this.__killKeySeqTimedActionId=-1;
this.__keySequence=[];
this.__keyboardHandlingInited=true
};
DwtKeyboardMgr.prototype.__checkStatus=function(){
if(!this.__enabled){
return false
}
if(!this.__keyboardHandlingInited){
this.__initKeyboardHandling()
}
return true
};
DwtKeyboardMgr.prototype.__doGrabFocus=function(e){
if(!e){
return
}
var o=e.isInputControl;
if(o||!(e instanceof DwtControl)){
if(this.__focusObj instanceof DwtControl&&!this.__dwtInputCtrl){
this.__oldFocusObj=this.__focusObj
}
this.__focusObj=e;
this.__dwtInputCtrl=o;
var a=o?e.getInputElement():e;
if((!AjxEnv.isIE&&e.focus)||(AjxEnv.isIE&&e.focus&&!a.disabled&&Dwt.getVisible(a))){
try{
e.focus()
}
catch(t){}}}else{
if(this.__dwtCtrlHasFocus&&(this.__focusObj instanceof DwtControl)){
DwtKeyboardMgr.__onBlurHdlr();
this.__dwtCtrlHasFocus=true
}
this.__focusObj=e;
this.__dwtInputCtrl=false;
if(this.__dwtCtrlHasFocus){
DwtKeyboardMgr.__onFocusHdlr()
}else{
DwtKeyboardMgr.__onFocusHdlr();
if(this.__enabled){
this._kbFocusField.focus()
}}}};
DwtKeyboardMgr.__onFocusHdlr=function(t){
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
a.__dwtCtrlHasFocus=true;
var e=a.__focusObj;
if(e&&e.__doFocus){
e.__doFocus()
}};
DwtKeyboardMgr.__onBlurHdlr=function(t){
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
var e=a.__oldFocusObj||a.__focusObj;
if(e&&e.__doBlur){
e.__doBlur()
}
a.__oldFocusObj=null;
a.__dwtCtrlHasFocus=false
};
DwtKeyboardMgr.__keyUpHdlr=function(e){
e=DwtUiEvent.getEvent(e);
var t=DwtKeyboardMgr.__shell.getKeyboardMgr();
if(t._evtMgr.notifyListeners(DwtEvent.ONKEYUP,e)===false){
return false
}
if(AjxEnv.isMac&&AjxEnv.isGeckoBased&&e.keyCode==0){
return DwtKeyboardMgr.__keyDownHdlr(e)
}else{
return DwtKeyboardMgr.__handleKeyEvent(e)
}};
DwtKeyboardMgr.__keyPressHdlr=function(e){
e=DwtUiEvent.getEvent(e);
var t=DwtKeyboardMgr.__shell.getKeyboardMgr();
if(t._evtMgr.notifyListeners(DwtEvent.ONKEYPRESS,e)===false){
return false
}
DwtKeyEvent.geckoCheck(e);
return DwtKeyboardMgr.__handleKeyEvent(e)
};
DwtKeyboardMgr.__handleKeyEvent=function(e){
if(DwtKeyboardMgr.__shell._blockInput){
return false
}
e=DwtUiEvent.getEvent(e,this);
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
var t=DwtShell.keyEvent;
t.setFromDhtmlEvent(e);
if(a.__kbEventStatus!=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED){
return a.__processKeyEvent(e,t,false)
}};
DwtKeyboardMgr.__syncFocus=function(t,e){
if((e!=t._kbFocusField)&&t.__dwtCtrlHasFocus){
t._kbFocusField.focus()
}
if(!t.__dwtCtrlHasFocus){
if((e!=t.__focusObj)&&!t.__dwtInputCtrl){
if(t.__currTabGroup&&t.__currTabGroup.setFocusMember(e)){
t.__focusObj=e;
t.__oldFocusObj=null
}else{
return false
}}}
return true
};
DwtKeyboardMgr.__keyDownHdlr=function(h){
try{
h=DwtUiEvent.getEvent(h,this);
var e=DwtKeyboardMgr.__shell.getKeyboardMgr();
h.focusObj=null;
if(e._evtMgr.notifyListeners(DwtEvent.ONKEYDOWN,h)===false){
return false
}
if(DwtKeyboardMgr.__shell._blockInput){
return false
}
if(e&&!e.isEnabled()){
return true
}
if(!e||!e.__checkStatus()){
return false
}
var c=DwtShell.keyEvent;
c.setFromDhtmlEvent(h);
var l=DwtKeyEvent.getCharCode(h);
DwtKeyboardMgr.__shell.getToolTip().popdown();
var o=DwtKeyboardMgr.__syncFocus(e,c.target);
if(!o){}
if(l==DwtKeyMapMgr.TAB_KEYCODE){
if(e.__currTabGroup&&!DwtKeyMapMgr.hasModifier(c)){
if(!DwtMenu.menuShowing()){
if(o||e.__currTabGroup.getFocusMember()){
if(!c.shiftKey){
e.__currTabGroup.getNextFocusMember(true)
}else{
e.__currTabGroup.getPrevFocusMember(true)
}}else{
e.__currTabGroup.resetFocusMember(true)
}}
return e.__processKeyEvent(h,c,false,DwtKeyboardMgr.__KEYSEQ_HANDLED)
}else{
return e.__processKeyEvent(h,c,true,DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}}else{
if(e.__currTabGroup&&!o&&AjxEnv.isGecko&&c.target instanceof HTMLHtmlElement){
e.__currTabGroup.resetFocusMember(true)
}}
if(e.__dwtCtrlHasFocus){
e._kbFocusField.value=""
}
if(DwtKeyMap.IS_MODIFIER[l]||(!e.__dwtCtrlHasFocus&&(e.__killKeySeqTimedActionId==-1)&&c.target&&DwtKeyMapMgr.isInputElement(c.target)&&!c.target["data-hidden"]&&!DwtKeyboardMgr.isPossibleInputShortcut(c))){
return e.__processKeyEvent(h,c,true,DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}
if(e.__killKeySeqTimedActionId!=-1){
AjxTimedAction.cancelAction(e.__killKeySeqTimedActionId);
e.__killKeySeqTimedActionId=-1
}
var t=[];
if(c.altKey){
t.push(DwtKeyMap.ALT)
}
if(c.ctrlKey){
t.push(DwtKeyMap.CTRL)
}
if(c.metaKey){
t.push(DwtKeyMap.META)
}
if(c.shiftKey){
t.push(DwtKeyMap.SHIFT)
}
t.push(l);
e.__keySequence[e.__keySequence.length]=t.join(DwtKeyMap.JOIN);
var s=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
var a=h.focusObj||e.__focusObj;
if(a&&(a.handleKeyAction)&&(e.__dwtCtrlHasFocus||e.__dwtInputCtrl||(a.hasFocus&&a.hasFocus()))){
s=e.__dispatchKeyEvent(a,c);
while((s==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)&&a.parent&&a.parent.getKeyMapName){
a=a.parent;
s=e.__dispatchKeyEvent(a,c)
}}
if((s==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)&&e.__currDefaultHandler&&!(e.__currTabGroup&&e.__currTabGroup.isDefaultHandlingBlocked())){
s=e.__dispatchKeyEvent(e.__currDefaultHandler,c)
}
if(c.forcePropagate){
s=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
c.forcePropagate=false
}
e.__kbEventStatus=s;
var n=(s==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED);
if(s!=DwtKeyboardMgr.__KEYSEQ_PENDING){
e.clearKeySeq()
}
return e.__processKeyEvent(h,c,n)
}
catch(r){
AjxException.reportScriptError(r)
}};
DwtKeyboardMgr.prototype.__dispatchKeyEvent=function(n,s,a){
if(n&&n.handleKeyEvent){
var r=n.handleKeyEvent(s);
return r?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var o=(n&&n.getKeyMapName)?n.getKeyMapName():null;
if(!o){
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var t=this.__keyMapMgr.getActionCode(this.__keySequence,o,a);
if(t==DwtKeyMapMgr.NOT_A_TERMINAL){
this.__hdlr=n;
this.__mapName=o;
this.__ev=s;
this.__killKeySeqTimedActionId=AjxTimedAction.scheduleAction(this.__killKeySeqTimedAction,this.__keyTimeout);
return DwtKeyboardMgr.__KEYSEQ_PENDING
}else{
if(t!=null){
if(!n.handleKeyAction){
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var e=n.handleKeyAction(t,s);
return e?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}else{
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}}};
DwtKeyboardMgr.prototype.__killKeySequenceAction=function(){
this.__dispatchKeyEvent(this.__hdlr,this.__ev,true);
this.clearKeySeq()
};
DwtKeyboardMgr.prototype.__tabGrpChangeListener=function(e){
this.__doGrabFocus(e.newFocusMember)
};
DwtKeyboardMgr.prototype.__processKeyEvent=function(a,o,e,t){
if(t){
this.__kbEventStatus=t
}
o._stopPropagation=!e;
o._returnValue=e;
o.setToDhtmlEvent(a);
return e
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroup")){
DwtTabGroup=function(t,e){
this.__members=new AjxVector();
this.__parent=null;
this.__name=t;
this.__blockApplicationHandling=e;
this.__currFocusMember=null;
this.__evtMgr=new AjxEventMgr()
};
DwtTabGroup.NOT_ROOT_TABGROUP="NOT ROOT TAB GROUP";
DwtTabGroup.__changeEvt=new DwtTabGroupEvent();
DwtTabGroup.prototype.toString=function(){
return"DwtTabGroup"
};
DwtTabGroup.prototype.getName=function(){
return this.__name
};
DwtTabGroup.prototype.addFocusChangeListener=function(e){
this.__checkRoot();
this.__evtMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabGroup.prototype.removeFocusChangeListener=function(e){
this.__checkRoot();
this.__evtMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabGroup.prototype.addMember=function(n,a){
if(!n){
return
}
var t=(n instanceof Array)?n:[n];
for(var o=0,e=t.length;
o<e;
o++){
this.__members.add(t[o],a);
if(t[o] instanceof DwtTabGroup){
t[o].newParent(this)
}}};
DwtTabGroup.prototype.addMemberAfter=function(e,t){
this.addMember(e,this.__members.indexOf(t)+1)
};
DwtTabGroup.prototype.addMemberBefore=function(e,t){
this.addMember(e,this.__members.indexOf(t))
};
DwtTabGroup.prototype.removeMember=function(a,e,t){
return this.replaceMember(a,null,e,t)
};
DwtTabGroup.prototype.removeAllMembers=function(){
this.__members.removeAll()
};
DwtTabGroup.prototype.replaceMember=function(n,s,l,r,e,o){
var t=this.__getTabGroupForMember(n);
if(!t){
this.addMember(s);
return null
}
var h=this.__getRootTabGroup();
var a;
if(e){
a=e
}else{
if(h.__currFocusMember==n||((n instanceof DwtTabGroup)&&n.contains(h.__currFocusMember))){
if(s){
a=(s instanceof DwtTabGroup)?s.getFirstMember():s
}else{
a=this.__getPrevMember(n,l);
if(!a){
a=this.__getNextMember(n,l)
}}}}
if(a&&!o){
h.__currFocusMember=a;
if(!r){
this.__notifyListeners(a)
}}
return s?this.__members.replaceObject(n,s):this.__members.remove(n)
};
DwtTabGroup.prototype.contains=function(e){
return(Boolean(this.__getTabGroupForMember(e)))
};
DwtTabGroup.prototype.newParent=function(e){
this.__parent=e
};
DwtTabGroup.prototype.getFirstMember=function(e){
return this.__getLeftMostMember(e)
};
DwtTabGroup.prototype.getTabGroupMemberByName=function(t){
var e=this.__members.getArray();
for(var a=0;
a<e.length;
a++){
var o=e[a];
if(o instanceof DwtTabGroup&&o.getName()==t){
return o
}}};
DwtTabGroup.prototype.getLastMember=function(e){
return this.__getRightMostMember(e)
};
DwtTabGroup.prototype.getFocusMember=function(){
this.__checkRoot();
return this.__currFocusMember
};
DwtTabGroup.prototype.setFocusMember=function(o,e,t){
this.__checkRoot();
if(!this.__checkEnabled(o,e)){
return false
}
var a=this.__getTabGroupForMember(o);
if(a){
this.__currFocusMember=o;
if(!t){
this.__notifyListeners(this.__currFocusMember)
}
return true
}
return false
};
DwtTabGroup.prototype.getNextFocusMember=function(e,t){
this.__checkRoot();
return this.__setFocusMember(true,e,t)
};
DwtTabGroup.prototype.getPrevFocusMember=function(e,t){
this.__checkRoot();
return this.__setFocusMember(false,e,t)
};
DwtTabGroup.prototype.resetFocusMember=function(t,a){
this.__checkRoot();
var e=this.__getLeftMostMember(t);
if((e!=this.__currFocusMember)&&!a){
this.__notifyListeners(this.__currFocusMember)
}
this.__currFocusMember=e;
return this.__currFocusMember
};
DwtTabGroup.prototype.blockDefaultHandling=function(e){
this.__blockDefaultHandling=blockDefaultHandling
};
DwtTabGroup.prototype.isDefaultHandlingBlocked=function(e){
return this.__blockDefaultHandling
};
DwtTabGroup.prototype.dump=function(e){
if(!window.AjxDebug&&window.DBG){
return
}
this.__dump(this,e)
};
DwtTabGroup.prototype.size=function(){
return this.__members.size()
};
DwtTabGroup.prototype.__getPrevMember=function(s,t){
var e=this.__members.getArray();
for(var o=this.__members.indexOf(s)-1;
o>-1;
o--){
var n=e[o];
if(!(n instanceof DwtTabGroup)){
if(this.__checkEnabled(n,t)){
return n
}}else{
n=n.__getRightMostMember(t);
if(n&&this.__checkEnabled(n,t)){
return n
}}}
return this.__parent?this.__parent.__getPrevMember(this,t):null
};
DwtTabGroup.prototype.__checkEnabled=function(t,e){
if(!e){
return true
}
if(!t||t.noTab){
return false
}
if(t instanceof DwtControl){
return(t.getEnabled()&&t.getVisible())
}else{
return !t.disabled&&Dwt.getVisible(t)
}};
DwtTabGroup.prototype.__getNextMember=function(r,t){
var e=this.__members.getArray();
var s=this.__members.size();
for(var n=this.__members.indexOf(r)+1;
n<s;
n++){
var o=e[n];
if(!(o instanceof DwtTabGroup)){
if(this.__checkEnabled(o,t)){
return o
}}else{
o=o.__getLeftMostMember(t);
if(o&&this.__checkEnabled(o,t)){
return o
}}}
return this.__parent?this.__parent.__getNextMember(this,t):null
};
DwtTabGroup.prototype.__getRightMostMember=function(t){
var e=this.__members.getArray();
var n=null;
for(var o=this.__members.size()-1;
o>=0;
o--){
n=e[o];
if(!(n instanceof DwtTabGroup)){
if(this.__checkEnabled(n,t)){
break
}}else{
n=n.__getRightMostMember(t);
if(n&&this.__checkEnabled(n,t)){
break
}}}
return(n&&this.__checkEnabled(n,t))?n:null
};
DwtTabGroup.prototype.__getLeftMostMember=function(t){
var n=this.__members.size();
var e=this.__members.getArray();
var s=null;
for(var o=0;
o<n;
o++){
s=e[o];
if(!(s instanceof DwtTabGroup)){
if(this.__checkEnabled(s,t)){
break
}}else{
s=s.__getLeftMostMember(t);
if(s&&this.__checkEnabled(s,t)){
break
}}}
return(s&&this.__checkEnabled(s,t))?s:null
};
DwtTabGroup.prototype.__notifyListeners=function(t){
var a=this.__getRootTabGroup();
if(a.__evtMgr){
var e=DwtTabGroup.__changeEvt;
e.reset();
e.tabGroup=this;
e.newFocusMember=t;
a.__evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,e)
}};
DwtTabGroup.prototype.__getRootTabGroup=function(){
var e=this;
while(e.__parent){
e=e.__parent
}
return e
};
DwtTabGroup.prototype.__dump=function(n,t,h){
h=h||0;
var r="";
for(var o=0;
o<h;
o++){
r+="&nbsp;&nbsp;&nbsp;&nbsp;"
}
t=t||AjxDebug.DBG1;
r+="&nbsp;&nbsp;&nbsp;&nbsp;";
var s=n.__members.size();
var e=n.__members.getArray();
for(var o=0;
o<s;
o++){
if(e[o] instanceof DwtTabGroup){
n.__dump(e[o],t,h+1)
}else{
if(e[o].toString){}else{}}}};
DwtTabGroup.prototype.__setFocusMember=function(n,t,a){
if(!this.__currFocusMember){
return this.resetFocusMember(t,a)
}
var o=this.__getTabGroupForMember(this.__currFocusMember);
if(!o){
return null
}
var e=(n)?o.__getNextMember(this.__currFocusMember,t):o.__getPrevMember(this.__currFocusMember,t);
if(!e){
e=(n)?this.__getLeftMostMember(t):this.__getRightMostMember(t);
if(e==this.__currFocusMember){
return null
}}
this.__currFocusMember=e;
if(!a){
this.__notifyListeners(this.__currFocusMember)
}
return this.__currFocusMember
};
DwtTabGroup.prototype.__getTabGroupForMember=function(s){
if(!s){
return null
}
var n=this.__members.size();
var t=this.__members.getArray();
var e;
for(var o=0;
o<n;
o++){
e=t[o];
if(e==s){
return this
}else{
if(e instanceof DwtTabGroup&&(e=e.__getTabGroupForMember(s))){
return e
}}}
return null
};
DwtTabGroup.prototype.__checkRoot=function(){
if(this.__parent){
throw DwtTabGroup.NOT_ROOT_TABGROUP
}}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragEvent")){
DwtDragEvent=function(){
this.operation=null;
this.srcControl=null;
this.action=null;
this.doIt=false;
this.srcData=null
};
DwtDragEvent.DRAG_INIT="INIT";
DwtDragEvent.DRAG_START="START";
DwtDragEvent.SET_DATA="SET_DATA";
DwtDragEvent.DRAG_MOVE="MOVE";
DwtDragEvent.DRAG_END="END";
DwtDragEvent.DRAG_CANCEL="CANCEL"
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragSource")){
DwtDragSource=function(e){
this.__supportedOps=e;
this.__evtMgr=new AjxEventMgr()
};
DwtDragSource.__DRAG_LISTENER="DwtDragSource.__DRAG_LISTENER";
DwtDragSource.__dragEvent=new DwtDragEvent();
DwtDragSource.prototype.toString=function(){
return"DwtDragSource"
};
DwtDragSource.prototype.addDragListener=function(e){
this.__evtMgr.addListener(DwtDragSource.__DRAG_LISTENER,e)
};
DwtDragSource.prototype.removeDragListener=function(e){
this.__evtMgr.removeListener(DwtDragSource.__DRAG_LISTENER,e)
};
DwtDragSource.prototype._beginDrag=function(e,t){
if(!(this.__supportedOps&e)){
return Dwt.DND_DROP_NONE
}
DwtDragSource.__dragEvent.operation=e;
DwtDragSource.__dragEvent.srcControl=t;
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_START;
DwtDragSource.__dragEvent.srcData=null;
DwtDragSource.__dragEvent.doit=true;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.operation
};
DwtDragSource.prototype._getData=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.SET_DATA;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.srcData
};
DwtDragSource.prototype._endDrag=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_END;
DwtDragSource.__dragEvent.doit=false;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.doit
};
DwtDragSource.prototype._cancelDrag=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_CANCEL;
DwtDragSource.__dragEvent.doit=false;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.doit
}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDropEvent")){
DwtDropEvent=function(){
this.operation=null;
this.targetControl=null;
this.action=null;
this.srcData=null;
this.doIt=false
};
DwtDropEvent.DRAG_ENTER=1;
DwtDropEvent.DRAG_LEAVE=2;
DwtDropEvent.DRAG_OP_CHANGED=3;
DwtDropEvent.DRAG_DROP=4
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDropTarget")){
DwtDropTarget=function(t){
this._evtMgr=new AjxEventMgr();
this.__hasMultiple=false;
this._types={};
if(typeof t=="string"){
t=[t]
}
if(t&&t.length){
for(var e=0;
e<t.length;
e++){
this.addTransferType(t[e])
}}};
DwtDropTarget.__DROP_LISTENER="DwtDropTarget.__DROP_LISTENER";
DwtDropTarget.__dropEvent=new DwtDropEvent();
DwtDropTarget.prototype.toString=function(){
return"DwtDropTarget"
};
DwtDropTarget.prototype.addDropListener=function(e){
this._evtMgr.addListener(DwtDropTarget.__DROP_LISTENER,e)
};
DwtDropTarget.prototype.removeDropListener=function(e){
this._evtMgr.removeListener(DwtDropTarget.__DROP_LISTENER,e)
};
DwtDropTarget.prototype.isValidTarget=function(t){
if(t instanceof Array){
var e=t.length;
for(var a=0;
a<e;
a++){
if(!this.__checkTarget(t[a])){
return false
}}
return true
}else{
return this.__checkTarget(t)
}};
DwtDropTarget.prototype.markAsMultiple=function(){
this.__hasMultiple=true
};
DwtDropTarget.prototype.hasMultipleTargets=function(){
return this.__hasMultiple
};
DwtDropTarget.prototype.getTransferTypes=function(){
return this._types
};
DwtDropTarget.prototype.addTransferType=function(e){
this._types[e]=null
};
DwtDropTarget.prototype._dragEnter=function(e,a,n,t,o){
DwtDropTarget.__dropEvent.operation=e;
DwtDropTarget.__dropEvent.targetControl=a;
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_ENTER;
DwtDropTarget.__dropEvent.srcData=n;
DwtDropTarget.__dropEvent.uiEvent=t;
DwtDropTarget.__dropEvent.doIt=true;
DwtDropTarget.__dropEvent.dndProxy=o;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype._dragLeave=function(){
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_LEAVE;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent)
};
DwtDropTarget.prototype._dragOpChanged=function(e){
DwtDropTarget.__dropEvent.operation=e;
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_OP_CHANGED;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype._drop=function(t,e){
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_DROP;
DwtDropTarget.__dropEvent.srcData=t;
DwtDropTarget.__dropEvent.uiEvent=e;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype.__checkTarget=function(item){
if(this._types){
for(var i in this._types){
var ctor;
if(this._types[i]){
ctor=this._types[i]
}else{
ctor=this._types[i]=eval(i)
}
if(ctor&&(typeof ctor=="function")&&(item instanceof ctor)){
return true
}}
return false
}}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragBox")){
DwtDragBox=function(){
this.__evtMgr=new AjxEventMgr()
};
DwtDragBox.__DRAG_LISTENER="DwtDragBox.__DRAG_LISTENER";
DwtDragBox.__dragEvent=new DwtDragEvent();
DwtDragBox.prototype.toString=function(){
return"DwtDragBox"
};
DwtDragBox.prototype.addDragListener=function(e){
this.__evtMgr.addListener(DwtDragBox.__DRAG_LISTENER,e)
};
DwtDragBox.prototype.removeDragListener=function(e){
this.__evtMgr.removeListener(DwtDragBox.__DRAG_LISTENER,e)
};
DwtDragBox.prototype._setStart=function(e,t){
this._startX=e.docX;
this._startY=e.docY;
this._dragObj=DwtDragBox.__dragEvent.srcControl=t;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_INIT;
DwtDragBox.__dragEvent.target=e.target;
return(this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)!==false)
};
DwtDragBox.prototype._beginDrag=function(e){
e._dragging=DwtControl._DRAGGING;
DwtDragBox.__dragEvent.srcControl=e;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_START;
this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)
};
DwtDragBox.prototype._dragMove=function(s,r){
var o=s.docX-this._startX;
var t=s.docY-this._startY;
var a=(o>0)?this._startX:s.docX;
var e=(t>0)?this._startY:s.docY;
var n=r.getDragSelectionBox();
Dwt.setLocation(n,a,e);
Dwt.setSize(n,Math.abs(o),Math.abs(t));
DwtDragBox.__dragEvent.srcControl=r;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_MOVE;
this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)
};
DwtDragBox.prototype._endDrag=function(e){
e._dragging=DwtControl._NO_DRAG;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_END;
if(!this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)){
e.destroyDragSelectionBox()
}
this._dragObj=null
};
DwtDragBox.prototype.getStartX=function(){
return this._startX
};
DwtDragBox.prototype.getStartY=function(){
return this._startY
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtHoverMgr")){
DwtHoverMgr=function(){
this._hoverOverAction=new AjxTimedAction(this,this._notifyHoverOver);
this._hoverOutAction=new AjxTimedAction(this,this._notifyHoverOut);
this._ignoreHoverOverOnClickAction=new AjxTimedAction(this,this._resetIgnoreHoverOverOnClick)
};
DwtHoverMgr.prototype.isDwtHoverMgr=true;
DwtHoverMgr.prototype.toString=function(){
return"DwtHoverMgr"
};
DwtHoverMgr.prototype._hoverObject;
DwtHoverMgr.prototype._hoverOverDelay=750;
DwtHoverMgr.prototype._hoverOverData;
DwtHoverMgr.prototype._hoverOverAction;
DwtHoverMgr.prototype._hoverOverActionId=-1;
DwtHoverMgr.prototype._hoverOverListener;
DwtHoverMgr.prototype._hoverOutDelay=50;
DwtHoverMgr.prototype._ignoreHoverOverOnClickDelay=750;
DwtHoverMgr.prototype._hoverOutData;
DwtHoverMgr.prototype._hoverOutAction;
DwtHoverMgr.prototype._hoverOutActionId=-1;
DwtHoverMgr.prototype._hoverOutListener;
DwtHoverMgr.prototype._isHovering=false;
DwtHoverMgr.prototype.setHoverObject=function(e){
this._hoverObject=e
};
DwtHoverMgr.prototype.getHoverObject=function(){
return this._hoverObject
};
DwtHoverMgr.prototype.reset=function(){
this._hoverObject=null;
this._hoverOverDelay=DwtHoverMgr.prototype._hoverOverDelay;
this._hoverOverData=null;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
this._hoverOverActionId=-1;
this._hoverOverListener=null;
this._hoverOutDelay=DwtHoverMgr.prototype._hoverOutDelay;
this._hoverOutData=null;
if(this._hoverOutActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOutActionId);
this._notifyHoverOut()
}
this._hoverOutActionId=-1;
this._hoverOutListener=null
};
DwtHoverMgr.prototype.isHovering=function(){
return this._isHovering
};
DwtHoverMgr.prototype.setHoverOverDelay=function(e){
this._hoverOverDelay=e
};
DwtHoverMgr.prototype.setHoverOverData=function(e){
this._hoverOverData=e
};
DwtHoverMgr.prototype.setHoverOverListener=function(e){
this._hoverOverListener=e
};
DwtHoverMgr.prototype.setHoverOutDelay=function(e){
this._hoverOutDelay=e
};
DwtHoverMgr.prototype.setHoverOutData=function(e){
this._hoverOutData=e
};
DwtHoverMgr.prototype.setHoverOutListener=function(e){
this._hoverOutListener=e
};
DwtHoverMgr.prototype.ignoreHoverOverOnClick=function(){
this._ignoreHoverOverOnClick=true;
AjxTimedAction.scheduleAction(this._ignoreHoverOverOnClickAction,this._ignoreHoverOverOnClickDelay)
};
DwtHoverMgr.prototype._resetIgnoreHoverOverOnClick=function(){
this._ignoreHoverOverOnClick=false
};
DwtHoverMgr.prototype.hoverOver=function(e,t){
if(this._ignoreHoverOverOnClick){
return
}
this._isHovering=true;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
this._hoverOverAction.args=[e,t];
this._hoverOverActionId=AjxTimedAction.scheduleAction(this._hoverOverAction,this._hoverOverDelay)
};
DwtHoverMgr.prototype.hoverOut=function(){
this._isHovering=false;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
if(this._hoverOutActionId==-1){
if(this._hoverOutDelay>0){
this._hoverOutActionId=AjxTimedAction.scheduleAction(this._hoverOutAction,this._hoverOutDelay)
}else{
this._notifyHoverOut()
}}};
DwtHoverMgr.prototype._notifyHoverOver=function(){
this._hoverOverActionId=-1;
if(this._hoverOverListener!=null){
var e=this._hoverOverAction.args[0];
var a=this._hoverOverAction.args[1];
var t=new DwtHoverEvent(DwtEvent.HOVEROVER,this._hoverOverDelay,this._hoverOverData,e,a);
this._hoverOverListener.handleEvent(t)
}};
DwtHoverMgr.prototype._notifyHoverOut=function(){
this._hoverOutActionId=-1;
if(this._hoverOutListener!=null){
var e=new DwtHoverEvent(DwtEvent.HOVEROUT,this._hoverOutDelay,this._hoverOutData);
this._hoverOutListener.handleEvent(e)
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtControl")){
DwtControl=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtControl.PARAMS);
var e=this.parent=t.parent;
if(e&&!(e.isDwtComposite)){
throw new DwtException("Parent must be a subclass of Composite",DwtException.INVALIDPARENT,"DwtControl")
}
this.shell=null;
this._data={};
this._eventMgr=new AjxEventMgr();
this._disposed=false;
if(!e){
return
}
this._className=t.className||"DwtControl";
this.__posStyle=t.posStyle;
if(t.id){
this._htmlElId=t.id
}
this.__index=t.index;
this.__parentElement=t.parentElement;
this._enabled=false;
this._dragging=null;
this._dndProxy=null;
this._hasFocus=false;
if(!t.deferred){
this.__initCtrl()
}
this._hoverOverListener=new AjxListener(this,this.__handleHoverOver);
this._hoverOutListener=new AjxListener(this,this.__handleHoverOut);
this._dblClickIsolation=false;
this._ignoreInternalOverOut=false;
this.TEMPLATE=t.template||this.TEMPLATE
};
DwtControl.prototype.isDwtControl=true;
DwtControl.prototype.toString=function(){
return"DwtControl"
};
DwtControl.PARAMS=["parent","className","posStyle","deferred","id","index","template"];
DwtControl.ALL_BY_ID={};
DwtControl.NORMAL="";
DwtControl.ACTIVE="ZActive";
DwtControl.FOCUSED="ZFocused";
DwtControl.DISABLED="ZDisabled";
DwtControl.HOVER="ZHover";
DwtControl.SELECTED="ZSelected";
DwtControl.DEFAULT="ZDefault";
DwtControl.ERROR="ZError";
DwtControl._RE_STATES=new RegExp("\\b("+[DwtControl.ACTIVE,DwtControl.FOCUSED,DwtControl.DISABLED,DwtControl.HOVER,DwtControl.SELECTED,DwtControl.DEFAULT,DwtControl.ERROR].join("|")+")\\b","g");
DwtControl.useBrowserTooltips=false;
DwtControl.STATIC_STYLE=Dwt.STATIC_STYLE;
DwtControl.ABSOLUTE_STYLE=Dwt.ABSOLUTE_STYLE;
DwtControl.RELATIVE_STYLE=Dwt.RELATIVE_STYLE;
DwtControl.FIXED_STYLE=Dwt.FIXED_STYLE;
DwtControl.CLIP=Dwt.CLIP;
DwtControl.VISIBLE=Dwt.VISIBLE;
DwtControl.SCROLL=Dwt.SCROLL;
DwtControl.FIXED_SCROLL=Dwt.FIXED_SCROLL;
DwtControl.DEFAULT=Dwt.DEFAULT;
DwtControl._NO_DRAG="NO_DRAG";
DwtControl._DRAGGING="DRAGGING";
DwtControl._DRAG_REJECTED="DRAG_REJECTED";
DwtControl.__DRAG_THRESHOLD=3;
DwtControl.__TOOLTIP_THRESHOLD=5;
DwtControl.__DND_HOVER_DELAY=750;
DwtControl.__controlEvent=new DwtControlEvent();
DwtControl.__DBL_CLICK_TIMEOUT=300;
DwtControl.prototype._displayState="";
DwtControl.prototype.addControlListener=function(e){
this.addListener(DwtEvent.CONTROL,e)
};
DwtControl.prototype.removeControlListener=function(e){
this.removeListener(DwtEvent.CONTROL,e)
};
DwtControl.prototype.addDisposeListener=function(e){
this.addListener(DwtEvent.DISPOSE,e)
};
DwtControl.prototype.removeDisposeListener=function(e){
this.removeListener(DwtEvent.DISPOSE,e)
};
DwtControl.prototype.addListener=function(t,a,e){
return this._eventMgr.addListener(t,a,e)
};
DwtControl.prototype.removeListener=function(e,t){
return this._eventMgr.removeListener(e,t)
};
DwtControl.prototype.removeAllListeners=function(e){
return this._eventMgr.removeAll(e)
};
DwtControl.prototype.isListenerRegistered=function(e){
return this._eventMgr.isListenerRegistered(e)
};
DwtControl.prototype.notifyListeners=function(e,t){
return this._eventMgr.notifyListeners(e,t)
};
DwtControl.prototype.dispose=function(){
if(this._disposed){
return
}
if(this.parent&&this.parent.isDwtComposite){
this.parent.removeChild(this)
}
this._elRef=null;
if(DwtControl.ALL_BY_ID){
DwtControl.ALL_BY_ID[this._htmlElId]=null;
delete DwtControl.ALL_BY_ID[this._htmlElId]
}
this._disposed=true;
var e=new DwtDisposeEvent();
e.dwtObj=this;
this.notifyListeners(DwtEvent.DISPOSE,e);
this._eventMgr.clearAllEvents()
};
DwtControl.prototype.getDocument=function(){
return document
};
DwtControl.prototype.getTabGroupMember=function(){
return this
};
DwtControl.prototype.getData=function(e){
return this._data[e]
};
DwtControl.prototype.setData=function(e,t){
this._data[e]=t
};
DwtControl.prototype.isDisposed=function(){
return this._disposed
};
DwtControl.prototype.isInitialized=function(){
return this.__ctrlInited
};
DwtControl.prototype.focus=function(){
DwtShell.getShell(window).getKeyboardMgr().grabFocus(this);
this.__doFocus()
};
DwtControl.prototype.blur=function(){
this.__doBlur()
};
DwtControl.prototype.hasFocus=function(){
return this._hasFocus
};
DwtControl.prototype.handleKeyAction=function(e,t){
return false
};
DwtControl.prototype.reparent=function(t,e){
if(!this._checkState()){
return
}
var a=this.getHtmlElement();
this.parent.removeChild(this,true);
DwtComposite._pendingElements[this._htmlElId]=a;
t.addChild(this,e);
this.parent=t
};
DwtControl.prototype.reparentHtmlElement=function(a,e){
if(typeof a=="string"){
a=document.getElementById(a)
}
if(!a){
return
}
var t=this.getHtmlElement();
if(e==null){
a.appendChild(t)
}else{
if(typeof e=="object"){
a.insertBefore(t,e)
}else{
if(a.childNodes[e]){
a.insertBefore(t,a.childNodes[e])
}else{
a.appendChild(t)
}}}};
DwtControl.prototype.setHandler=function(t,e){
if(!this._checkState()){
return
}
var a=this.getHtmlElement();
Dwt.setHandler(a,t,e)
};
DwtControl.prototype.clearHandler=function(e){
if(!this._checkState()){
return
}
var t=this.getHtmlElement();
Dwt.clearHandler(t,e)
};
DwtControl.prototype.getBounds=function(){
if(!this._checkState()){
return
}
return Dwt.getBounds(this.getHtmlElement())
};
DwtControl.prototype.setBounds=function(a,s,o,t){
if(!this._checkState()){
return
}
var n=this.getHtmlElement();
if(this.isListenerRegistered(DwtEvent.CONTROL)){
this.__controlEvent.reset(DwtControlEvent.RESIZE|DwtControlEvent.MOVE);
var e=Dwt.getBounds(n);
this.__controlEvent.oldX=e.x;
this.__controlEvent.oldY=e.y;
this.__controlEvent.oldWidth=e.width;
this.__controlEvent.oldHeight=e.height;
this.setLocation(a,s);
this.setSize(o,t);
e=Dwt.getBounds(n);
this.__controlEvent.newX=e.x;
this.__controlEvent.newY=e.y;
this.__controlEvent.newWidth=(AjxUtil.isNumber(o))?o:e.width;
this.__controlEvent.newHeight=(AjxUtil.isNumber(t))?t:e.height;
this.__controlEvent.requestedWidth=o;
this.__controlEvent.requestedHeight=t;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
this.setLocation(a,s);
this.setSize(o,t)
}
return this
};
DwtControl.prototype.getClassName=function(){
return this._className
};
DwtControl.prototype.setClassName=function(t){
if(!this._checkState()){
return
}
this._className=t;
var e=this.getHtmlElement();
e.className=t;
Dwt.addClass(e,this._displayState)
};
DwtControl.prototype.addClassName=function(e){
Dwt.addClass(this.getHtmlElement(),e)
};
DwtControl.prototype.delClassName=function(e,t){
Dwt.delClass(this.getHtmlElement(),e,t)
};
DwtControl.prototype.condClassName=function(a,e,t){
Dwt.condClass(this.getHtmlElement(),a,e,t)
};
DwtControl.prototype.setDisplayState=function(o){
if(!this._enabled){
o=DwtControl.DISABLED
}
if(arguments.length>1){
var e=[];
for(var t=0;
t<arguments.length;
t++){
e.push(arguments[t])
}
o=e.join(" ")
}
if(this._displayState!=o){
this._displayState=o;
Dwt.delClass(this.getHtmlElement(),DwtControl._RE_STATES,o)
}};
DwtControl.prototype.showAlert=function(e){
if(e&&!this._alert){
this.delClassName(null,"ZAlert")
}else{
if(!e&&this._alert){
this.delClassName("ZAlert",null)
}}
this._alert=e
};
DwtControl.prototype.isAlertShown=function(){
return this._alert
};
DwtControl.prototype._createHtmlFromTemplate=function(e,a){
this.getHtmlElement().innerHTML=AjxTemplate.expand(e,a);
var o=AjxTemplate.getParams(e);
var t=o&&o["class"];
if(t){
t=[this._className,t].join(" ");
this.setClassName(t)
}};
DwtControl.prototype.getCursor=function(){
if(!this._checkState()){
return
}
return Dwt.getCursor(this.getHtmlElement())
};
DwtControl.prototype.setCursor=function(e){
if(!this._checkState()){
return
}
Dwt.setCursor(this.getHtmlElement(),e)
};
DwtControl.prototype.getDragSource=function(){
return this._dragSource
};
DwtControl.prototype.setDragSource=function(e){
this._dragSource=e;
if(e&&!this._ctrlCaptureObj){
this.__initCapture();
this._dndHoverAction=new AjxTimedAction(null,this.__dndDoHover)
}};
DwtControl.prototype.getDropTarget=function(){
return this._dropTarget
};
DwtControl.prototype.setDropTarget=function(e){
this._dropTarget=e
};
DwtControl.prototype.getDragBox=function(){
return this._dragBox
};
DwtControl.prototype.setDragBox=function(e){
this._dragBox=e;
if(e&&!this._ctrlCaptureObj){
this.__initCapture()
}};
DwtControl.prototype.__initCapture=function(e){
this._ctrlCaptureObj=new DwtMouseEventCapture({
targetObj:this,id:"DwtControl",mouseOverHdlr:DwtControl.__mouseOverHdlr,mouseDownHdlr:DwtControl.__mouseDownHdlr,mouseMoveHdlr:DwtControl.__mouseMoveHdlr,mouseUpHdlr:DwtControl.__mouseUpHdlr,mouseOutHdlr:DwtControl.__mouseOutHdlr}
)
};
DwtControl.prototype.getEnabled=function(){
if(!this._checkState()){
return
}
return this._enabled
};
DwtControl.prototype.setEnabled=function(e,t){
if(!this._checkState()){
return
}
if(e!=this._enabled){
this._enabled=e;
this.setDisplayState(e?DwtControl.NORMAL:DwtControl.DISABLED);
if(t){
this.getHtmlElement().disabled=!e
}}};
DwtControl.prototype.getHTMLElId=function(){
return this._htmlElId
};
DwtControl.prototype.getHtmlElement=function(){
if(!this._checkState()){
return
}
var e=this._elRef||document.getElementById(this._htmlElId);
if(e==null){
e=DwtComposite._pendingElements[this._htmlElId]
}else{
if(!e._rendered){
delete DwtComposite._pendingElements[this._htmlElId];
e._rendered=true
}}
return this._elRef=e
};
DwtControl.fromElement=function(e){
return DwtControl.ALL_BY_ID&&DwtControl.ALL_BY_ID[e.id]
};
DwtControl.fromElementId=function(e){
return DwtControl.ALL_BY_ID&&DwtControl.ALL_BY_ID[e]
};
DwtControl.findControl=function(a){
if(AjxEnv.isFirefox3_5up&&!AjxEnv.isFirefox3_6up){
var t=HTMLElement.prototype.toString.call(a);
if(t=="[xpconnect wrapped native prototype]"||t=="[object XULElement]"){
return null
}}
try{
while(a){
if(a.id&&DwtControl.ALL_BY_ID&&DwtControl.ALL_BY_ID[a.id]){
return DwtControl.ALL_BY_ID[a.id]
}
a=a.parentNode
}}
catch(o){}
return null
};
DwtControl.getTargetControl=function(e,a){
var t=DwtUiEvent.getTarget(e,a);
return t?DwtControl.findControl(t):null
};
DwtControl.prototype.setHtmlElementId=function(t){
if(this._disposed){
return
}
if(this.__ctrlInited){
var e=this.getHtmlElement();
if(!e._rendered){
delete DwtComposite._pendingElements[this._htmlElId];
DwtComposite._pendingElements[t]=e
}else{
delete DwtControl.ALL_BY_ID[this._htmlElId];
DwtControl.ALL_BY_ID[t]=this
}
e.id=t
}
this._htmlElId=t
};
DwtControl.prototype.getX=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement()).x
};
DwtControl.prototype.getXW=function(){
if(!this._checkState()){
return
}
var e=this.getBounds();
return e.x+e.width
};
DwtControl.prototype.getY=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement()).y
};
DwtControl.prototype.getYH=function(){
if(!this._checkState()){
return
}
var e=this.getBounds();
return e.y+e.height
};
DwtControl.prototype.getPosition=function(){
if(!this._checkState()){
return
}
return Dwt.getPosition(this.getHtmlElement())
};
DwtControl.prototype.setPosition=function(e){
if(!this._checkState()){
return
}
return Dwt.setPosition(this.getHtmlElement(),e)
};
DwtControl.prototype.getLocation=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement())
};
DwtControl.prototype.setLocation=function(e,o){
if(!this._checkState()){
return
}
if(this.isListenerRegistered(DwtEvent.CONTROL)){
var t=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.MOVE);
var a=Dwt.getLocation(t);
this.__controlEvent.oldX=a.x;
this.__controlEvent.oldY=a.y;
Dwt.setLocation(t,e,o);
a=Dwt.getLocation(t);
this.__controlEvent.newX=a.x;
this.__controlEvent.newY=a.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
Dwt.setLocation(this.getHtmlElement(),e,o)
}
return this
};
DwtControl.prototype.getScrollStyle=function(){
if(!this._checkState()){
return
}
return Dwt.getScrollStyle(this.getHtmlElement())
};
DwtControl.prototype.setScrollStyle=function(e){
if(!this._checkState()){
return
}
Dwt.setScrollStyle(this.getHtmlElement(),e)
};
DwtControl.prototype.setPosition=function(e){
if(!this._checkState()){
return
}
if(e==DwtControl.STATIC_STYLE||e==DwtControl.ABSOLUTE_STYLE||e==DwtControl.RELATIVE_STYLE){
this.__posStyle=e;
Dwt.setPosition(this.getHtmlElement(),e)
}};
DwtControl.prototype.getW=function(){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement()).x
};
DwtControl.prototype.getH=function(){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement()).y
};
DwtControl.prototype.getSize=function(e){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement(),null,e)
};
DwtControl.prototype.setSize=function(t,e){
if(!this._checkState()){
return
}
if(this.isListenerRegistered(DwtEvent.CONTROL)){
var o=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.RESIZE);
var a=Dwt.getSize(o);
this.__controlEvent.oldWidth=a.x;
this.__controlEvent.oldHeight=a.y;
Dwt.setSize(o,t,e);
a=Dwt.getSize(o);
this.__controlEvent.newWidth=a.x;
this.__controlEvent.newHeight=a.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
Dwt.setSize(this.getHtmlElement(),t,e)
}
return this
};
DwtControl.prototype.getToolTipContent=function(e){
if(this._disposed){
return null
}
return this.__toolTipContent
};
DwtControl.prototype.setToolTipContent=function(t,e){
if(this._disposed){
return
}
if(t&&(typeof(t)=="string")&&DwtControl.useBrowserTooltips){
if(!t||(!t.match(/[\n\r\t]/)&&!t.match(/<[a-zA-Z]+/))){
var a=this.getHtmlElement();
if(a){
a.title=t;
this._browserToolTip=true;
return
}}}
this._browserToolTip=false;
this.__toolTipContent=t
};
DwtControl.prototype.getVisible=function(){
if(!this._checkState()){
return
}
return Dwt.getVisible(this.getHtmlElement())
};
DwtControl.prototype.setVisible=function(e){
if(!this._checkState()){
return
}
Dwt.setVisible(this.getHtmlElement(),e)
};
DwtControl.prototype.setVisibility=function(e){
if(!this._checkState()){
return
}
Dwt.setVisibility(this.getHtmlElement(),e)
};
DwtControl.prototype.getVisibility=function(){
if(!this._checkState()){
return
}
return Dwt.getVisiblility(this.getHtmlElement())
};
DwtControl.prototype.getZIndex=function(){
if(!this._checkState()){
return
}
return Dwt.getZIndex(this.getHtmlElement())
};
DwtControl.prototype.setZIndex=function(e){
if(!this._checkState()){
return
}
Dwt.setZIndex(this.getHtmlElement(),e)
};
DwtControl.prototype.zShow=function(e){
this.setZIndex(e?Dwt.Z_VIEW:Dwt.Z_HIDDEN)
};
DwtControl.prototype.setDisplay=function(e){
if(!this._checkState()){
return
}
Dwt.setDisplay(this.getHtmlElement(),e)
};
DwtControl.prototype.preventSelection=function(e){
return !this.__isInputEl(e)
};
DwtControl.prototype.preventContextMenu=function(e){
return e?(!this.__isInputEl(e)):true
};
DwtControl.prototype.setContent=function(e){
if(e){
this.getHtmlElement().innerHTML=e
}};
DwtControl.prototype.clearContent=function(){
this.getHtmlElement().innerHTML=""
};
DwtControl.prototype.appendElement=function(t){
var e=AjxUtil.isString(t)?document.getElementById(t):t;
if(e){
e.appendChild(this.getHtmlElement(),e)
}};
DwtControl.prototype.replaceElement=function(o,e,n){
var t=AjxUtil.isString(o)?document.getElementById(o):o;
if(t){
var a=this.getHtmlElement();
t.parentNode.replaceChild(a,t);
this._replaceElementHook(t,a,e,n)
}};
DwtControl.prototype._replaceElementHook=function(a,n,t,h){
if((t==null||t)&&a.className){
Dwt.addClass(n,a.className)
}
if(h==null||h){
var o=a.getAttribute("style")||a.style;
if(o){
if(AjxUtil.isString(o)){
n.setAttribute("style",[n.getAttribute("style"),o].join(";"))
}else{
for(var s in o){
if(o[s]){
try{
n.style[s]=o[s]
}
catch(r){}}}}}}};
DwtControl.prototype._blur=function(){};
DwtControl.prototype._focus=function(){};
DwtControl.prototype._focusByMouseUpEvent=function(e){
if(this.getEnabled()){
this.focus()
}};
DwtControl.prototype._focusByMouseDownEvent=function(e){
this._duringFocusByMouseDown=true;
this._focusByMouseUpEvent(e);
this._duringFocusByMouseDown=false
};
DwtControl.prototype._getDragOp=function(e){
return e.ctrlKey?Dwt.DND_DROP_COPY:Dwt.DND_DROP_MOVE
};
DwtControl.prototype._getDragProxy=function(e){
return null
};
DwtControl.prototype.getDragSelectionBox=function(e){
if(!this._dragSelectionBox){
var t=this._dragSelectionBox=document.createElement("div");
t.className="dndSelectionBox";
Dwt.setPosition(t,Dwt.ABSOLUTE_STYLE);
this.shell.getHtmlElement().appendChild(t);
Dwt.setZIndex(t,Dwt.Z_DND)
}
return this._dragSelectionBox
};
DwtControl.prototype._setDragProxyState=function(e){
if(this._dndProxy){
Dwt.condClass(this._dndProxy,e,DwtCssStyle.DROPPABLE,DwtCssStyle.NOT_DROPPABLE)
}};
DwtControl.__junkIconId=0;
DwtControl.prototype._destroyDragProxy=function(e){
if(e){
if(e.parentNode){
e.parentNode.removeChild(e)
}else{
e.style.zIndex=-100;
e.id="DwtJunkIcon"+DwtControl.__junkIconId++;
e=null
}}};
DwtControl.prototype.destroyDragSelectionBox=function(){
var e=this._dragSelectionBox;
if(e&&e.parentNode){
e.parentNode.removeChild(e)
}
this._dragSelectionBox=null
};
DwtControl.prototype._isValidDragObject=function(e){
return true
};
DwtControl.prototype._dragEnter=function(e){};
DwtControl.prototype._dragOver=function(e){};
DwtControl.prototype._dragHover=function(e){};
DwtControl.prototype._dragLeave=function(e){};
DwtControl.prototype._drop=function(e){};
DwtControl.prototype._setKeyPressEventHdlr=function(e){
this._setEventHdlrs([DwtEvent.ONKEYPRESS],e)
};
DwtControl.prototype._setMouseEventHdlrs=function(e){
this._setEventHdlrs(DwtEvent.MOUSE_EVENTS,e)
};
DwtControl.prototype._setEventHdlrs=function(a,e){
if(!this._checkState()){
return
}
var o=this.getHtmlElement();
for(var t=0;
t<a.length;
t++){
if(e!==true){
Dwt.setHandler(o,a[t],DwtControl.__HANDLER[a[t]])
}else{
Dwt.clearHandler(o,a[t])
}}};
DwtControl.prototype._setMouseEvents=function(){
var e=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART];
if(AjxEnv.isIE){
e.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{
e.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
this._setEventHdlrs(e)
};
DwtControl.prototype._setMouseEvent=function(t,e){
t.reset();
e.ersatz=true;
DwtUiEvent.copy(t,e);
t.button=e.button
};
DwtControl.prototype._getStopPropagationValForMouseEv=function(e){
return true
};
DwtControl.prototype._getEventReturnValForMouseEv=function(e){
return false
};
DwtControl.prototype._checkState=function(){
if(this._disposed){
return false
}
if(!this.__ctrlInited){
this.__initCtrl()
}
return true
};
DwtControl.prototype._position=function(o){
this._checkState();
var a=this.shell.getSize();
var t=this.getSize();
var e,n;
if(!o){
e=Math.round((a.x-t.x)/2);
n=Math.round((a.y-t.y)/2)
}else{
e=o.x;
n=o.y
}
if((e+t.x)>a.x){
e=a.x-t.x
}
if((n+t.y)>a.y){
n=a.y-t.y
}
this.setLocation(e,n)
};
DwtControl._dndScrollCallback=function(a,r){
var t=a.container;
if(!t){
return
}
var d=r.dwtObj&&r.dwtObj._dndScrollId;
if(r.type=="mouseup"||!d||(a.id&&d!=a.id)){
if(t._dndScrollActionId!=-1){
AjxTimedAction.cancelAction(t._dndScrollActionId);
t._dndScrollActionId=-1
}
return
}
t._scrollAmt=0;
if(t.clientHeight<t.scrollHeight){
var o=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y;
var u=o+t.scrollTop;
var h=t.scrollTop;
var l=r.docY-u;
var n=(t.clientWidth<t.scrollWidth)?a.threshold+Dwt.SCROLLBAR_WIDTH:a.threshold;
var s=(l<=n)?-1*a.amount:0;
if(s==0){
var e=Dwt.getSize(t,DwtPoint.tmp).y;
var c=u+e;
l=c-r.docY;
s=(l<=n)?a.amount:0
}
t._scrollAmt=s;
if(s){
if(!t._dndScrollAction){
t._dndScrollAction=new AjxTimedAction(null,DwtControl._dndScroll,[a]);
t._dndScrollActionId=-1
}
if(t._dndScrollActionId==-1){
t._dndScrollActionId=AjxTimedAction.scheduleAction(t._dndScrollAction,0)
}}else{
if(t._dndScrollActionId!=-1){
AjxTimedAction.cancelAction(t._dndScrollActionId);
t._dndScrollActionId=-1
}}}};
DwtControl._dndScroll=function(n){
var t=n.container;
var o=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y;
var a=Dwt.getSize(t,DwtPoint.tmp).y;
var e=t.scrollTop;
if((t._scrollAmt<0&&e>0)||(t._scrollAmt>0&&(e+a<t.scrollHeight))){
t.scrollTop+=t._scrollAmt;
t._dndScrollActionId=AjxTimedAction.scheduleAction(t._dndScrollAction,n.interval)
}};
DwtControl.__keyPressHdlr=function(a){
var o=o?o:DwtControl.getTargetControl(a);
if(!o){
return false
}
if(o.__hasToolTipContent()){
var t=DwtShell.getShell(window);
var e=t.getHoverMgr();
e.setHoverOutListener(o._hoverOutListener);
e.hoverOut();
o.__tooltipClosed=false
}};
DwtControl.prototype.__hasToolTipContent=function(){
if(this._disposed){
return false
}
return Boolean(!this._browserToolTip&&(this.__toolTipContent||(this.getToolTipContent!=DwtControl.prototype.getToolTipContent)))
};
DwtControl.prototype.__doBlur=function(){
this._hasFocus=false;
if(this.isListenerRegistered(DwtEvent.ONBLUR)){
var e=DwtShell.focusEvent;
e.dwtObj=this;
e.state=DwtFocusEvent.BLUR;
obj.notifyListeners(DwtEvent.ONBLUR,mouseEv)
}
this._blur()
};
DwtControl.prototype.__doFocus=function(){
this._hasFocus=true;
if(this.isListenerRegistered(DwtEvent.ONFOCUS)){
var e=DwtShell.focusEvent;
e.dwtObj=this;
e.state=DwtFocusEvent.FOCUS;
obj.notifyListeners(DwtEvent.ONFOCUS,mouseEv)
}
this._focus()
};
DwtControl.__clickHdlr=function(t){
try{
return DwtControl.__mouseEvent(t,DwtEvent.ONCLICK)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__dblClickHdlr=function(t){
try{
var a=DwtControl.getTargetControl(t);
if(a&&a._dblClickIsolation){
a._clickPending=false;
AjxTimedAction.cancelAction(a._dblClickActionId)
}
return DwtControl.__mouseEvent(t,DwtEvent.ONDBLCLICK)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__mouseOverHdlr=function(s,r){
try{
var a=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
if(a!=null){
s=DwtUiEvent.getEvent(s);
s._stopPropagation=true;
return false
}
var t=DwtControl.getTargetControl(s);
if(!t){
return false
}
r=r||DwtEvent.ONMOUSEOVER;
if((r==DwtEvent.ONMOUSEOVER)&&t._ignoreInternalOverOut){
var l=DwtControl.getTargetControl(s,true);
if(t==l){
return false
}}
var h=DwtShell.mouseEvent;
if(t._dragging==DwtControl._NO_DRAG){
h.setFromDhtmlEvent(s,t);
h.hoverStarted=false;
if(t.isListenerRegistered(r)){
t.notifyListeners(r,h)
}
if(t.__hasToolTipContent(h)&&!h.hoverStarted){
var o=DwtShell.getShell(window);
var e=o.getHoverMgr();
if((!e.isHovering()||e.getHoverObject()!=t)&&!DwtMenu.menuShowing()){
e.reset();
e.setHoverObject(t);
e.setHoverOverData(h);
e.setHoverOverDelay(DwtToolTip.TOOLTIP_DELAY);
e.setHoverOverListener(t._hoverOverListener);
e.hoverOver(h.docX,h.docY)
}}}
h._stopPropagation=true;
h._returnValue=false;
h.setToDhtmlEvent(s);
return false
}
catch(n){
AjxException.reportScriptError(n)
}};
DwtControl.__mouseEnterHdlr=function(e){
return DwtControl.__mouseOverHdlr(e,DwtEvent.ONMOUSEENTER)
};
DwtControl.__mouseDownHdlr=function(n){
try{
var s=DwtControl.getTargetControl(n);
if(!s){
return false
}
n=DwtUiEvent.getEvent(n);
var o=DwtShell.mouseEvent;
o.setFromDhtmlEvent(n,s);
if(o.button==DwtMouseEvent.LEFT){
s._focusByMouseDownEvent(n);
o.setFromDhtmlEvent(n,s)
}
if(s.__hasToolTipContent()){
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
t.setHoverOutListener(s._hoverOutListener);
t.hoverOut()
}
if(s._dragSource&&(o.button==DwtMouseEvent.LEFT)&&s._isValidDragObject(o)){
try{
s._ctrlCaptureObj.capture()
}
catch(e){}
s._dragOp=s._getDragOp(o);
s.__dragStartX=o.docX;
s.__dragStartY=o.docY
}else{
if(s._dragBox){
if(s._dragBox._setStart(o,s)){
try{
s._ctrlCaptureObj.capture()
}
catch(e){}}}}
return DwtControl.__mouseEvent(n,DwtEvent.ONMOUSEDOWN,s,o)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__mouseMoveHdlr=function(m){
try{
var r=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var s=r?r.targetObj:DwtControl.getTargetControl(m);
if(!s){
return false
}
if(s.__dndHoverActionId!=-1){
AjxTimedAction.cancelAction(s.__dndHoverActionId);
s.__dndHoverActionId=-1
}
var f=DwtShell.mouseEvent;
f.setFromDhtmlEvent(m,r?true:s);
if(f.docX<0||f.docY<0){
f._stopPropagation=true;
f._returnValue=false;
f.setToDhtmlEvent(m);
return false
}
var d=(s._dragSource&&r&&(Math.abs(s.__dragStartX-f.docX)>=DwtControl.__DRAG_THRESHOLD||Math.abs(s.__dragStartY-f.docY)>=DwtControl.__DRAG_THRESHOLD));
var p=(r&&s._dragBox&&s._dragBox._dragObj==s);
if(!d&&!p){
if(s.__hasToolTipContent()){
var l=DwtShell.getShell(window);
var a=l.getHoverMgr();
if(!s.__tooltipClosed&&!DwtMenu.menuShowing()){
a.hoverOver(f.docX,f.docY)
}else{
var o=s.__lastTooltipX?Math.abs(f.docX-s.__lastTooltipX):null;
var t=s.__lastTooltipY?Math.abs(f.docY-s.__lastTooltipY):null;
if((o!=null&&o>DwtControl.__TOOLTIP_THRESHOLD)||(t!=null&&t>DwtControl.__TOOLTIP_THRESHOLD)){
a.setHoverOutListener(s._hoverOutListener);
a.hoverOut();
s.__tooltipClosed=true
}}}
return DwtControl.__mouseEvent(m,DwtEvent.ONMOUSEMOVE,s,f)
}else{
if(s._dragging==DwtControl._NO_DRAG){
if(s._dragSource){
s._dragOp=s._dragSource._beginDrag(s._dragOp,s);
if(s._dragOp!=Dwt.DND_DROP_NONE){
s._dragging=DwtControl._DRAGGING;
s._dndProxy=s._getDragProxy(s._dragOp);
Dwt.addClass(s._dndProxy,"DwtDragProxy");
if(!s._dndProxy){
s._dragging=DwtControl._DRAG_REJECTED
}}else{
s._dragging=DwtControl._DRAG_REJECTED
}}else{
if(s._dragBox){
s._dragging=DwtControl._DRAGGING;
s._dragBox._beginDrag(s)
}}}
if(s._dragging!=DwtControl._DRAG_REJECTED){
var c=f.dwtObj;
if(s._dragSource){
var e=c&&c._dropTarget;
var g=s.__lastTargetObj;
if(c){
s._dndHoverAction.args=[c];
s.__dndHoverActionId=AjxTimedAction.scheduleAction(s._dndHoverAction,DwtControl.__DND_HOVER_DELAY)
}
if(c&&e&&((c!=s)||e.hasMultipleTargets())){
if(c!=g||e.hasMultipleTargets()){
var n=s._dragSource._getData();
if(e._dragEnter(s._dragOp,c,n,f,s._dndProxy)){
s._setDragProxyState(true);
s.__dropAllowed=true;
c._dragEnter(f)
}else{
s._setDragProxyState(false);
s.__dropAllowed=false
}}else{
if(s.__dropAllowed){
c._dragOver(f)
}}}else{
s._setDragProxyState(false)
}
if(g&&g!=c&&g._dropTarget&&g!=s){
if(c&&!c._dndScrollCallback&&g._dndScrollCallback){
g._dndScrollCallback.run(f)
}
g._dragLeave(f);
g._dropTarget._dragLeave()
}
s.__lastTargetObj=c;
if((c!=s)&&c&&c._dndScrollCallback){
c._dndScrollCallback.run(f)
}
Dwt.setLocation(s._dndProxy,f.docX+2,f.docY+2)
}else{
if(s._dragBox){
var h=DwtUiEvent.getTarget(m);
if(c&&(Dwt.isAncestor(s.getHtmlElement(),h)||h==s._dragSelectionBox)){
s._dragBox._dragMove(f,s)
}}}}else{
DwtControl.__mouseEvent(m,DwtEvent.ONMOUSEMOVE,s,f)
}
f._stopPropagation=true;
f._returnValue=false;
f.setToDhtmlEvent(m);
return false
}}
catch(u){
AjxException.reportScriptError(u)
}};
DwtControl.__mouseUpHdlr=function(o){
try{
var s=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var n=s?s.targetObj:DwtControl.getTargetControl(o);
if(!n){
return false
}
if(n.__dndHoverActionId!=-1){
AjxTimedAction.cancelAction(n.__dndHoverActionId);
n.__dndHoverActionId=-1
}
var a=DwtShell.mouseEvent;
a.setFromDhtmlEvent(o,s?true:n);
if(!(s&&(n._dragSource||n._dragBox))){
return DwtControl.__processMouseUpEvent(o,n,a)
}else{
s.release();
if(n._dragging!=DwtControl._DRAGGING){
n._dragging=DwtControl._NO_DRAG;
return DwtControl.__processMouseUpEvent(o,n,a)
}
if(n._dragSource){
n.__lastTargetObj=null;
var t=a.dwtObj;
var r=t&&t._dropTarget;
if(t&&r&&n.__dropAllowed&&((t!=n)||r.hasMultipleTargets())){
t._drop(a);
r._drop(n._dragSource._getData(),a);
n._dragSource._endDrag();
n._destroyDragProxy(n._dndProxy);
n._dragging=DwtControl._NO_DRAG
}else{
DwtControl.__badDrop(n,a)
}
if(t&&t._dndScrollCallback){
t._dndScrollCallback.run(a)
}}else{
if(n._dragBox){
n._dragBox._endDrag(n)
}}
a._stopPropagation=true;
a._returnValue=false;
a.setToDhtmlEvent(o);
return false
}}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__badDrop=function(o,a){
if(o._dragSource){
o._dragSource._cancelDrag()
}
var t=a.dwtObj;
if(t){
t._drop(a)
}
o.__dragEndX=a.docX;
o.__dragEndY=a.docY;
if(o.__badDropAction==null){
o.__badDropAction=new AjxTimedAction(o,o.__badDropEffect)
}
var e=(o.__dragEndY-o.__dragStartY)/(o.__dragEndX-o.__dragStartX);
o.__badDropAction.args=[e,o.__dragStartY-(e*o.__dragStartX),(o.__dragStartX-o.__dragEndX<0)?-1:1];
AjxTimedAction.scheduleAction(o.__badDropAction,0)
};
DwtControl.__processMouseUpEvent=function(o,s,a){
var t=DwtShell.getShell(window);
var n=t.getHoverMgr();
n.ignoreHoverOverOnClick();
if(s._dblClickIsolation&&a&&(a.button==DwtMouseEvent.LEFT)){
if(s._clickPending){
return false
}else{
s._clickPending=true;
var e=new AjxTimedAction(null,DwtControl.__timedClick,[o,s,a]);
s._dblClickActionId=AjxTimedAction.scheduleAction(e,DwtControl.__DBL_CLICK_TIMEOUT);
DwtUiEvent.setBehaviour(o,true,false);
s._st=new Date();
return false
}}else{
s._clickPending=false;
return DwtControl.__mouseEvent(o,DwtEvent.ONMOUSEUP,s,a)
}};
DwtControl.__timedClick=function(t,a,e){
a._clickPending=false;
DwtControl.__mouseEvent(t,DwtEvent.ONMOUSEUP,a,e)
};
DwtControl.__mouseOutHdlr=function(s,n){
try{
var r=DwtControl.getTargetControl(s);
if(!r){
return false
}
n=n||DwtEvent.ONMOUSEOUT;
if((n==DwtEvent.ONMOUSEOUT)&&r._ignoreInternalOverOut){
var e=DwtControl.getTargetControl(s,true);
if(r==e){
return false
}}
if(r.__hasToolTipContent()){
var o=DwtShell.getShell(window);
var a=o.getHoverMgr();
a.setHoverOutListener(r._hoverOutListener);
a.hoverOut();
r.__tooltipClosed=false
}
return DwtControl.__mouseEvent(s,n||DwtEvent.ONMOUSEOUT,r)
}
catch(t){
AjxException.reportScriptError(t)
}};
DwtControl.__mouseLeaveHdlr=function(e){
return DwtControl.__mouseOutHdlr(e,DwtEvent.ONMOUSELEAVE)
};
DwtControl.__mouseWheelHdlr=function(t){
try{
var a=DwtControl.getTargetControl(t);
if(!a){
return false
}
return DwtControl.__mouseEvent(t,DwtEvent.ONMOUSEWHEEL,a)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__selectStartHdlr=function(t){
try{
return DwtControl.__mouseEvent(t,DwtEvent.ONSELECTSTART)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__contextMenuHdlr=function(a){
try{
if(AjxEnv.isSafari){
var o=DwtControl.getTargetControl(a);
var e=o?o.preventContextMenu():true;
if(e){
DwtControl.__mouseEvent(a,DwtEvent.ONMOUSEDOWN);
return DwtControl.__mouseEvent(a,DwtEvent.ONMOUSEUP)
}}
return DwtControl.__mouseEvent(a,DwtEvent.ONCONTEXTMENU)
}
catch(t){
AjxException.reportScriptError(t)
}};
DwtControl.__mouseEvent=function(o,t,n,a){
var n=n?n:DwtControl.getTargetControl(o);
if(!n){
return false
}
if(!a){
a=DwtShell.mouseEvent;
a.setFromDhtmlEvent(o,n)
}
var e=a.target.tagName&&a.target.tagName.toLowerCase();
if(!e||(e!="input"&&e!="textarea"&&e!="a")){
a._stopPropagation=true;
a._returnValue=false
}else{
a._stopPropagation=false;
a._returnValue=true
}
DwtEventManager.notifyListeners(t,a);
if(n.isListenerRegistered&&n.isListenerRegistered(t)){
n.notifyListeners(t,a)
}
a.setToDhtmlEvent(o);
return a._returnValue
};
DwtControl.__HANDLER={};
DwtControl.__HANDLER[DwtEvent.ONCONTEXTMENU]=DwtControl.__contextMenuHdlr;
DwtControl.__HANDLER[DwtEvent.ONCLICK]=DwtControl.__clickHdlr;
DwtControl.__HANDLER[DwtEvent.ONDBLCLICK]=DwtControl.__dblClickHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEDOWN]=DwtControl.__mouseDownHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEENTER]=DwtControl.__mouseEnterHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSELEAVE]=DwtControl.__mouseLeaveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEMOVE]=DwtControl.__mouseMoveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOUT]=DwtControl.__mouseOutHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOVER]=DwtControl.__mouseOverHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEUP]=DwtControl.__mouseUpHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEWHEEL]=DwtControl.__mouseWheelHdlr;
DwtControl.__HANDLER[DwtEvent.ONSELECTSTART]=DwtControl.__selectStartHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYPRESS]=DwtControl.__keyPressHdlr;
DwtControl.prototype.__initCtrl=function(){
this.shell=this.parent.shell||this.parent;
this._htmlElId=this.__internalId=this._htmlElId||Dwt.getNextId();
var e=this._elRef=this._createElement(this._htmlElId);
e.id=this._htmlElId;
if(DwtControl.ALL_BY_ID){
if(DwtControl.ALL_BY_ID[this._htmlElId]){
this._htmlElId=e.id=this.__internalId=DwtId.makeId(this._htmlElId,Dwt.getNextId())
}
DwtControl.ALL_BY_ID[this._htmlElId]=this
}
DwtComposite._pendingElements[this._htmlElId]=e;
e.style.position=this.__posStyle||DwtControl.STATIC_STYLE;
e.className=this._className;
e.style.overflow="visible";
this._enabled=true;
this.__controlEvent=DwtControl.__controlEvent;
this._dragging=DwtControl._NO_DRAG;
this.__ctrlInited=true;
this.parent.addChild(this,this.__index)
};
DwtControl.prototype._createElement=function(e){
return document.createElement("DIV")
};
DwtControl.prototype.__dndDoHover=function(e){
e._dragHover()
};
DwtControl.prototype.__badDropEffect=function(e,n,a){
var t=(Math.abs(e)<=1);
var o=t?this.__dragStartX-this.__dragEndX:this.__dragStartY-this.__dragEndY;
if(o*a>0&&!(this.__dragEndY==this.__dragStartY||this.__dragEndX==this.__dragStartX)){
if(t){
this.__dragEndX+=(30*a);
this._dndProxy.style.top=e*this.__dragEndX+n;
this._dndProxy.style.left=this.__dragEndX
}else{
this.__dragEndY+=(30*a);
this._dndProxy.style.top=this.__dragEndY;
this._dndProxy.style.left=(this.__dragEndY-n)/e
}
AjxTimedAction.scheduleAction(this.__badDropAction,0)
}else{
this._destroyDragProxy(this._dndProxy);
this._dragging=DwtControl._NO_DRAG
}};
DwtControl.prototype.__handleHoverOver=function(o){
if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROVER)){
this._eventMgr.notifyListeners(DwtEvent.HOVEROVER,o)
}
var a=o&&o.object;
var n=this.getToolTipContent(a);
var t,s;
if(!n){
t=""
}else{
if(typeof(n)=="string"){
t=n
}else{
if(n.isAjxCallback){
s=n
}else{
if(typeof(n)=="object"){
t=n.content;
s=n.callback
}}}}
if(!t&&s&&n.loading){
t=AjxMsg.loading
}
if(t){
this.__showToolTip(o,t)
}
if(s){
var e=new AjxCallback(this,this.__showToolTip,[o]);
AjxTimedAction.scheduleAction(new AjxTimedAction(null,function(){
s.run(e)
}
),0)
}};
DwtControl.prototype.__showToolTip=function(t,e){
if(!e){
return
}
DwtControl.showToolTip(e,t.x,t.y,this,t);
this.__lastTooltipX=t.x;
this.__lastTooltipY=t.y;
this.__tooltipClosed=false
};
DwtControl.prototype.__handleHoverOut=function(e){
if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROUT)){
this._eventMgr.notifyListeners(DwtEvent.HOVEROUT,e)
}
DwtControl.hideToolTip();
this.__lastTooltipX=null;
this.__lastTooltipY=null
};
DwtControl.prototype.__isInputEl=function(a){
var o=false;
if(!a||!a.tagName){
return o
}
var e=a.tagName.toLowerCase();
var t=e=="input"?a.type.toLowerCase():null;
if(e=="textarea"||(t&&(t=="text"||t=="password"))){
o=true
}
return o
};
DwtControl.ON_UNLOAD=function(){
var t=DwtControl.ALL_BY_ID,e;
for(e in t){
t[e]._elRef=null
}
DwtControl.ALL_BY_ID=null
};
if(AjxEnv.isIE){
window.attachEvent("onunload",DwtControl.ON_UNLOAD)
}else{
window.addEventListener("unload",DwtControl.ON_UNLOAD,false)
}
DwtControl.showToolTip=function(t,e,s,o,n){
if(!t){
return
}
var a=DwtShell.getShell(window).getToolTip();
a.setContent(t);
a.popup(e,s,false,false,o,n)
};
DwtControl.hideToolTip=function(){
DwtShell.getShell(window).getToolTip().popdown()
};
DwtControl.prototype.getTooltipBase=function(e){
return this.getHtmlElement()
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtComposite")){
DwtComposite=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtComposite.PARAMS);
e.className=e.className||"DwtComposite";
DwtControl.call(this,e);
this._children=new AjxVector()
};
DwtComposite.PARAMS=DwtControl.PARAMS.concat();
DwtComposite.prototype=new DwtControl;
DwtComposite.prototype.constructor=DwtComposite;
DwtComposite.prototype.isDwtComposite=true;
DwtComposite.prototype.toString=function(){
return"DwtComposite"
};
DwtComposite._pendingElements=new Object();
DwtComposite.prototype.dispose=function(){
if(this._disposed){
return
}
var e=this._children.getArray();
while(e.length>0){
e.pop().dispose()
}
DwtControl.prototype.dispose.call(this)
};
DwtComposite.prototype.getChildren=function(){
return this._children.getArray().slice(0)
};
DwtComposite.prototype.cleanupSeparators=function(){
var t=this.getChildren();
var a=true;
var n;
for(var o=0;
o<t.length;
o++){
var s=t[o];
var e=s.isStyle&&s.isStyle(DwtMenuItem.SEPARATOR_STYLE);
if(e){
s.setVisible(!a);
if(!a||!n){
a=true;
n=s
}
continue
}
if(s.getVisible()){
a=false
}}
if(a&&n){
n.setVisible(false)
}};
DwtComposite.prototype.getNumChildren=function(){
return this._children.size()
};
DwtComposite.prototype.removeChildren=function(){
var e=this._children.getArray();
while(e.length>0){
e[0].dispose()
}};
DwtComposite.prototype.clear=function(){
this.removeChildren();
this.getHtmlElement().innerHTML=""
};
DwtComposite.prototype.addChild=function(a,e){
this._children.add(a,e);
var t=a.getHtmlElement();
t.setAttribute("parentId",this._htmlElId);
if(this instanceof DwtShell&&this.isVirtual()){
document.body.appendChild(t)
}else{
a.reparentHtmlElement(a.__parentElement||this.getHtmlElement(),e);
a.__parentElement=null
}};
DwtComposite.prototype.removeChild=function(a){
if(a.isInitialized()){
this._children.remove(a);
var t=a.getHtmlElement();
if(t){
t.removeAttribute("parentId");
if(t.parentNode){
var e=t.parentNode.removeChild(t)
}}}};
DwtComposite.prototype._setAllowSelection=function(){
if(!this._allowSelection){
this._allowSelection=true;
this.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));
this.addListener(DwtEvent.ONCONTEXTMENU,new AjxListener(this,this._contextMenuListener))
}};
DwtComposite.prototype.preventSelection=function(e){
return this._allowSelection?false:DwtControl.prototype.preventSelection.call(this,e)
};
DwtComposite.prototype.preventContextMenu=function(a){
if(!this._allowSelection){
return DwtControl.prototype.preventContextMenu.apply(this,arguments)
}
var e=a?(a.id.indexOf("OBJ_")==0):false;
var t=false;
if(document.selection){
t=document.selection.type=="Text"
}else{
if(getSelection()){
t=getSelection().toString().length>0
}}
return(t&&!e)?false:true
};
DwtComposite.prototype._focusByMouseUpEvent=function(){
if(!this._allowSelection){
DwtControl.prototype._focusByMouseUpEvent.apply(this,arguments)
}};
DwtComposite.prototype._mouseDownListener=function(e){
if(e.button==DwtMouseEvent.LEFT){
e._stopPropagation=true;
e._returnValue=true
}};
DwtComposite.prototype._contextMenuListener=function(e){
e._stopPropagation=false;
e._returnValue=true
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtShell")){
DwtShell=function(n){
if(window._dwtShellId){
throw new DwtException("DwtShell already exists for window",DwtException.INVALID_OP,"DwtShell")
}
var a=n.className||"DwtShell";
DwtComposite.call(this,{
className:a}
);
this.__ctrlInited=true;
document.body.style.margin=0;
if(!n.docBodyScrollable){
if(AjxEnv.isIE){
document.body.onscroll=DwtShell.__onBodyScroll
}
document.body.style.overflow="hidden"
}
document.body.onselect=DwtShell._preventDefaultSelectPrt;
document.body.onselectstart=DwtShell._preventDefaultSelectPrt;
document.body.oncontextmenu=DwtShell._preventDefaultPrt;
window.onresize=DwtShell._resizeHdlr;
var o=document.createElement("div");
this._htmlElId=window._dwtShellId=o.id=n.id||Dwt.getNextId();
DwtControl.ALL_BY_ID[this._htmlElId]=this;
o.className=a;
o.style.width=o.style.height="100%";
if(o.style.overflow){
o.style.overflow=null
}
try{
if(n.userShell){
document.body.removeChild(n.userShell)
}}
catch(t){}
document.body.appendChild(o);
if(n.userShell){
var e=new DwtControl({
parent:this,posStyle:Dwt.ABSOLUTE_STYLE}
);
e.getHtmlElement().appendChild(n.userShell);
e.setSize("100%","100%");
e.zShow(true)
}
this.shell=this;
this._createBusyOverlay(o);
this._veilOverlay=document.createElement("div");
this._veilOverlay.className=(!AjxEnv.isLinux)?"VeilOverlay":"VeilOverlay-linux";
this._veilOverlay.style.position="absolute";
this._veilOverlay.style.cursor=AjxEnv.isIE6up?"not-allowed":"wait";
Dwt.setBounds(this._veilOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._veilOverlay,Dwt.Z_HIDDEN);
this._veilOverlay.veilZ=new Array();
this._veilOverlay.veilZ.push(Dwt.Z_HIDDEN);
this._veilOverlay.dialogZ=new Array();
this._veilOverlay.activeDialogs=new Array();
this._veilOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
o.appendChild(this._veilOverlay);
if(n.useCurtain){
this._curtainOverlay=document.createElement("div");
this._curtainOverlay.className="CurtainOverlay";
this._curtainOverlay.style.position="absolute";
Dwt.setBounds(this._curtainOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._curtainOverlay,Dwt.Z_CURTAIN);
this._curtainOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
o.appendChild(this._curtainOverlay)
}
this._uiEvent=new DwtUiEvent(true);
this._currWinSize=Dwt.getWindowSize();
this._toolTip=new DwtToolTip(this);
this._hoverMgr=new DwtHoverMgr();
this._keyboardMgr=new DwtKeyboardMgr(this)
};
DwtShell.prototype=new DwtComposite;
DwtShell.prototype.constructor=DwtShell;
DwtShell.CANCEL_BUTTON=-1;
DwtShell.controlEvent=new DwtControlEvent();
DwtShell.focusEvent=new DwtFocusEvent();
DwtShell.keyEvent=new DwtKeyEvent();
DwtShell.mouseEvent=new DwtMouseEvent();
DwtShell.selectionEvent=new DwtSelectionEvent(true);
DwtShell.treeEvent=new DwtTreeEvent();
DwtShell._GLOBAL_SELECTION="GlobalSelection";
DwtShell.prototype.toString=function(){
return"DwtShell"
};
DwtShell.getShell=function(e){
return DwtControl.fromElementId(e._dwtShellId)
};
DwtShell.prototype.getKeyboardMgr=function(){
return this._keyboardMgr
};
DwtShell.prototype.setBusy=function(o,n,t,a,e){
if(o){
this._setBusyCount++
}else{
if(this._setBusyCount>0){
this._setBusyCount--
}}
if(!this._setBusy&&(this._setBusyCount>0)){
Dwt.setCursor(this._busyOverlay,"wait");
Dwt.setVisible(this._busyOverlay,true);
this._setBusy=this._blockInput=true
}else{
if(this._setBusy&&(this._setBusyCount<=0)){
Dwt.setCursor(this._busyOverlay,"default");
Dwt.setVisible(this._busyOverlay,false);
this._setBusy=this._blockInput=false
}}
if(o&&t){
if(a&&a>0){
this._busyActionId[n]=AjxTimedAction.scheduleAction(this._busyTimedAction,a)
}else{
this._showBusyDialogAction(n)
}
this._cancelBusyCallback=e;
if(this._busyDialog){
this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(e!=null))
}}else{
if(this._busyActionId[n]&&(this._busyActionId[n]!=-1)){
AjxTimedAction.cancelAction(this._busyActionId[n]);
this._busyActionId[n]=-1
}
if(this._busyDialog&&this._busyDialog.isPoppedUp){
this._busyDialog.popdown()
}}};
DwtShell.prototype.getBusy=function(){
return this._setBusy
};
DwtShell.prototype.setBusyDialogText=function(e){
this._busyDialogText=e;
if(this._busyDialogTxt){
this._busyDialogTxt.innerHTML=(e)?e:""
}};
DwtShell.prototype.setBusyDialogTitle=function(e){
this._busyDialogTitle=e;
if(this._busyDialog){
this._busyDialog.setTitle((e)?e:AjxMsg.workInProgress)
}};
DwtShell.prototype.getHoverMgr=function(){
return this._hoverMgr
};
DwtShell.prototype.getToolTip=function(){
return this._toolTip
};
DwtShell.prototype.getH=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e).y:Dwt.getSize(document.body,e).y
};
DwtShell.prototype.getW=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e).x:Dwt.getSize(document.body,e).x
};
DwtShell.prototype.getSize=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e):Dwt.getSize(document.body,e)
};
DwtShell.prototype.getLocation=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()):Dwt.getLocation(document.body)
};
DwtShell.prototype.getX=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).x:Dwt.getLocation(document.body).x
};
DwtShell.prototype.getY=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).y:Dwt.getLocation(document.body).y
};
DwtShell.prototype.getBounds=function(e){
return(!this._virtual)?Dwt.getBounds(this.getHtmlElement(),e):Dwt.getBounds(document.body,e)
};
DwtShell.prototype.setVirtual=function(){
this._virtual=true;
this.setVisible(false)
};
DwtShell.prototype.addFocusListener=function(e){
if(!this._hasFocusHandler){
var t=document;
if(typeof t.onfocusin!="undefined"){
t.attachEvent("onfocusin",DwtShell.__focusHdlr)
}else{
window.addEventListener("focus",DwtShell.__focusHdlr,false)
}
this._hasFocusHandler=true
}
this.addListener(DwtEvent.ONFOCUS,e)
};
DwtShell.prototype.addBlurListener=function(e){
if(!this._hasBlurHandler){
var t=document;
if(typeof t.onfocusout!="undefined"){
t.attachEvent("onfocusout",DwtShell.__blurHdlr)
}else{
window.addEventListener("blur",DwtShell.__blurHdlr,false)
}
this._hasBlurHandler=true
}
this.addListener(DwtEvent.ONBLUR,e)
};
DwtShell.prototype.addGlobalSelectionListener=function(e){
this.addListener(DwtShell._GLOBAL_SELECTION,e)
};
DwtShell.prototype.removeGlobalSelectionListener=function(e){
this.removeListener(DwtShell._GLOBAL_SELECTION,e)
};
DwtShell.prototype.notifyGlobalSelection=function(e){
this.notifyListeners(DwtShell._GLOBAL_SELECTION,e)
};
DwtShell.prototype.isVirtual=function(){
return this._virtual
};
DwtShell.prototype._showBusyDialogAction=function(t){
var e=this._getBusyDialog();
e.popup();
this._busyActionId[t]=-1
};
DwtShell.prototype._createBusyOverlay=function(e){
this._busyOverlay=document.createElement("div");
this._busyOverlay.className=(!AjxEnv.isLinux)?"BusyOverlay":"BusyOverlay-linux";
this._busyOverlay.style.position="absolute";
Dwt.setBounds(this._busyOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._busyOverlay,Dwt.Z_VEIL);
this._busyOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
e.appendChild(this._busyOverlay);
Dwt.setVisible(this._busyOverlay,false);
this._busyTimedAction=new AjxTimedAction(this,this._showBusyDialogAction);
this._busyActionId={};
this._setBusyCount=0;
this._setBusy=false
};
DwtShell.prototype._getBusyDialog=function(a){
if(!this._busyDialog){
var o=new DwtDialog_ButtonDescriptor(DwtShell.CANCEL_BUTTON,AjxMsg.cancelRequest,DwtDialog.ALIGN_CENTER);
this._busyDialog=new DwtDialog({
parent:this,className:"DwtShellBusyDialog",title:AjxMsg.workInProgress,standardButtons:DwtDialog.NO_BUTTONS,extraButtons:[o],zIndex:Dwt.BUSY+10}
);
this._busyDialog.registerCallback(DwtShell.CANCEL_BUTTON,this._busyCancelButtonListener,this);
var t=Dwt.getNextId();
var e=["<table class='DialogContent'><tr>","<td><div class='WaitIcon'></div></td><td class='MsgText' id='",t,"'>&nbsp;</td>","</tr></table>"].join("");
this._busyDialog.setContent(e);
this._busyDialogTxt=document.getElementById(t);
if(this._busyDialogText){
this._busyDialogTxt.innerHTML=this._busyDialogText
}
if(this._busyDialogTitle){
this._busyDialog.setTitle(this._busyDialogTitle)
}
this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(this._cancelBusyCallback!=null))
}
return this._busyDialog
};
DwtShell.prototype._busyCancelButtonListener=function(e){
this._cancelBusyCallback.run();
if(this._busyDialog){
this._busyDialog.popdown()
}};
DwtShell._preventDefaultSelectPrt=function(t){
var e=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
e.setFromDhtmlEvent(t,true);
if(e.dwtObj&&e.dwtObj instanceof DwtControl&&!e.dwtObj.preventSelection(e.target)){
e._stopPropagation=false;
e._returnValue=true
}else{
e._stopPropagation=true;
e._returnValue=false
}
e.setToDhtmlEvent(t);
return !e._stopPropagation
};
DwtShell._preventDefaultPrt=function(t){
t=DwtUiEvent.getEvent(t);
var a=t.target?t.target:t.srcElement;
var e=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
e.setFromDhtmlEvent(t,true);
e._stopPropagation=true;
e._returnValue=false;
if(e.dwtObj&&e.dwtObj instanceof DwtControl&&!e.dwtObj.preventContextMenu(e.target)){
e._stopPropagation=false;
e._returnValue=true
}else{
if(a!=null&&typeof(a)=="object"){
if((a.tagName=="A"||a.tagName=="a")&&a.href){
e._stopPropagation=false;
e._returnValue=true
}}}
e.setToDhtmlEvent(t);
return e._returnValue
};
DwtShell._resizeHdlr=function(a){
var t=DwtControl.fromElementId(window._dwtShellId);
if(t.isListenerRegistered(DwtEvent.CONTROL)){
var e=DwtShell.controlEvent;
e.reset();
e.oldWidth=t._currWinSize.x;
e.oldHeight=t._currWinSize.y;
t._currWinSize=Dwt.getWindowSize();
e.newWidth=t._currWinSize.x;
e.newHeight=t._currWinSize.y;
t.notifyListeners(DwtEvent.CONTROL,e)
}else{
t._currWinSize=Dwt.getWindowSize()
}};
DwtShell.__onBodyScroll=function(){
document.body.scrollTop=0;
document.body.scrollLeft=0
};
DwtShell.__focusHdlr=function(){
var t=DwtShell.focusEvent;
var e=DwtShell.getShell(window);
t.dwtObj=e;
t.state=DwtFocusEvent.FOCUS;
e.notifyListeners(DwtEvent.ONFOCUS,t)
};
DwtShell.__blurHdlr=function(){
var t=DwtShell.focusEvent;
var e=DwtShell.getShell(window);
t.dwtObj=e;
t.state=DwtFocusEvent.BLUR;
e.notifyListeners(DwtEvent.ONBLUR,t)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtLabel")){
DwtLabel=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtLabel.PARAMS);
e.className=e.className||"DwtLabel";
DwtComposite.call(this,e);
this._style=e.style||(DwtLabel.IMAGE_LEFT|DwtLabel.ALIGN_CENTER);
this._textBackground=null;
this._textForeground=null;
this._createHtml(e.template)
};
DwtLabel.PARAMS=["parent","style","className","posStyle","id","index"];
DwtLabel.prototype=new DwtComposite;
DwtLabel.prototype.constructor=DwtLabel;
DwtLabel.prototype.toString=function(){
return"DwtLabel"
};
DwtLabel.IMAGE_LEFT=1;
DwtLabel.IMAGE_RIGHT=2;
DwtLabel.ALIGN_LEFT=4;
DwtLabel.ALIGN_RIGHT=8;
DwtLabel.ALIGN_CENTER=16;
DwtLabel._LAST_STYLE=16;
DwtLabel.prototype.TEMPLATE="dwt.Widgets#ZLabel";
DwtLabel.prototype.dispose=function(){
delete this._dropDownEl;
delete this._iconEl;
delete this._textEl;
DwtControl.prototype.dispose.call(this)
};
DwtLabel.prototype.setEnabled=function(e){
if(e!=this._enabled){
DwtControl.prototype.setEnabled.call(this,e);
this.__setImage(this.__imageInfo)
}};
DwtLabel.prototype.getImage=function(){
return this.__imageInfo
};
DwtLabel.prototype.setImage=function(e){
this.__imageInfo=e;
this.__setImage(e)
};
DwtLabel.prototype.setIconEl=function(e){
this._iconEl=e
};
DwtLabel.prototype.setDisabledImage=function(e){};
DwtLabel.prototype.getText=function(){
return(this.__text!=null)?this.__text:null
};
DwtLabel.prototype.setText=function(e){
if(!this._textEl){
return
}
if(e==null||e==""){
this.__text=null;
this._textEl.innerHTML=""
}else{
this.__text=e;
this._textEl.innerHTML=e
}};
DwtLabel.prototype.setTextBackground=function(e){
this._textBackground=e;
if(this._textEl){
this._textEl.style.backgroundColor=e
}};
DwtLabel.prototype.setTextForeground=function(e){
this._textForeground=e;
if(this._textEl){
this._textEl.style.color=e
}};
DwtLabel.prototype.setAlign=function(e){
this._style=e;
this.__setImage(this.__imageInfo)
};
DwtLabel.prototype.isStyle=function(e){
return this._style&e
};
DwtLabel.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtLabel.prototype._createHtmlFromTemplate=function(e,t){
DwtControl.prototype._createHtmlFromTemplate.call(this,e,t);
this._textEl=document.getElementById(t.id+"_title")
};
DwtLabel.prototype._getIconEl=function(){
var e=(this._style&DwtLabel.IMAGE_RIGHT?"right":"left");
return this._iconEl||(this._iconEl=document.getElementById(this._htmlElId+"_"+e+"_icon"))
};
DwtLabel.prototype.__setImage=function(t){
var e=this._getIconEl();
if(e){
if(t){
AjxImg.setImage(e,t,null,!this._enabled);
var a=(this._style&DwtLabel.IMAGE_RIGHT?"ZHasRightIcon":"ZHasLeftIcon");
Dwt.addClass(this.getHtmlElement(),a)
}else{
e.innerHTML=""
}}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtListView")){
DwtListView=function(o){
if(arguments.length==0){
return
}
o=Dwt.getParams(arguments,DwtListView.PARAMS);
o.className=o.className||"DwtListView";
DwtComposite.call(this,o);
this._view=o.view||Dwt.getNextId();
if(o.headerList){
var a=this.getHtmlElement();
var s=new Array(50);
var h=0;
var r=Dwt.getNextId();
var e=Dwt.getNextId();
s[h++]="<table width='100%'><tr><td ";
s[h++]="id="+r;
s[h++]="></td></tr><tr><td ";
s[h++]="id="+e;
s[h++]="></td></tr></table>";
a.innerHTML=s.join("");
var l=document.getElementById(r);
this._listColDiv=document.createElement("div");
this._listColDiv.id=DwtId.getListViewId(this._view,DwtId.LIST_VIEW_HEADERS);
this._listColDiv.className="DwtListView-ColHeader";
l.appendChild(this._listColDiv);
var t=document.getElementById(e);
this._listDiv=document.createElement("div");
this._listDiv.id=DwtId.getListViewId(this._view,DwtId.LIST_VIEW_ROWS);
this._listDiv.className="DwtListView-Rows";
t.appendChild(this._listDiv);
this._bSortAsc=false;
this._currentColId=null;
this.sortingEnabled=true
}else{
this.setScrollStyle(DwtControl.SCROLL)
}
this._setMouseEventHdlrs();
this._listenerMouseOver=this._mouseOverListener.bind(this);
this._listenerMouseOut=this._mouseOutListener.bind(this);
this._listenerMouseDown=this._mouseDownListener.bind(this);
this._listenerMouseUp=this._mouseUpListener.bind(this);
this._listenerMouseMove=this._mouseMoveListener.bind(this);
this._listenerDoubleClick=this._doubleClickListener.bind(this);
this.addListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.addListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.addListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.addListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.addListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.addListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick);
this._evtMgr=new AjxEventMgr();
this._selectedItems=new AjxVector();
this._selAnchor=null;
this._kbAnchor=null;
this._selEv=new DwtSelectionEvent(true);
this._actionEv=new DwtListViewActionEvent(true);
this._stateChangeEv=new DwtEvent(true);
this._headerList=o.headerList;
this._noMaximize=o.noMaximize;
this._parentEl=this._headerList?this._listDiv:this.getHtmlElement();
this._list=null;
this.offset=0;
this.headerColCreated=false;
this.multiSelectEnabled=true;
this.firstSelIndex=-1;
this._data={};
this._rowClass=[this._className,DwtListView.ROW_CLASS].join("");
var n=this._normalClass=DwtListView.ROW_CLASS;
this._selectedClass=[n,DwtCssStyle.SELECTED].join("-");
this._disabledSelectedClass=[this._selectedClass,DwtCssStyle.DISABLED].join("-");
this._kbFocusClass=[n,DwtCssStyle.FOCUSED].join("-");
this._dndClass=[n,DwtCssStyle.DRAG_PROXY].join("-");
this._rightClickClass=[this._selectedClass,DwtCssStyle.ACTIONED].join("-");
this._styleRe=this._getStyleRegex()
};
DwtListView.prototype=new DwtComposite;
DwtListView.prototype.constructor=DwtListView;
DwtListView.prototype.isDwtListView=true;
DwtListView.prototype.toString=function(){
return"DwtListView"
};
DwtListView.PARAMS=["parent","className","posStyle","headerList","noMaximize"];
DwtListView.ITEM_SELECTED=1;
DwtListView.ITEM_DESELECTED=2;
DwtListView.ITEM_DBL_CLICKED=3;
DwtListView._LAST_REASON=3;
DwtListView._TOOLTIP_DELAY=250;
DwtListView.HEADERITEM_HEIGHT=24;
DwtListView.TYPE_HEADER_ITEM="1";
DwtListView.TYPE_LIST_ITEM="2";
DwtListView.TYPE_HEADER_SASH="3";
DwtListView.DEFAULT_LIMIT=25;
DwtListView.MAX_REPLENISH_THRESHOLD=10;
DwtListView.MIN_COLUMN_WIDTH=20;
DwtListView.COL_MOVE_THRESHOLD=3;
DwtListView.ROW_CLASS="Row";
DwtListView.ROW_CLASS_ODD="RowEven";
DwtListView.ROW_CLASS_EVEN="RowOdd";
DwtListView._STYLE_CLASS="_sc";
DwtListView._SELECTED_STYLE_CLASS="_ssc";
DwtListView._SELECTED_DIS_STYLE_CLASS="_sdsc";
DwtListView._KBFOCUS_CLASS="_kfc";
DwtListView.prototype.dispose=function(){
this._listColDiv=null;
this._listDiv=null;
this._parentEl=null;
this._clickDiv=null;
this._selectedItems=null;
DwtComposite.prototype.dispose.call(this)
};
DwtListView.prototype.setEnabled=function(e){
DwtComposite.prototype.setEnabled.call(this,e);
this.removeListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.removeListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.removeListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.removeListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.removeListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.removeListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick);
if(e){
this.addListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.addListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.addListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.addListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.addListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.addListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick)
}
var a=this.getSelectedItems();
if(a){
var o=a.getArray();
for(var t=0;
t<o.length;
t++){
Dwt.delClass(o[t],this._styleRe,e?this._selectedClass:this._disabledSelectedClass)
}}};
DwtListView.prototype.createHeaderHtml=function(d){
if(!this._headerList||this.headerColCreated){
return
}
this._headerHash={};
this._headerIdHash={};
var u=0;
var f=[];
f[u++]="<table id='";
f[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_TABLE,this._view);
f[u++]="' height=100%";
f[u++]=this._noMaximize?">":" width=100%>";
f[u++]="<tr>";
var o=this._headerList.length;
for(var s=0;
s<o;
s++){
var l=this._headerList[s];
var c=l._field;
l._index=s;
var t=l._id=DwtId.getListViewHdrId(DwtId.WIDGET_HDR,this._view,c);
this._headerHash[c]=l;
this._headerIdHash[t]=l;
if(l._variable){
this._variableHeaderCol=l
}
if(l._visible){
u=this._createHeader(f,u,l,s,o,t,d)
}}
f[u++]="</tr></table>";
this._listColDiv.innerHTML=f.join("");
var e=0,h;
for(var n=0;
n<this._headerList.length;
n++){
var l=this._headerList[n];
var m=document.getElementById(l._id);
if(!m){
continue
}
if(l._sortable&&l._field==d){
m.className="DwtListView-Column DwtListView-ColumnActive"
}
if(l._resizeable){
var r=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_SASH,this._view,l._field);
var a=document.getElementById(r);
if(a){
this.associateItemWithElement(l,a,DwtListView.TYPE_HEADER_SASH,r,{
index:n}
)
}
e++;
h=l
}
this.associateItemWithElement(l,m,DwtListView.TYPE_HEADER_ITEM,l._id,{
index:n}
)
}
if(e==1){
h._resizeable=false
}
this.headerColCreated=true
};
DwtListView.prototype._createHeader=function(m,u,l,n,o,t,d){
var c=l._field;
m[u++]="<td id='";
m[u++]=t;
m[u++]="' class='";
var r=(t==this._currentColId)?"DwtListView-Column DwtListView-ColumnActive":"DwtListView-Column";
r+=l._sortable?"":" DwtDefaultCursor";
m[u++]=r+"'";
if(l._width){
m[u++]=" width=";
m[u++]=l._width;
if(l._widthUnits){
m[u++]=l._widthUnits
}}
if(l._tooltip&&DwtControl.useBrowserTooltips){
m[u++]=" title='"+l._tooltip+"'"
}
m[u++]=">";
m[u++]="<div";
var s=null;
if(l._width&&l._width!="auto"){
if(AjxEnv.isIE){
s=l._width
}else{
s=l._width+2
}
if(l._widthUnits){
s+=l._widthUnits
}}
if(!!s){
m[u++]=" style='overflow: hidden; width: ";
m[u++]=s;
m[u++]="'>"
}else{
m[u++]=">"
}
m[u++]="<table width=100%><tr>";
if(l._iconInfo){
var h=["id='",DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,c),"'"].join("");
m[u++]="<td><center>";
m[u++]=AjxImg.getImageHtml(l._iconInfo,null,h);
m[u++]="</center></td>"
}
if(l._label){
m[u++]="<td id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,c);
m[u++]="' class='DwtListHeaderItem-label'>";
m[u++]=l._label;
m[u++]="</td>"
}
if(l._sortable&&!l._noSortArrow){
var e=this._bSortAsc?"ColumnUpArrow":"ColumnDownArrow";
m[u++]="<td align=right style='padding-right:2px' width=100% id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,c);
m[u++]="'>";
var a=(c==d);
m[u++]=AjxImg.getImageHtml(e,a?null:"visibility:hidden");
m[u++]="</td>";
if(a){
this._currentColId=t
}}
if(n<(o-1)){
m[u++]="<td width=6>";
m[u++]="<table align=right width=6 height=100% id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_SASH,this._view,c);
m[u++]="'><tr>";
m[u++]="<td class='DwtListView-Sash'><div style='width: 1px; height: ";
m[u++]=(DwtListView.HEADERITEM_HEIGHT-2);
m[u++]="px; background-color: #8A8A8A;margin-left:2px'></div></td><td class='DwtListView-Sash'><div style='width: 1px; height: ";
m[u++]=(DwtListView.HEADERITEM_HEIGHT-2);
m[u++]="px; background-color: #FFFFFF;margin-right:2px'></div></td></tr></table>";
m[u++]="</td>"
}
m[u++]="</tr></table>";
m[u++]="</div></td>";
return u
};
DwtListView.prototype.getItemIndex=function(a){
var o=this._list;
if(o){
var e=o.size();
for(var t=0;
t<e;
++t){
if(o.get(t).id==a.id){
return t
}}}
return null
};
DwtListView.prototype.setSize=function(t,e){
DwtComposite.prototype.setSize.call(this,t,e);
this._sizeChildren(e)
};
DwtListView.prototype.size=function(){
return this._list?this._list.size():0
};
DwtListView.prototype.set=function(a,t,e){
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=null;
this.sortingEnabled=true;
this._resetList();
this._list=a;
this.setUI(t,e)
};
DwtListView.prototype.setUI=function(t,e){
this.removeAll();
this.createHeaderHtml(t);
this._renderList(this._list,e)
};
DwtListView.prototype._renderList=function(r,s,a){
if(r instanceof AjxVector&&r.size()){
var t=new Date();
var c=r.size();
var h=[];
for(var n=0;
n<c;
n++){
var l=r.get(n);
var e=this._createItemHtml(l,{
now:t}
,!a,n);
if(e){
if(e instanceof Array){
for(var o=0;
o<e.length;
o++){
this._addRow(e[o])
}}else{
if(e.tagName||a){
this._addRow(e)
}else{
h.push(e)
}}}}
if(h.length){
this._parentEl.innerHTML=h.join("")
}}else{
if(!s){
this._setNoResultsHtml()
}}};
DwtListView.prototype.addItems=function(e){
if(AjxUtil.isArray(e)){
if(!this._list){
this._list=new AjxVector()
}
if(this._list.size()==0){
this._resetList()
}
this._renderList(AjxVector.fromArray(e),null,true);
this._list.addList(e)
}};
DwtListView.prototype.addItem=function(n,t,a,o){
if(!this._list){
this._list=new AjxVector()
}
if(this._list.size()==0){
this._resetList()
}
this._list.add(n,(o!=null)?o:t);
var s=this._createItemHtml(n);
if(s){
if(s instanceof Array){
for(var e=0;
e<s.length;
e++){
this._addRow(s[e])
}}else{
this._addRow(s,t)
}}
if(!a&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.removeItem=function(a,t,o){
var e=this._getElFromItem(a);
if(!e){
return
}
var n=this._getRowIndex(a);
this._selectedItems.remove(e);
if(this._rightSelItem==e){
this._rightSelItem=null
}
if(this._kbAnchor==e){
this._kbAnchor=null
}
this._parentEl.removeChild(e);
if(this._list){
this._list.remove(a)
}
var s=e.id;
if(this._data[s]){
this._data[s]=null;
delete this._data[s]
}
if(!o){
this._fixAlternation(n)
}
if(!t&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.redrawItem=function(t){
var a=this._getElFromItem(t);
if(a){
var e=a.className;
var o=this._createItemHtml(t);
o.className=e;
a.parentNode.replaceChild(o,a);
if(this._selectedItems.contains(a)){
this._selectedItems.remove(a);
this.selectItem(t)
}}};
DwtListView.prototype.addSelectionListener=function(e){
this._evtMgr.addListener(DwtEvent.SELECTION,e)
};
DwtListView.prototype.removeSelectionListener=function(e){
this._evtMgr.removeListener(DwtEvent.SELECTION,e)
};
DwtListView.prototype.addActionListener=function(e){
this._evtMgr.addListener(DwtEvent.ACTION,e)
};
DwtListView.prototype.removeActionListener=function(e){
this._evtMgr.removeListener(DwtEvent.ACTION,e)
};
DwtListView.prototype.addStateChangeListener=function(e){
this._evtMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtListView.prototype.removeStateChangeListener=function(e){
this._evtMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtListView.prototype.removeAll=function(e){
if(this._parentEl){
this._parentEl.innerHTML=""
}
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=this._selAnchor=this._kbAnchor=null;
if(!e&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.selectAll=function(){
if(this._list&&this._list.size()){
this.setSelectedItems(this._list.getArray())
}};
DwtListView.prototype.deselectAll=function(){
if(this._selectedItems){
var e=this._selectedItems.getArray();
var o=this._selectedItems.size();
for(var t=0;
t<o;
t++){
Dwt.delClass(e[t],this._styleRe)
}
this._selectedItems.removeAll();
this._rightSelItem=this._selAnchor=null;
if(this._kbAnchor!=null&&this.hasFocus()){
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}}};
DwtListView.prototype.getDnDSelection=function(){
if(this._dndSelection instanceof AjxVector){
return this.getSelection()
}else{
return this.getItemFromElement(this._dndSelection)
}};
DwtListView.prototype.getSelection=function(){
var t=[];
if(this._rightSelItem){
t.push(this.getItemFromElement(this._rightSelItem))
}else{
if(this._selectedItems){
var e=this._selectedItems.getArray();
var n=this._selectedItems.size();
for(var o=0;
o<n;
o++){
t[o]=this.getItemFromElement(e[o])
}}}
return t
};
DwtListView.prototype.getSelectedItems=function(){
return this._selectedItems
};
DwtListView.prototype.setSelection=function(a,e){
if(!a){
return
}
var t=this._getElFromItem(a);
if(t){
if((this._selectedItems.size()==1)&&(this._selectedItems.get(0)==t)){
return
}
this.deselectAll();
this._unmarkKbAnchorElement(true);
this._selAnchor=this._kbAnchor=t;
this.selectItem(a,this.getEnabled());
this.firstSelIndex=(this._list&&this._list.size()>0)?this._list.indexOf(a):-1;
this._scrollList(t);
if(!e&&this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
var o=new DwtSelectionEvent(true);
o.button=DwtMouseEvent.LEFT;
o.target=t;
o.item=this.getItemFromElement(t);
o.detail=DwtListView.ITEM_SELECTED;
o.ersatz=true;
this._evtMgr.notifyListeners(DwtEvent.SELECTION,o)
}}};
DwtListView.prototype.setMultiSelection=function(e,n,a){
if(n){
this._selectedItems.remove(e);
Dwt.delClass(e,this._styleRe);
this._selEv.detail=DwtListView.ITEM_DESELECTED
}else{
this._selectedItems.add(e,null,true);
Dwt.delClass(e,this._styleRe,this._selectedClass);
this._selEv.detail=DwtListView.ITEM_SELECTED
}
if(this._kbAnchor&&this._kbAnchor!=e){
var o=this._kbAnchor;
var t=this._selectedClass;
if(o.className.indexOf(t)!=-1){
Dwt.delClass(o,this._styleRe,t)
}else{
Dwt.delClass(o,this._styleRe)
}}
this._selAnchor=this._kbAnchor=e;
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
};
DwtListView.prototype.setSelectedItems=function(a){
this.deselectAll();
var o=a.length,e=this.getEnabled();
for(var t=0;
t<o;
++t){
this.selectItem(a[t],e)
}};
DwtListView.prototype.selectItem=function(a,t){
var e=this._getElFromItem(a);
if(e){
Dwt.delClass(e,this._styleRe,t?this._selectedClass:this._disabledSelectedClass);
if(this._kbAnchor==e&&this.hasFocus()){
Dwt.addClass(e,this._kbFocusClass)
}
this._selectedItems.add(e)
}};
DwtListView.prototype.getSelectionCount=function(){
return this._rightSelItem?1:this._selectedItems.size()
};
DwtListView.prototype.handleActionPopdown=function(){
this._clearRightSel()
};
DwtListView.prototype.associateItemWithElement=function(o,t,a,s,n){
s=s||this._getItemId(o);
if(t){
t.id=s
}
a=a||DwtListView.TYPE_LIST_ITEM;
this._data[s]={
item:o,id:s,type:a};
if(n){
for(var e in n){
this._data[s][e]=n[e]
}}
return s
};
DwtListView.prototype.getItemFromElement=function(e){
return this._getItemData(e,"item")
};
DwtListView.prototype.findItem=function(e){
if(!e){
return
}
var t=this.findItemDiv(e);
return this._getItemData(t,"item")
};
DwtListView.prototype.findItemDiv=function(e){
if(!e){
return
}
while(e&&(e.id!=this._htmlElId)){
if(e.id&&this._data[e.id]){
return e
}
e=e.parentNode
}
return null
};
DwtListView.prototype.getTargetItem=function(e){
return this.findItem(DwtUiEvent.getTarget(e))
};
DwtListView.prototype.getTargetItemDiv=function(e){
return this.findItemDiv(DwtUiEvent.getTarget(e))
};
DwtListView.prototype.dragSelect=function(t){
if(this._dragHighlight){
var e=document.getElementById(this._dragHighlight);
if(!t||(e&&(t.id!=e.id))){
this._updateDragSelection(e,false)
}}
if(!t){
return
}
if(this._getItemData(t,"type")!=DwtListView.TYPE_LIST_ITEM){
return
}
if(t.id!=this._dragHighlight){
this._dragHighlight=t.id;
this._updateDragSelection(t,true)
}};
DwtListView.prototype.dragDeselect=function(t){
if(this._dragHighlight){
var e=document.getElementById(this._dragHighlight);
this._updateDragSelection(e,false);
this._dragHighlight=null
}};
DwtListView.prototype.scrollToItem=function(t){
var e=this._getElFromItem(t);
if(e){
this._listDiv.scrollTop=e.offsetTop
}};
DwtListView.prototype.scrollToTop=function(){
this._listDiv.scrollTop=0
};
DwtListView.prototype.scrollPage=function(e){
var t=this._parentEl;
if(t.clientHeight>=t.scrollHeight){
return
}
t.scrollTop=e?Math.max(t.scrollTop-t.clientHeight,0):Math.min(t.scrollTop+t.clientHeight,t.scrollHeight-t.clientHeight)
};
DwtListView.prototype.setSortByAsc=function(a,t){
if(!this._headerList){
return
}
this._bSortAsc=t;
var o=null;
for(var e=0;
e<this._headerList.length;
e++){
if(this._headerList[e]._sortable&&this._headerList[e]._field==a){
o=this._headerList[e]._id;
break
}}
if(o){
this._setSortedColStyle(o)
}};
DwtListView.prototype.getNewOffset=function(t){
var e=this.getLimit();
var a=t?(this.offset+e):(this.offset-e);
return(a<0)?0:a
};
DwtListView.prototype.getLimit=function(){
return DwtListView.DEFAULT_LIMIT
};
DwtListView.prototype.getReplenishThreshold=function(){
return DwtListView.MAX_REPLENISH_THRESHOLD
};
DwtListView.prototype.getList=function(){
return this._list
};
DwtListView.prototype.replenish=function(o){
this._list.addList(o);
var t=o.size();
for(var e=0;
e<t;
e++){
var a=o.get(e);
var n=this._createItemHtml(a);
if(n){
this._addRow(n)
}}};
DwtListView.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_LIST
};
DwtListView.prototype.handleKeyAction=function(n,h){
switch(n){
case DwtKeyMap.SELECT:this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,kbNavEvent:true}
);
break;
case DwtKeyMap.SELECT_CURRENT:this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,ctrlKey:true,kbNavEvent:true}
);
break;
case DwtKeyMap.SELECT_NEXT:this._selectItem(true,false,true);
break;
case DwtKeyMap.SELECT_PREV:this._selectItem(false,false,true);
break;
case DwtKeyMap.ADD_SELECT_NEXT:this._selectItem(true,true,true);
break;
case DwtKeyMap.ADD_SELECT_PREV:this._selectItem(false,true,true);
break;
case DwtKeyMap.PREV:this._setKbFocusElement(false);
break;
case DwtKeyMap.NEXT:this._setKbFocusElement(true);
break;
case DwtKeyMap.DBLCLICK:if(!this._kbAnchor){
break
}
var t=false;
var c=this.getSelectedItems().getArray();
for(var o=0;
o<c.length;
o++){
if(c[o]==this._kbAnchor){
t=true;
break
}}
if(t){
this.emulateDblClick(this.getItemFromElement(this._kbAnchor),true)
}else{
this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,kbNavEvent:true}
)
}
break;
case DwtKeyMap.SELECT_ALL:this.selectAll();
break;
case DwtKeyMap.SELECT_FIRST:case DwtKeyMap.SELECT_LAST:var d=(n==DwtKeyMap.SELECT_FIRST)?this._getFirstItem():this._getLastItem();
if(d){
this.setSelection(d);
this._scrollList(this._kbAnchor)
}
break;
case DwtKeyMap.ACTION:if(this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
var e=Dwt.toWindow(this._kbAnchor,0,0);
var u=Dwt.getSize(this._kbAnchor);
var l=e.x+u.x/4;
var r=e.y+u.y/2;
this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.RIGHT,docX:l,docY:r,kbNavEvent:true}
)
}
break;
case DwtKeyMap.PAGE_UP:case DwtKeyMap.PAGE_DOWN:this.scrollPage(n==DwtKeyMap.PAGE_UP);
break;
default:return false
}
return true
};
DwtListView.prototype.setMultiSelect=function(e){
this.multiSelectEnabled=e
};
DwtListView.prototype.isMultiSelectEnabled=function(){
return this.multiSelectEnabled
};
DwtListView.prototype.setListDivHeight=function(a){
if(this._listDiv&&this._listColDiv){
var t=Dwt.getSize(this._listColDiv).y;
var e=a-t-10;
Dwt.setSize(this._listDiv,Dwt.DEFAULT,e)
}};
DwtListView.prototype._getStyleRegex=function(){
return new RegExp("\\bRow(-("+[DwtCssStyle.SELECTED,DwtCssStyle.ACTIONED,DwtCssStyle.FOCUSED,DwtCssStyle.DISABLED,DwtCssStyle.DRAG_PROXY].join("|")+"))+\\b","g")
};
DwtListView.prototype._addRow=function(a,t){
if(!a||!this._parentEl){
return
}
var e=this._parentEl.childNodes.length;
if(t!=null&&e>0&&t!=e){
this._parentEl.insertBefore(a,this._parentEl.childNodes[t])
}else{
this._parentEl.appendChild(a)
}
this._fixAlternation((t!=null)?t:e)
};
DwtListView.prototype._fixAlternation=function(e){
var n=this._parentEl.childNodes;
if(!(n&&n.length)){
return
}
if(!(this._list&&this._list.size())){
return
}
var o=n[e];
if(!o){
return
}
var a=Boolean(e%2);
this._setAlternatingRowClass(o,a);
var t=o.nextSibling;
while(t){
a=!a;
this._setAlternatingRowClass(t,a);
t=t.nextSibling
}};
DwtListView.prototype._setAlternatingRowClass=function(o,e){
var t=e?DwtListView.ROW_CLASS_ODD:DwtListView.ROW_CLASS_EVEN;
var a=e?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD;
Dwt.delClass(o,t,a)
};
DwtListView.prototype._createItemHtml=function(c,a,s,n){
a=a||{};
this._addParams(c,a,l,h);
var e;
var l=[];
var h=0;
if(s){
h=this._getDivHtml(c,a,l,h,n)
}else{
e=a.div||this._getDiv(c,a)
}
h=this._getTable(l,h,a);
h=this._getRow(l,h,c,a);
var t=a.headerList||this._headerList;
if(t&&t.length){
for(var o=0;
o<t.length;
o++){
if(!t[o]._visible){
continue
}
var r=t[o]._field;
h=this._getCell(l,h,c,r,o,a)
}}else{
h=this._getCell(l,h,c,null,null,a)
}
l[h++]="</tr></table>";
if(s){
l[h++]="</div>";
return l.join("")
}
e.innerHTML=l.join("");
return e
};
DwtListView.prototype._addParams=function(e,t){};
DwtListView.prototype._getDiv=function(t,a){
var o=document.createElement("div");
var e=[];
this._getDivHtml(t,a,e,0,0);
o.innerHTML=e.join("");
return o.firstChild
};
DwtListView.prototype._getExtraStyle=function(e){
return null
};
DwtListView.prototype._getDivHtml=function(n,r,t,e,o){
t[e++]="<div class='";
t[e++]=this._getDivClass(r.divClass||this._normalClass,n,r);
t[e++]=" ";
t[e++]=(o%2)?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD;
t[e++]="'";
var a=[];
if(r.isDragProxy&&AjxEnv.isMozilla){
a.push("overflow:visible")
}
if(r.isDragProxy){
a.push("position:absolute")
}
var s=this._getExtraStyle(n);
if(s){
a.push(s)
}
if(a.length){
t[e++]=" style='";
t[e++]=a.join(";");
t[e++]="'"
}
var h=r.isDragProxy?this._getItemId(n)+"_dnd":null;
t[e++]=" id='";
t[e++]=this.associateItemWithElement(n,null,null,h);
t[e++]="'>";
return e
};
DwtListView.prototype._getDivClass=function(t,e,a){
return a.isDragProxy?([t," ",t,"-",DwtCssStyle.DRAG_PROXY].join("")):t
};
DwtListView.prototype._getTable=function(t,e,a){
t[e++]="<table width=";
t[e++]=!a.isDragProxy?"100%>":(this.getSize().x+">");
return e
};
DwtListView.prototype._getRow=function(t,e,o,s){
var n=this._getRowId(o,s)||Dwt.getNextId();
var a=this._getRowClass(o,s);
t[e++]=n?["<tr id='",n,"'"].join(""):"<tr";
t[e++]=a?([" class='",a,"'>"].join("")):">";
return e
};
DwtListView.prototype._getRowClass=function(e,t){
return null
};
DwtListView.prototype._getRowId=function(e,t){
return null
};
DwtListView.prototype._getCell=function(f,m,g,d,n,o){
var a=this._getCellId(g,d,o);
var u=a?[" id=","'",a,"'"].join(""):"";
var t=this._getCellWidth(n,o);
var h=t?([" width=",t].join("")):(" width='100%'");
var l=this._getCellClass(g,d,o);
var s=l?[" class=",l].join(""):"";
var p=this._getCellAlign(n,o);
var c=p?[" align=",p].join(""):"";
var e=(this._getCellAttrText(g,d,o))||"";
var r=[u,h,s,c,e].join(" ");
f[m++]="<td";
f[m++]=r?(" "+r):"";
f[m++]=">";
m=this._getCellContents(f,m,g,d,n,o);
f[m++]="</td>";
return m
};
DwtListView.prototype._getCellWidth=function(o,a){
if(o==null){
return null
}
var e=a.headerList||this._headerList;
var t=e[o]._width;
if(t){
if(t!="auto"&&t>0){
if(AjxEnv.isIE){
return(t+2)
}
if(AjxEnv.isSafari&&!AjxEnv.isSafari6up&&!AjxEnv.isChrome19up){
return(t+5)
}}
return t
}
return null
};
DwtListView.prototype._getCellAlign=function(a,t){
if(a==null){
return null
}
var e=t.headerList||this._headerList;
return e[a]._align
};
DwtListView.prototype._getCellId=function(e,t,a){
return null
};
DwtListView.prototype._getCellClass=function(e,t,a){
return null
};
DwtListView.prototype._getCellAttrText=function(e,t,a){
return null
};
DwtListView.prototype._getCellContents=function(t,e,a,o,s,n){
t[e++]=a.toString?a.toString():a;
return e
};
DwtListView.prototype._getFieldId=function(e,t){
return DwtId.getListViewItemId(DwtId.WIDGET_ITEM_FIELD,this._view,e.id,t)
};
DwtListView.prototype._getElement=function(e,t){
return document.getElementById(this._getFieldId(e,t))
};
DwtListView.prototype._getDragProxy=function(o){
var n=this.getDnDSelection();
if(!n){
return null
}
var r;
var e;
var t;
this._dndImg=null;
if(!(n instanceof Array)||n.length==1){
var l=(n instanceof Array)?n[0]:n;
r=this._createItemHtml(l,{
now:new Date(),isDragProxy:true}
);
this._setItemData(r,"origClassName",r.className);
Dwt.setPosition(r,Dwt.ABSOLUTE_STYLE);
t="position:absolute;top:18;left:-11;visibility:hidden"
}else{
r=document.createElement("div");
r.className="DragProxy";
Dwt.setPosition(r,Dwt.ABSOLUTE_STYLE);
AjxImg.setImage(r,"DndMultiYes_48");
this._dndImg=r;
e=document.createElement("div");
Dwt.setPosition(e,Dwt.ABSOLUTE_STYLE);
var h=this.allSelected?ZmMsg.all:n.length;
e.innerHTML="<table><tr><td class='DragProxyTextLabel'>"+h+"</td></tr></table>";
r.appendChild(e);
t="position:absolute;top:30;left:0;visibility:hidden";
Dwt.setBounds(r,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE,43+32-16,36+32-20)
}
var a=AjxImg.getImageHtml("RoundPlus",t,"id="+DwtId.DND_PLUS_ID);
if(!this._noDndPlusImage){
r.appendChild(Dwt.parseHtmlFragment(a))
}
this.shell.getHtmlElement().appendChild(r);
if(e){
var s=Dwt.getSize(e);
Dwt.setLocation(e,16+(32-s.x)/2,19+(32-s.y)/2)
}
Dwt.setZIndex(r,Dwt.Z_DND);
return r
};
DwtListView.prototype._setDragProxyState=function(t){
if(this._dndImg){
AjxImg.setImage(this._dndImg,t?"DndMultiYes_48":"DndMultiNo_48")
}else{
if(this._dndProxy){
var a=t?DwtCssStyle.DROPPABLE:DwtCssStyle.NOT_DROPPABLE;
var e=this._getItemData(this._dndProxy,"origClassName");
this._dndProxy.className=[e,a].join(" ")
}}};
DwtListView.prototype._setNoResultsHtml=function(){
var t=document.createElement("div");
var e={
message:this._getNoResultsMessage(),type:this.type};
t.innerHTML=AjxTemplate.expand("dwt.Widgets#DwtListView-NoResults",e);
this._addRow(t)
};
DwtListView.prototype._getNoResultsMessage=function(){
return AjxMsg.noResults
};
DwtListView.prototype._clearRightSel=function(){
if(this._rightSelItem){
Dwt.delClass(this._rightSelItem,this._styleRe);
this._rightSelItem=null
}};
DwtListView.prototype._getItemId=function(e){
return DwtId.getListViewItemId(DwtId.WIDGET_ITEM,this._view,(e&&e.id)?e.id:Dwt.getNextId())
};
DwtListView.prototype._getElFromItem=function(e){
return Dwt.byId(this._getItemId(e))
};
DwtListView.prototype._getRowIndex=function(t){
var o=this._getItemId(t);
var a=this._parentEl.childNodes;
for(var e=0;
e<a.length;
e++){
if(a[e].id==o){
return e
}}
return null
};
DwtListView.prototype._getItemData=function(e,a,o){
o=o||(e?e.id:null);
var t=this._data[o];
return t?t[a]:null
};
DwtListView.prototype._setItemData=function(e,o,a,n){
n=n||(e?e.id:null);
var t=this._data[n];
if(t){
t[o]=a
}};
DwtListView.prototype._isValidDragObject=function(e){
return(this.getTargetItemDiv(e)!=null)
};
DwtListView.prototype._updateDragSelection=function(t,e){
if(!t){
return
}
if(!e){
t.className=this._getItemData(t,"origClassName")
}else{
this._setItemData(t,"origClassName",t.className);
Dwt.delClass(t,this._styleRe,this._dndClass)
}};
DwtListView.prototype._mouseOverAction=function(t,o){
var e=this._getItemData(o,"type");
if(e==DwtListView.TYPE_HEADER_ITEM){
var a=this.getItemFromElement(o);
if(a&&this.sortingEnabled&&a._sortable&&!this._headerClone){
o.className="DwtListView-Column DwtListView-ColumnHover"
}}else{
if(e==DwtListView.TYPE_HEADER_SASH){
o.style.cursor=AjxEnv.isIE?"col-resize":"e-resize"
}}
return true
};
DwtListView.prototype._mouseOutAction=function(t,o){
var e=this._getItemData(o,"type");
if(e==DwtListView.TYPE_HEADER_ITEM&&!this._headerClone){
o.className=(o.id!=this._currentColId)?"DwtListView-Column":"DwtListView-Column DwtListView-ColumnActive";
var a=this.getItemFromElement(o);
if(!a._sortable){
o.className+=" DwtDefaultCursor"
}}else{
if(e==DwtListView.TYPE_HEADER_SASH){
o.style.cursor="auto"
}}
return true
};
DwtListView.prototype._mouseOverListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
return
}
this._mouseOverAction(e,t)
};
DwtListView.prototype._mouseOutListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
return
}
this.setToolTipContent(null);
this._mouseOutAction(e,t)
};
DwtListView.prototype._mouseMoveListener=function(t){
if(!this._clickDiv){
return
}
var e=this._getItemData(this._clickDiv,"type");
if(e==DwtListView.TYPE_HEADER_ITEM){
this._handleColHeaderMove(t)
}else{
if(e==DwtListView.TYPE_HEADER_SASH){
this._handleColHeaderResize(t)
}}};
DwtListView.prototype._mouseDownListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
this._dndSelection=null
}else{
this._clickDiv=t;
if(this._getItemData(t,"type")!=DwtListView.TYPE_LIST_ITEM){
this._dndSelection=null
}else{
this._dndSelection=(this._selectedItems.contains(t))?this._selectedItems:t
}}
this._mouseDownAction(e,t)
};
DwtListView.prototype._mouseUpListener=function(a){
var s=this.getTargetItemDiv(a);
var n=this._handleColHeaderDrop(a);
var e=this._handleColSashDrop(a);
if(!s||s!=this._clickDiv||n||e){
delete this._clickDiv;
this._mouseUpAction(a,s);
return
}
delete this._clickDiv;
var t=this._getItemData(s,"type");
if(this._headerList&&t==DwtListView.TYPE_HEADER_ITEM){
if(a.button==DwtMouseEvent.LEFT){
this._columnClicked(s,a)
}else{
if(a.button==DwtMouseEvent.RIGHT){
var o=this._getActionMenuForColHeader();
if(o&&o instanceof DwtMenu){
o.popup(0,a.docX,a.docY)
}}}}else{
if(t==DwtListView.TYPE_LIST_ITEM){
if(a.button==DwtMouseEvent.LEFT||a.button==DwtMouseEvent.RIGHT){
this._itemClicked(s,a)
}}}
this._mouseUpAction(a,s)
};
DwtListView.prototype._mouseDownAction=function(e,t){};
DwtListView.prototype._mouseUpAction=function(e,t){};
DwtListView.prototype._doubleClickAction=function(e,t){
return true
};
DwtListView.prototype._doubleClickListener=function(t){
var a=this.getTargetItemDiv(t);
if(!a){
return
}
var e=this._getItemData(a,"type");
if(e==DwtListView.TYPE_LIST_ITEM){
if(!this._doubleClickAction(t,a)){
return
}
if(this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
DwtUiEvent.copy(this._selEv,t);
this._selEv.item=this.getItemFromElement(a);
this._selEv.detail=DwtListView.ITEM_DBL_CLICKED;
this._evtMgr.notifyListeners(DwtEvent.SELECTION,this._selEv)
}}};
DwtListView.prototype.emulateDblClick=function(e,t){
var o=document.getElementById(this._getItemId(e));
if(o){
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
target:o,button:DwtMouseEvent.LEFT}
);
a.kbNavEvent=t;
this._itemClicked(o,a);
this._doubleClickListener(a)
}};
DwtListView.prototype._selectItem=function(a,e,o){
if(!this.size()){
return
}
var t=(this._kbAnchor)?this._getSiblingElement(this._kbAnchor,a):this._parentEl.firstChild;
this._scrollList(t);
this._emulateSingleClick({
target:t,button:DwtMouseEvent.LEFT,shiftKey:e,kbNavEvent:o}
)
};
DwtListView.prototype._getSiblingElement=function(e,a){
if(!e){
return null
}
var t=a?e.nextSibling:e.previousSibling;
while(this._hasHiddenRows&&t&&!Dwt.getVisible(t)){
t=a?t.nextSibling:t.previousSibling
}
return(!t||(this._hasHiddenRows&&!Dwt.getVisible(t)))?e:t
};
DwtListView.prototype._scrollList=function(e){
Dwt.scrollIntoView(e,e.parentNode)
};
DwtListView.prototype._setRowHeight=function(){
if(!this._rowHeight){
var e=this._parentEl.firstChild;
this._rowHeight=e&&Dwt.getSize(e).y
}};
DwtListView.prototype._emulateSingleClick=function(e){
this._clickDiv=this.findItemDiv(e.target);
var t=new DwtMouseEvent();
this._setMouseEvent(t,e);
t.kbNavEvent=e.kbNavEvent;
this.notifyListeners(DwtEvent.ONMOUSEUP,t)
};
DwtListView.prototype._setKbFocusElement=function(e){
if(!this._list){
return
}
var a=this._kbAnchor;
if(e&&e!==true){
this._kbAnchor=e
}else{
if(this._kbAnchor){
this._kbAnchor=this._getSiblingElement(this._kbAnchor,e)
}else{
this._kbAnchor=this._parentEl.firstChild
}}
if(this._kbAnchor!=a){
if(a){
var t=this._selectedClass;
if(a.className.indexOf(t)!=-1){
Dwt.delClass(a,this._styleRe,t)
}else{
Dwt.delClass(a,this._styleRe)
}}
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}
if(this._kbAnchor&&!this._duringFocusByMouseDown){
this._scrollList(this._kbAnchor)
}};
DwtListView.prototype._itemSelected=function(e,a){
if(this._allowLeftSelection(e,a,a&&a.button)){
this._unmarkKbAnchorElement(true);
this.deselectAll();
this._selectedItems.add(e);
this._selAnchor=this._kbAnchor=e;
Dwt.delClass(e,this._styleRe,this._selectedClass);
if(this.hasFocus()){
Dwt.addClass(e,this._kbFocusClass)
}
var t=this.getItemFromElement(e);
this.firstSelIndex=(this._list&&t)?this._list.indexOf(t):-1
}};
DwtListView.prototype._itemClicked=function(s,d){
if(this._rightSelItem){
Dwt.delClass(this._rightSelItem,this._styleRe);
this._rightSelItem=null
}
var n=this._selectedItems.size();
var a=this._selectedItems.contains(s);
if((!d.shiftKey&&!d.ctrlKey)||!this.multiSelectEnabled){
if(d.button==DwtMouseEvent.LEFT||d.button==DwtMouseEvent.RIGHT){
this._selEv.detail=DwtListView.ITEM_SELECTED
}
if(d.button==DwtMouseEvent.LEFT){
this._itemSelected(s,d)
}else{
if(d.button==DwtMouseEvent.RIGHT&&!a&&this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
this._rightSelItem=s;
Dwt.delClass(s,this._styleRe,this._rightClickClass);
if(this._kbAnchor==s){
Dwt.addClass(s,this._kbFocusClass)
}}}}else{
if(d.button==DwtMouseEvent.LEFT){
if(d.ctrlKey){
this.setMultiSelection(s,a,d)
}else{
if(!this._selAnchor){
return
}
var r=this._getChildren()||s.parentNode.childNodes;
var l=r.length;
var o;
var e=0;
for(var h=0;
h<l;
h++){
o=r[h];
var u=this.getItemFromElement(o);
if(u===null){
continue
}
if(o==this._rightSelItem){
this._rightSelItem=null
}
if(o==s){
e++
}
var t=this._selectedClass;
if(o==this._selAnchor){
e++;
if(o.className.indexOf(t)==-1){
this._selectedItems.add(o)
}
Dwt.delClass(o,this._styleRe,t);
continue
}
if(e!=1&&o.className.indexOf(t)!=-1&&o!=s){
Dwt.delClass(o,this._styleRe);
this._selectedItems.remove(o)
}else{
if(e==1||o==s){
if(o.className.indexOf(t)==-1){
this._selectedItems.add(o)
}
Dwt.delClass(o,this._styleRe,t)
}}}
this._kbAnchor=s;
Dwt.addClass(this._kbAnchor,this._kbFocusClass);
var c=this._selectedItems.size();
if(n<c){
this._selEv.detail=DwtListView.ITEM_SELECTED
}else{
if(n>c){
this._selEv.detail=DwtListView.ITEM_DESELECTED
}else{
return
}}}}}
if(d.button==DwtMouseEvent.LEFT&&this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
if(this._setListEvent(d,this._selEv,s)){
this._evtMgr.notifyListeners(DwtEvent.SELECTION,this._selEv)
}}else{
if(d.button==DwtMouseEvent.RIGHT&&!d.shiftKey&&!d.ctrlKey&&this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
if(this._setListEvent(d,this._actionEv,s)){
this._evtMgr.notifyListeners(DwtEvent.ACTION,this._actionEv)
}}}};
DwtListView.prototype._setListEvent=function(t,a,e){
DwtUiEvent.copy(a,t);
a.kbNavEvent=t.kbNavEvent;
a.item=this.findItem(e);
return true
};
DwtListView.prototype._columnClicked=function(n,a){
var s=this.getItemFromElement(n);
if(!(s._sortable&&this.sortingEnabled)){
return
}
var o=this.getList();
var e=o?o.size():null;
var t=this._columnHasCustomQuery(s);
if(!e&&!t){
return
}
this._bSortAsc=(s._id==this._currentColId)?!this._bSortAsc:this._getDefaultSortbyForCol(s);
this._setSortedColStyle(s._id);
if(e>=1||t){
this._sortColumn(s,this._bSortAsc)
}};
DwtListView.prototype._columnHasCustomQuery=function(e){
return false
};
DwtListView.prototype._sortColumn=function(e,t){};
DwtListView.prototype._getActionMenuForColHeader=function(){
return null
};
DwtListView.prototype._getDefaultSortbyForCol=function(e){
return true
};
DwtListView.prototype._allowLeftSelection=function(t,a,e){
return true
};
DwtListView.prototype._setSortedColStyle=function(e){
if(this._currentColId&&(e!=this._currentColId)){
var s=this._headerIdHash[this._currentColId];
if(s&&!s._noSortArrow){
var r=s._field;
var h=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,r);
var o=document.getElementById(h);
if(o&&o.firstChild){
var t=(AjxImg._mode==AjxImg.SINGLE_IMG)?o.firstChild:o.firstChild.firstChild;
if(t){
t.style.visibility="hidden"
}}}
var c=document.getElementById(this._currentColId);
if(c){
c.className="DwtListView-Column"
}}
this._currentColId=e;
var s=this._headerIdHash[this._currentColId];
if(!s._noSortArrow){
var r=s._field;
var l=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,r);
var a=document.getElementById(l);
if(a){
AjxImg.setImage(a,this._bSortAsc?"ColumnUpArrow":"ColumnDownArrow");
var t=(AjxImg._mode==AjxImg.SINGLE_IMG)?a.firstChild:a.firstChild.firstChild;
if(t){
t.style.visibility="visible"
}}}
var n=document.getElementById(e);
if(n){
n.className="DwtListView-Column DwtListView-ColumnActive"
}};
DwtListView.prototype._resetList=function(){
if(this._list&&this._list.size()){
this._list.removeAll()
}
this._resetListView()
};
DwtListView.prototype._resetListView=function(){
var e;
while(this._parentEl&&this._parentEl.hasChildNodes()){
var e=this._parentEl.removeChild(this._parentEl.firstChild);
this._data[e.id]=null
}
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=null
};
DwtListView.prototype._destroyDragProxy=function(e){
this._data[e.id]=null;
DwtControl.prototype._destroyDragProxy.call(this,e)
};
DwtListView.prototype._handleColHeaderMove=function(r){
if(!this._headerClone){
if(!this._headerColX){
this._headerColX=r.docX;
return
}else{
var n=Math.abs(this._headerColX-r.docX);
if(n<DwtListView.COL_MOVE_THRESHOLD){
return
}}
this._headerClone=document.createElement("div");
var d=Dwt.getSize(this._clickDiv);
var t=AjxEnv.isIE?d.x:d.x-3;
var c=AjxEnv.isIE?d.y:d.y-5;
Dwt.setSize(this._headerClone,t,c);
Dwt.setPosition(this._headerClone,Dwt.ABSOLUTE_STYLE);
Dwt.setZIndex(this._headerClone,Dwt.Z_DND);
Dwt.setLocation(this._headerClone,Dwt.DEFAULT,r.docY);
this._headerClone.className=this._clickDiv.className+" DragProxy";
this._headerClone.innerHTML=this._clickDiv.innerHTML;
this._clickDiv.className="DwtListView-Column DwtListView-ColumnEmpty";
this._headerClone.style.borderTop="1px solid #777777";
var h=this._headerIdHash[this._clickDiv.id];
var l=h._field;
var o=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,l);
var a=document.getElementById(o);
if(a){
a.style.color="#FFFFFF"
}
this.shell.getHtmlElement().appendChild(this._headerClone)
}else{
var e=this.getTargetItemDiv(r);
var s=this._getItemData(e,"type");
if(s==DwtListView.TYPE_HEADER_ITEM){
if(this._headerCloneTarget&&(this._headerCloneTarget==this._clickDiv)){
this._headerCloneTarget=null
}else{
if(this._headerCloneTarget!=e){
this._headerCloneTarget=e
}}}else{
this._headerCloneTarget=null
}}
if(this._headerClone){
Dwt.setLocation(this._headerClone,r.docX+2)
}};
DwtListView.prototype._handleColHeaderResize=function(t){
if(!this._headerSash){
this._headerSash=document.createElement("div");
Dwt.setSize(this._headerSash,Dwt.DEFAULT,this.getSize().y);
Dwt.setPosition(this._headerSash,Dwt.ABSOLUTE_STYLE);
Dwt.setZIndex(this._headerSash,Dwt.Z_DND);
var a=this._getHeaderSashLocation();
this._headerSashFudgeX=a.x;
Dwt.setLocation(this._headerSash,Dwt.DEFAULT,a.y);
this._headerSash.className="DwtListView-ColumnSash";
this.getHtmlElement().appendChild(this._headerSash);
this._headerSashX=t.docX
}
var e=this._getParentForColResize();
var o=Dwt.toWindow(e.getHtmlElement(),0,0);
Dwt.setLocation(this._headerSash,(t.docX-o.x)+this._headerSashFudgeX)
};
DwtListView.prototype._getHeaderSashLocation=function(){
if(!this._tmpPoint){
this._tmpPoint=new DwtPoint()
}
this._tmpPoint.x=0;
this._tmpPoint.y=0;
return this._tmpPoint
};
DwtListView.prototype._handleColHeaderDrop=function(h){
this._headerColX=null;
if(this._headerClone==null||h.button==DwtMouseEvent.RIGHT){
return false
}
if(this._headerCloneTarget){
var e=this._getItemData(this._clickDiv,"index");
var a=this._getItemData(this._headerCloneTarget,"index");
this._reIndexColumn(e,a)
}
this._clickDiv.className=(this._clickDiv.id!=this._currentColId)?"DwtListView-Column":"DwtListView-Column DwtListView-ColumnActive";
var c=this._headerClone.parentNode;
if(c){
c.removeChild(this._headerClone)
}
delete this._headerClone;
var s=this._data[this._clickDiv.id];
if(s.type!=DwtListView.TYPE_HEADER_ITEM){
var l=this._headerIdHash[this._currentColId];
var r=l._sortable?l._field:null;
this.headerColCreated=false;
this.createHeaderHtml(r)
}else{
var l=this._headerIdHash[this._clickDiv.id];
var o=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,l._field);
var t=document.getElementById(o);
if(t){
t.style.color="#000000"
}}
for(var n=0;
n<this._headerList.length;
n++){
this._headerList[n]._width=this._calcRelativeWidth(n)
}
this._resetColWidth();
return true
};
DwtListView.prototype._reIndexColumn=function(o,a){
if(!this._headerList){
return
}
var e=this._headerList.length;
if(o<0||a<0||o>=e||a>=e||o==a){
return
}
var t=this._headerList.splice(o,1);
this._headerList.splice(a,0,t[0]);
this._relayout()
};
DwtListView.prototype._handleColSashDrop=function(c){
if(this._headerSash==null||c.button==DwtMouseEvent.RIGHT){
return false
}
var d=this._headerSash.parentNode;
if(d){
d.removeChild(this._headerSash)
}
delete this._headerSash;
for(var o=0;
o<this._headerList.length;
o++){
this._headerList[o]._width=this._calcRelativeWidth(o)
}
var a=this._getItemData(this._clickDiv,"index");
if(a==null){
return false
}
var u=c.docX-this._headerSashX;
var l=this._headerList[a];
var h=l;
var r;
var n=[];
if(u<0){
if((h==r)||!r){
r=this._getNextResizeableColumnHeader(h)
}
if(!r){
return false
}
u=Math.max(DwtListView.MIN_COLUMN_WIDTH-l._width,u);
l._width=Math.max(l._width+u,DwtListView.MIN_COLUMN_WIDTH);
r._width=Math.max(this._calcRelativeWidth(r._index)-u,DwtListView.MIN_COLUMN_WIDTH);
n.push(l._index,r._index)
}else{
if(u>0){
var s=u;
while(s>0){
if((h==r)||!r){
r=this._getNextResizeableColumnHeader(h,[],false)
}
if(!r){
u-=s;
break
}
var m=this._calcRelativeWidth(r._index);
var e=m-DwtListView.MIN_COLUMN_WIDTH;
if(s>e){
s-=e;
m=DwtListView.MIN_COLUMN_WIDTH
}else{
m-=s;
s=0
}
r._width=m;
n.push(r._index);
h=r
}
l._width=Math.max(l._width+u,DwtListView.MIN_COLUMN_WIDTH);
n.push(l._index)
}}
var t=this._getNextResizeableColumnHeader(l,n,true);
if(t){
t._width="auto"
}
this._relayout();
this._resetColWidth();
return true
};
DwtListView.prototype._calcRelativeWidth=function(a){
var t=this._headerList[a];
if(!t._width||(t._width&&t._width=="auto")){
var e=document.getElementById(t._id);
return(e)?(e.clientWidth-(AjxEnv.isIE?4:5)):null
}
return t._width
};
DwtListView.prototype._resetColWidth=function(){
if(!this.headerColCreated){
return
}
var s=this._getLastColumnIndex();
if(s){
var a=this._headerList[s];
var t=document.getElementById(a._id);
if(t){
var r=t.firstChild;
var e=16;
var n=this._listColDiv.clientWidth;
var o=this._listDiv.clientWidth;
if(n!=o){
t.style.width=r.style.width=(a._width!=null&&a._width!="auto")?(a._width+e):(t.clientWidth+e)
}else{
t.style.width=r.style.width=(a._width||"")
}}}};
DwtListView.prototype._getLastColumnIndex=function(){
var t=null;
if(this._headerList){
var e=this._headerList.length-1;
while(t==null&&e>=0){
if(this._headerList[e]._visible){
t=e
}
e--
}}
return t
};
DwtListView.prototype._getNextResizeableColumnIndex=function(n,e,o){
e=e?AjxUtil.arrayAsHash(e):{};
e[n]=true;
if(this._headerList){
for(var a=n+1;
a<this._headerList.length;
a++){
var t=this._headerList[a];
if(e[a]){
continue
}
if(t._visible&&t._resizeable){
return a
}}
if(o){
for(var a=0;
a<n;
a++){
if(e[a]){
continue
}
var t=this._headerList[a];
if(t._visible&&t._resizeable){
return a
}}}}
return null
};
DwtListView.prototype._getNextResizeableColumnHeader=function(o,e,a){
var t=this._getNextResizeableColumnIndex(o._index,e,a);
return(t!==null)?this._headerList[t]:false
};
DwtListView.prototype._relayout=function(){
this.headerColCreated=false;
var a=this._headerIdHash[this._currentColId];
var e=(a&&a._sortable)?a._field:null;
var t=this.getSelection()[0];
this.setUI(e);
this.setSelection(t,true)
};
DwtListView.prototype._getParentForColResize=function(){
return this
};
DwtListView.prototype._sizeChildren=function(e){
if(this.headerColCreated&&this._listDiv&&(e!=Dwt.DEFAULT)){
Dwt.setSize(this._listDiv,Dwt.DEFAULT,e-DwtListView.HEADERITEM_HEIGHT);
return true
}else{
return false
}};
DwtListView.prototype._getChildren=function(){
return null
};
DwtListView.prototype._focus=function(){
if(this.size()==0){
return
}
if(this._kbAnchor){
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}else{
this._setKbFocusElement()
}};
DwtListView.prototype._blur=function(){
this._unmarkKbAnchorElement()
};
DwtListView.prototype._unmarkKbAnchorElement=function(e){
if(this._kbAnchor){
if(this._selectedItems.contains(this._kbAnchor)){
Dwt.delClass(this._kbAnchor,this._styleRe,this._selectedClass)
}else{
Dwt.delClass(this._kbAnchor,this._styleRe)
}}
if(e){
this._kbAnchor=null
}};
DwtListView.prototype._getFirstItem=function(){
var e=this._list.getArray();
if(e&&e.length>1){
return e[0]
}
return null
};
DwtListView.prototype._getLastItem=function(){
var e=this._list.getArray();
if(e&&e.length>1){
return e[e.length-1]
}
return null
};
DwtListHeaderItem=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtListView.PARAMS);
this._field=t.field;
this._label=t.text;
this._iconInfo=t.icon;
this._sortable=t.sortable;
this._noSortArrow=t.noSortArrow;
this._resizeable=t.resizeable;
this._visible=(t.visible!==false);
this._name=t.name||t.text;
this._align=t.align;
this._noRemove=t.noRemove;
this._tooltip=t.tooltip;
var e=parseInt(t.width);
if(isNaN(e)||!e){
this._width="auto";
this._variable=true;
this._resizeable=true
}else{
if(String(e)==String(t.width)){
this._width=e
}else{
this._width=parseInt(String(t.width).substr(0,String(e).length));
this._widthUnits=AjxStringUtil.getUnitsFromSizeString(t.width)
}}};
DwtListHeaderItem.prototype.isDwtListHeaderItem=true;
DwtListHeaderItem.prototype.toString=function(){
return"DwtListHeaderItem"
};
DwtListHeaderItem.PARAMS=["id","text","icon","width","sortable","resizeable","visible","name","align","noRemove","view"];
DwtListHeaderItem.sortCompare=function(t,e){
return t._index<e._index?-1:(t._index>e._index?1:0)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtButton")){
DwtButton=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtButton.PARAMS);
a.className=a.className||"ZButton";
DwtLabel.call(this,a);
var t=a.parent;
if(!t._hasSetMouseEvents||AjxEnv.isIE){
this._setMouseEvents()
}
var e;
if(t._hasSetMouseEvents){
e=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[]
}else{
e=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
e=e.concat([DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP])
}
if(e&&e.length){
this._setEventHdlrs(e)
}
this._listeners=a.listeners||DwtButton._listeners;
this._addMouseListeners();
this._ignoreInternalOverOut=true;
this._dropDownEvtMgr=new AjxEventMgr();
this._selected=false;
this._actionTiming=a.actionTiming||DwtButton.ACTION_MOUSEUP;
this.__preventMenuFocus=null;
this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_BELOW
};
DwtButton.prototype=new DwtLabel;
DwtButton.prototype.constructor=DwtButton;
DwtButton.prototype.isDwtButton=true;
DwtButton.prototype.toString=function(){
return"DwtButton"
};
DwtButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index","listeners"];
DwtButton.TOGGLE_STYLE=DwtLabel._LAST_STYLE*2;
DwtButton.ALWAYS_FLAT=DwtLabel._LAST_STYLE*4;
DwtButton._LAST_STYLE=DwtButton.ALWAYS_FLAT;
DwtButton.ACTION_MOUSEUP=1;
DwtButton.ACTION_MOUSEDOWN=2;
DwtButton.NOTIFY_WINDOW=500;
DwtButton.MENU_POPUP_STYLE_BELOW="BELOW";
DwtButton.MENU_POPUP_STYLE_ABOVE="ABOVE";
DwtButton.MENU_POPUP_STYLE_RIGHT="RIGHT";
DwtButton.MENU_POPUP_STYLE_CASCADE="CASCADE";
DwtButton.prototype.TEMPLATE="dwt.Widgets#ZButton";
DwtButton.prototype.dispose=function(){
if(this._menu&&this._menu.isDwtMenu&&(this._menu.parent==this)){
this._menu.dispose();
this._menu=null
}
DwtLabel.prototype.dispose.call(this)
};
DwtButton.prototype.addSelectionListener=function(t,e){
this.addListener(DwtEvent.SELECTION,t,e)
};
DwtButton.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype.removeSelectionListeners=function(){
this.removeAllListeners(DwtEvent.SELECTION)
};
DwtButton.prototype.addDropDownSelectionListener=function(e){
return this._dropDownEvtMgr.addListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype.removeDropDownSelectionListener=function(e){
this._dropDownEvtMgr.removeListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype._dropDownImg="SelectPullDownArrow";
DwtButton.prototype._dropDownDepImg="SelectPullDownArrow";
DwtButton.prototype._dropDownHovImg="SelectPullDownArrowHover";
DwtButton.prototype.setDropDownImages=function(t,a,o,e){
this._dropDownImg=t;
this._dropDownHovImg=o;
this._dropDownDepImg=e
};
DwtButton.prototype.setDropDownHovImage=function(e){
this._dropDownHovImg=e
};
DwtButton.prototype._addMouseListeners=function(){
var t=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP];
t=t.concat(AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]);
for(var e=0;
e<t.length;
e++){
this.addListener(t[e],this._listeners[t[e]])
}};
DwtButton.prototype._removeMouseListeners=function(){
var t=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP];
t=t.concat(AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]);
for(var e=0;
e<t.length;
e++){
this.removeListener(t[e],this._listeners[t[e]])
}};
DwtButton.prototype.setDisplayState=function(t,e){
if(this._selected&&t!=DwtControl.SELECTED&&!e){
t=[DwtControl.SELECTED,t].join(" ")
}
DwtLabel.prototype.setDisplayState.call(this,t)
};
DwtButton.prototype.setEnabled=function(t){
if(t!=this._enabled){
DwtLabel.prototype.setEnabled.call(this,t);
if(t){
var a=(AjxEnv.isIE)?this.getHtmlElement().firstChild:null;
if(a){
var e=a.className;
a.className="";
a.className=e
}
this._addMouseListeners();
if(this._menu){
this._setDropDownCellMouseHandlers(true);
if(this._dropDownEl&&this._dropDownImg){
AjxImg.setImage(this._dropDownEl,this._dropDownImg)
}}}else{
this._removeMouseListeners();
if(this._menu){
this._setDropDownCellMouseHandlers(false);
if(this._dropDownEl&&this._dropDownImg){
AjxImg.setDisabledImage(this._dropDownEl,this._dropDownImg)
}}}}};
DwtButton.prototype.setImage=function(e){
if(this.whatToShow&&!this.whatToShow.showImage){
return
}
DwtLabel.prototype.setImage.call(this,e);
this._setMinWidth()
};
DwtButton.prototype.setText=function(e){
if(this.whatToShow&&!this.whatToShow.showText){
return
}
DwtLabel.prototype.setText.call(this,e);
this._setMinWidth()
};
DwtButton.prototype._setMinWidth=function(){
if(this.getText()!=null){
Dwt.addClass(this.getHtmlElement(),"ZHasText")
}else{
Dwt.delClass(this.getHtmlElement(),"ZHasText")
}};
DwtButton.prototype.setHoverImage=function(e){
this._hoverImageInfo=e
};
DwtButton.prototype.setMenu=function(e){
e=Dwt.getParams(arguments,DwtButton.setMenuParams,(arguments.length==1&&!arguments[0].menu));
this._menu=e.menu;
if(this._menu){
if(this._menu.isDwtMenu){
this._shouldToggleMenu=(e.shouldToggle===true);
if(e.popupAbove){
this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_ABOVE
}else{
if(e.popupRight){
this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_RIGHT
}else{
this._menuPopupStyle=e.menuPopupStyle||DwtButton.MENU_POPUP_STYLE_BELOW
}}}else{
this._savedMenuParams=e
}
if(this._dropDownEl){
Dwt.addClass(this.getHtmlElement(),"ZHasDropDown");
if(this._dropDownImg){
AjxImg.setImage(this._dropDownEl,this._dropDownImg)
}
if(this._enabled){
this._setDropDownCellMouseHandlers(true)
}
if(this._menu.isDwtMenu){
this._menu.setAssociatedElementId(this._dropDownEl.id)
}}
if((this.__preventMenuFocus!=null)&&this._menu.isDwtMenu){
this._menu.dontStealFocus(this.__preventMenuFocus)
}}else{
if(this._dropDownEl){
Dwt.delClass(this.getHtmlElement(),"ZHasDropDown");
this._dropDownEl.innerHTML=""
}}};
DwtButton.setMenuParams=["menu","shouldToggle","followIconStyle","popupAbove","popupRight"];
DwtButton.prototype._setDropDownCellMouseHandlers=function(e){
this._dropDownEventsEnabled=e
};
DwtButton.prototype.getMenu=function(e){
if(this._menu&&this._menu.isAjxCallback){
if(e){
return null
}
var a=this._menu;
var t=this._savedMenuParams||{};
t.menu=a.run(this);
this.setMenu(t);
if((this.__preventMenuFocus!=null)&&(this._menu.isDwtMenu)){
this._menu.dontStealFocus(this.__preventMenuFocus)
}}
if(this._menu){
this.getHtmlElement().setAttribute("menuId",this._menu._htmlElId)
}
return this._menu
};
DwtButton.prototype.resetClassName=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype.setActionTiming=function(e){
this._actionTiming=e
};
DwtButton.prototype.setHovered=function(e){
this.setDisplayState(e?DwtControl.HOVER:DwtControl.NORMAL)
};
DwtButton.prototype.setEnabledImage=function(e){
this._enabledImageInfo=e;
this.setImage(e)
};
DwtButton.prototype.setDepressedImage=function(e){
this._depressedImageInfo=e
};
DwtButton.prototype.setSelected=function(e){
if(this._selected!=e){
this._selected=e;
this.setDisplayState(e?DwtControl.SELECTED:DwtControl.NORMAL)
}};
DwtButton.prototype.isToggled=function(){
return this._selected
};
DwtButton.prototype.popup=function(o){
o=o||this.getMenu();
if(!o){
return
}
var c=o.parent;
var s=c.getBounds();
var l=o.shell.getSize();
var e=o.getSize();
var d=c.getHtmlElement();
var a=Dwt.toWindow(d,0,0);
var t=(d.style.borderLeftWidth=="")?0:parseInt(d.style.borderLeftWidth);
var h;
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_RIGHT){
h=a.x+s.width-e.x
}else{
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_CASCADE){
h=a.x+s.width
}else{
h=a.x+t;
h=((h+e.x)>=l.x)?l.x-e.x:h
}}
var r;
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_ABOVE){
r=a.y-e.y
}else{
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_CASCADE){
r=a.y
}else{
var n=(d.style.borderTopWidth=="")?0:parseInt(d.style.borderTopWidth);
n+=(d.style.borderBottomWidth=="")?0:parseInt(d.style.borderBottomWidth);
r=a.y+s.height+n
}}
o.popup(0,h,r)
};
DwtButton.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_BUTTON
};
DwtButton.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.SELECT:this._emulateSingleClick();
break;
case DwtKeyMap.SUBMENU:var a=this.getMenu();
if(!a){
return false
}
this._emulateDropDownClick();
a.setSelectedItem(0);
break
}
return true
};
DwtButton.prototype._emulateSingleClick=function(){
this.trigger();
var e=this.getHtmlElement();
var t=Dwt.toWindow(e);
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
dwtObj:this,target:e,button:DwtMouseEvent.LEFT,docX:t.x,docY:t.y}
);
if(this._actionTiming==DwtButton.ACTION_MOUSEDOWN){
this.notifyListeners(DwtEvent.ONMOUSEDOWN,a)
}else{
this.notifyListeners(DwtEvent.ONMOUSEUP,a)
}};
DwtButton.prototype._emulateDropDownClick=function(){
var e=this._dropDownEl;
if(!e){
return
}
var t=Dwt.toWindow(e);
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
dwtObj:this,target:e,button:DwtMouseEvent.LEFT,docX:t.x,docY:t.y}
);
DwtButton._dropDownCellMouseDownHdlr(a)
};
DwtButton.prototype._focusByMouseUpEvent=function(){
if(!(this.parent&&(this.parent instanceof DwtToolBar)&&this.parent.noFocus)){
DwtShell.getShell(window).getKeyboardMgr().grabFocus(this.getTabGroupMember())
}};
DwtButton.prototype._focus=function(){
this.setDisplayState(DwtControl.FOCUSED)
};
DwtButton.prototype._blur=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._toggleMenu=function(){
if(this._shouldToggleMenu){
var e=this.getMenu();
if(!e.isPoppedUp()){
this.popup();
this._menuUp=true
}else{
e.popdown();
this._menuUp=false;
this.deactivate()
}}else{
this.popup()
}};
DwtButton.prototype._isDropDownEvent=function(t){
if(this._dropDownEventsEnabled&&this._dropDownEl){
var e=t.docX;
var a=Dwt.toWindow(this._dropDownEl,0,0,window).x;
if(e>=a){
return true
}}
return false
};
DwtButton.prototype.trigger=function(){
if(this._depressedImageInfo){
this.setImage(this._depressedImageInfo)
}
this.setDisplayState(DwtControl.ACTIVE,true);
this.isActive=true
};
DwtButton.prototype.deactivate=function(){
this._showHoverImage(true);
if(this._style&DwtButton.TOGGLE_STYLE){
this._selected=!this._selected
}
this.setDisplayState(DwtControl.HOVER)
};
DwtButton.prototype.dontStealFocus=function(e){
if(e==null){
e=true
}
if(this._menu&&this._menu.isDwtMenu){
this._menu.dontStealFocus(e)
}
this.__preventMenuFocus=e
};
DwtButton.prototype._showHoverImage=function(t){
if(this._hoverImageInfo){
var e=this._getIconEl();
if(e){
var a=t?this._hoverImageInfo:this.__imageInfo;
e.firstChild.className=AjxImg.getClassForImage(a)
}}};
DwtButton.prototype._handleClick=function(t){
if(this.isListenerRegistered(DwtEvent.SELECTION)){
var e=(new Date()).getTime();
if(!this._lastNotify||(e-this._lastNotify>DwtButton.NOTIFY_WINDOW)){
var a=DwtShell.selectionEvent;
DwtUiEvent.copy(a,t);
a.item=this;
a.detail=(typeof this.__detail=="undefined")?0:this.__detail;
this.notifyListeners(DwtEvent.SELECTION,a);
this._lastNotify=e;
this.shell.notifyGlobalSelection(a)
}}else{
if(this._menu){
if(this._menu.isDwtMenu&&!this.isListenerRegistered(DwtEvent.SELECTION)){
this._menu.setAssociatedObj(this)
}
this._toggleMenu()
}}};
DwtButton.prototype._setMouseOutClassName=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._createHtmlFromTemplate=function(e,t){
DwtLabel.prototype._createHtmlFromTemplate.call(this,e,t);
this._dropDownEl=document.getElementById(t.id+"_dropdown")
};
DwtButton._dropDownCellMouseDownHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,a);
if(e.button==DwtMouseEvent.LEFT){
if(this._depImg){
AjxImg.setImage(this,this._depImg)
}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtButton._dropDownCellMouseUpHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(e.button==DwtMouseEvent.LEFT){
if(this._dropDownHovImg&&!this.noMenuBar){
AjxImg.setImage(this,this._dropDownHovImg)
}
DwtEventManager.notifyListeners(DwtEvent.ONMOUSEDOWN,e);
var o=DwtControl.getTargetControl(t);
if(o){
if(o.getMenu()&&o.getMenu().isPoppedUp()){
o.getMenu().popdown()
}else{
if(o._menu&&o._menu.isAjxCallback){
o.popup()
}
if(o._dropDownEvtMgr.isListenerRegistered(DwtEvent.SELECTION)){
var a=DwtShell.selectionEvent;
DwtUiEvent.copy(a,e);
a.item=o;
o._dropDownEvtMgr.notifyListeners(DwtEvent.SELECTION,a)
}else{
o._toggleMenu()
}}}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtButton._mouseOverListener=function(o){
var t=o.dwtObj;
if(!t){
return false
}
t._showHoverImage(true);
t.setDisplayState(DwtControl.HOVER);
var n=t._dropDownEl;
if(t._menu&&n&&t._dropDownHovImg&&!t.noMenuBar&&t.isListenerRegistered(DwtEvent.SELECTION)){
if(t._dropDownHovImg){
AjxImg.setImage(n,t._dropDownHovImg)
}}
if(AjxEnv.isIE){
if(o&&o.target&&o.target.firstChild){
var a=o.target.firstChild;
var e=a.className;
a.className="";
a.className=e
}}
o._stopPropagation=true
};
DwtButton._mouseOutListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
e._showHoverImage(false);
e._setMouseOutClassName();
e.isActive=false;
var a=e._dropDownEl;
if(e._menu&&a&&e._dropDownImg){
AjxImg.setImage(a,e._dropDownImg)
}};
DwtButton._mouseDownListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
if(e._isDropDownEvent(t)){
return DwtButton._dropDownCellMouseDownHdlr(t)
}
if(t.button!=DwtMouseEvent.LEFT){
return
}
var a=e._dropDownEl;
if(e._menu&&a&&e._dropDownDepImg){
AjxImg.setImage(a,e._dropDownDepImg)
}
switch(e._actionTiming){
case DwtButton.ACTION_MOUSEDOWN:e.trigger();
e._handleClick(t);
break;
case DwtButton.ACTION_MOUSEUP:e.trigger();
break
}};
DwtButton._mouseUpListener=function(a){
var e=a.dwtObj;
if(!e){
return false
}
if(e._isDropDownEvent(a)){
return DwtButton._dropDownCellMouseUpHdlr(a)
}
if(a.button!=DwtMouseEvent.LEFT){
return
}
var o=e._dropDownEl;
if(e._menu&&o&&e._dropDownHovImg&&!e.noMenuBar){
AjxImg.setImage(o,e._dropDownHovImg)
}
switch(e._actionTiming){
case DwtButton.ACTION_MOUSEDOWN:e.deactivate();
break;
case DwtButton.ACTION_MOUSEUP:var t=e.getHtmlElement();
if(e.isActive){
e.deactivate();
e._handleClick(a)
}
break
}};
DwtButton._listeners={};
DwtButton._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtButton._mouseOutListener);
DwtButton._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtButton._mouseDownListener);
DwtButton._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtButton._mouseUpListener);
DwtButton._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtButton._mouseOutListener)
}
if(AjxPackage.define("ajax.dwt.widgets.DwtLinkButton")){
DwtLinkButton=function(e){
e.className=e.className||"ZButtonLink";
DwtButton.call(this,e)
};
DwtLinkButton.prototype=new DwtButton;
DwtLinkButton.prototype.constructor=DwtLinkButton;
DwtLinkButton.prototype.TEMPLATE="dwt.Widgets#ZLinkButton";
DwtLinkButton.prototype._dropDownImg=null;
DwtLinkButton.prototype._dropDownDepImg=null;
DwtLinkButton.prototype._dropDownHovImg=null;
DwtLinkButton.prototype.toString=function(){
return"DwtLinkButton"
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtBorderlessButton")){
DwtBorderlessButton=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtBorderlessButton.PARAMS);
DwtButton.call(this,e)
};
DwtBorderlessButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index"];
DwtBorderlessButton.prototype=new DwtButton;
DwtBorderlessButton.prototype.constructor=DwtBorderlessButton;
DwtBorderlessButton.prototype.toString=function(){
return"DwtBorderlessButton"
};
DwtBorderlessButton.prototype.TEMPLATE="dwt.Widgets#ZBorderlessButton"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMenuItem")){
DwtMenuItem=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtMenuItem.PARAMS);
var t=a.parent;
if(!(t&&t.isDwtMenu)){
throw new DwtException("Parent must be a DwtMenu object",DwtException.INVALIDPARENT,"DwtMenuItem")
}
var e=a.style=a.style||DwtMenuItem.NO_STYLE;
if(t._style==DwtMenu.BAR_STYLE&&e!=DwtMenuItem.PUSH_STYLE){
throw new DwtException("DwtMenuItemInit: invalid style",DwtException.INVALID_PARAM,"DwtMenuItem")
}
e&=~DwtLabel.IMAGE_RIGHT;
e|=DwtButton.ALWAYS_FLAT|DwtLabel.IMAGE_LEFT;
a.className=(e&DwtMenuItem.SEPARATOR_STYLE)?"ZMenuItemSeparator":(a.className||"ZMenuItem");
a.listeners=DwtMenuItem._listeners;
DwtButton.call(this,a);
this.setDropDownImages("Cascade","Cascade","Cascade","Cascade");
this._radioGroupId=a.radioGroupId;
if(t._addItem){
t._addItem(this,a.index)
}
if(!(e&DwtMenuItem.SEPARATOR_STYLE)){
this.addSelectionListener(this.__handleItemSelect.bind(this))
}};
DwtMenuItem.PARAMS=["parent","style","radioGroupId","index","className","posStyle","id"];
DwtMenuItem.prototype=new DwtButton;
DwtMenuItem.prototype.constructor=DwtMenuItem;
DwtMenuItem.prototype.isDwtMenuItem=true;
DwtMenuItem.prototype.toString=function(){
return"DwtMenuItem"
};
DwtMenuItem.CHECKED=1;
DwtMenuItem.UNCHECKED=2;
DwtMenuItem.NO_STYLE=0;
DwtMenuItem.CHECK_STYLE=DwtButton._LAST_STYLE*2;
DwtMenuItem.RADIO_STYLE=DwtButton._LAST_STYLE*4;
DwtMenuItem.SEPARATOR_STYLE=DwtButton._LAST_STYLE*8;
DwtMenuItem.CASCADE_STYLE=DwtButton._LAST_STYLE*16;
DwtMenuItem.PUSH_STYLE=DwtButton._LAST_STYLE*32;
DwtMenuItem.SELECT_STYLE=DwtButton._LAST_STYLE*64;
DwtMenuItem._LAST_STYLE=DwtMenuItem.SELECT_STYLE;
DwtMenuItem._MENU_POPUP_DELAY=250;
DwtMenuItem._MENU_POPDOWN_DELAY=250;
DwtMenuItem.prototype.TEMPLATE="dwt.Widgets#ZMenuItem";
DwtMenuItem.prototype.SEPARATOR_TEMPLATE="dwt.Widgets#ZMenuItemSeparator";
DwtMenuItem.prototype.BLANK_CHECK_TEMPLATE="dwt.Widgets#ZMenuItemBlankCheck";
DwtMenuItem.prototype.BLANK_ICON_TEMPLATE="dwt.Widgets#ZMenuItemBlankIcon";
DwtMenuItem.prototype.BLANK_CASCADE_TEMPLATE="dwt.Widgets#ZMenuItemBlankCascade";
DwtMenuItem.prototype.dispose=function(){
delete this._checkEl;
DwtButton.prototype.dispose.call(this)
};
DwtMenuItem.create=function(t){
var e=new DwtMenuItem(t);
if(t.imageInfo){
e.setImage(t.imageInfo)
}
if(t.text){
e.setText(t.text)
}
e.setEnabled(t.enabled!==false);
return e
};
DwtMenuItem.prototype.getChecked=function(){
return this._itemChecked
};
DwtMenuItem.prototype.setChecked=function(t,e){
this._setChecked(t,null,e);
this.parent._checkItemAdded(this)
};
DwtMenuItem.prototype.setImage=function(e){
DwtButton.prototype.setImage.call(this,e);
this.parent._iconItemAdded(this)
};
DwtMenuItem.prototype.setText=function(e){
DwtButton.prototype.setText.call(this,e);
if(this.parent.isPoppedUp()){
this.parent.render()
}};
DwtMenuItem.prototype.setMenu=function(e){
var e=Dwt.getParams(arguments,DwtButton.setMenuParams);
DwtButton.prototype.setMenu.call(this,e);
this.parent._submenuItemAdded(this)
};
DwtMenuItem.prototype.setHoverDelay=function(e){
this._hoverDelay=e
};
DwtMenuItem.prototype.setShortcut=function(e){
if(e&&this._dropDownEl){
this._dropDownEl.innerHTML=e
}};
DwtMenuItem.prototype.setSelectableWithSubmenu=function(e){
this._selectableWithSubmenu=e
};
DwtMenuItem.prototype.isSeparator=function(){
return Boolean(this._style&DwtMenuItem.SEPARATOR_STYLE)
};
DwtMenuItem.prototype._createHtml=function(e){
var t=this.isSeparator()?this.SEPARATOR_TEMPLATE:this.TEMPLATE;
DwtButton.prototype._createHtml.call(this,e||t)
};
DwtMenuItem.prototype._createHtmlFromTemplate=function(e,t){
DwtButton.prototype._createHtmlFromTemplate.call(this,e,t);
this._checkEl=document.getElementById(t.id+"_check")
};
DwtMenuItem.prototype._setChecked=function(s,n,t){
var e=this._style&DwtMenuItem.CHECK_STYLE;
var o=this._style&DwtMenuItem.RADIO_STYLE;
if((e||o)&&this._itemChecked!=s){
this._itemChecked=s;
if(this._checkEl){
this._checkEl.innerHTML="";
var a=s?(e?"MenuCheck":"MenuRadio"):"Blank_9";
AjxImg.setImage(this._checkEl,a);
if(s){
if(o){
this.parent._radioItemSelected(this,t)
}}}}};
DwtMenuItem.prototype._checkItemAdded=function(e){};
DwtMenuItem.prototype._checkedItemsRemoved=function(){};
DwtMenuItem.prototype._submenuItemAdded=function(){
if(this.isSeparator()){
return
}
if(this._cascCell==null){
this._cascCell=this._row.insertCell(-1);
this._cascCell.noWrap=true
}};
DwtMenuItem.prototype._submenuItemRemoved=function(){
if(this._dropDownEl){
this._dropDownEl.innerHTML=""
}};
DwtMenuItem.prototype._popupMenu=function(n,u){
var e=this.getMenu();
var t=this.parent.parent;
var c=this.getBounds();
var r=e.shell.getSize();
var m=e.getSize();
var d;
var h;
var o;
var l;
var a=t.getHtmlElement();
if(t._style==DwtMenu.BAR_STYLE){
o=(a.style.borderLeftWidth=="")?0:parseInt(a.style.borderLeftWidth);
d=c.x+o;
l=(a.style.borderTopWidth=="")?0:parseInt(a.style.borderTopWidth);
l+=(a.style.borderBottomWidth=="")?0:parseInt(a.style.borderBottonWidth);
h=c.y+c.height+l;
d=((d+m.x)>=r.x)?d-(d+m.x-r.x):d
}else{
o=(a.style.borderLeftWidth=="")?0:parseInt(a.style.borderLeftWidth);
o+=(a.style.borderRightWidth=="")?0:parseInt(a.style.borderRightWidth);
d=c.x+c.width+o;
l=(a.style.borderTopWidth=="")?0:parseInt(a.style.borderTopWidth);
h=c.y+l
}
e.popup(n,d,h,u)
};
DwtMenuItem.prototype._popdownMenu=function(){
var e=this.getMenu();
if(e){
e.popdown()
}};
DwtMenuItem.prototype._isMenuPoppedUp=function(){
var e=this.getMenu();
return(e&&e.isPoppedUp())
};
DwtMenuItem.prototype.__handleItemSelect=function(e){
this.setDisplayState(DwtControl.NORMAL);
if(this.isStyle(DwtMenuItem.CHECK_STYLE)){
this._setChecked(!this._itemChecked,null,true);
e.detail=this.getChecked()?DwtMenuItem.CHECKED:DwtMenuItem.UNCHECKED
}else{
if(this.isStyle(DwtMenuItem.RADIO_STYLE)){
this._setChecked(true,true);
this.parent._radioItemSelected(this,true);
e.detail=this.getChecked()?DwtMenuItem.CHECKED:DwtMenuItem.UNCHECKED
}else{
if(this.isStyle(DwtMenuItem.PUSH_STYLE)){
if(this._menu){
if(this._isMenuPoppedUp()){
DwtMenu.closeActiveMenu(e)
}else{
this._popupMenu()
}}
return
}}}
if(!this.isStyle(DwtMenuItem.CASCADE_STYLE)){
if(this._selectableWithSubmenu||!this._menu||!this._menu.isPoppedUp||!this._menu.isPoppedUp()){
DwtMenu.closeActiveMenu(e)
}}};
DwtMenuItem._mouseOverListener=function(a){
var e=a.dwtObj;
if(!e){
return false
}
var o=e.parent;
if(o._hoveredItem){
var t=new DwtMouseEvent();
t.dwtObj=o._hoveredItem;
DwtButton._mouseOutListener(t)
}
if(e.isSeparator()){
return false
}
DwtButton._mouseOverListener(a,e);
o._hoveredItem=e;
o._popdownSubmenus();
if(e._menu&&!a.ersatz){
e._popupMenu(e._hoverDelay)
}};
DwtMenuItem._mouseOutListener=function(a){
var t=a.dwtObj;
var e=t&&t.getMenu();
if(e&&e.isPoppedUp()){
return
}
DwtButton._mouseOutListener(a);
if(t){
t.parent._hoveredItem=null
}};
DwtMenuItem.prototype.getRowElement=function(){
var e=this._textEl?this._textEl:this._iconEl?this._iconEl:this._dropDownEl;
if(e){
return e.parentNode
}};
DwtMenuItem._listeners={};
DwtMenuItem._listeners[DwtEvent.ONMOUSEOVER]=DwtMenuItem._mouseOverListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEOUT]=DwtMenuItem._mouseOutListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEDOWN]=DwtButton._mouseDownListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEUP]=DwtButton._mouseUpListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEENTER]=DwtMenuItem._mouseOverListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSELEAVE]=DwtButton._mouseOutListener.bind()
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMenu")){
DwtMenu=function(n){
this._created=false;
if(arguments.length==0){
return
}
n=Dwt.getParams(arguments,DwtMenu.PARAMS);
this._origStyle=n.style;
var a=n.parent;
if(a){
if(a instanceof DwtMenuItem||a instanceof DwtButton){
if(n.style==DwtMenu.GENERIC_WIDGET_STYLE){
this._style=n.style
}else{
this._style=DwtMenu.DROPDOWN_STYLE
}}else{
this._style=n.style||DwtMenu.POPUP_STYLE
}
if(!n.posStyle){
n.posStyle=(this._style==DwtMenu.BAR_STYLE)?DwtControl.STATIC_STYLE:DwtControl.ABSOLUTE_STYLE
}}
n.className=n.className||"DwtMenu";
this._layoutStyle=n.layout==null||n.layout;
if(this._layoutStyle===true){
this._layoutStyle=DwtMenu.LAYOUT_CASCADE
}else{
if(this._layoutStyle===false){
this._layoutStyle=DwtMenu.LAYOUT_STACK
}}
this._maxRows=this._layoutStyle&&n.maxRows||0;
this._congruent=n.congruent;
n.parent=(a instanceof DwtShell)?a:a.shell;
DwtComposite.call(this,n);
this.parent=a;
var e=(this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE);
if(e&&(this._layoutStyle==DwtMenu.LAYOUT_STACK)){
this.setScrollStyle(DwtControl.SCROLL)
}
if(!a){
return
}
var t=AjxEnv.isIE?[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP]:[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
this._setEventHdlrs(t);
this._hasSetMouseEvents=true;
var o=this.getHtmlElement();
if(n.posStyle!=DwtControl.STATIC_STYLE){
Dwt.setLocation(o,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}
if(this._style!=DwtMenu.COLOR_PICKER_STYLE&&this._style!=DwtMenu.CALENDAR_PICKER_STYLE&&this._style!=DwtMenu.GENERIC_WIDGET_STYLE){
this._table=document.createElement("table");
this._table.border=this._table.cellPadding=this._table.cellSpacing=0;
this._table.className="DwtMenuTable";
this._table.id=Dwt.getNextId();
if(this._layoutStyle==DwtMenu.LAYOUT_SCROLL){
this._setupScroll()
}else{
o.appendChild(this._table)
}
this._table.backgroundColor=DwtCssStyle.getProperty(o,"background-color")
}
if(n.style!=DwtMenu.BAR_STYLE){
this.setZIndex(Dwt.Z_HIDDEN);
this._isPoppedUp=false
}else{
DwtMenu._activeMenuIds.add(o.id,null,true);
this._isPoppedUp=true
}
this._popdownAction=new AjxTimedAction(this,this._doPopdown);
this._popdownActionId=-1;
this._popupAction=new AjxTimedAction(this,this._doPopup);
this._popupActionId=-1;
this._outsideListener=new AjxListener(null,DwtMenu._outsideMouseDownListener);
this._menuItemsHaveChecks=false;
this._menuItemsHaveIcons=false;
this._menuItemsWithSubmenus=0;
this.__currentItem=null;
this.__preventMenuFocus=false;
this._tabGroup=new DwtTabGroup(this.toString(),true);
this._tabGroup.addMember(this);
this._created=true;
this._itemSelectionListener=new AjxListener(this,this._propagateItemSelection)
};
DwtMenu.PARAMS=["parent","style","className","posStyle","cascade","id"];
DwtMenu.prototype=new DwtComposite;
DwtMenu.prototype.constructor=DwtMenu;
DwtMenu.prototype.isDwtMenu=true;
DwtMenu.prototype.toString=function(){
return"DwtMenu"
};
DwtMenu.BAR_STYLE="BAR";
DwtMenu.POPUP_STYLE="POPUP";
DwtMenu.DROPDOWN_STYLE="DROPDOWN";
DwtMenu.COLOR_PICKER_STYLE="COLOR";
DwtMenu.CALENDAR_PICKER_STYLE="CALENDAR";
DwtMenu.GENERIC_WIDGET_STYLE="GENERIC";
DwtMenu.HAS_ICON="ZHasIcon";
DwtMenu.HAS_CHECK="ZHasCheck";
DwtMenu.HAS_SUBMENU="ZHasSubMenu";
DwtMenu.LAYOUT_STACK=0;
DwtMenu.LAYOUT_CASCADE=1;
DwtMenu.LAYOUT_SCROLL=2;
DwtMenu._activeMenuUp=false;
DwtMenu._activeMenuIds=new AjxVector();
DwtMenu._activeMenus=new AjxVector();
DwtMenu.prototype.dispose=function(){
this._table=null;
DwtComposite.prototype.dispose.call(this);
if(!(this.parent instanceof DwtShell)){
this.shell.removeChild(this)
}};
DwtMenu.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
DwtMenu.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtMenu.prototype.addPopupListener=function(e){
this.addListener(DwtEvent.POPUP,e)
};
DwtMenu.prototype.removePopupListener=function(e){
this.removeListener(DwtEvent.POPUP,e)
};
DwtMenu.prototype.addPopdownListener=function(e){
this.addListener(DwtEvent.POPDOWN,e)
};
DwtMenu.prototype.removePopdownListener=function(e){
this.removeListener(DwtEvent.POPDOWN,e)
};
DwtMenu.prototype.setWidth=function(e){
this._width=e
};
DwtMenu.prototype.getItem=function(e){
return this._children.get(e)
};
DwtMenu.prototype.getItemIndex=function(e){
return this._children.indexOf(e)
};
DwtMenu.prototype.getItemById=function(a,n){
var e=this.getItems();
for(var t=0;
t<e.length;
t++){
var o=e[t].getData(a);
if(o==n){
e[t].index=t;
return e[t]
}}
return null
};
DwtMenu.prototype.getItemCount=function(){
return this._children.size()
};
DwtMenu.prototype.getItems=function(){
return this._children.getArray()
};
DwtMenu.prototype.getSelectedItem=function(n){
var e=this._children.getArray();
for(var o=0;
o<e.length;
o++){
var t=e[o];
if((n==null||(t._style&&n!=0))&&t.getChecked()){
return t
}}
return null
};
DwtMenu.prototype.isPoppedUp=function(){
return this._isPoppedUp
};
DwtMenu.prototype.popup=function(a,e,o,t){
if(this._style==DwtMenu.BAR_STYLE){
return
}
if(this._popdownActionId!=-1){
AjxTimedAction.cancelAction(this._popdownActionId);
this._popdownActionId=-1
}else{
if(this._isPoppedUp||(this._popupActionId!=-1&&a&&a>0)){
return
}else{
if(this._popupActionId!=-1){
AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}}
if(!a){
this._doPopup(e,o,t)
}else{
this._popupAction.args=[e,o,t];
this._popupActionId=AjxTimedAction.scheduleAction(this._popupAction,a)
}}};
DwtMenu.prototype.popdown=function(t,e){
if(this._style==DwtMenu.BAR_STYLE){
return
}
if(this._popupActionId!=-1){
AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}else{
if(!this._isPoppedUp||this._popdownActionId!=-1){
return
}
if(t==null||t==0){
this._doPopdown(e)
}else{
this._popdownActionId=AjxTimedAction.scheduleAction(this._popdownAction,t)
}}};
DwtMenu.prototype._setupScroll=function(){
var h=this.getHtmlElement();
this._table.style.position="relative";
this._topScroller=document.createElement("div");
this._topScroller.className="DwtMenuScrollTop";
this._topScroller.id=Dwt.getNextId();
this._imgDivTop=document.createElement("div");
this._imgDivTop.className="ImgUpArrowSmall";
this._topScroller.appendChild(this._imgDivTop);
Dwt.setHandler(this._imgDivTop,DwtEvent.ONMOUSEOUT,DwtMenu._stopEvent);
Dwt.setHandler(this._imgDivTop,DwtEvent.ONMOUSEOVER,DwtMenu._stopEvent);
h.appendChild(this._topScroller);
this._tableContainer=document.createElement("div");
this._tableContainer.appendChild(this._table);
h.appendChild(this._tableContainer);
this._bottomScroller=document.createElement("div");
this._bottomScroller.className="DwtMenuScrollBottom";
this._bottomScroller.id=Dwt.getNextId();
this._imgDivBottom=document.createElement("div");
this._imgDivBottom.className="ImgDownArrowSmall";
Dwt.setHandler(this._imgDivBottom,DwtEvent.ONMOUSEOUT,DwtMenu._stopEvent);
Dwt.setHandler(this._imgDivBottom,DwtEvent.ONMOUSEOVER,DwtMenu._stopEvent);
this._bottomScroller.appendChild(this._imgDivBottom);
h.appendChild(this._bottomScroller);
var a=AjxCallback.simpleClosure(this._scroll,this,this._table.id,true,false);
var e=AjxCallback.simpleClosure(this._scroll,this,this._table.id,false,false);
var t=AjxCallback.simpleClosure(this._handleMouseOut,this,this._topScroller.id,this._table.id);
var s=AjxCallback.simpleClosure(this._handleMouseOut,this,this._bottomScroller.id,this._table.id);
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEDOWN,a);
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEUP,e);
if(!AjxEnv.isIE){
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEOUT,t)
}else{
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSELEAVE,e)
}
var n=AjxCallback.simpleClosure(this._scroll,this,this._table.id,true,true);
var o=AjxCallback.simpleClosure(this._scroll,this,this._table.id,false,true);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEDOWN,n);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEUP,o);
if(!AjxEnv.isIE){
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEOUT,s)
}else{
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSELEAVE,o)
}
var r=AjxCallback.simpleClosure(this._handleScroll,this,this._table.id);
Dwt.setHandler(h,DwtEvent.ONMOUSEWHEEL,r)
};
DwtMenu.prototype.render=function(k,w){
var T=this.shell.getSize();
var S=this.getSize();
var q=this.getHtmlElement();
T.y-=10+(AjxEnv.isIE?20:0);
T.x-=28;
var z=this._layoutStyle==DwtMenu.LAYOUT_SCROLL;
var s=(this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE);
var W=this._layoutStyle==DwtMenu.LAYOUT_CASCADE;
if(this._table){
if(s&&W){
var F=T.y;
var M=null;
var v=this._table.rows;
var r=v.length;
var t=this._maxRows;
var O=S.y;
var g=F-25;
for(var C=r-1;
C>=0;
C--){
O-=Dwt.getSize(v[C]).y;
if(O<g){
break
}}
var p=t?Math.min(C+1,t):(C+1);
for(var B=p;
B<r;
B++){
var f=v[(B-p)%p];
var o=f.insertCell(-1);
o.className="DwtMenuCascadeCell";
var m=v[B].cells[0].firstChild;
while(m!=null){
o.appendChild(m);
m=m.nextSibling
}}
for(B=v.length-1;
B>=p;
B--){
this._table.deleteRow(p)
}
var d=r%p;
if(d>0){
for(var B=d;
B<p;
B++){
var f=v[B];
var o=f.insertCell(-1);
o.className="DwtMenuCascadeCell";
o.empty=true;
o.innerHTML="&nbsp;"
}}
S=this.getSize();
if(M){
w=M-S.y
}}else{
if(s&&z){
var v=this._table.rows;
var r=v.length;
var t=this._maxRows;
var u=t?Math.min(t,r):r;
var c=T.y-25;
var O=20;
for(var C=0;
C<u;
C++){
var e=Dwt.getSize(v[C]).y;
if(O+e<=c){
O+=e
}else{
break
}}
S.y=O
}}}
var H="auto";
var l="auto";
if(s&&z){
l=S.y;
if(this._tableContainer){
this._tableContainer.style.height=(l-20)+"px"
}}else{
if((s&&W)||w+S.y<T.y-5){
l="auto"
}else{
l=T.y-w-5
}}
if(z){
if(this._table){
this._table.style.width=S.x
}
H=S.x
}
this.setSize(H,l);
if((AjxEnv.isGeckoBased||AjxEnv.isSafari||(this._origStyle==DwtMenu.CALENDAR_PICKER_STYLE))&&this._table&&!z){
q.style.width=(S.x+(s&&!W?10:0))+"px"
}
var R=k+S.x>=T.x?T.x-S.x:k;
if(this.parent instanceof DwtMenuItem){
Dwt.delClass(q,"DwtMenu-congruentLeft");
Dwt.delClass(q,"DwtMenu-congruentRight");
var D=this.parent.getBounds();
var I=DwtCssStyle.getComputedStyleObject(this.parent.parent.getHtmlElement());
var a=DwtCssStyle.getComputedStyleObject(q);
if(((R>D.x&&R<D.x+D.width)||(D.x>R&&D.x<R+S.x))&&D.x>=S.x){
var n=parseInt(a.width);
if(!AjxEnv.isIE){
n+=parseInt(a.paddingLeft)+parseInt(a.paddingRight)+parseInt(a.borderLeftWidth)+parseInt(a.borderRightWidth)
}
R=(parseInt(I.left)||D.x)-(n||S.x);
if(this._congruent){
var d;
if(AjxEnv.isIE){
d=parseInt(a.borderLeftWidth)
}else{
d=parseInt(a.borderLeftWidth)+parseInt(a.borderRightWidth)
}
if(!isNaN(d)){
R+=d;
Dwt.addClass(q,"DwtMenu-congruentLeft")
}}}else{
var h=parseInt(I.left)||(D.x-(parseInt(I.paddingLeft)||0));
var A=parseInt(I.width)||D.width;
R=h+A;
if(this._congruent){
var d=parseInt(I.paddingRight)+parseInt(a.paddingLeft)+parseInt(a.borderLeftWidth);
if(!isNaN(d)){
R+=d;
Dwt.addClass(q,"DwtMenu-congruentRight")
}}}}
var M=s&&w+S.y>=T.y?T.y-S.y:w;
if(this.parent instanceof DwtMenuItem&&this._congruent){
var d=(parseInt(a.paddingTop)||0)-(parseInt(a.borderTopWidth)||0);
if(d>0){
M-=d
}}
this.setLocation(R,M)
};
DwtMenu.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_MENU
};
DwtMenu.prototype._handleScroll=function(e,o){
if(!o){
o=window.event
}
var s=Dwt.byId(e);
if(s&&o){
o=o?o:window.event;
var t=o.detail?o.detail*-1:o.wheelDelta/40;
var n=s.rows;
var a=Dwt.getSize(n[0]).y||10;
this._popdownSubmenus();
if(t>0){
this._doScroll(s,+a)
}else{
if(t<0){
this._doScroll(s,-a)
}}}};
DwtMenu.prototype._handleMouseOut=function(e,t,a){
if(e&&a.type&&a.type=="mouseout"&&!AjxEnv.isIE){
var o=e?Dwt.byId(e):null;
fromEl=a.target;
if(fromEl!=o){
return
}
toEl=a.relatedTarget;
while(toEl){
toEl=toEl.parentNode;
if(toEl==o){
return
}}
this._scroll(t,false,false,null)
}};
DwtMenu.prototype._scroll=function(e,s,n,a){
var r=e?document.getElementById(e):null;
if(r&&s){
var o=r.rows;
var t=Dwt.getSize(o[0]).y||10;
if(this._direction!=n||!this._scrollTimer){
this._popdownSubmenus();
this._direction=n;
if(this._scrollTimer){
clearInterval(this._scrollTimer);
this._scrollTimer=null
}
if(n){
this._scrollTimer=setInterval(AjxCallback.simpleClosure(this._doScroll,this,r,-t),100);
this._doScroll(r,-t)
}else{
this._scrollTimer=setInterval(AjxCallback.simpleClosure(this._doScroll,this,r,t),100);
this._doScroll(r,t)
}}}else{
if(this._scrollTimer){
clearInterval(this._scrollTimer);
this._scrollTimer=null
}}};
DwtMenu.prototype._doScroll=function(r,o){
if(r&&o){
var a=parseInt(r.style.top)||0;
var s;
if(o<0){
var n=this._table.rows||null;
var t=n&&n.length&&Dwt.getSize(n[0]).y;
var e=r.scrollHeight-(parseInt(r.parentNode.style.height)||((this._maxRows||(n&&n.length))*t)||0);
if(Math.abs(a+o)<=e){
s=a+o
}else{
s=-e
}}else{
if((a+o)<0){
s=a+o
}else{
s=0
}}
Dwt.setLocation(r,Dwt.DEFAULT,s)
}};
DwtMenu.prototype.scrollToItem=function(a,e){
var t=this.getItemIndex(a);
if(t!=-1){
this.scrollToIndex(t,e)
}};
DwtMenu.prototype.scrollToIndex=function(r,o){
if(this._created&&this._layoutStyle==DwtMenu.LAYOUT_SCROLL&&r!==null&&r>=0&&this._table){
var f=this._table.rows;
if(f){
var u=this._maxRows;
var e=0;
var c=[];
for(var a=0,s=f.length;
a<s;
a++){
var n=Dwt.getSize(f[a]).y;
if(a<u){
e+=n
}
c.push(n)
}
var t=c[r];
var l=parseInt(this._table.style.top)||0;
if(r>=f.length){
r=f.length-1
}
var d=0;
for(var a=0;
a<r&&a<c.length;
a++){
d+=c[a]
}
var m=0;
if(o){
if(d<-l){
m=-(d+l)
}else{
if(d+t>e-l){
m=-(d+l-e+t)
}}}else{
m=-(d+l)
}
if(m){
this._popdownSubmenus();
this._doScroll(this._table,m)
}}}};
DwtMenu.prototype.handleKeyAction=function(t,o){
switch(this._style){
case DwtMenu.BAR_STYLE:case DwtMenu.POPUP_STYLE:case DwtMenu.DROPDOWN_STYLE:break;
default:return false
}
switch(t){
case DwtKeyMap.PAGE_UP:case DwtKeyMap.PAGE_DOWN:var a=this.__currentItem||this._children.get(0);
var e=this.getItemIndex(a);
if(this._maxRows&&e!=-1){
this.setSelectedItem(e+((t==DwtKeyMap.PAGE_UP)?-this._maxRows:this._maxRows))
}else{
this.setSelectedItem(t==DwtKeyMap.PAGE_DOWN)
}
break;
case DwtKeyMap.SELECT_NEXT:case DwtKeyMap.SELECT_PREV:this.setSelectedItem(t==DwtKeyMap.SELECT_NEXT);
break;
case DwtKeyMap.SELECT:if(this.__currentItem){
this.__currentItem._emulateSingleClick()
}
break;
case DwtKeyMap.SUBMENU:if(this.__currentItem&&this.__currentItem._menu){
this.__currentItem._popupMenu(0,true)
}
break;
case DwtKeyMap.PARENTMENU:if(this.parent instanceof DwtMenuItem){
this.popdown(0)
}
break;
case DwtKeyMap.CANCEL:if(this.__currentItem){
var n=new DwtMouseEvent();
this._setMouseEvent(n,{
dwtObj:this.__currentItem}
);
this.notifyListeners(DwtEvent.ONMOUSEOUT,n);
this.__currentItem=null
}
this.popdown(0);
break;
default:return false
}
return true
};
DwtMenu.prototype._focus=function(){};
DwtMenu.prototype._blur=function(){};
DwtMenu.prototype.setAssociatedObj=function(e){
this._associatedObj=e
};
DwtMenu.prototype.setAssociatedElementId=function(e){
this._associatedElId=e
};
DwtMenu.prototype.checkItem=function(s,n,a){
var e=this._children.getArray();
for(var t=0;
t<e.length;
t++){
var o=e[t];
if(!(o.isStyle(DwtMenuItem.CHECK_STYLE)||o.isStyle(DwtMenuItem.RADIO_STYLE))){
continue
}
var r=o.getData(s);
if(r==n){
o.setChecked(true,a)
}}};
DwtMenu.prototype.setSelectedItem=function(t){
var e=this.__currentItem;
if(typeof(t)=="boolean"){
e=!e?this._children.get(0):t?this._children.getNext(e):this._children.getPrev(e)
}else{
if(t instanceof DwtMenuItem){
if(this._children.contains(t)){
e=t
}}else{
t=Math.max(0,Math.min(this._children.size()-1,t));
e=this._children.get(t)
}}
while(e){
if(!e.isStyle){
e.focus();
break
}else{
if(!e.isStyle(DwtMenuItem.SEPARATOR_STYLE)&&e.getEnabled()&&e.getVisible()){
break
}}
e=(t===false)?this._children.getPrev(e):this._children.getNext(e)
}
if(!e){
return
}
var a=new DwtMouseEvent();
if(this.__currentItem){
this._setMouseEvent(a,{
dwtObj:this.__currentItem}
);
this.__currentItem.notifyListeners(AjxEnv.isIE?DwtEvent.ONMOUSELEAVE:DwtEvent.ONMOUSEOUT,a)
}
this._setMouseEvent(a,{
dwtObj:e}
);
e.notifyListeners(AjxEnv.isIE?DwtEvent.ONMOUSEENTER:DwtEvent.ONMOUSEOVER,a);
this.__currentItem=e;
this.scrollToItem(e,true)
};
DwtMenu.prototype.clearExternallySelectedItems=function(){
if(this._externallySelected!=null){
this._externallySelected._deselect();
this._externallySelected=null
}};
DwtMenu.prototype.removeChild=function(a){
if(this._table){
if(this._style==DwtMenu.BAR_STYLE){
var e=a.getHtmlElement().parentNode;
this._table.rows[0].deleteCell(Dwt.getCellIndex(e))
}else{
var t=a.getHtmlElement();
if(t&&t.parentNode.parentNode.rowIndex>-1){
this._table.deleteRow(t.parentNode.parentNode.rowIndex)
}}}
this._children.remove(a);
if(a.removeSelectionListener){
a.removeSelectionListener(this._itemSelectionListener)
}};
DwtMenu.prototype.addChild=function(e){
DwtComposite.prototype.addChild.apply(this,arguments);
if(Dwt.instanceOf(e,"DwtColorPicker")||Dwt.instanceOf(e,"DwtCalendar")||(this._style==DwtMenu.GENERIC_WIDGET_STYLE)){
this._addItem(e)
}
if(e.addSelectionListener){
e.addSelectionListener(this._itemSelectionListener)
}};
DwtMenu.prototype._addItem=function(o,t){
if(this._style==DwtMenu.COLOR_PICKER_STYLE||this._style==DwtMenu.CALENDAR_PICKER_STYLE||this._style==DwtMenu.GENERIC_WIDGET_STYLE){
return
}
var s;
var e;
if(this._style==DwtMenu.BAR_STYLE){
var n=this._table.rows;
s=(n.length!=0)?n[0]:this._table.insertRow(0);
if(t==null||t>s.cells.length){
t=n.cells.length
}
e=s.insertCell(t);
e.align="center";
e.vAlign="middle";
var a=s.insertCell(-1);
a.nowrap=true;
a.width="7px"
}else{
if(o.isStyle&&(o.isStyle(DwtMenuItem.CHECK_STYLE)||o.isStyle(DwtMenuItem.RADIO_STYLE))){
this._checkItemAdded()
}
if(t==null||t>this._table.rows.length){
t=-1
}
s=this._table.insertRow(t);
e=s.insertCell(0)
}
e.noWrap=true;
e.appendChild(o.getHtmlElement())
};
DwtMenu.prototype._radioItemSelected=function(r,n){
var t=r._radioGroupId;
var s=this._children.size();
var e=this._children.getArray();
for(var o=0;
o<s;
o++){
if(e[o]!=r&&e[o].isStyle(DwtMenuItem.RADIO_STYLE)&&e[o]._radioGroupId==t&&e[o]._itemChecked){
e[o].setChecked(false,n);
break
}}};
DwtMenu.prototype._propagateItemSelection=function(e){
if(this.isListenerRegistered(DwtEvent.SELECTION)){
this.notifyListeners(DwtEvent.SELECTION,e)
}};
DwtMenu.prototype._menuHasCheckedItems=function(){
return this._menuItemsHaveChecks
};
DwtMenu.prototype._menuHasItemsWithIcons=function(){
return this._menuItemsHaveIcons
};
DwtMenu.prototype._menuHasSubmenus=function(){
return(this._menuItemsWithSubmenus>0)
};
DwtMenu.prototype._iconItemAdded=function(e){
if(!this._menuItemsHaveIcons){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_ICON)
}
this._menuItemsHaveIcons=true
};
DwtMenu.prototype._checkItemAdded=function(e){
if(!this._menuItemsHaveChecks){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_CHECK)
}
this._menuItemsHaveChecks=true
};
DwtMenu.prototype._submenuItemAdded=function(){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU);
this._menuItemsWithSubmenus++
};
DwtMenu.prototype._submenuItemRemoved=function(){
if(this._menuItemsWithSubmenus==1){
var o=this._children.size();
var e=this._children.getArray();
for(var t=0;
t<o;
t++){
e[t]._submenuItemRemoved()
}}
this._menuItemsWithSubmenus--;
if(this._menuItemsWithSubmenus==0){
Dwt.delClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU)
}};
DwtMenu.prototype._popdownSubmenus=function(){
var o=this._children.size();
var e=this._children.getArray();
for(var t=0;
t<o;
t++){
if(e[t]._popdownMenu){
e[t]._popdownMenu()
}}};
DwtMenu.prototype.dontStealFocus=function(e){
if(e==null){
e=true
}
this.__preventMenuFocus=!!e
};
DwtMenu.prototype._doPopup=function(n,a,h){
this.render(n,a);
var t=this._layoutStyle==DwtMenu.LAYOUT_SCROLL;
var c=(this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE);
var s=this._layoutStyle==DwtMenu.LAYOUT_CASCADE;
if(!t){
this.setScrollStyle(c&&s?Dwt.CLIP:Dwt.SCROLL)
}else{
if(this._tableContainer){
Dwt.setScrollStyle(this._tableContainer,Dwt.CLIP)
}}
this.notifyListeners(DwtEvent.POPUP,this);
var l=this.shell.getToolTip();
if(l){
l.popdown()
}
var o=DwtBaseDialog.getActiveDialog()?Dwt.Z_DIALOG_MENU:Dwt.Z_MENU;
this.setZIndex(o);
this._popupActionId=-1;
this._isPoppedUp=true;
var r=DwtOutsideMouseEventMgr.INSTANCE;
var e={
id:"DwtMenu",obj:this,outsideListener:this._outsideListener};
r.startListening(e);
if(!DwtMenu._activeMenu){
DwtMenu._activeMenu=this;
DwtMenu._activeMenuUp=true
}
DwtMenu._activeMenuIds.add(this._htmlElId,null,true);
DwtMenu._activeMenuIds.sort();
DwtMenu._activeMenus.add(this,null,true);
if(!this.__preventMenuFocus){
DwtShell.getShell(window).getKeyboardMgr().pushTabGroup(this._tabGroup)
}
if(h){
this.handleKeyAction(DwtKeyMap.SELECT_NEXT)
}else{
if(this.__currentItem){
this.setSelectedItem(this.__currentItem)
}}};
DwtMenu.prototype.getSize=function(t){
var e;
if(this._table){
e=Dwt.getSize(this._table,t)
}else{
e=DwtComposite.prototype.getSize.call(this,t)
}
if(this._width&&this._width>e.x){
e.x=this._width
}
return e
};
DwtMenu.prototype._doPopdown=function(h){
var l=this._children.getArray();
var m=this._children.size();
for(var n=0;
n<m;
n++){
if((l[n] instanceof DwtMenuItem)&&!(l[n].isStyle(DwtMenuItem.SEPARATOR_STYLE))){
l[n]._popdownMenu()
}}
this.setZIndex(Dwt.Z_HIDDEN);
this.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._ev=h;
this.notifyListeners(DwtEvent.POPDOWN,this);
var d=DwtOutsideMouseEventMgr.INSTANCE;
d.stopListening({
id:"DwtMenu",obj:this}
);
if(DwtMenu._activeMenu==this){
DwtMenu._activeMenu=null;
DwtMenu._activeMenuUp=false
}
DwtMenu._activeMenuIds.remove(this._htmlElId);
DwtMenu._activeMenus.remove(this);
this._popdownActionId=-1;
this._isPoppedUp=false;
if((this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE)&&this._table&&this._table.rows&&this._table.rows.length&&this._table.rows[0].cells.length){
var t=this._table.rows[0].cells.length;
var r=this._table.rows.length;
for(var n=1;
n<t;
n++){
for(var o=0;
o<r;
o++){
var c=this._table.rows[o].cells[n];
if(!c.empty){
var e=c.firstChild;
var u=this._table.insertRow(this._table.rows.length);
var c=u.insertCell(0);
while(e!=null){
c.appendChild(e);
e=e.nextSibling
}}}}
for(var o=0;
o<r;
o++){
var u=this._table.rows[o];
for(var n=u.cells.length-1;
n>0;
n--){
u.deleteCell(n)
}}}
this.__currentItem=null;
if(this._hoveredItem){
var h=new DwtMouseEvent();
h.dwtObj=this._hoveredItem;
DwtButton._mouseOutListener(h)
}
DwtShell.getShell(window).getKeyboardMgr().popTabGroup(this._tabGroup)
};
DwtMenu.prototype._getActiveItem=function(){
var e=this._children.getArray();
var o=this._children.size();
for(var t=0;
t<o;
t++){
if(e[t]._isMenuPoppedUp()){
return e[t]
}}
return null
};
DwtMenu._outsideMouseDownListener=function(t){
if(DwtMenu._activeMenuUp){
var o=DwtMenu._activeMenu;
var n=o._htmlElId;
var a=DwtUiEvent.getTarget(t);
while(a!=null){
if(a.id&&a.id!=""&&(a.id==n||a.id==o._associatedElId||DwtMenu._activeMenuIds.binarySearch(a.id)!=-1)){
return false
}
a=a.parentNode
}
o.popdown(0,t);
var e=null;
do{
e=DwtMenu._activeMenus.getLast();
if(e!=null&&e instanceof DwtMenu){
e.popdown()
}}
while(e!=null)
}};
DwtMenu._stopEvent=function(t){
if(!t){
t=window.event
}
t.cancelBubble=true;
if(t.stopPropagation){
t.stopPropagation()
}};
DwtMenu.menuShowing=function(){
return DwtMenu._activeMenuUp
};
DwtMenu.closeActiveMenu=function(e){
if(DwtMenu._activeMenuUp){
DwtMenu._activeMenu.popdown(0,e)
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtInputField")){
DwtInputField=function(h){
if(arguments.length==0){
return
}
this._origClassName=h.className?h.className:"DwtInputField";
this._errorClassName=this._origClassName+"-Error";
this._hintClassName=this._origClassName+"-hint";
this._disabledClassName=this._origClassName+"-disabled";
this._errorHintClassName=this._origClassName+"-errorhint";
DwtComposite.call(this,h);
this._inputEventHandlers={};
this._type=h.type?h.type:DwtInputField.STRING;
this._rows=h.rows?h.rows:1;
this._size=h.size;
this._errorIconStyle=h.errorIconStyle?h.errorIconStyle:h.validator?DwtInputField.ERROR_ICON_RIGHT:DwtInputField.ERROR_ICON_NONE;
this._validationStyle=h.validationStyle?h.validationStyle:DwtInputField.ONEXIT_VALIDATION;
this._hasError=false;
this._hintIsVisible=false;
this._hint=h.hint;
var r=h.inputId||Dwt.getNextId();
var s=Dwt.getNextId();
var n=this.getHtmlElement();
if(this._errorIconStyle==DwtInputField.ERROR_ICON_NONE){
if(h.forceMultiRow||(h.rows&&h.rows>1)){
var e=["<textarea id='",r,"' rows=",h.rows];
var o=e.length;
if(h.forceMultiRow||h.size){
e[o++]=" cols=";
e[o++]=h.size||1
}
if(h.wrap){
e[o++]=" wrap=";
e[o++]=h.wrap
}
e[o++]="></textarea>";
n.innerHTML=e.join("")
}else{
n.innerHTML=["<input id='",r,"'>"].join("")
}}else{
var e=["<table cellspacing='0' cellpadding='0'><tr>"];
var o=1;
if(this._errorIconStyle==DwtInputField.ERROR_ICON_LEFT){
e[o++]=["<td style='padding-right:2px;'id='",s,"'></td>"].join("")
}
e[o++]=["<td>","<input id='",r,"'>","</td>"].join("");
if(this._errorIconStyle==DwtInputField.ERROR_ICON_RIGHT){
e[o++]=["<td style='padding-left:2px;' id='",s,"'></td>"].join("")
}
e[o++]="</tr></table>";
n.innerHTML=e.join("");
if(this._errorIconStyle!=DwtInputField.ERROR_ICON_NONE){
this._errorIconTd=document.getElementById(s);
this._errorIconTd.vAlign="middle";
this._errorIconTd.innerHTML=DwtInputField._NOERROR_ICON_HTML
}}
this._tabGroup=new DwtTabGroup(this._htmlElId);
if(h.forceMultiRow||this._rows>1){
this._inputField=document.getElementById(r);
this._inputField.onkeyup=DwtInputField._keyUpHdlr;
this._inputField.onblur=DwtInputField._blurHdlr;
this._inputField.onfocus=DwtInputField._focusHdlr;
this._inputField.onkeydown=DwtInputField._keyDownHdlr;
if(h.size){
this._inputField.size=h.size
}
if(h.maxLen){
this._inputField.maxLength=this._maxLen=h.maxLen
}
this._inputField.value=h.initialValue||"";
this._tabGroup.addMember(this._inputField)
}else{
var t=document.getElementById(r);
var a=this.__createInputEl(h);
if(AjxEnv.isCamino){
t.parentNode.style.overflow="hidden"
}
t.parentNode.replaceChild(a,t)
}
this.setValidatorFunction(h.validatorCtxtObj,h.validator);
this._setMouseEventHdlrs(false);
this._setKeyPressEventHdlr(false);
if(h.required!=null){
this.setRequired(h.required)
}};
DwtInputField.prototype=new DwtComposite;
DwtInputField.prototype.constructor=DwtInputField;
DwtInputField.prototype.isDwtInputField=true;
DwtInputField.prototype.isInputControl=true;
DwtInputField.prototype.toString=function(){
return"DwtInputField"
};
DwtInputField.ERROR_ICON_LEFT=1;
DwtInputField.ERROR_ICON_RIGHT=2;
DwtInputField.ERROR_ICON_NONE=3;
DwtInputField.CONTINUAL_VALIDATION=1;
DwtInputField.ONEXIT_VALIDATION=2;
DwtInputField.MANUAL_VALIDATION=3;
DwtInputField.NUMBER=1;
DwtInputField.INTEGER=2;
DwtInputField.FLOAT=3;
DwtInputField.STRING=4;
DwtInputField.PASSWORD=5;
DwtInputField.DATE=6;
DwtInputField._ERROR_ICON_HTML=AjxImg.getImageHtml("ClearSearch");
DwtInputField._NOERROR_ICON_HTML=AjxImg.getImageHtml("Blank_9");
DwtInputField.prototype.dispose=function(){
this._errorIconTd=null;
this._inputField=null;
DwtComposite.prototype.dispose.call(this)
};
DwtInputField.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtInputField.prototype.setHandler=function(t,e){
if(!this._checkState()){
return
}
this._inputEventHandlers[t]=e;
Dwt.setHandler(this.getInputElement(),t,e)
};
DwtInputField.prototype.setInputType=function(a){
if(a!=this._type&&this._rows==1){
this._type=a;
if(AjxEnv.isIE){
var e=this._inputField;
var t=this.__createInputEl();
e.parentNode.replaceChild(t,e)
}else{
this._inputField.type=this._type!=DwtInputField.PASSWORD?"text":"password"
}}};
DwtInputField.prototype.setValidatorFunction=function(t,e){
if(e){
this._validator=e;
this._validatorObj=t
}else{
switch(this._type){
case DwtInputField.NUMBER:this._validator=DwtInputField.validateNumber;
break;
case DwtInputField.INTEGER:this._validator=DwtInputField.validateInteger;
break;
case DwtInputField.FLOAT:this._validator=DwtInputField.validateFloat;
break;
case DwtInputField.STRING:case DwtInputField.PASSWORD:this._validator=DwtInputField.validateString;
break;
case DwtInputField.DATE:this._validator=DwtInputField.validateDate;
break;
default:this._validator=DwtInputField.validateAny
}}};
DwtInputField.prototype.setValidatorRegExp=function(e,t){
this._validator=e;
this._validatorObj=null;
this._errorString=t||""
};
DwtInputField.prototype.setValidationCallback=function(e){
this._validationCallback=e
};
DwtInputField.prototype.getInputElement=function(){
return this._inputField
};
DwtInputField.prototype.getValue=function(){
return this._hintIsVisible?"":this._inputField.value
};
DwtInputField.prototype.setValue=function(t,e){
t=t||"";
this._inputField.value=t;
if(!e){
t=this._validateInput(t);
if(t!=null){
this._inputField.value=t
}}
if(this._hintIsVisible&&t){
this._hideHint(t)
}else{
if(!t){
this._showHint()
}}};
DwtInputField.prototype.clear=function(){
this.setValue("")
};
DwtInputField.prototype.setHint=function(t){
var e=this._hint;
this._hint=t;
if(this._hintIsVisible){
this.getInputElement().value=t;
if(!t){
this._hintIsVisible=false;
this._updateClassName()
}}else{
if(this._inputField.value==""){
this._showHint()
}}};
DwtInputField.prototype.setValidNumberRange=function(t,e){
this._minNumVal=t;
this._maxNumVal=e;
var a=this._validateInput(this.getValue());
if(a!=null){
this.setValue(a)
}};
DwtInputField.prototype.setValidStringLengths=function(t,e){
this._minLen=t||0;
if(e!=null){
this._inputField.maxLength=e;
this._maxLen=e
}};
DwtInputField.prototype.setNumberPrecision=function(e){
this._decimals=e
};
DwtInputField.prototype.setReadOnly=function(e){
this._inputField.setAttribute("readonly",(e==null?true:e))
};
DwtInputField.prototype.setRequired=function(t){
var e=t==null?true:t;
if(this._required!=e){
this._required=e;
this.validate()
}};
DwtInputField.prototype.getEnabled=function(){
return !this.getInputElement().disabled
};
DwtInputField.prototype.setEnabled=function(e){
DwtControl.prototype.setEnabled.call(this,e);
this.getInputElement().disabled=!e;
this._validateInput(this.getValue())
};
DwtInputField.prototype.focus=function(){
if(this.getEnabled()){
this._hasFocus=true;
this.getInputElement().focus();
DwtShell.getShell(window).getKeyboardMgr().grabFocus(this.getTabGroupMember())
}};
DwtInputField.prototype.blur=function(){
this.getInputElement().blur()
};
DwtInputField.prototype.setVisible=function(e){
DwtComposite.prototype.setVisible.apply(this,arguments);
Dwt.setVisible(this.getInputElement(),e)
};
DwtInputField.prototype.isValid=function(){
if(!this.getEnabled()){
return this.getValue()
}
try{
if(typeof this._validator=="function"){
return this._validatorObj?this._validator.call(this._validatorObj,this.getValue(),this):this._validator(this.getValue())
}else{
return this._validator.test(this._inputField.value)
}}
catch(e){
if(typeof e=="string"){
return null
}else{
throw e
}}};
DwtInputField.prototype.validate=function(){
var e=this._validateInput(this.getValue());
if(e!=null){
this.setValue(e);
return true
}else{
return false
}};
DwtInputField.validateNumber=function(e){
var t=new Number(e);
if(isNaN(t)||(Math.round(t)!=t)){
throw AjxMsg.notAnInteger
}
return DwtInputField.validateFloat.call(this,e)
};
DwtInputField.validateInteger=function(e){
var t=new Number(e);
if(isNaN(t)||(Math.round(t)!=t)||(t.toString()!=e)){
throw AjxMsg.notAnInteger
}
if(this._minNumVal&&e<this._minNumVal){
throw AjxMessageFormat.format(AjxMsg.numberLessThanMin,this._minNumVal)
}
if(this._maxNumVal&&e>this._maxNumVal){
throw AjxMessageFormat.format(AjxMsg.numberMoreThanMax,this._maxNumVal)
}
return e
};
DwtInputField.validateFloat=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
var o=new Number(e);
if(isNaN(o)){
throw AjxMsg.notANumber
}
if(this._minNumVal&&e<this._minNumVal){
throw AjxMessageFormat.format(AjxMsg.numberLessThanMin,this._minNumVal)
}
if(this._maxNumVal&&e>this._maxNumVal){
throw AjxMessageFormat.format(AjxMsg.numberMoreThanMax,this._maxNumVal)
}
if(this._decimals!=null){
var t=o.toString();
var a=t.indexOf(".");
if(a==-1){
a=t.length
}
e=o.toPrecision(a+this._decimals)
}else{
e=o.toString()
}
return e
};
DwtInputField.validateString=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(this._minLen!=null&&e.length<this._minLen){
throw AjxMessageFormat.format(AjxMsg.stringTooShort,this._minLen)
}
if(this._maxLen!=null&&e.length>this._maxLen){
throw AjxMessageFormat.format(AjxMsg.stringTooLong,this._maxLen)
}
return e
};
DwtInputField.validateDate=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(AjxDateUtil.simpleParseDateStr(e)==null){
throw AjxMsg.invalidDatetimeString
}
return e
};
DwtInputField.validateEmail=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(!AjxEmailAddress.isValid(e)){
throw AjxMsg.invalidEmailAddr
}
return e
};
DwtInputField.validateAny=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
return e
};
DwtInputField.prototype._validateRegExp=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(this._regExp&&!this._regExp.test(e)){
throw this._errorString
}
return e
};
DwtInputField._keyUpHdlr=function(t){
var e=DwtShell.keyEvent;
e.setFromDhtmlEvent(t,true);
var o=e.dwtObj;
var a=e.keyCode;
if(o.notifyListeners(DwtEvent.ONKEYUP,e)){
return true
}
var n=null;
if((a==13||a==9)&&o._validationStyle==DwtInputField.ONEXIT_VALIDATION){
n=o._validateInput(o.getValue())
}else{
if(o._validationStyle==DwtInputField.CONTINUAL_VALIDATION){
n=o._validateInput(o.getValue())
}}
if(n!=null&&n!=o.getValue()){
o.setValue(n)
}
return true
};
DwtInputField._blurHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t){
t._hasFocus=false;
if(t._validationStyle==DwtInputField.ONEXIT_VALIDATION){
var a=t._validateInput(t.getValue());
if(a!=null){
t.setValue(a)
}}
if(!t._hintIsVisible&&t._hint){
t._showHint()
}}
t.notifyListeners(DwtEvent.ONBLUR,e)
};
DwtInputField._focusHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t){
var a=DwtShell.getShell(window).getKeyboardMgr().inputGotFocus(t);
if(t._hintIsVisible){
t._hideHint("")
}}
t.notifyListeners(DwtEvent.ONFOCUS,e)
};
DwtInputField._keyDownHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t){
if(t._hintIsVisible){
t._hideHint("")
}}};
DwtInputField.prototype._hideHint=function(t){
var e=this.getInputElement();
e.value=t;
e.title=this._hint||"";
this._hintIsVisible=false;
this._updateClassName()
};
DwtInputField.prototype._showHint=function(){
if(this._hint){
var e=this.getInputElement();
if(!e.value){
this._hintIsVisible=true;
this._updateClassName();
e.title="";
e.value=this._hint
}}};
DwtInputField.prototype._updateClassName=function(){
var e;
if(!this.getEnabled()){
e=this._disabledClassName
}else{
if(this._hasError){
if(this._hintIsVisible&&!this._hasFocus){
e=this._errorHintClassName
}else{
e=this._errorClassName
}}else{
if(this._hintIsVisible&&!this._hasFocus){
e=this._hintClassName
}else{
e=this._origClassName
}}}
this.getHtmlElement().className=e
};
DwtInputField.prototype._validateInput=function(a){
var n=true;
var o;
var t;
if(!this.getEnabled()){
o=this.getValue()
}else{
try{
if(typeof this._validator=="function"){
o=a=this._validatorObj?this._validator.call(this._validatorObj,a,this):this._validator(a)
}else{
if(!this._validator.test(a)){
t=this._errorString
}}}
catch(e){
if(typeof e=="string"){
t=e
}else{
throw e
}}}
if(t){
this._hasError=true;
if(this._errorIconTd){
this._errorIconTd.innerHTML=DwtInputField._ERROR_ICON_HTML
}
this.setToolTipContent(t);
n=false;
o=null
}else{
this._hasError=false;
if(this._errorIconTd){
this._errorIconTd.innerHTML=DwtInputField._NOERROR_ICON_HTML
}
this.setToolTipContent(null);
n=true
}
this._updateClassName();
if(this._validationCallback){
this._validationCallback.run(this,n,a)
}
return o
};
DwtInputField.prototype._focusByMouseUpEvent=function(){
if(this.getEnabled()){
this._hasFocus=true
}};
DwtInputField.prototype._replaceElementHook=function(t,a,e,o){
a=this.getInputElement();
DwtControl.prototype._replaceElementHook.call(this,t,a,e,o);
if(t.id){
a.id=t.id
}
if(t.size){
a.size=t.size
}
if(t.title){
this.setHint(t.title)
}};
DwtInputField.prototype.__createInputEl=function(l){
var a=this._inputField;
if(a){
for(var s in this._inputEventHandlers){
a.removeAttribute(s)
}}
var n;
var r=this._type!=DwtInputField.PASSWORD?"text":"password";
if(AjxEnv.isIE){
try{
var n=document.createElement(["<INPUT type='",r,"'>"].join(""))
}
catch(h){
n=document.createElement("INPUT");
n.type=r
}}else{
n=document.createElement("INPUT");
n.type=r
}
this._inputField=n;
var o=l?l.size:a.size;
var t=l?l.maxLen:a.maxLength;
n.autocomplete="off";
if(o){
n.size=o
}
if(t){
n.maxLength=t
}
n.value=(l?l.initialValue:a.value)||"";
n.readonly=a?a.readonly:false;
if(l&&l.inputId){
n.id=l.inputId
}
n.onkeyup=DwtInputField._keyUpHdlr;
n.onblur=DwtInputField._blurHdlr;
n.onfocus=DwtInputField._focusHdlr;
n.onkeydown=DwtInputField._keyDownHdlr;
for(var s in this._inputEventHandlers){
n[s]=this._inputEventHandlers[s]
}
this._tabGroup.removeAllMembers();
this._tabGroup.addMember(n);
return n
};
DwtInputField.prototype.disableFocusHdlr=function(){
this._inputField.onfocus=null
};
DwtInputField.prototype.enableFocusHdlr=function(){
this._inputField.onfocus=DwtInputField._focusHdlr
};
DwtInputField.prototype.enableKeyDownHdlr=function(){
this._inputField.onkeydown=DwtInputField._keyDownHdlr
};
DwtInputField.prototype.moveCursorToEnd=function(){
Dwt.moveCursorToEnd(this._inputField)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtBaseDialog")){
DwtBaseDialog=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtBaseDialog.PARAMS);
var e=t.parent;
if(!(e instanceof DwtShell)){
throw new DwtException("DwtBaseDialog parent must be a DwtShell",DwtException.INVALIDPARENT,"DwtDialog")
}
t.className=t.className||"DwtBaseDialog";
t.posStyle=DwtControl.ABSOLUTE_STYLE;
this._title=t.title||"";
DwtComposite.call(this,t);
this._shell=e;
this._zIndex=t.zIndex||Dwt.Z_DIALOG;
this._mode=t.mode||DwtBaseDialog.MODAL;
this._loc=new DwtPoint();
if(t.loc){
this._loc.x=t.loc.x;
this._loc.y=t.loc.y
}else{
this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
}
this._tabGroup=new DwtTabGroup(this.toString(),true);
this._dragHandleId=t.dragHandleId||this._htmlElId+"_handle";
this._createHtml();
this._initializeDragging(this._dragHandleId);
if(t.view){
this.setView(t.view)
}
this.setZIndex(Dwt.Z_HIDDEN);
this._position(DwtBaseDialog.__nowhereLoc)
};
DwtBaseDialog.PARAMS=["parent","className","title","zIndex","mode","loc","view","dragHandleId","id"];
DwtBaseDialog.prototype=new DwtComposite;
DwtBaseDialog.prototype.constructor=DwtBaseDialog;
DwtBaseDialog.prototype.toString=function(){
return"DwtBaseDialog"
};
DwtBaseDialog.MODELESS=1;
DwtBaseDialog.MODAL=2;
DwtBaseDialog.__nowhereLoc=new DwtPoint(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
DwtBaseDialog.prototype.TEMPLATE="dwt.Widgets#DwtBaseDialog";
DwtBaseDialog.prototype.CONTROLS_TEMPLATE=null;
DwtBaseDialog.prototype.addPopupListener=function(e){
this.addListener(DwtEvent.POPUP,e)
};
DwtBaseDialog.prototype.removePopupListener=function(e){
this.removeListener(DwtEvent.POPUP,e)
};
DwtBaseDialog.prototype.addPopdownListener=function(e){
this.addListener(DwtEvent.POPDOWN,e)
};
DwtBaseDialog.prototype.removePopdownListener=function(e){
this.removeListener(DwtEvent.POPDOWN,e)
};
DwtBaseDialog.prototype.popup=function(t){
if(this._poppedUp){
return
}
this.cleanup(true);
var e=this._zIndex;
if(this._mode==DwtBaseDialog.MODAL){
e=this._setModalEffect(e)
}
this._shell._veilOverlay.activeDialogs.push(this);
if(t){
this._loc.x=t.x;
this._loc.y=t.y
}
this._position(t);
this._resetTabFocus();
this.setZIndex(e);
this._poppedUp=true;
var a=this._shell.getKeyboardMgr();
a.pushTabGroup(this._tabGroup);
a.pushDefaultHandler(this);
this.notifyListeners(DwtEvent.POPUP,this)
};
DwtBaseDialog.prototype._resetTabFocus=function(){
this._tabGroup.resetFocusMember(true)
};
DwtBaseDialog.prototype.focus=function(){
if(this.isListenerRegistered(DwtEvent.ONFOCUS)){
this.notifyListeners(DwtEvent.ONFOCUS)
}else{
if(this._focusElementId){
var e=document.getElementById(this._focusElementId);
if(e){
e.focus()
}}}};
DwtBaseDialog.prototype.isPoppedUp=function(){
return this._poppedUp
};
DwtBaseDialog.prototype.popdown=function(){
if(this._poppedUp){
this._poppedUp=false;
this.cleanup(false);
var e=this._zIndex;
this.setZIndex(Dwt.Z_HIDDEN);
this._position(DwtBaseDialog.__nowhereLoc);
if(this._mode==DwtBaseDialog.MODAL){
this._undoModality(e)
}else{
this._shell._veilOverlay.activeDialogs.pop()
}
var t=this._shell.getKeyboardMgr();
t.popTabGroup(this._tabGroup);
t.popDefaultHandler();
this.notifyListeners(DwtEvent.POPDOWN,this)
}};
DwtBaseDialog.prototype.setView=function(e){
this.reset();
if(e){
this._getContentDiv().appendChild(e.getHtmlElement())
}};
DwtBaseDialog.prototype.reset=function(){
this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
};
DwtBaseDialog.prototype.cleanup=function(t){
var o=this._getInputFields();
if(o){
var e=o.length;
for(var a=0;
a<e;
a++){
o[a].disabled=!t;
if(t){
o[a].value=""
}}}};
DwtBaseDialog.prototype.setTitle=function(e){
if(this._titleEl){
this._titleEl.innerHTML=e||""
}};
DwtBaseDialog.prototype.setContent=function(t){
var e=this._getContentDiv();
if(e){
e.innerHTML=t||""
}};
DwtBaseDialog.prototype._getContentDiv=function(){
return this._contentEl
};
DwtBaseDialog.prototype.addEnterListener=function(e){
this.addListener(DwtEvent.ENTER,e)
};
DwtBaseDialog.getActiveDialog=function(){
var t=null;
var a=DwtShell.getShell(window);
if(a){
var e=a._veilOverlay.activeDialogs.length;
if(e>0){
t=a._veilOverlay.activeDialogs[e-1]
}}
return t
};
DwtBaseDialog.prototype._initializeDragging=function(h){
var r=document.getElementById(h);
if(r){
var s=DwtControl.fromElementId(window._dwtShellId);
if(s){
var e=Dwt.getSize(s.getHtmlElement());
var a=document.getElementById(this._htmlElId);
var l=this.getSize();
var n=new AjxCallback(this,this._dragEnd);
var o=new AjxCallback(this,this._duringDrag);
var t=new AjxCallback(this,this._dragStart);
DwtDraggable.init(r,a,0,document.body.offsetWidth-10,0,document.body.offsetHeight-10,t,o,n)
}}};
DwtBaseDialog.prototype._getContentHtml=function(){
return""
};
DwtBaseDialog.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtBaseDialog.prototype._createHtmlFromTemplate=function(e,t){
t.dragId=this._dragHandleId;
t.title=this._title;
t.icon="";
t.closeIcon1="";
t.closeIcon2="";
t.controlsTemplateId=this.CONTROLS_TEMPLATE;
DwtComposite.prototype._createHtmlFromTemplate.call(this,e,t);
this._titleBarEl=document.getElementById(t.id+"_titlebar");
this._titleEl=document.getElementById(t.id+"_title");
this._contentEl=document.getElementById(t.id+"_content");
this.setContent(this._getContentHtml())
};
DwtBaseDialog.prototype._setModalEffect=function(){
var a=this._shell._veilOverlay.dialogZ;
var o=null;
var t,e;
if(a.length){
o=a[a.length-1]
}
if(o){
t=o+2;
e=o+1
}else{
t=this._zIndex;
e=Dwt.Z_VEIL
}
this._shell._veilOverlay.veilZ.push(e);
this._shell._veilOverlay.dialogZ.push(t);
Dwt.setZIndex(this._shell._veilOverlay,e);
return t
};
DwtBaseDialog.prototype._undoModality=function(a){
var e=this._shell._veilOverlay.veilZ;
e.pop();
var t=e[e.length-1];
Dwt.setZIndex(this._shell._veilOverlay,t);
this._shell._veilOverlay.dialogZ.pop();
this._shell._veilOverlay.activeDialogs.pop();
if(this._shell._veilOverlay.activeDialogs.length>0){
this._shell._veilOverlay.activeDialogs[0].focus()
}};
DwtBaseDialog.prototype._getInputFields=function(){};
DwtBaseDialog.prototype._dragStart=function(e,t){
if(AjxEnv.isNav&&!this._ignoreSetDragBoundries){
this._currSize=this.getSize();
DwtDraggable.setDragBoundaries(DwtDraggable.dragEl,0,document.body.offsetWidth-this._currSize.x,0,document.body.offsetHeight-this._currSize.y)
}};
DwtBaseDialog.prototype._dragEnd=function(e,t){
this._loc.x=e;
this._loc.y=t
};
DwtBaseDialog.prototype._duringDrag=function(e,t){};
DwtBaseDialog.prototype._doesContainElement=function(e){
return Dwt.contains(this.getHtmlElement(),e)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtDialog")){
DwtDialog=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtDialog.PARAMS);
t.className=t.className||"DwtDialog";
this._title=t.title=t.title||"";
var a=t.standardButtons;
var l=t.extraButtons;
if(!a){
a=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]
}else{
if(a==DwtDialog.NO_BUTTONS){
a=null
}else{
if(a&&!a.length){
a=[a]
}}}
this._buttonList=[];
var d={};
d[DwtDialog.ALIGN_LEFT]=[];
d[DwtDialog.ALIGN_CENTER]=[];
d[DwtDialog.ALIGN_RIGHT]=[];
if(a||l){
this._buttonDesc={};
if(a&&a.length){
this._initialEnterButtonId=this._enterButtonId=a[0];
for(var o=0;
o<a.length;
o++){
var h=a[o];
this._buttonList.push(h);
var r=DwtDialog.ALIGN[h];
if(r){
d[r].push(h)
}
this._buttonDesc[h]=new DwtDialog_ButtonDescriptor(h,AjxMsg[DwtDialog.MSG_KEY[h]],r)
}
this._resetCallbacks()
}
if(l&&l.length){
if(!this._enterButtonId){
this._initialEnterButtonId=this._enterButtonId=l[0]
}
for(var o=0;
o<l.length;
o++){
var h=l[o].id;
this._buttonList.push(h);
var r=l[o].align;
if(r){
d[r].push(h)
}
this._buttonDesc[h]=l[o]
}}}
this._buttonElementId={};
for(var o=0;
o<this._buttonList.length;
o++){
var h=this._buttonList[o];
this._buttonElementId[h]=this._buttonDesc[h].label?this._buttonDesc[h].label+"_"+Dwt.getNextId():Dwt.getNextId()
}
DwtBaseDialog.call(this,t);
this._button={};
for(var o=0;
o<this._buttonList.length;
o++){
var h=this._buttonList[o];
var c=this._button[h]=new DwtButton({
parent:this,id:this._htmlElId+"_button"+h}
);
c.setText(this._buttonDesc[h].label);
c.buttonId=h;
c.addSelectionListener(new AjxListener(this,this._buttonListener));
var e=document.getElementById(this._buttonElementId[h]);
if(e){
e.appendChild(c.getHtmlElement())
}}
var s=d[DwtDialog.ALIGN_LEFT].concat(d[DwtDialog.ALIGN_CENTER],d[DwtDialog.ALIGN_RIGHT]);
for(var o=0;
o<s.length;
o++){
var n=this._button[s[o]];
this._tabGroup.addMember(n)
}};
DwtDialog.PARAMS=["parent","className","title","standardButtons","extraButtons","zIndex","mode","loc","id"];
DwtDialog.prototype=new DwtBaseDialog;
DwtDialog.prototype.constructor=DwtDialog;
DwtDialog.prototype.isDwtDialog=true;
DwtDialog.prototype.toString=function(){
return"DwtDialog"
};
DwtDialog.ALIGN_LEFT=1;
DwtDialog.ALIGN_RIGHT=2;
DwtDialog.ALIGN_CENTER=3;
DwtDialog.CANCEL_BUTTON=1;
DwtDialog.OK_BUTTON=2;
DwtDialog.DISMISS_BUTTON=3;
DwtDialog.NO_BUTTON=4;
DwtDialog.YES_BUTTON=5;
DwtDialog.LAST_BUTTON=5;
DwtDialog.NO_BUTTONS=256;
DwtDialog.ALL_BUTTONS=[DwtDialog.CANCEL_BUTTON,DwtDialog.OK_BUTTON,DwtDialog.DISMISS_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.YES_BUTTON];
DwtDialog.MSG_KEY={};
DwtDialog.MSG_KEY[DwtDialog.CANCEL_BUTTON]="cancel";
DwtDialog.MSG_KEY[DwtDialog.OK_BUTTON]="ok";
DwtDialog.MSG_KEY[DwtDialog.DISMISS_BUTTON]="dismiss";
DwtDialog.MSG_KEY[DwtDialog.NO_BUTTON]="no";
DwtDialog.MSG_KEY[DwtDialog.YES_BUTTON]="yes";
DwtDialog.ALIGN={};
DwtDialog.ALIGN[DwtDialog.CANCEL_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.OK_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.DISMISS_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.NO_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.YES_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.MODELESS=DwtBaseDialog.MODELESS;
DwtDialog.MODAL=DwtBaseDialog.MODAL;
DwtDialog.prototype.CONTROLS_TEMPLATE="dwt.Widgets#DwtDialogControls";
DwtDialog.prototype.popdown=function(){
DwtBaseDialog.prototype.popdown.call(this);
this.resetButtonStates()
};
DwtDialog.prototype.popup=function(e,t){
this._focusButtonId=t;
DwtBaseDialog.prototype.popup.call(this,e)
};
DwtDialog.prototype._resetTabFocus=function(){
if(this._focusButtonId){
var e=this.getButton(this._focusButtonId);
this._tabGroup.setFocusMember(e,true)
}else{
DwtBaseDialog.prototype._resetTabFocus.call(this)
}};
DwtDialog.prototype.reset=function(){
this._resetCallbacks();
this.resetButtonStates();
DwtBaseDialog.prototype.reset.call(this)
};
DwtDialog.prototype.resetButtonStates=function(){
for(b in this._button){
this._button[b].setEnabled(true);
this._button[b].setHovered(false)
}
this.associateEnterWithButton(this._initialEnterButtonId)
};
DwtDialog.prototype.getButton=function(e){
return this._button[e]
};
DwtDialog.prototype.setButtonEnabled=function(t,e){
if(!this._button[t]){
return
}
this._button[t].setEnabled(e)
};
DwtDialog.prototype.setButtonVisible=function(e,t){
if(!this._button[e]){
return
}
this._button[e].setVisible(t)
};
DwtDialog.prototype.getButtonEnabled=function(e){
return this._button[e].getEnabled()
};
DwtDialog.prototype.registerCallback=function(t,a,o,e){
this._buttonDesc[t].callback=(a instanceof AjxCallback)?a:(new AjxCallback(o,a,e))
};
DwtDialog.prototype.unregisterCallback=function(e){
this._buttonDesc[e].callback=null
};
DwtDialog.prototype.setButtonListener=function(e,t){
this._button[e].removeSelectionListeners();
this._button[e].addSelectionListener(t)
};
DwtDialog.prototype.setEnterListener=function(e){
this.removeAllListeners(DwtEvent.ENTER);
this.addEnterListener(e)
};
DwtDialog.prototype.associateEnterWithButton=function(e){
this._enterButtonId=e
};
DwtDialog.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_DIALOG
};
DwtDialog.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.ENTER:this.notifyListeners(DwtEvent.ENTER,t);
break;
case DwtKeyMap.CANCEL:var a=false;
a=a||this._runCallbackForButtonId(DwtDialog.CANCEL_BUTTON);
a=a||this._runCallbackForButtonId(DwtDialog.NO_BUTTON);
a=a||this._runCallbackForButtonId(DwtDialog.DISMISS_BUTTON);
if(!a&&this._buttonDesc[DwtDialog.OK_BUTTON]&&this._buttonList.length==1){
a=a||this._runCallbackForButtonId(DwtDialog.OK_BUTTON)
}
this.popdown();
return true;
case DwtKeyMap.YES:if(this._buttonDesc[DwtDialog.YES_BUTTON]){
this._runCallbackForButtonId(DwtDialog.YES_BUTTON)
}
break;
case DwtKeyMap.NO:if(this._buttonDesc[DwtDialog.NO_BUTTON]){
this._runCallbackForButtonId(DwtDialog.NO_BUTTON)
}
break;
default:return false
}
return true
};
DwtDialog.prototype._createHtmlFromTemplate=function(a,n){
DwtBaseDialog.prototype._createHtmlFromTemplate.call(this,a,n);
var o=n.id+"_focus";
if(document.getElementById(o)){
this._focusElementId=o
}
this._buttonsEl=document.getElementById(n.id+"_buttons");
if(this._buttonsEl){
var t=[];
var e=0;
this._addButtonsHtml(t,e);
this._buttonsEl.innerHTML=t.join("")
}};
DwtDialog.prototype._getButtonsContainerStartTemplate=function(){
return"<table width='100%'><tr>"
};
DwtDialog.prototype._getButtonsAlignStartTemplate=function(){
return'<td align="{0}"><table><tr>'
};
DwtDialog.prototype._getButtonsAlignEndTemplate=function(){
return"</tr></table></td>"
};
DwtDialog.prototype._getButtonsCellTemplate=function(){
return'<td id="{0}"></td>'
};
DwtDialog.prototype._getButtonsContainerEndTemplate=function(){
return"</tr></table>"
};
DwtDialog.prototype._addButtonsHtml=function(s,t){
if(this._buttonList&&this._buttonList.length){
var a=new Array();
var e=new Array();
var n=new Array();
for(var o=0;
o<this._buttonList.length;
o++){
var r=this._buttonList[o];
switch(this._buttonDesc[r].align){
case DwtDialog.ALIGN_RIGHT:e.push(r);
break;
case DwtDialog.ALIGN_LEFT:a.push(r);
break;
case DwtDialog.ALIGN_CENTER:n.push(r);
break
}}
s[t++]=this._getButtonsContainerStartTemplate();
if(a.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["left"]);
for(var o=0;
o<a.length;
o++){
var r=a[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
if(n.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["center"]);
for(var o=0;
o<n.length;
o++){
var r=n[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
if(e.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["right"]);
for(var o=0;
o<e.length;
o++){
var r=e[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
s[t++]=this._getButtonsContainerEndTemplate()
}
return t
};
DwtDialog.prototype._buttonListener=function(a,e){
var o=DwtControl.getTargetControl(a);
var t=(o&&o.buttonId)||this._enterButtonId;
if(t){
this._runCallbackForButtonId(t,e)
}};
DwtDialog.prototype._runCallbackForButtonId=function(o,e){
var t=this._buttonDesc[o];
var a=t&&t.callback;
if(!a){
return false
}
e=(e instanceof Array)?e:[e];
a.run.apply(a,e);
return true
};
DwtDialog.prototype._runEnterCallback=function(e){
if(this._enterButtonId&&this.getButtonEnabled(this._enterButtonId)){
this._runCallbackForButtonId(this._enterButtonId,e)
}};
DwtDialog.prototype._resetCallbacks=function(){
if(this._buttonDesc){
for(var e=0;
e<DwtDialog.ALL_BUTTONS.length;
e++){
var t=DwtDialog.ALL_BUTTONS[e];
if(this._buttonDesc[t]){
this._buttonDesc[t].callback=new AjxCallback(this,this.popdown)
}}}};
DwtDialog_ButtonDescriptor=function(n,e,o,a,t){
this.id=n;
this.label=e;
this.align=o;
this.callback=a;
this.cellTemplate=t
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtSash")){
DwtSash=function(a){
a=Dwt.getParams(arguments,DwtSash.PARAMS);
a.className=a.className||"DwtSash";
a.posStyle=a.posStyle||DwtControl.ABSOLUTE_STYLE;
DwtControl.call(this,a);
var t=this.getHtmlElement();
var e="dwt.Widgets#";
if(!a.style||a.style!=DwtSash.HORIZONTAL_STYLE){
this._style=DwtSash.VERTICAL_STYLE;
t.style.cursor=AjxEnv.isIE?"row-resize":"s-resize";
t.innerHTML=AjxTemplate.expand(e+"DwtVerticalSash")
}else{
this._style=DwtSash.HORIZONTAL_STYLE;
t.style.cursor=AjxEnv.isIE?"col-resize":"w-resize";
t.innerHTML=AjxTemplate.expand(e+"DwtHorizontalSash")
}
this._threshold=(a.threshold>0)?a.threshold:1;
this._captureObj=new DwtMouseEventCapture({
targetObj:this,id:"DwtSash",mouseOverHdlr:DwtSash._mouseOverHdlr,mouseDownHdlr:DwtSash._mouseDownHdlr,mouseMoveHdlr:DwtSash._mouseMoveHdlr,mouseUpHdlr:DwtSash._mouseUpHdlr,mouseOutHdlr:DwtSash._mouseOutHdlr}
);
this.setHandler(DwtEvent.ONMOUSEDOWN,DwtSash._mouseDownHdlr);
this.setHandler(DwtEvent.ONMOUSEOVER,DwtSash._mouseOverHdlr);
this.setHandler(DwtEvent.ONMOUSEOUT,DwtSash._mouseOutHdlr);
this.setZIndex(Dwt.Z_VIEW)
};
DwtSash.PARAMS=["parent","style","className","threshold","posStyle"];
DwtSash.prototype=new DwtControl;
DwtSash.prototype.constructor=DwtSash;
DwtSash.prototype.toString=function(){
return"DwtSash"
};
DwtSash.HORIZONTAL_STYLE=1;
DwtSash.VERTICAL_STYLE=2;
DwtSash.prototype.registerCallback=function(e,t){
this._callbackFunc=e;
this._callbackObj=t
};
DwtSash._mouseOverHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseDownHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,true);
if(e.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(t,true,false);
return false
}
DwtEventManager.notifyListeners(DwtEvent.ONMOUSEDOWN,e);
var a=e.dwtObj;
if(a._callbackFunc!=null){
a._captureObj.capture();
a._startCoord=(a._style==DwtSash.HORIZONTAL_STYLE)?e.docX:e.docY
}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseMoveHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
var o=0;
var a=DwtMouseEventCapture.getTargetObj();
if(a._style==DwtSash.HORIZONTAL_STYLE){
if(e.docX>0&&e.docX!=a._startCoord){
o=e.docX-a._startCoord
}}else{
if(e.docY>0&&e.docY!=a._startCoord){
o=e.docY-a._startCoord
}}
if(Math.abs(o)>=a._threshold){
if(a._callbackObj!=null){
o=a._callbackFunc.call(a._callbackObj,o)
}else{
o=a._callbackFunc(o)
}
a._startCoord+=o;
if(o!=0&&a.getHtmlElement().style.position==Dwt.ABSOLUTE_STYLE){
if(a._style==DwtSash.HORIZONTAL_STYLE){
a.setLocation(a.getLocation().x+o,Dwt.DEFAULT)
}else{
a.setLocation(Dwt.DEFAULT,a.getLocation().y+o)
}}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseUpHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(e.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(t,true,false);
return false
}
var a=DwtMouseEventCapture.getTargetObj();
if(a._callbackFunc!=null){
DwtMouseEventCapture.getCaptureObj().release()
}
a.notifyListeners(DwtEvent.ONMOUSEUP,e);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseOutHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtToolBar")){
DwtToolBar=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtToolBar.PARAMS);
t.className=t.className||"ZToolbar";
DwtComposite.call(this,t);
if(t.parent instanceof DwtToolBar){
this._hasSetMouseEvents=t.parent._hasSetMouseEvents
}
if(t.handleMouse!==false&&!this._hasSetMouseEvents){
var e=AjxEnv.isIE?[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP]:[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
this._setEventHdlrs(e);
this._hasSetMouseEvents=true
}
this._style=t.style||DwtToolBar.HORIZ_STYLE;
this._items=[];
this._createHtml();
this._numFillers=0;
this._curFocusIndex=0;
this._keyMapName=(this._style==DwtToolBar.HORIZ_STYLE)?DwtKeyMap.MAP_TOOLBAR_HORIZ:DwtKeyMap.MAP_TOOLBAR_VERT
};
DwtToolBar.PARAMS=["parent","className","posStyle","style","index","id"];
DwtToolBar.prototype=new DwtComposite;
DwtToolBar.prototype.constructor=DwtToolBar;
DwtToolBar.prototype.isDwtToolBar=true;
DwtToolBar.prototype.toString=function(){
return"DwtToolBar"
};
DwtToolBar.HORIZ_STYLE=1;
DwtToolBar.VERT_STYLE=2;
DwtToolBar.ELEMENT=1;
DwtToolBar.SPACER=2;
DwtToolBar.SEPARATOR=3;
DwtToolBar.FILLER=4;
DwtToolBar.FIRST_ITEM="ZFirstItem";
DwtToolBar.LAST_ITEM="ZLastItem";
DwtToolBar.SELECTED_NEXT=DwtControl.SELECTED+"Next";
DwtToolBar.SELECTED_PREV=DwtControl.SELECTED+"Prev";
DwtToolBar._NEXT_PREV_RE=new RegExp("\\b"+[DwtToolBar.SELECTED_NEXT,DwtToolBar.SELECTED_PREV].join("|")+"\\b","g");
DwtToolBar.prototype.TEMPLATE="dwt.Widgets#ZToolbar";
DwtToolBar.prototype.ITEM_TEMPLATE="dwt.Widgets#ZToolbarItem";
DwtToolBar.prototype.SEPARATOR_TEMPLATE="dwt.Widgets#ZToolbarSeparator";
DwtToolBar.prototype.SPACER_TEMPLATE="dwt.Widgets#ZToolbarSpacer";
DwtToolBar.prototype.FILLER_TEMPLATE="dwt.Widgets#ZToolbarFiller";
DwtToolBar.__itemCount=0;
DwtToolBar.prototype.dispose=function(){
this._itemsEl=null;
this._prefixEl=null;
this._suffixEl=null;
DwtComposite.prototype.dispose.call(this)
};
DwtToolBar.prototype.getItem=function(e){
return this._children.get(e)
};
DwtToolBar.prototype.getItemCount=function(){
return this._children.size()
};
DwtToolBar.prototype.getItems=function(){
return this._children.getArray()
};
DwtToolBar.prototype.addSpacer=function(t,e){
var a=this._createSpacerElement();
this._addItem(DwtToolBar.SPACER,a,e);
return a
};
DwtToolBar.prototype.addSeparator=function(a,e){
var t=this._createSeparatorElement();
this._addItem(DwtToolBar.SEPARATOR,t,e);
return t
};
DwtToolBar.prototype.removeSeparator=function(e){
this._removeItem(e)
};
DwtToolBar.prototype.addFiller=function(a,e){
var t=this._createFillerElement();
this._addItem(DwtToolBar.FILLER,t,e);
return t
};
DwtToolBar.prototype.addChild=function(a,e){
if(a.isDwtControl){
DwtComposite.prototype.addChild.apply(this,arguments)
}
var t=this._createItemElement();
t.appendChild(a.isDwtControl?a.getHtmlElement():a);
this._addItem(DwtToolBar.ELEMENT,t,e)
};
DwtToolBar.prototype.getKeyMapName=function(){
return this._keyMapName
};
DwtToolBar.prototype.handleKeyAction=function(t,o){
var a=this.getItem(this._curFocusIndex);
var e=this.getItemCount();
if(e<2){
return true
}
switch(t){
case DwtKeyMap.PREV:if(this._curFocusIndex>0){
this._moveFocus(true)
}
break;
case DwtKeyMap.NEXT:if(this._curFocusIndex<(e-1)){
this._moveFocus()
}
break;
default:if(a){
return a.handleKeyAction(t,o)
}}
return true
};
DwtToolBar.prototype._createItemId=function(t){
t=t||this._htmlElId;
var e=[t,"item",++DwtToolBar.__itemCount].join("_");
return e
};
DwtToolBar.prototype._createHtml=function(){
var e={
id:this._htmlElId};
this._createHtmlFromTemplate(this.TEMPLATE,e);
this._itemsEl=document.getElementById(e.id+"_items");
this._prefixEl=document.getElementById(e.id+"_prefix");
this._suffixEl=document.getElementById(e.id+"_suffix")
};
DwtToolBar.prototype._createItemElement=function(a){
a=a||this.ITEM_TEMPLATE;
var o={
id:this._htmlElId,itemId:this._createItemId()};
var t=AjxTemplate.expand(a,o);
var e=AjxStringUtil.calcDIV();
e.innerHTML=t;
return e.firstChild.rows[0].cells[0]
};
DwtToolBar.prototype._createSpacerElement=function(e){
return this._createItemElement(e||this.SPACER_TEMPLATE)
};
DwtToolBar.prototype._createSeparatorElement=function(e){
return this._createItemElement(e||this.SEPARATOR_TEMPLATE)
};
DwtToolBar.prototype._createFillerElement=function(e){
return this._createItemElement(e||this.FILLER_TEMPLATE)
};
DwtToolBar.prototype._addItem=function(o,a,t){
var n=this._items[t]||this._suffixEl;
var e=t||(typeof t=="number")?t:this._items.length;
this._items.splice(e,0,a);
this._itemsEl.insertBefore(a,n)
};
DwtToolBar.prototype._removeItem=function(t){
for(var e=0;
e<this._items.length;
e++){
if(this._items[e]==t){
this._items.splice(e,1);
this._itemsEl.removeChild(t);
break
}}};
DwtToolBar.prototype._focus=function(e){
if(!this._submenuKeySet){
var a=this.shell.getKeyboardMgr();
if(a.isEnabled()){
var t=a.__keyMapMgr;
if(t){
if(this._style==DwtToolBar.HORIZ_STYLE){
t.removeMapping(DwtKeyMap.MAP_BUTTON,"ArrowRight");
t.setMapping(DwtKeyMap.MAP_BUTTON,"ArrowDown",DwtKeyMap.SUBMENU)
}else{
t.removeMapping(DwtKeyMap.MAP_BUTTON,"ArrowDown");
t.setMapping(DwtKeyMap.MAP_BUTTON,"ArrowRight",DwtKeyMap.SUBMENU)
}
t.reloadMap(DwtKeyMap.MAP_BUTTON)
}}
this._submenuKeySet=true
}
e=e?e:this._getFocusItem(this._curFocusIndex);
if(e){
e._hasFocus=true;
e._focus()
}else{
this._moveFocus()
}};
DwtToolBar.prototype._blur=function(e){
e=e?e:this._getFocusItem(this._curFocusIndex);
if(e){
e._hasFocus=false;
e._blur()
}};
DwtToolBar.prototype._getFocusItem=function(e){
var t=this.getItem(e);
if(!t||(t instanceof DwtToolBar)){
return null
}
if(t._noFocus){
return null
}
if(t.getEnabled&&!t.getEnabled()){
return null
}
if(t.getVisible&&!t.getVisible()){
return null
}
return t
};
DwtToolBar.prototype._moveFocus=function(e){
var t=this._curFocusIndex;
var a=this.getItemCount()-1;
var o=null;
while(!o&&t>=0&&t<=a){
t=e?t-1:t+1;
o=this._getFocusItem(t)
}
if(o){
this._blur();
this._curFocusIndex=t;
this._focus(o)
}};
DwtToolBar.prototype.__markPrevNext=function(r,s){
var e=this.__getButtonIndex(r);
var o=this.__getButtonAt(e-1);
var t=this.__getButtonAt(e+1);
if(s){
if(o){
Dwt.delClass(o.getHtmlElement(),DwtToolBar._NEXT_PREV_RE,DwtToolBar.SELECTED_PREV)
}
if(t){
Dwt.delClass(t.getHtmlElement(),DwtToolBar._NEXT_PREV_RE,DwtToolBar.SELECTED_NEXT)
}}else{
if(o){
Dwt.delClass(o.getHtmlElement(),DwtToolBar._NEXT_PREV_RE)
}
if(t){
Dwt.delClass(t.getHtmlElement(),DwtToolBar._NEXT_PREV_RE)
}}
var n=this.__getButtonAt(0);
if(n){
Dwt.addClass(n.getHtmlElement(),DwtToolBar.FIRST_ITEM)
}
var a=this.__getButtonAt(this.getItemCount()-1);
if(a){
Dwt.addClass(a.getHtmlElement(),DwtToolBar.LAST_ITEM)
}};
DwtToolBar.prototype.__getButtonIndex=function(a){
var t=this.getChildren();
var e=this._buttons[a];
if(t&&t.length&&e){
return AjxUtil.indexOf(t,e)
}
return -1
};
DwtToolBar.prototype.__getButtonAt=function(t){
var a=0;
for(var e in this._buttons){
if(this._buttons.hasOwnProperty(e)){
if(a==t){
return this._buttons[e]
}
a++
}}
return null
};
DwtToolBarButton=function(e){
if(arguments.length==0){
return
}
var e=Dwt.getParams(arguments,DwtToolBarButton.PARAMS);
e.className=e.className||"ZToolbarButton";
DwtButton.call(this,e)
};
DwtToolBarButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index"];
DwtToolBarButton.prototype=new DwtButton;
DwtToolBarButton.prototype.constructor=DwtToolBarButton;
DwtToolBarButton.prototype.isDwtToolBarButton=true;
DwtToolBarButton.prototype.toString=function(){
return"DwtToolBarButton"
};
DwtToolBarButton.prototype.TEMPLATE="dwt.Widgets#ZToolbarButton"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtToolTip")){
DwtToolTip=function(a,o,t){
if(arguments.length==0){
return
}
this.shell=a;
this._dialog=t;
this._poppedUp=false;
this._div=document.createElement("div");
this._div.className=o||"DwtToolTip";
this._div.style.position=DwtControl.ABSOLUTE_STYLE;
this.shell.getHtmlElement().appendChild(this._div);
Dwt.setZIndex(this._div,Dwt.Z_HIDDEN);
Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
var e="dwt.Widgets#"+this._borderStyle;
this._div.innerHTML=AjxTemplate.expand(e,"tooltip");
var n=AjxTemplate.getParams(e);
this._offsetX=(n.width!=null)?Number(n.width):DwtToolTip.POPUP_OFFSET_X;
this._offsetY=(n.height!=null)?Number(n.height):DwtToolTip.POPUP_OFFSET_Y;
this._contentDiv=document.getElementById("tooltipContents");
Dwt.setHandler(this._div,DwtEvent.ONMOUSEOVER,AjxCallback.simpleClosure(this._mouseOverListener,this))
};
DwtToolTip.prototype.isDwtToolTip=true;
DwtToolTip.prototype.toString=function(){
return"DwtToolTip"
};
DwtToolTip.TOOLTIP_DELAY=750;
DwtToolTip.WINDOW_GUTTER=5;
DwtToolTip.POPUP_OFFSET_X=5;
DwtToolTip.POPUP_OFFSET_Y=5;
DwtToolTip.prototype._borderStyle="DwtToolTip";
DwtToolTip.prototype.getContent=function(){
return this._div.innerHTML
};
DwtToolTip.prototype.setContent=function(t,e){
this._content=t;
if(e){
this._contentDiv.innerHTML=this._content
}};
DwtToolTip.prototype.popup=function(e,s,t,a,o,n){
if(this._popupAction){
AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}
this._popdownOnMouseOver=a;
if(this._content!=null){
if(!t){
this._contentDiv.innerHTML=this._content
}
this._popupAction=new AjxTimedAction(this,this._positionElement,[e,s,o,n]);
AjxTimedAction.scheduleAction(this._popupAction,5)
}};
DwtToolTip.prototype.setSticky=function(e){
this._poppedUp=!e
};
DwtToolTip.prototype.popdown=function(){
this._popdownOnMouseOver=false;
if(this._popupAction){
AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}
if(this._content!=null&&this._poppedUp){
Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._poppedUp=false
}};
DwtToolTip.prototype._positionElement=function(r,s,n,h){
this._popupAction=null;
var a=DwtShell.getShell(window).getSize();
var t=a.x,f=a.y;
var p,m,e;
var g=n&&n.getTooltipBase(h);
if(g){
e=Dwt.toWindow(g);
var o=Dwt.getSize(g);
p=e.x+this._offsetX;
m=e.y+o.y+this._offsetY
}else{
p=r+this._offsetX;
m=s+this._offsetY
}
var d=Dwt.getSize(this._div);
var u=d.x,l=d.y;
if(p+u>t-DwtToolTip.WINDOW_GUTTER){
p=t-DwtToolTip.WINDOW_GUTTER-u
}
if(m+l>f-DwtToolTip.WINDOW_GUTTER){
m=(e?e.y:m)-this._offsetY-l
}
Dwt.setLocation(this._div,p,m);
var c=this._dialog?this._dialog.getZIndex()+Dwt._Z_INC:Dwt.Z_TOOLTIP;
Dwt.setZIndex(this._div,c);
this._poppedUp=true
};
DwtToolTip.prototype._mouseOverListener=function(e){
if(this._popdownOnMouseOver&&this._poppedUp){
var t=(this._popdownOnMouseOver.isAjxCallback)?this._popdownOnMouseOver:null;
this.popdown();
if(t){
t.run()
}}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTreeItem")){
DwtTreeItem=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtTreeItem.PARAMS);
var e=t.parent;
if(e instanceof DwtTree){
this._tree=e
}else{
if(e instanceof DwtTreeItem){
this._tree=e._tree
}else{
throw new DwtException("DwtTreeItem parent must be a DwtTree or DwtTreeItem",DwtException.INVALIDPARENT,"DwtTreeItem")
}}
this._origClassName=t.className||"DwtTreeItem";
this._textClassName=[this._origClassName,"Text"].join("-");
this._selectedClassName=[this._origClassName,DwtCssStyle.SELECTED].join("-");
this._selectedFocusedClassName=[this._origClassName,DwtCssStyle.SELECTED,DwtCssStyle.FOCUSED].join("-");
this._actionedClassName=[this._origClassName,DwtCssStyle.ACTIONED].join("-");
this._dragOverClassName=[this._origClassName,DwtCssStyle.DRAG_OVER].join("-");
this._treeItemTextClass="DwtTreeItem-Text";
this._treeItemExtraImgClass="DwtTreeItem-ExtraImg";
t.deferred=(t.deferred!==false);
t.className=null;
DwtComposite.call(this,t);
this._imageInfoParam=t.imageInfo;
this._extraInfo=t.extraInfo;
this._textParam=t.text;
this._deferred=t.deferred;
this._expandNodeImage=t.expandNodeImage||"NodeExpanded";
this._collapseNodeImage=t.collapseNodeImage||"NodeCollapsed";
this._itemChecked=false;
this._initialized=false;
this._selectionEnabled=Boolean(t.selectable!==false);
this._forceNotifySelection=Boolean(t.forceNotifySelection);
this._actionEnabled=true;
this._forceNotifyAction=Boolean(t.forceNotifyAction);
this._dndScrollCallback=t.dndScrollCallback;
this._dndScrollId=t.dndScrollId;
this._contextEnabled=(!(!(e._optButton))||e._contextEnabled)&&this._selectionEnabled;
if(t.singleClickAction){
this._singleClickAction=true;
this._selectedFocusedClassName=this._selectedClassName=this._textClassName;
this._hoverClassName=[this._origClassName,DwtCssStyle.HOVER].join("-")
}else{
this._hoverClassName=this._textClassName
}
if(e instanceof DwtTree||(e._initialized&&(!e._deferred||e._expanded))||!t.deferred){
this._initialize(t.index)
}else{
e._addDeferredChild(this,t.index);
this._index=t.index
}};
DwtTreeItem.PARAMS=["parent","index","text","imageInfo","deferred","className","posStyle","forceNotifySelection","forceNotifyAction"];
DwtTreeItem.prototype=new DwtComposite;
DwtTreeItem.prototype.constructor=DwtTreeItem;
DwtTreeItem.prototype.isDwtTreeItem=true;
DwtTreeItem.prototype.toString=function(){
return"DwtTreeItem"
};
DwtTreeItem.prototype.TEMPLATE="dwt.Widgets#ZTreeItem";
DwtTreeItem.prototype._checkBoxVisible=true;
DwtTreeItem._NODECELL_DIM="16px";
DwtTreeItem._processedMouseDown=false;
DwtTreeItem.prototype.dispose=function(){
this._itemDiv=null;
this._nodeCell=null;
this._checkBoxCell=null;
this._checkedImg=null;
this._checkBox=null;
this._imageCell=null;
this._textCell=null;
this._childDiv=null;
DwtComposite.prototype.dispose.call(this)
};
DwtTreeItem.prototype.getChecked=function(){
return this._itemChecked
};
DwtTreeItem.prototype.setChecked=function(e,t){
if((this._itemChecked!=e)||t){
this._itemChecked=e;
if(this._checkBox!=null&&(this._checkBoxCell&&Dwt.getVisible(this._checkBoxCell))){
Dwt.setVisible(this._checkedImg,e)
}}};
DwtTreeItem.prototype._handleCheckboxOnclick=function(e){
this.setChecked(!Dwt.getVisible(this._checkedImg));
e=e||window.event;
e.item=this;
this._tree._itemChecked(this,e)
};
DwtTreeItem.prototype.getExpanded=function(){
return this._expanded
};
DwtTreeItem.prototype.setExpanded=function(t,s,n){
if(t){
var r=this.parent;
while(r instanceof DwtTreeItem&&!r._expanded){
r.setExpanded(true);
r=r.parent
}
this._realizeDeferredChildren()
}
if(this.getNumChildren()){
if(t&&s){
if(!this._expanded){
this._expand(t,null,n)
}
var e=this.getChildren();
for(var o=0;
o<e.length;
o++){
if(e[o] instanceof DwtTreeItem){
e[o].setExpanded(t,s,n)
}}}else{
if(this._expanded!=t){
this._expand(t,null,n)
}}}};
DwtTreeItem.prototype.getItemCount=function(){
return this._children.size()
};
DwtTreeItem.prototype.getItems=function(){
return this._children.getArray()
};
DwtTreeItem.prototype.getChildIndex=function(e){
return this._children.indexOf(e)
};
DwtTreeItem.prototype.getImage=function(){
return this._imageInfo
};
DwtTreeItem.prototype.setImage=function(e){
if(this._initialized){
if(this._imageCell){
AjxImg.setImage(this._imageCell,e)
}
this._imageInfo=e
}else{
this._imageInfoParam=e
}};
DwtTreeItem.prototype.setDndImage=function(e){
this._dndImageInfo=e
};
DwtTreeItem.prototype.getSelected=function(){
return this._selected
};
DwtTreeItem.prototype.getActioned=function(){
return this._actioned
};
DwtTreeItem.prototype.getText=function(){
return this._text
};
DwtTreeItem.prototype.setText=function(e){
if(this._initialized){
if(!e){
e=""
}
this._text=this._textCell.innerHTML=e
}else{
this._textParam=e
}};
DwtTreeItem.prototype.setDndText=function(e){
this._dndText=e
};
DwtTreeItem.prototype.showCheckBox=function(e){
this._checkBoxVisible=e;
if(this._checkBoxCell){
Dwt.setVisible(this._checkBoxCell,e)
}};
DwtTreeItem.prototype.showExpansionIcon=function(e){
if(this._nodeCell){
Dwt.setVisible(this._nodeCell,e)
}};
DwtTreeItem.prototype.enableSelection=function(e){
this._selectionEnabled=e;
this._selectedClassName=e?this._origClassName+"-"+DwtCssStyle.SELECTED:this._origClassName;
this._contextEnabled=!(!(this.parent._optButton))&&this._selectionEnabled
};
DwtTreeItem.prototype.enableAction=function(e){
this._actionEnabled=e
};
DwtTreeItem.prototype.addSeparator=function(e){
this._children.add((new DwtTreeItemSeparator(this)),e)
};
DwtTreeItem.prototype.setVisible=function(a,t,e){
if(t&&!e){
Dwt.setVisible(this._itemDiv,a)
}else{
if(e&&!t){
Dwt.setVisible(this._childDiv,a)
}else{
DwtComposite.prototype.setVisible.call(this,a)
}}};
DwtTreeItem.prototype.removeChild=function(t){
if(t._initialized){
this._tree._deselect(t);
if(this._childDiv){
this._childDiv.removeChild(t.getHtmlElement())
}}
this._children.remove(t);
if(this._children.size()==0){
if(this._expanded){
this._expanded=false
}
if(this._initialized&&this._nodeCell){
AjxImg.setImage(this._nodeCell,"Blank_16");
var e=AjxImg.getImageElement(this._nodeCell);
if(e){
Dwt.clearHandler(e,DwtEvent.ONMOUSEDOWN)
}}}};
DwtTreeItem.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_TREE
};
DwtTreeItem.prototype.handleKeyAction=function(a,r){
switch(a){
case DwtKeyMap.ENTER:this._tree.setEnterSelection(this,true);
break;
case DwtKeyMap.NEXT:var n=this._tree._getNextTreeItem(true);
if(n){
n._tree.setSelection(n,false,true)
}
break;
case DwtKeyMap.PREV:var n=this._tree._getNextTreeItem(false);
if(n){
n._tree.setSelection(n,false,true)
}
break;
case DwtKeyMap.EXPAND:if(!this._expanded){
this.setExpanded(true,false,true)
}
break;
case DwtKeyMap.COLLAPSE:if(this._expanded){
this.setExpanded(false,false,true)
}
break;
case DwtKeyMap.ACTION:var l=this.getHtmlElement();
var h=Dwt.toWindow(l,0,0);
var o=this.getSize();
var t=h.x+o.x/4;
var e=h.y+o.y/2;
this._gotMouseDownRight=true;
this._emulateSingleClick({
dwtObj:this,target:l,button:DwtMouseEvent.RIGHT,docX:t,docY:e,kbNavEvent:true}
);
break;
default:return false
}
return true
};
DwtTreeItem.prototype.addNodeIconListeners=function(){
var e=AjxImg.getImageElement(this._nodeCell);
if(e){
Dwt.setHandler(e,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr);
Dwt.setHandler(e,DwtEvent.ONMOUSEUP,DwtTreeItem._nodeIconMouseUpHdlr)
}};
DwtTreeItem.prototype._initialize=function(e,n,o){
this._checkState();
if(AjxEnv.isIE){
this._setEventHdlrs([DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE])
}
if(AjxEnv.isSafari){
this._setEventHdlrs([DwtEvent.ONCONTEXTMENU])
}
var a={
id:this._htmlElId,divClassName:this._origClassName,isCheckedStyle:this._tree.isCheckedStyle,textClassName:this._textClassName};
this._createHtmlFromTemplate(this.TEMPLATE,a);
this.parent._addItem(this,e,n);
this._itemDiv=document.getElementById(a.id+"_div");
this._nodeCell=document.getElementById(a.id+"_nodeCell");
this._checkBoxCell=document.getElementById(a.id+"_checkboxCell");
this._checkBox=document.getElementById(a.id+"_checkbox");
this._checkedImg=document.getElementById(a.id+"_checkboxImg");
this._imageCell=document.getElementById(a.id+"_imageCell");
this._textCell=document.getElementById(a.id+"_textCell");
this._extraCell=document.getElementById(a.id+"_extraCell");
if(!this._contextEnabled){
var t=document.getElementById(a.id+"_table");
t.style.tableLayout="auto"
}
if(this._nodeCell){
this._nodeCell.style.width=this._nodeCell.style.height=DwtTreeItem._NODECELL_DIM;
if(this._children.size()>0||o){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage);
this.addNodeIconListeners()
}}
if(this._extraCell){
AjxImg.setImage(this._extraCell,(this._extraInfo||"Blank_16"));
this._extraCell.className=this._treeItemExtraImgClass
}
if(this._tree.isCheckedStyle&&this._checkBox){
this._checkBox.onclick=AjxCallback.simpleClosure(this._handleCheckboxOnclick,this);
this.showCheckBox(this._checkBoxVisible);
this.setChecked(this._tree.isCheckedByDefault,true)
}
if(this._imageCell&&this._imageInfoParam){
AjxImg.setImage(this._imageCell,this._imageInfoParam);
this._imageInfo=this._imageInfoParam
}
if(this._textCell&&this._textParam){
this._textCell.innerHTML=this._text=this._textParam
}
this._expanded=this._selected=this._actioned=false;
this._gotMouseDownLeft=this._gotMouseDownRight=false;
this._addMouseListeners();
this._initialized=true
};
DwtTreeItem.prototype.setTreeItemColor=function(o){
var s=this._htmlElId+"_table";
var a=document.getElementById(s);
var n=document.getElementById(this._htmlElId+"_div");
var t=this.getHtmlElement();
var e=this._origClassName+" "+o;
if(n){
n.className=e
}else{
if(t){
t.className=o
}}};
DwtTreeItem.prototype._addMouseListeners=function(){
var t=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONDBLCLICK];
if(AjxEnv.isIE){
t.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{
t.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
if(AjxEnv.isSafari){
t.push(DwtEvent.ONCONTEXTMENU)
}
for(var e=0;
e<t.length;
e++){
this.addListener(t[e],DwtTreeItem._listeners[t[e]])
}};
DwtTreeItem.prototype._addDeferredChild=function(a,e){
if(this._initialized&&this._children.size()==0){
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage);
var t=AjxImg.getImageElement(this._nodeCell);
if(t){
Dwt.setHandler(t,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr);
Dwt.setHandler(t,DwtEvent.ONMOUSEUP,DwtTreeItem._nodeIconMouseUpHdlr)
}}}
this._children.add(a,e)
};
DwtTreeItem.prototype.addChild=function(e){};
DwtTreeItem.prototype._addItem=function(a,t,s){
if(!this._children.contains(a)){
this._children.add(a,t)
}
if(this._childDiv==null){
this._childDiv=document.createElement("div");
this._childDiv.className=(this.parent!=this._tree)?"DwtTreeItemChildDiv":"DwtTreeItemLevel1ChildDiv";
this.getHtmlElement().appendChild(this._childDiv);
if(!this._expanded){
this._childDiv.style.display="none"
}}
if(s&&this._nodeCell){
if(AjxImg.getImageClass(this._nodeCell)==AjxImg.getClassForImage("Blank_16")){
AjxImg.setImage(this._nodeCell,this._expanded?this._expandNodeImage:this._collapseNodeImage);
var n=AjxImg.getImageElement(this._nodeCell);
if(n){
Dwt.setHandler(n,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr)
}}}
var e=this._childDiv;
var o=e.childNodes.length;
if(t==null||t>=o||o==0){
e.appendChild(a.getHtmlElement())
}else{
e.insertBefore(a.getHtmlElement(),e.childNodes[t])
}};
DwtTreeItem.prototype.sort=function(e){
this._children.sort(e);
if(this._childDiv){
this._setChildElOrder()
}else{
this._needsSort=true
}};
DwtTreeItem.prototype._setChildElOrder=function(e){
var t=document.createDocumentFragment();
this._children.foreach(function(o,a){
t.appendChild(o.getHtmlElement());
o._index=a
}
);
this._childDiv.appendChild(t)
};
DwtTreeItem.prototype._getDragProxy=function(){
var t=document.createElement("div");
Dwt.setPosition(t,Dwt.ABSOLUTE_STYLE);
var a=document.createElement("table");
t.appendChild(a);
a.cellSpacing=a.cellPadding=0;
var o=a.insertRow(0);
var e=0;
var n=o.insertCell(e++);
n.noWrap=true;
if(this._dndImageInfo){
AjxImg.setImage(n,this._dndImageInfo)
}else{
if(this._imageInfo){
AjxImg.setImage(n,this._imageInfo)
}}
n=o.insertCell(e);
n.noWrap=true;
n.className=this._origClassName;
if(this._dndText){
n.innerHTML=this._dndText
}else{
if(this._text){
n.innerHTML=this._text
}}
this.shell.getHtmlElement().appendChild(t);
Dwt.setZIndex(t,Dwt.Z_DND);
return t
};
DwtTreeItem.prototype._dragEnter=function(){
this._preDragClassName=this._textCell.className;
this._textCell.className=this._dragOverClassName;
this._draghovering=true
};
DwtTreeItem.prototype._dragHover=function(){
if(this.getNumChildren()>0&&!this.getExpanded()){
this.setExpanded(true)
}};
DwtTreeItem.prototype._dragLeave=function(e){
if(this._preDragClassName){
this._textCell.className=this._preDragClassName
}
this._draghovering=false
};
DwtTreeItem.prototype._drop=function(){
if(this._preDragClassName){
this._textCell.className=this._preDragClassName
}
this._draghovering=false
};
DwtTreeItem.prototype._focusByMouseDownEvent=function(e){};
DwtTreeItem._nodeIconMouseDownHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,a);
if(e.button==DwtMouseEvent.LEFT){
a._expand(!a._expanded,e)
}else{
if(e.button==DwtMouseEvent.RIGHT){
e.dwtObj._tree._itemActioned(e.dwtObj,e)
}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtTreeItem._nodeIconMouseUpHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtTreeItem.prototype._expand=function(t,a,e){
if(t!==this._expanded){
if(!t){
this._expanded=false;
this._childDiv.style.display="none";
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage)
}
this._tree._itemCollapsed(this,a,e)
}else{
this._realizeDeferredChildren();
this._expanded=true;
if(this._childDiv&&this._childDiv.style){
this._childDiv.style.display="block"
}
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._expandNodeImage)
}
this._tree._itemExpanded(this,a,e)
}}};
DwtTreeItem.prototype._realizeDeferredChildren=function(){
var e=this._children.getArray();
for(var t=0;
t<e.length;
t++){
var o=e[t];
if(!o._initialized){
o._initialize(o._index,true)
}else{
if(o._isSeparator&&!o.div&&this._childDiv){
var n=o.div=document.createElement("div");
n.className="vSpace";
this._childDiv.appendChild(n);
o._initialized=true
}}}
if(this._needsSort){
if(e.length){
this._setChildElOrder()
}
delete this.__needsSort
}};
DwtTreeItem.prototype._isChildOf=function(e){
var t=this.parent;
while(t&&t!=this._tree){
if(t==e){
return true
}
t=t.parent
}
return false
};
DwtTreeItem.prototype._setTreeElementStyles=function(e,a){
if(!this._contextEnabled||this._draghovering){
return
}
var t=a?"-focused":"";
if(this._extraCell){
AjxImg.setImage(this._extraCell,e);
this._extraCell.className=this._treeItemExtraImgClass+t
}
if(this._textCell){
this._textCell.className=this._treeItemTextClass+t
}};
DwtTreeItem.prototype._setSelected=function(e,t){
if(this._selected!=e){
this._selected=e;
if(!this._initialized){
this._initialize()
}
if(!this._itemDiv){
return
}
if(e&&(this._selectionEnabled||this._forceNotifySelection||this._checkBoxVisible)){
this._itemDiv.className=this._selectedClassName;
this._setTreeElementStyles("DownArrowSmall",true);
if(!t){
this.focus()
}
return true
}else{
this._setTreeElementStyles("Blank_16",false);
this._itemDiv.className=this._origClassName;
return false
}}};
DwtTreeItem.prototype._setActioned=function(e){
if(this._actioned!=e){
this._actioned=e;
if(!this._initialized){
this._initialize()
}
if(!this._itemDiv){
return
}
if(e&&(this._actionEnabled||this._forceNotifyAction)&&!this._selected){
this._itemDiv.className=this._actionedClassName;
return true
}
if(!e){
if(!this._selected){
this._itemDiv.className=this._origClassName
}
return false
}}};
DwtTreeItem.prototype._focus=function(){
if(!this._itemDiv){
return
}
this._itemDiv.className=this._selectedFocusedClassName;
this._setTreeElementStyles("DownArrowSmall",true)
};
DwtTreeItem.prototype._blur=function(){
if(!this._itemDiv){
return
}
this._itemDiv.className=this._selected?this._selectedClassName:this._origClassName;
this._setTreeElementStyles(this._selected?"DownArrowSmall":"Blank_16",this._selected)
};
DwtTreeItem._mouseDownListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(e.button==DwtMouseEvent.LEFT&&(t._selectionEnabled||t._forceNotifySelection)){
t._gotMouseDownLeft=true
}else{
if(e.button==DwtMouseEvent.RIGHT&&(t._actionEnabled||t._forceNotifyAction)){
t._gotMouseDownRight=true
}}};
DwtTreeItem._mouseOutListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
t._gotMouseDownLeft=false;
t._gotMouseDownRight=false;
if(t._singleClickAction&&t._textCell){
t._textCell.className=t._textClassName
}
if(!t._selected){
t._setTreeElementStyles("Blank_16",false)
}};
DwtTreeItem._mouseOverListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(t._singleClickAction&&t._textCell){
t._textCell.className=t._hoverClassName
}
if(!t._selected){
t._setTreeElementStyles("ColumnDownArrow",true)
}};
DwtTreeItem._mouseUpListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(e.button==DwtMouseEvent.LEFT&&t._gotMouseDownLeft){
t._tree._itemClicked(t,e)
}else{
if(e.button==DwtMouseEvent.RIGHT&&t._gotMouseDownRight){
t._tree._itemActioned(t,e)
}}};
DwtTreeItem._doubleClickListener=function(t){
var a=t.dwtObj;
if(!a){
return false
}
if(t.target==a._childDiv){
return
}
var o=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,o);
if(e.button==DwtMouseEvent.LEFT||e.button==DwtMouseEvent.NONE){
e.dwtObj._tree._itemDblClicked(e.dwtObj,e)
}};
DwtTreeItem._contextListener=function(t){
if(AjxEnv.isSafari){
var a=DwtControl.getTargetControl(t);
var e=a?a.preventContextMenu():true;
if(e){
a.notifyListeners(DwtEvent.ONMOUSEDOWN,t);
return a.notifyListeners(DwtEvent.ONMOUSEUP,t)
}}};
DwtTreeItem.prototype._emulateSingleClick=function(e){
var t=new DwtMouseEvent();
this._setMouseEvent(t,e);
t.kbNavEvent=e.kbNavEvent;
this.notifyListeners(DwtEvent.ONMOUSEUP,t)
};
DwtTreeItem.prototype.getTooltipBase=function(e){
return this._itemDiv
};
DwtTreeItem._listeners={};
DwtTreeItem._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtTreeItem._mouseDownListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtTreeItem._mouseOutListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtTreeItem._mouseOutListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtTreeItem._mouseOverListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtTreeItem._mouseOverListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtTreeItem._mouseUpListener);
DwtTreeItem._listeners[DwtEvent.ONDBLCLICK]=new AjxListener(null,DwtTreeItem._doubleClickListener);
DwtTreeItem._listeners[DwtEvent.ONCONTEXTMENU]=new AjxListener(null,DwtTreeItem._contextListener);
DwtTreeItemSeparator=function(e){
this.parent=e;
this._isSeparator=true;
this._initialized=true
};
DwtTreeItemSeparator.prototype.dispose=function(){
DwtComposite.prototype.removeChild.call(this.parent,this)
};
DwtTreeItemSeparator.prototype.isInitialized=function(){
return this._initialized
};
DwtTreeItemSeparator.prototype.getHtmlElement=function(){
return this.div
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtHeaderTreeItem")){
DwtHeaderTreeItem=function(e){
this.overview=e.overview;
this._optButton=e.optButton;
this._noNodeCell=e.noNodeCell;
DwtTreeItem.call(this,e)
};
DwtHeaderTreeItem.prototype=new DwtTreeItem;
DwtHeaderTreeItem.prototype.constructor=DwtHeaderTreeItem;
DwtHeaderTreeItem.prototype.TEMPLATE="dwt.Widgets#ZHeaderTreeItem";
DwtHeaderTreeItem.prototype.toString=function(){
return"DwtHeaderTreeItem"
};
DwtHeaderTreeItem.prototype._createHtmlFromTemplate=function(e,t){
t.noNodeCell=this._noNodeCell;
DwtTreeItem.prototype._createHtmlFromTemplate.apply(this,arguments)
};
DwtHeaderTreeItem.prototype._initialize=function(){
DwtTreeItem.prototype._initialize.apply(this,arguments);
if(this._optButton){
this._optButtonId=this._htmlElId+"_optButton";
var e=document.getElementById(this._optButtonId);
if(e){
this._optButtonItem=new DwtBorderlessButton({
parent:this,style:DwtLabel.IMAGE_LEFT}
);
this._optButtonItem.setToolTipContent(this._optButton.tooltip);
this._optButtonItem.callback=this._optButton.callback;
this._optButtonItem.addSelectionListener(new AjxListener(this,this._onclickHandler));
this._optButtonItem.replaceElement(this._optButtonId);
this._optButtonItem.setImage("ContextMenu");
this._optButtonItem.setIconEl(this._optButtonItem.getHtmlElement())
}}};
DwtHeaderTreeItem.prototype._onclickHandler=function(e){
this._tree._itemActioned(this,e)
};
DwtHeaderTreeItem.prototype._focusByMouseUpEvent=function(t){
var e=t.target&&t.target.id;
if(e&&(e==this._headerButtonId)){
return
}
DwtTreeItem.prototype._focusByMouseUpEvent.apply(this,arguments)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTree")){
DwtTree=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtTree.PARAMS);
a.className=a.className||"DwtTree";
DwtComposite.call(this,a);
var e=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONDBLCLICK];
if(!AjxEnv.isIE){
e=e.concat([DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT])
}
this._setEventHdlrs(e);
var t=a.style;
if(!t){
this._style=DwtTree.SINGLE_STYLE
}else{
if(t==DwtTree.CHECKEDITEM_STYLE){
t|=DwtTree.SINGLE_STYLE
}
this._style=t
}
this.isCheckedStyle=((this._style&DwtTree.CHECKEDITEM_STYLE)!=0);
this.isCheckedByDefault=a.isCheckedByDefault;
this._selectedItems=new AjxVector();
this._selEv=new DwtSelectionEvent(true);
this._selByClickEv=new DwtSelectionEvent(true);
this._selByClickEv.clicked=true;
this._selByEnterEv=new DwtSelectionEvent(true);
this._selByEnterEv.enter=true
};
DwtTree.PARAMS=["parent","style","className","posStyle"];
DwtTree.prototype=new DwtComposite;
DwtTree.prototype.constructor=DwtTree;
DwtTree.prototype.toString=function(){
return"DwtTree"
};
DwtTree.SINGLE_STYLE=1;
DwtTree.MULTI_STYLE=2;
DwtTree.CHECKEDITEM_STYLE=4;
DwtTree.ITEM_SELECTED=0;
DwtTree.ITEM_DESELECTED=1;
DwtTree.ITEM_CHECKED=2;
DwtTree.ITEM_ACTIONED=3;
DwtTree.ITEM_DBL_CLICKED=4;
DwtTree.ITEM_EXPANDED=1;
DwtTree.ITEM_COLLAPSED=2;
DwtTree.prototype.getStyle=function(){
return this._style
};
DwtTree.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
DwtTree.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtTree.prototype.addTreeListener=function(e){
this.addListener(DwtEvent.TREE,e)
};
DwtTree.prototype.removeTreeListener=function(e){
this.removeListener(DwtEvent.TREE,e)
};
DwtTree.prototype.getItemCount=function(){
return this.getItems().length
};
DwtTree.prototype.getItems=function(){
return this._children.getArray()
};
DwtTree.prototype.clearItems=function(){
var e=this.getItems();
for(var t=0;
t<e.length;
t++){
this.removeChild(e[t])
}
this._getContainerElement().innerHTML=""
};
DwtTree.prototype.deselectAll=function(){
var e=this._selectedItems.getArray();
var o=this._selectedItems.size();
for(var t=0;
t<o;
t++){
if(e[t]){
e[t]._setSelected(false)
}}
if(o>0){
this._notifyListeners(DwtEvent.SELECTION,this._selectedItems.getArray(),DwtTree.ITEM_DESELECTED,null,this._selEv)
}
this._selectedItems.removeAll()
};
DwtTree.prototype.getSelection=function(){
return this._selectedItems.getArray()
};
DwtTree.prototype.setEnterSelection=function(t,e){
if(!t){
return
}
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_SELECTED,null,this._selByEnterEv,e)
};
DwtTree.prototype.setSelection=function(n,r,c,e){
if(!n){
return
}
var l=this._selectedItems.getArray();
var h=this._selectedItems.size();
var d;
var t=0;
var s=false;
for(var o=0;
o<h;
o++){
if(l[o]==n){
s=true
}else{
l[o]._setSelected(false);
this._selectedItems.remove(l[o]);
if(d==null){
d=new Array()
}
d[t++]=l[o]
}}
if(d&&!r){
this._notifyListeners(DwtEvent.SELECTION,d,DwtTree.ITEM_DESELECTED,null,this._selEv,c)
}
if(s){
return
}
this._selectedItems.add(n);
this._expandUp(n);
if(n._setSelected(true,e)&&!r){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,null,this._selEv,c)
}};
DwtTree.prototype.getSelectionCount=function(){
return this._selectedItems.size()
};
DwtTree.prototype.addChild=function(e){
if(e instanceof DwtTreeItem){
return
}
DwtComposite.prototype.addChild.apply(this,arguments)
};
DwtTree.prototype.addSeparator=function(){
var e=document.createElement("div");
e.className="vSpace";
this._getContainerElement().appendChild(e)
};
DwtTree.prototype._expandUp=function(t){
var e=t.parent;
while(e instanceof DwtTreeItem){
e.setExpanded(true);
e.setVisible(true);
e=e.parent
}};
DwtTree.prototype._addItem=function(t,e){
this._children.add(t,e);
var o=this._getContainerElement();
var a=o.childNodes.length;
if(e==null||e>a){
o.appendChild(t.getHtmlElement())
}else{
o.insertBefore(t.getHtmlElement(),o.childNodes[e])
}};
DwtTree.prototype._getContainerElement=DwtTree.prototype.getHtmlElement;
DwtTree.prototype.sort=function(a){
var t=this.getItems();
t.sort(a);
var e=document.createDocumentFragment();
AjxUtil.foreach(t,function(n,o){
e.appendChild(n.getHtmlElement());
n._index=o
}
);
this._getContainerElement().appendChild(e)
};
DwtTree.prototype.removeChild=function(t){
this._children.remove(t);
this._selectedItems.remove(t);
var e=t.getHtmlElement();
if(e.parentNode){
e.parentNode.removeChild(e)
}};
DwtTree.prototype._getNextTreeItem=function(n){
var a=this.getSelection();
var l=(a&&a.length)?a[0]:null;
var e=null,h=-1;
var r=this.getTreeItemList(true);
if(l){
for(var o=0,s=r.length;
o<s;
o++){
var t=r[o];
if(t==l){
h=n?o+1:o-1;
break
}}
e=r[h]
}else{
if(r&&r.length){
e=n?r[0]:r[r.length-1]
}}
return e
};
DwtTree.prototype.getTreeItemList=function(e){
return this._addToList([],e)
};
DwtTree.prototype._addToList=function(n,s,o){
if(o&&!o._isSeparator&&(!s||(o.getVisible()&&o._selectionEnabled))){
n.push(o)
}
if(!o||!s||o._expanded){
var a=o||this;
var t=a.getChildren?a.getChildren():[];
for(var e=0;
e<t.length;
e++){
this._addToList(n,s,t[e])
}}
return n
};
DwtTree.prototype._deselect=function(e){
if(this._selectedItems.contains(e)){
this._selectedItems.remove(e);
e._setSelected(false);
this._notifyListeners(DwtEvent.SELECTION,[e],DwtTree.ITEM_DESELECTED,null,this._selEv)
}};
DwtTree.prototype._itemActioned=function(t,e){
if(this._actionedItem){
this._actionedItem._setActioned(false);
this._notifyListeners(DwtEvent.SELECTION,[this._actionedItem],DwtTree.ITEM_DESELECTED,e,this._selEv)
}
this._actionedItem=t;
t._setActioned(true);
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_ACTIONED,e,this._selEv)
};
DwtTree.prototype._itemChecked=function(t,e){
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_CHECKED,e,this._selEv)
};
DwtTree.prototype._itemClicked=function(n,o){
var t;
var e=this._selectedItems.getArray();
var s=this._selectedItems.size();
if(this._style&DwtTree.SINGLE_STYLE||(!o.shiftKey&&!o.ctrlKey)){
if(s>0){
for(t=0;
t<s;
t++){
e[t]._setSelected(false)
}
this._notifyListeners(DwtEvent.SELECTION,this._selectedItems.getArray(),DwtTree.ITEM_DESELECTED,o,this._selByClickEv);
this._selectedItems.removeAll()
}
this._selectedItems.add(n);
if(n._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,o,this._selByClickEv)
}}else{
if(o.ctrlKey){
if(this._selectedItems.contains(n)){
this._selectedItems.remove(n);
n._setSelected(false);
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_DESELECTED,o,this._selByClickEv)
}else{
this._selectedItems.add(n);
if(n._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,o,this._selByClickEv)
}}}else{}}};
DwtTree.prototype._itemDblClicked=function(t,e){
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_DBL_CLICKED,e,this._selEv)
};
DwtTree.prototype._itemExpanded=function(a,t,e){
if(!e){
this._notifyListeners(DwtEvent.TREE,[a],DwtTree.ITEM_EXPANDED,t,DwtShell.treeEvent)
}};
DwtTree.prototype._itemCollapsed=function(l,s,n){
var o;
if(!n){
this._notifyListeners(DwtEvent.TREE,[l],DwtTree.ITEM_COLLAPSED,s,DwtShell.treeEvent)
}
var h=false;
var r=this._selectedItems.getArray();
var e=this._selectedItems.size();
var c;
var t=0;
for(o=0;
o<e;
o++){
if(r[o]._isChildOf(l)){
h=true;
if(c==null){
c=new Array()
}
c[t++]=r[o];
r[o]._setSelected(false);
this._selectedItems.remove(r[o])
}}
if(c){
this._notifyListeners(DwtEvent.SELECTION,c,DwtTree.ITEM_DESELECTED,s,this._selEv)
}
if(h&&!this._selectedItems.contains(l)){
this._selectedItems.add(l);
if(l._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[l],DwtTree.ITEM_SELECTED,s,this._selEv)
}}};
DwtTree.prototype._notifyListeners=function(s,e,o,a,t,n){
if(this.isListenerRegistered(s)){
if(a){
DwtUiEvent.copy(t,a)
}
t.items=e;
if(e.length==1){
t.item=e[0]
}
t.detail=o;
t.kbNavEvent=n;
this.notifyListeners(s,t);
if(s==DwtEvent.SELECTION){
this.shell.notifyGlobalSelection(t)
}}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtText")){
DwtText=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtText.PARAMS);
e.className=e.className||"DwtText";
DwtControl.call(this,e)
};
DwtText.PARAMS=["parent","className","posStyle"];
DwtText.prototype=new DwtControl;
DwtText.prototype.constructor=DwtText;
DwtText.prototype.toString=function(){
return"DwtText"
};
DwtText.prototype.getTabGroupMember=function(){
return null
};
DwtText.prototype.setText=function(a){
if(!this._textNode){
this._textNode=document.createTextNode(a);
this.getHtmlElement().appendChild(this._textNode)
}else{
try{
this._textNode.data=a
}
catch(t){}}};
DwtText.prototype.getText=function(){
return this._textNode?this._textNode.data:""
};
DwtText.prototype.getTextNode=function(){
return this._textNode
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtIframe")){
DwtIframe=function(o){
o.posStyle=o.posStyle||DwtControl.STATIC_STYLE;
o.className=o.className||"DwtIframe";
DwtControl.call(this,o);
this._styles=o.styles;
this._noscroll=o.noscroll;
this._iframeID=o.id?DwtId.getIframeId(o.id):Dwt.getNextId();
this._onLoadHandler=o.onload;
this._processHtmlCallback=o.processHtmlCallback;
this._hidden=o.hidden;
if(!this._createFrame(o.html)){
this.initFailed=true;
return
}
if(o.useKbMgmt){
var t=this.getIframe();
var e=Dwt.getIframeDoc(t);
var a=AjxEnv.isIE?e:t.contentWindow;
Dwt.setHandler(a,DwtEvent.ONKEYDOWN,DwtKeyboardMgr.__keyDownHdlr);
Dwt.setHandler(a,DwtEvent.ONKEYUP,DwtKeyboardMgr.__keyUpHdlr);
Dwt.setHandler(a,DwtEvent.ONKEYPRESS,DwtKeyboardMgr.__keyPressHdlr)
}};
DwtIframe.prototype=new DwtControl;
DwtIframe.prototype.constructor=DwtIframe;
DwtIframe.prototype.isDwtIframe=true;
DwtIframe.prototype.toString=function(){
return"DwtIframe"
};
DwtIframe.prototype.getIframe=function(){
return document.getElementById(this._iframeID)
};
DwtIframe.prototype.getDocument=function(){
return this.getIframe().contentWindow.document
};
DwtIframe.prototype._rawEventHandler=function(r){
var a=this.getIframe();
var o=a.contentWindow;
if(AjxEnv.isIE){
r=o.event
}
var e;
if(/mouse|context|click|select/i.test(r.type)){
e=new DwtMouseEvent(true)
}else{
e=new DwtUiEvent(true)
}
e.setFromDhtmlEvent(r);
if(r.type=="mousedown"||r.type=="mousewheel"){
DwtOutsideMouseEventMgr.forwardEvent(r)
}
var n=e.type.toLowerCase();
if(!/^on/.test(n)){
n="on"+n
}
var s=this.getLocation();
if(!AjxEnv.isIE){
var h=o.document;
var t=h.documentElement.scrollLeft||(h.body?h.body.scrollLeft:0);
var d=h.documentElement.scrollTop||(h.body?h.body.scrollTop:0);
s.x-=t;
s.y-=d
}
e.docX+=s.x;
e.docY+=s.y;
e.elementX+=s.x;
e.elementY+=s.y;
var c=DwtMouseEventCapture.getCaptureObj();
c=c&&e.button!=DwtMouseEvent.RIGHT;
if(AjxEnv.isIE||!c){
DwtEventManager.notifyListeners(n,e);
this.parent.notifyListeners(n,e)
}else{
var l=document.createEvent("MouseEvents");
l.initMouseEvent(r.type,true,true,document.defaultView,0,r.screenX,r.screenY,e.docX,e.docY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget);
document.body.dispatchEvent(l)
}
e.setToDhtmlEvent(r);
return e._returnValue
};
DwtIframe._forwardEvents=[DwtEvent.ONCHANGE,DwtEvent.ONCLICK,DwtEvent.ONCONTEXTMENU,DwtEvent.ONDBLCLICK,DwtEvent.ONFOCUS,DwtEvent.ONKEYDOWN,DwtEvent.ONKEYPRESS,DwtEvent.ONKEYUP,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEOUT,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART];
DwtIframe.prototype._createFrame=function(t){
var e=this.getHTMLElId();
function a(s){
var n=document.getElementById(e);
var o=DwtControl.findControl(n);
return o._rawEventHandler(s)
}
return(function(){
var l,h=[],r=0,o;
var s=document.getElementById(e);
var n=DwtControl.findControl(s);
if(!n){
return false
}
h[r++]="<iframe";
if(n._noscroll){
h[r++]=" scrolling='no'"
}
if(n._hidden){
h[r++]=" style='visibility:hidden'"
}
h[r++]=" frameborder='0' width='100%' id='";
h[r++]=n._iframeID;
h[r++]="' name='"+n._iframeID+"'";
if(n._onLoadHandler){
h[r++]=" onload='"+n._onLoadHandler+"'"
}
h[r++]=" src='javascript:\"\";' ></iframe>";
n.setContent(h.join(""));
t=t.replace(/(<style[^>]*>)[\s\t\u00A0]*((.|\n)*?)[\s\t\u00A0]*<\x2fstyle>/mgi,function(c,u,d){
return u+d.replace(/@import.*?(;|[\s\t\u00A0]*$)/gi,"")+"</style>"
}
);
t=t.replace(AjxStringUtil.IMG_SRC_CID_REGEX,'<img pnsrc="cid:');
l=n.getIframe();
o=Dwt.getIframeDoc(l);
o.open();
if(n._styles){
o.write(["<style type='text/css'>",n._styles,"</style>"].join(""))
}
o.write(t);
o.close();
if(n._processHtmlCallback){
n._processHtmlCallback.run(o)
}
h=o.documentElement.style;
h.margin=h.padding="0";
if(o.body){
o.body.style.margin="0"
}
h=DwtIframe._forwardEvents;
if(!AjxEnv.isIE){
o=l.contentWindow
}
for(r=h.length;
--r>=0;
){
o[h[r]]=a
}
return true
}
)()
};
DwtIframe.prototype._resetEventHandlers=function(){
var e=this;
function t(a){
return e._rawEventHandler(a)
}
(function(){
var s,n=[],o=0,a;
s=e.getIframe();
a=Dwt.getIframeDoc(s);
n=DwtIframe._forwardEvents;
if(!AjxEnv.isIE){
a=s.contentWindow
}
for(o=n.length;
--o>=0;
){
a[n[o]]=t
}}
)()
};
DwtIframe.prototype.setSrc=function(t){
t=t||'javascript:"";';
var e=this.getIframe();
e.src=t
};
DwtIframe.prototype.setIframeContent=function(e){
var t=this.getDocument();
t.body.innerHTML=e
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtForm")){
DwtForm=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtForm.PARAMS);
e.className=e.className||"DwtForm";
DwtComposite.apply(this,arguments);
this.setScrollStyle(DwtControl.SCROLL);
this._tabGroup=new DwtTabGroup(this._htmlElId);
this._context={
set:AjxCallback.simpleClosure(this.set,this),get:AjxCallback.simpleClosure(this.get,this)};
this._dirty={};
this._ignore={};
this._invalid={};
this._errorMessages={};
this.setModel(e.model);
this.setForm(e.form);
this.reset()
};
DwtForm.prototype=new DwtComposite;
DwtForm.prototype.constructor=DwtForm;
DwtForm.prototype.toString=function(){
return"DwtForm"
};
DwtForm.PARAMS=DwtControl.PARAMS.concat("form","model");
DwtForm.prototype.setValue=function(s,a,t){
if(typeof s!="string"){
s=String(s)
}
if(s.match(/\./)||s.match(/\[/)){
var n=s.replace(/\[(\d+)\](\.)?/,".$1$2").split(".");
var o=this.getControl(n[0]);
if(Dwt.instanceOf(o,"DwtForm")){
o.setValue(n.slice(1).join("."),a,t)
}
return
}
var e=this._items[s];
if(!e){
return
}
if(!t&&a==e.value){
return
}
this._setModelValue(s,a);
this._setControlValue(s,a)
};
DwtForm.prototype.getValue=function(s,e){
if(typeof s!="string"){
s=String(s)
}
if(s.match(/\./)||s.match(/\[/)){
var n=s.replace(/\[(\d+)\](\.)?/,".$1$2").split(".");
var o=this.getControl(n[0]);
if(Dwt.instanceOf(o,"DwtForm")){
return o.getValue(n.slice(1).join("."))
}
return null
}
var t=this._items[s];
if(!t){
return
}
if(t.getter){
return this._call(t.getter)||e
}
var a=this._getControlValue(s);
if(a==null){
a=t.value
}
return a||e||""
};
DwtForm.prototype.getControl=function(t){
if(typeof t!="string"){
t=String(t)
}
var e=this._items[t];
return e&&e.control
};
DwtForm.prototype.isRelevant=function(e){
return this.isVisible(e)&&this.isEnabled(e)
};
DwtForm.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtForm.prototype.setLabel=function(o,e){
var t=this._items[o];
if(!t){
return
}
if(e==this.getLabel(o)){
return
}
var a=t.control;
if(!a){
return
}
if(a.setLabel){
a.setLabel(e);
return
}
if(a.setText){
a.setText(e);
return
}};
DwtForm.prototype.getLabel=function(a){
var e=this._items[a];
var t=e&&e.control;
if(t){
if(t.getLabel){
return t.getLabel()
}
if(t.getText){
return t.getText()
}}
return""
};
DwtForm.prototype.setVisible=function(n,o){
if(arguments.length==1){
DwtComposite.prototype.setVisible.call(this,arguments[0]);
return
}
var t=this._items[n];
var a=t&&t.control;
if(!a){
return
}
if(a.setVisible){
a.setVisible(o)
}else{
Dwt.setVisible(a,o)
}
var e=document.getElementById([this._htmlElId,n,"row"].join("_"));
if(e){
Dwt.setVisible(e,o)
}};
DwtForm.prototype.isVisible=function(a){
if(arguments.length==0){
return DwtComposite.prototype.isVisible.call(this)
}
var e=this._items[a];
var t=e&&e.control;
if(!t){
return false
}
if(t.getVisible){
return t.getVisible()
}
if(t.isVisible){
return t.isVisible()
}
return Dwt.getVisible(t)
};
DwtForm.prototype.setEnabled=function(o,e){
if(arguments.length==1){
DwtComposite.prototype.setEnabled.call(this,arguments[0]);
return
}
var t=this._items[o];
var a=t&&t.control;
if(!a){
return
}
if(a.setEnabled){
a.setEnabled(e)
}else{
a.disabled=!e
}};
DwtForm.prototype.isEnabled=function(a){
if(arguments.length==0){
return DwtComposite.prototype.isEnabled.call(this)
}
var e=this._items[a];
var t=e&&e.control;
if(!t){
return false
}
if(t.isEnabled){
return t.isEnabled()
}
if(t.getEnabled){
return t.getEnabled()
}
return !t.disabled
};
DwtForm.prototype.setValid=function(t,e){
if(typeof(t)=="boolean"){
e=arguments[0];
for(t in this._items){
this.setValid(t,e)
}
return
}
if(e){
delete this._invalid[t]
}else{
this._invalid[t]=true
}};
DwtForm.prototype.isValid=function(e){
if(arguments.length==0||AjxUtil.isUndefined(e)){
for(var e in this._invalid){
return false
}
return true
}
return !(e in this._invalid)
};
DwtForm.prototype.setErrorMessage=function(t,e){
if(!t||t==""){
this._errorMessages={};
return
}
if(!e){
delete this._errorMessages[t]
}else{
this._errorMessages[t]=e
}};
DwtForm.prototype.getErrorMessage=function(t){
if(arguments.length==0){
var e={};
for(var t in this._invalid){
e[t]=this._errorMessages[t]
}
return e
}
return this._errorMessages[t]
};
DwtForm.prototype.getInvalidItems=function(){
return AjxUtil.keys(this._invalid)
};
DwtForm.prototype.setDirty=function(o,t,e){
if(typeof o=="boolean"){
t=arguments[0];
for(o in this._items){
this.setDirty(o,t,true)
}
if(!e&&this._ondirty){
this._call(this._ondirty,["*"])
}
return
}
if(t){
this._dirty[o]=true
}else{
delete this._dirty[o]
}
if(!e&&this._ondirty){
var a=this._items[o];
if(!a.ignore||!this._call(a.ignore)){
this._call(this._ondirty,[o])
}}};
DwtForm.prototype.isDirty=function(t){
if(arguments.length==0){
for(var t in this._dirty){
var e=this._items[t];
if(e.ignore&&this._call(e.ignore)){
continue
}
return true
}
return false
}
var e=this._items[t];
return e.ignore&&this._call(e.ignore)?false:t in this._dirty
};
DwtForm.prototype.getDirtyItems=function(){
DwtForm.__acceptDirtyItem.form=this;
return AjxUtil.keys(this._dirty,DwtForm.__acceptDirtyItem)
};
DwtForm.__acceptDirtyItem=function(a){
var t=arguments.callee.form;
var e=t._items[a];
return !e.ignore||!t._call(e.ignore)
};
DwtForm.prototype.setIgnore=function(t,e){
if(typeof t=="boolean"){
this._ignore={};
return
}
if(e){
this._ignore[t]=true;
return
}
delete this._ignore[t]
};
DwtForm.prototype.isIgnore=function(e){
return e in this._ignore
};
DwtForm.prototype.set=function(t,e){
this.setValue(t,e,true);
this.update()
};
DwtForm.prototype.get=DwtForm.prototype.getValue;
DwtForm.prototype.setModel=function(e,t){
this._context.model=this.model=e
};
DwtForm.prototype.setForm=function(e){
this._context.form=this.form=e;
this._createHtml(e.template)
};
DwtForm.prototype.validate=function(e){
if(arguments.length==0){
this.setValid(true);
for(var e in this._items){
this._validateItem(e)
}
return this.isValid()
}
return this._validateItem(e)
};
DwtForm.prototype._validateItem=function(r){
if(!r){
return true
}
var o=this._items[r];
if(!o){
return true
}
try{
var n=this.getValue(r);
var a=o.validator?o.validator(n):((o.control&&o.control.validator)?o.control.validator(n):true);
this.setValid(r,Boolean(a)||a==="");
if(AjxUtil.isString(a)||AjxUtil.isObject(a)){
this._setControlValue(r,a);
o.value=o.setter?this._call(o.setter,[a]):a;
var t=!Boolean(this._call(o.equals,[o.value,o.ovalue]));
this.setDirty(r,t)
}}
catch(s){
this.setErrorMessage(r,AjxUtil.isString(s)?s:s.message);
this.setValid(r,false)
}
return !(r in this._invalid)
};
DwtForm.prototype.reset=function(o){
this._dirty={};
this._ignore={};
this._invalid={};
for(var a in this._items){
var t=this._items[a];
if(t.control instanceof DwtForm){
t.control.reset(o)
}
var e=this._items[a].def;
if(!e){
continue
}
this._initControl(e,o)
}
this.update();
for(var a in this._items){
var t=this._items[a];
t.ovalue=t.value
}
this.validate();
this.setDirty(false);
if(this._onreset){
this._call(this._onreset)
}};
DwtForm.prototype.update=function(){
for(var t in this._items){
var e=this._items[t];
if(e.control instanceof DwtForm){
e.control.update()
}
if(e.getter){
this.setValue(t,this._call(e.getter))
}}
for(var t in this._items){
var e=this._items[t];
if(e.visible){
this.setVisible(t,Boolean(this._call(e.visible)))
}
if(e.enabled){
this.setEnabled(t,Boolean(this._call(e.enabled)))
}
if(e.ignore){
this.setIgnore(t,Boolean(this._call(e.ignore)))
}}
if(this._onupdate){
this._call(this._onupdate)
}};
DwtForm.prototype._setModelValue=function(o,a){
var t=this._items[o];
t.value=t.setter?this._call(t.setter,[a]):a;
var e=!Boolean(this._call(t.equals,[t.value,t.ovalue]));
this.setDirty(o,e);
this.validate(o);
return e
};
DwtForm.prototype._setControlValue=function(a,e){
var t=this._items[a].control;
if(t){
if(t instanceof DwtCheckbox||t instanceof DwtRadioButton){
t.setSelected(e);
return
}
if(t instanceof DwtMenuItem&&t.isStyle(DwtMenuItem.CHECK_STYLE)){
t.setChecked(e,true);
return
}
if(t.setSelectedValue){
t.setSelectedValue(e);
return
}
if(t.setValue){
t.setValue(e);
return
}
if(t.setText&&!(t instanceof DwtButton)){
t.setText(e);
return
}
if(!(t instanceof DwtControl)){
if(t.type=="checkbox"||t=="radio"){
t.checked=e
}else{
t.value=e
}
return
}}};
DwtForm.prototype._getControlValue=function(t){
var e=this._items[t].control;
if(e){
if(e instanceof DwtCheckbox||e instanceof DwtRadioButton){
return e.isSelected()
}
if(e.getSelectedValue){
return e.getSelectedValue()
}
if(e.getValue){
return e.getValue()
}
if(e.getText&&!(e instanceof DwtButton)){
return e.getText()
}
if(!(e instanceof DwtControl)){
if(e.type=="checkbox"||e=="radio"){
return e.checked
}
return e.value
}}};
DwtForm.prototype._deleteItem=function(e){
delete this._items[e];
delete this._dirty[e];
delete this._invalid[e];
delete this._ignore[e]
};
DwtForm.prototype._call=function(t,e){
if(t){
if(e){
return t.apply(this,e)
}
return t.call(this)
}};
DwtForm.prototype._createHtml=function(e){
this._createHtmlFromTemplate(e||this.TEMPLATE,{
id:this._htmlElId}
)
};
DwtForm.prototype._createHtmlFromTemplate=function(t,s){
DwtComposite.prototype._createHtmlFromTemplate.apply(this,arguments);
var a=[];
this._items={};
this._tabGroup.removeAllMembers();
this._onupdate=null;
this._onreset=null;
this._ondirty=null;
var e=this.form;
if(e&&e.items){
this._registerControls(e.items,null,a);
this._onupdate=DwtForm.__makeFunc(e.onupdate);
this._onreset=DwtForm.__makeFunc(e.onreset);
this._ondirty=DwtForm.__makeFunc(e.ondirty)
}
var l=this.getHtmlElement().getElementsByTagName("A");
for(var r=0;
r<l.length;
r++){
var h=l[r];
if(!h.href||h.getAttribute("notab")=="true"){
continue
}
var c=h.id&&h.id.substr(this.getHTMLElId().length+1);
if(this._items[c]){
continue
}
a.push({
tabindex:h.getAttribute("tabindex")||Number.MAX_VALUE,control:h}
)
}
a.sort(DwtForm.__byTabIndex);
for(var r=0;
r<a.length;
r++){
var n=a[r].control;
var o=(n.getTabGroupMember&&n.getTabGroupMember())||n;
this._tabGroup.addMember(o)
}};
DwtForm.prototype._registerControls=function(a,n,e,s,o,r){
for(var t=0;
t<a.length;
t++){
this._registerControl(a[t],n,e,s,o,r)
}};
DwtForm.prototype._registerControl=function(l,s,w,y,c,n){
var f=l.id||[this._htmlElId,Dwt.getNextId()].join("_");
var g=this._items[f]={
id:f,def:l,parentDef:s,equals:DwtForm.__makeFunc(l.equals)||DwtForm.__equals,getter:DwtForm.__makeGetter(l),setter:DwtForm.__makeSetter(l),value:l.value,visible:DwtForm.__makeFunc(l.visible),enabled:DwtForm.__makeFunc(l.enabled),validator:DwtForm.__makeFunc(l.validator),ignore:DwtForm.__makeFunc(l.ignore),control:l.control};
if(l.aka){
this._items[f].aka=l.aka;
this._items[l.aka]=g
}
var d=g.control;
if(d){
return d
}
c=c||this;
var o=l.type=l.type||n;
var t=(s&&s.menu==l);
var a=document.getElementById([c._htmlElId,f].join("_"));
if(Dwt.instanceOf(o,"DwtRadioButtonGroup")){
d=new window[o]({}
);
g.control=d;
var r={
name:[c._htmlElId,f].join("_"),value:l.value};
if(l.items){
for(var p=0;
p<l.items.length;
p++){
var m=l.items[p];
var h=m.checked||m.value==l.value;
var u=this._registerControl(m,l,w,r,c,"DwtRadioButton");
this._items[m.id].value=h;
if(u){
d.addRadio(u.getInputElement().id,u,h);
var e=DwtForm.__makeFunc(m.onclick||l.onclick);
u.addSelectionListener(new AjxListener(this,this._radio2group2model,[m.id,f,e]));
DwtForm.__hack_fixRadioButtonHandler(u)
}}}}else{
if(o){
if(Dwt.instanceOf(o,"DwtInputField")){
g.value=g.value||""
}
if(Dwt.instanceOf(o,"DwtFormRows")){
g.equals=DwtFormRows.__equals
}
if(a||t){
d=g.control=this._createControl(l,s,w,y,c,n)
}}else{
if(a){
this._attachElementHandlers(l,s,w,c,a);
d=g.control=a;
if(l.items){
this._registerControls(l.items,l,w,null,c,null)
}}}}
if(a&&d instanceof DwtControl){
d.replaceElement(a)
}
if(a&&d instanceof DwtInputField){
d.getInputElement().id+="_input"
}
if(l.notab==null){
l.notab=a&&a.getAttribute("notab")=="true"
}
if(w&&d&&!l.notab&&!(d instanceof DwtRadioButtonGroup)){
w.push({
tabindex:(a&&a.getAttribute("tabindex"))||Number.MAX_VALUE,control:d}
)
}
if(d instanceof DwtListView){
g.getter=g.getter||AjxCallback.simpleClosure(this.__list_getValue,this,f);
g.setter=g.setter||AjxCallback.simpleClosure(this.__list_setValue,this,f)
}
return d
};
DwtForm.prototype._attachElementHandlers=function(r,a,o,c,s){
var t=r.id;
var e=s.nodeName.toLowerCase();
var l=s.type;
if(l=="checkbox"||l=="radio"){
var h;
if(l=="radio"){
h=s.name;
if(!this._items[h]){
this._items[h]={
id:h}
}
if(s.checked){
this._items[h].value=s.value
}}
var u=s.onclick;
var d=DwtForm.__makeFunc(r.onclick);
s.onclick=AjxCallback.simpleClosure(this._htmlInput_checked,this,t,h,d,u)
}else{
if(e=="select"){
var n=s.onchange;
var d=DwtForm.__makeFunc(r.onchange);
s.onchange=AjxCallback.simpleClosure(this._htmlSelect_selectedIndex,this,t,d,n)
}else{
if(e=="button"||e=="a"||l=="button"||l=="reset"||l=="submit"){
var u=s.onclick;
var d=DwtForm.__makeFunc(r.onclick);
s.onclick=AjxCallback.simpleClosure(this._htmlElement,this,t,d,u)
}else{
if(e=="textarea"||e=="input"){
var n=s.onchange;
var d=DwtForm.__makeFunc(r.onchange);
s.onchange=AjxCallback.simpleClosure(this._htmlInput_value,this,t,d,n)
}}}}
return s
};
DwtForm.prototype._createControl=function(m,c,M,F,g,l){
var j=m.id||[this._htmlElId,Dwt.getNextId()].join("_");
var n=m.type=m.type||l;
F=F?AjxUtil.createProxy(F):{};
F.id=F.id||[this._htmlElId,j].join("_");
F.parent=g||this;
F.template=m.template||F.template;
F.className=m.className||F.className;
var S=Dwt.instanceOf(n,"DwtRadioButton");
var q=Dwt.instanceOf(n,"DwtCheckbox");
if(S||q){
F.name=m.name||F.name;
F.value=m.value||F.value;
F.checked=m.checked!=null?m.checked:F.checked
}
var f=Dwt.instanceOf(n,"DwtInputField");
if(f){
F.type=m.password?DwtInputField.PASSWORD:null;
F.size=m.cols;
F.rows=m.rows
}
var r=Dwt.instanceOf(n,"DwtTabViewPage");
if(r){
F.contentTemplate=m.template;
delete m.template
}
var x=Dwt.instanceOf(n,"DwtTree");
if(x){
F.style=m.style
}
F.formItemDef=m;
if(m.params){
for(var z in m.params){
F[z]=m.params[z]
}}
var y=new window[n](F);
if(y instanceof DwtSelect){
var o=m.items;
if(o){
for(var B=0;
B<o.length;
B++){
var k=o[B];
k.displayValue=k.label||k.value;
y.addOption(k)
}}
var t=DwtForm.__makeFunc(m.onchange);
y.addChangeListener(new AjxListener(this,this._control2model,[j,t]))
}else{
if(y instanceof DwtButton||y instanceof DwtMenuItem){
if(m.label){
y.setText(m.label)
}
if(m.image){
y.setImage(m.image)
}
if(m.menu){
var a=Dwt.instanceOf(m.menu.type||"DwtMenu","DwtMenu");
var e;
if(a){
e=this._registerControl(m.menu,m,null,null,y,"DwtMenu")
}else{
e=new DwtMenu({
parent:y}
);
var C=Dwt.instanceOf(m.menu.type,"DwtCalendar")?DwtMenu.CALENDAR_PICKER_STYLE:DwtMenu.GENERIC_WIDGET_STYLE;
this._registerControl(m.menu,m,null,{
style:C}
,e)
}
y.setMenu(e)
}
var W;
if(g instanceof DwtToolBar||g instanceof DwtMenu){
W=c.id
}
var t=DwtForm.__makeFunc(m.onclick||(c&&c.onclick));
y.addSelectionListener(new AjxListener(this,this._item2parent,[j,W,t]))
}else{
if(y instanceof DwtCheckbox&&!(y instanceof DwtRadioButton)){
var t=DwtForm.__makeFunc(m.onclick);
y.addSelectionListener(new AjxListener(this,this._control2model,[j,t]))
}else{
if(y instanceof DwtInputField){
var T=DwtForm.__makeFunc(m.onchange);
var A=AjxCallback.simpleClosure(this._input2model2handler,this,j,T);
y.setHandler(DwtEvent.ONKEYUP,A);
if(AjxEnv.isFirefox){
var u=this._onkeydownhandler.bind(this,j,T);
y.setHandler(DwtEvent.ONKEYDOWN,u)
}
var D=DwtForm.__makeFunc(m.onblur);
if(D){
var s=AjxCallback.simpleClosure(this._input2model2handler,this,j,D);
y.setHandler(DwtEvent.ONBLUR,s)
}
y.setHint(m.hint)
}else{
if(y instanceof DwtListView){
y.addSelectionListener(new AjxListener(this,this._handleListSelection,[j]))
}else{
if(y instanceof DwtMenu){
if(m.items){
var O=m.items;
for(var B=0;
B<O.length;
B++){
var v=O[B];
if(v.type==DwtMenuItem.SEPARATOR_STYLE){
new DwtMenuItem({
parent:y,style:DwtMenuItem.SEPARATOR_STYLE}
);
continue
}
this._registerControl(v,m,null,null,y,"DwtMenuItem")
}}}else{
if(y instanceof DwtTabView){
var d=m.items;
if(d){
this._registerControls(d,m,null,null,y,"DwtTabViewPage")
}}else{
if(y instanceof DwtTabViewPage&&g instanceof DwtTabView){
var R=g.addTab(m.label,y);
if(m.image){
g.getTabButton(R).setImage(m.image)
}
if(m.items){
this._registerControls(m.items,m,M,null,y)
}}else{
if(y instanceof DwtToolBar){
var w=m.items;
if(w){
for(var B=0;
B<w.length;
B++){
var h=w[B];
if(h.type==DwtToolBar.SPACER){
y.addSpacer(h.size);
continue
}
if(h.type==DwtToolBar.SEPARATOR){
y.addSeparator(h.className);
continue
}
if(h.type==DwtToolBar.FILLER){
y.addFiller(h.className);
continue
}
this._registerControl(h,m,null,null,y,"DwtToolBarButton")
}}}else{
if(y instanceof DwtCalendar){
if(m.onselect instanceof AjxListener){
y.addSelectionListener(m.onselect)
}}else{
if(y instanceof DwtComposite){
if(m.items){
this._registerControls(m.items,m,M,null,y)
}}}}}}}}}}}}
if(m.width||m.height){
if(y instanceof DwtInputField){
Dwt.setSize(y.getInputElement(),m.width,m.height)
}else{
y.setSize(m.width,m.height)
}}
return y
};
DwtForm.prototype._onkeydownhandler=function(t,e){
setTimeout(this._input2model2handler.bind(this,t,e),500)
};
DwtForm.prototype._initControl=function(e,o){
var a=e.id;
if(e.label){
this.setLabel(a,e.label)
}
var t=this._items[a];
if(o){
t.ovalue=t.value
}else{
if(e.value){
if(Dwt.instanceOf(e.type,"DwtRadioButton")){
t.ovalue=t.value=t.control&&t.control.isSelected()
}else{
this.setValue(a,e.value,true);
t.ovalue=t.value
}}else{
t.ovalue=null
}}
if(typeof e.enabled=="boolean"){
this.setEnabled(a,e.enabled)
}
if(typeof e.visible=="boolean"){
this.setVisible(a,e.visible)
}};
DwtForm.prototype._htmlElement=function(o,a,t,e){
if(a){
this._call(a,[o])
}
if(t){
t(e)
}};
DwtForm.prototype._htmlInput_checked=function(r,s,a,t,e){
var n=this.getControl(r);
var o=n.checked;
this._setModelValue(r,o);
if(s&&o){
this._setModelValue(s,n.value)
}
this.update();
this._htmlElement(r,a,t,e)
};
DwtForm.prototype._htmlInput_value=function(o,a,t,e){
this._setModelValue(o,this.getControl(o).value);
this.update();
this._htmlElement(o,a,t,e)
};
DwtForm.prototype._htmlSelect_selectedIndex=function(n,o,a,t){
var e=this.getControl(n);
this._setModelValue(n,e.options[e.selectedIndex].value);
this.update();
this._htmlElement(n,o,a,t)
};
DwtForm.prototype._control2model=function(t,e){
this._setModelValue(t,this._getControlValue(t));
this.update();
if(e){
this._call(e,[t])
}};
DwtForm.prototype._radio2group2model=function(e,t,a){
this._setModelValue(t,this.getControl(e).getValue());
this._setModelValue(e,this._getControlValue(e));
this.update();
if(a){
this._call(a,[e])
}};
DwtForm.prototype._input2model2handler=function(t,e){
this._setModelValue(t,this._getControlValue(t));
this.update();
if(e){
this._call(e,[t])
}};
DwtForm.prototype._item2parent=function(o,n,t){
var a=this.getControl(o);
var e=this._items[o].def;
if(a instanceof DwtButtonColorPicker||(e.menu&&!e.onclick)){
a._toggleMenu()
}else{
if(n){
this._setModelValue(n,this._getControlValue(o)||o);
this.update()
}}
if(t){
this._call(t,[o])
}};
DwtForm.prototype._handleListSelection=function(t,e){
this.update()
};
DwtForm.prototype.__list_getValue=function(e){
return this.getControl(e).getSelection()
};
DwtForm.prototype.__list_setValue=function(t,e){
this.getControl(t).setSelection(e)
};
DwtForm.__makeGetter=function(s){
var t=s.getter;
if(t){
return DwtForm.__makeFunc(t)
}
var n=s.ref;
if(!n){
return null
}
var r=n.split(".");
var e=["var context = this.model;",];
for(var o=0;
o<r.length;
o++){
var a=r[o];
var h=DwtForm.__makeFuncName(a);
if(o==r.length-1){
break
}
e.push("context = context && (context.",h," ? context.",h,"() : context.",a,");")
}
e.push("var value = context ? (context.",h," ? context.",h,"() : context.",a,") : this._items.",a,".value;","return value !== undefined ? value : defaultValue;");
return new Function("defaultValue",e.join(""))
};
DwtForm.__makeSetter=function(l){
var o=l.setter;
if(o){
return DwtForm.__makeFunc(o)
}
var a=l.ref;
if(!a){
return null
}
var n=a.split(".");
var h=["var context = this.model;",];
for(var r=0;
r<n.length;
r++){
var s=r==n.length-1;
var e=n[r];
var t=DwtForm.__makeFuncName(e,s?"set":"get");
if(s){
break
}
h.push("context = context && (context.",t," ? context.",t,"() : context.",e,");")
}
h.push("if (context) {","if (context.",t,") {","context.",t,"(value);","}","else {","context.",e," = value;","}","}");
return new Function("value",h.join("\n"))
};
DwtForm.__makeFuncName=function(e,t){
return[t||"get",e.substr(0,1).toUpperCase(),e.substr(1)].join("")
};
DwtForm.__makeFunc=function(t){
if(t==null){
return null
}
if(typeof t=="function"&&!(t instanceof RegExp)){
return t
}
var e=["with (this._context) {","return (",t,");","}"].join("");
return new Function(e)
};
DwtForm.__equals=function(t,e){
return t==e
};
DwtForm.__byTabIndex=function(t,e){
return t.tabindex-e.tabindex
};
DwtForm.__hack_fixRadioButtonHandler=function(t){
var e=[t.getInputElement().onclick,DwtCheckbox.__handleClick];
var a=function(o){
for(var n=0;
n<e.length;
n++){
var s=e[n];
if(s){
s(o)
}}};
Dwt.setHandler(t.getInputElement(),DwtEvent.ONCLICK,a)
};
DwtFormRows=function(a){
if(arguments.length==0){
return
}
this._itemDef=a.formItemDef||{};
a.className=a.className||"DwtFormRows";
DwtForm.call(this,{
id:a.id,parent:a.parent,form:{}
,template:this._itemDef.template}
);
this._rowsTabGroup=new DwtTabGroup(this._htmlElId);
this._rowDef=this._itemDef.rowitem||{};
this._equals=DwtForm.__makeFunc(this._rowDef.equals)||DwtForm.__equals;
this._rowCount=0;
this._minRows=this._itemDef.minrows||1;
this._maxRows=this._itemDef.maxrows||Number.MAX_VALUE;
if(this._itemDef.rowtemplate){
this.ROW_TEMPLATE=this._itemDef.rowtemplate
}
var t=this._itemDef.items||[];
for(var e=0;
e<t.length;
e++){
this.addRow(t[e])
}
for(;
e<this._minRows;
e++){
this.addRow()
}
this._onaddrow=DwtForm.__makeFunc(this._itemDef.onaddrow);
this._onremoverow=DwtForm.__makeFunc(this._itemDef.onremoverow)
};
DwtFormRows.prototype=new DwtForm;
DwtFormRows.prototype.constructor=DwtFormRows;
DwtFormRows.prototype.toString=function(){
return"DwtFormRows"
};
DwtFormRows.prototype.TEMPLATE="dwt.Widgets#DwtFormRows";
DwtFormRows.prototype.ROW_TEMPLATE="dwt.Widgets#DwtFormRow";
DwtFormRows.prototype.getTabGroupMember=function(){
return this._rowsTabGroup
};
DwtFormRows.prototype.setValue=function(o){
if(arguments.length>1){
DwtForm.prototype.setValue.apply(this,arguments);
return
}
var a=Math.max(o.length,this._minRows);
for(var t=this._rowCount;
t>a;
t--){
this.removeRow(t-1)
}
var e=Math.min(o.length,this._maxRows);
for(var t=this._rowCount;
t<e;
t++){
this.addRow()
}
for(var t=0;
t<e;
t++){
this.setValue(String(t),o[t],true)
}
for(var t=o.length;
t<this._rowCount;
t++){
this.setValue(String(t),null,true)
}};
DwtFormRows.prototype.getValue=function(){
if(arguments.length>0){
return DwtForm.prototype.getValue.apply(this,arguments)
}
var t=new Array(this._rowCount);
for(var e=0;
e<this._rowCount;
e++){
t[e]=this.getValue(String(e))
}
return t
};
DwtFormRows.prototype.getRowCount=function(){
return this._rowCount
};
DwtFormRows.prototype.addRow=function(n,o){
if(this._rowCount>=this._maxRows){
return
}
n=n||(this._rowDef&&AjxUtil.createProxy(this._rowDef));
if(!n){
return
}
if(o==null){
o=this._rowCount
}
for(var d=this._rowCount-1;
d>=o;
d--){
var w=d,u=d+1;
var m=this._items[w];
m.aka=String(u);
delete this._items[w];
this._items[m.aka]=m;
this._setControlIds(m.id,m.aka)
}
n.id=n.id||Dwt.getNextId();
n.aka=String(o);
this._rowCount++;
var v={
id:[this.getHTMLElId(),n.id].join("_")};
var p=AjxTemplate.expand(this.ROW_TEMPLATE,v);
var e=this._rowsEl;
e.appendChild(Dwt.toDocumentFragment(p,v.id+"_row"));
var g=e.lastChild;
if(o!=this._rowCount-1){
e.insertBefore(g,e.childNodes[o])
}
var y=[];
var s=this._registerControl(n,null,y);
var t=this._itemDef.additem?AjxUtil.createProxy(this._itemDef.additem):{
image:"Add"};
t.id=t.id||n.id+"_add";
t.visible="this.getRowCount() < this.getMaxRows()";
t.ignore=true;
var c=this._registerControl(t,null,y,null,null,"DwtButton");
if(!t.onclick){
c.addSelectionListener(new AjxListener(this,this._handleAddRow,[n.id]))
}
var h=this._itemDef.removeitem?AjxUtil.createProxy(this._itemDef.removeitem):{
image:"Remove"};
h.id=h.id||n.id+"_remove";
h.visible="this.getRowCount() > this.getMinRows()";
h.ignore=true;
var f=this._registerControl(h,null,y,null,null,"DwtButton");
if(!h.onclick){
f.addSelectionListener(new AjxListener(this,this._handleRemoveRow,[n.id]))
}
var m=this._items[n.id];
m._rowEl=g;
m._addId=t.id;
m._removeId=h.id;
this._setControlIds(m.id,o);
var a=new DwtTabGroup(n.id);
y.sort(DwtForm.__byTabIndex);
for(var d=0;
d<y.length;
d++){
var s=y[d].control;
a.addMember(s.getTabGroupMember()||s)
}
if(o==this._rowCount-1){
this._rowsTabGroup.addMember(a)
}else{
var r=this._items[String(o+1)];
var l=this._rowsTabGroup.getTabGroupMemberByName(r.id);
this._rowsTabGroup.addMemberBefore(a,l)
}
this.update();
if(this._onaddrow){
this._call(this._onaddrow,[o])
}
return s
};
DwtFormRows.prototype.removeRow=function(r){
if(this._rowCount<=this._minRows){
return
}
var c=this._items[r];
if(c.control instanceof DwtControl){
this.removeChild(c.control)
}
delete this._items[c.aka];
this._deleteItem(c.id);
var h=this._items[c._addId];
if(h){
this.removeChild(h.control);
this._deleteItem(h.id)
}
var l=this._items[c._removeId];
if(l){
this.removeChild(l.control);
this._deleteItem(l.id)
}
var s=Number(c.aka);
for(var a=s+1;
a<this._rowCount;
a++){
var n=a,t=a-1;
this._items[t]=this._items[n];
this._items[t].aka=String(t);
this._setControlIds(this._items[t].id,this._items[t].aka)
}
this._deleteItem(String(--this._rowCount));
var e=c._rowEl;
e.parentNode.removeChild(e);
delete c._rowEl;
var o=this._rowsTabGroup.getTabGroupMemberByName(c.id);
this._rowsTabGroup.removeMember(o);
this.update();
if(this._onremoverow){
this._call(this._onremoverow,[Number(c.aka)])
}};
DwtFormRows.prototype.getMinRows=function(){
return this._minRows
};
DwtFormRows.prototype.getMaxRows=function(){
return this._maxRows
};
DwtFormRows.prototype.getRowCount=function(){
return this._rowCount
};
DwtFormRows.prototype.getIndexForRowId=function(a){
var t=this._rowsEl.childNodes;
for(var e=0;
e<t.length;
e++){
if(t[e].id==[this._htmlElId,a,"row"].join("_")){
return e
}}
return -1
};
DwtFormRows.__equals=function(t,e){
if(t===e){
return true
}
if(!t||!e||t.length!=e.length){
return false
}
for(var o=0;
o<t.length;
o++){
if(!this._call(this._equals,[t[o],e[o]])){
return false
}}
return true
};
DwtFormRows.prototype._setControlIds=function(n,e){
var s=[this.getHTMLElId(),e].join("_");
var o=this._items[n];
this._setControlId(o&&o.control,s);
var t=this._items[o._addId];
this._setControlId(t&&t.control,s+"_add");
var a=this._items[o._removeId];
this._setControlId(a&&a.control,s+"_remove")
};
DwtFormRows.prototype._setControlId=function(e,t){
if(!e){
return
}
if(e instanceof DwtControl){
e.setHtmlElementId(t)
}else{
e.id=t
}};
DwtFormRows.prototype._handleAddRow=function(t){
if(this.getRowCount()<this.getMaxRows()){
var e=this.getIndexForRowId(t)+1;
this.addRow(null,e)
}};
DwtFormRows.prototype._handleRemoveRow=function(e){
this.removeRow(e)
};
DwtFormRows.prototype._setModelValue=function(t,e){
if(DwtForm.prototype._setModelValue.apply(this,arguments)){
this.parent.setDirty(this._itemDef.id,true)
}};
DwtFormRows.prototype._createHtmlFromTemplate=function(e,t){
DwtForm.prototype._createHtmlFromTemplate.apply(this,arguments);
this._rowsEl=document.getElementById(this._htmlElId+"_rows")
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMessageDialog")){
DwtMessageDialog=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtMessageDialog.PARAMS);
this._msgCellId=Dwt.getNextId("MessageDialog_");
e.standardButtons=e.buttons||[DwtDialog.OK_BUTTON];
DwtDialog.call(this,e);
this.setContent(this._contentHtml());
this._msgCell=document.getElementById(this._msgCellId);
this.addEnterListener(new AjxListener(this,this._enterListener))
};
DwtMessageDialog.PARAMS=["parent","className","buttons","extraButtons","id"];
DwtMessageDialog.prototype=new DwtDialog;
DwtMessageDialog.prototype.constructor=DwtMessageDialog;
DwtMessageDialog.CRITICAL_STYLE=1;
DwtMessageDialog.INFO_STYLE=2;
DwtMessageDialog.WARNING_STYLE=3;
DwtMessageDialog.TITLE={};
DwtMessageDialog.TITLE[DwtMessageDialog.CRITICAL_STYLE]=AjxMsg.criticalMsg;
DwtMessageDialog.TITLE[DwtMessageDialog.INFO_STYLE]=AjxMsg.infoMsg;
DwtMessageDialog.TITLE[DwtMessageDialog.WARNING_STYLE]=AjxMsg.warningMsg;
DwtMessageDialog.ICON={};
DwtMessageDialog.ICON[DwtMessageDialog.CRITICAL_STYLE]="Critical_32";
DwtMessageDialog.ICON[DwtMessageDialog.INFO_STYLE]="Information_32";
DwtMessageDialog.ICON[DwtMessageDialog.WARNING_STYLE]="Warning_32";
DwtMessageDialog.prototype.toString=function(){
return"DwtMessageDialog"
};
DwtMessageDialog.prototype.setMessage=function(a,o,n){
o=o||DwtMessageDialog.INFO_STYLE;
n=n||DwtMessageDialog.TITLE[o];
this.setTitle(n);
if(a){
var t=[];
var e=0;
t[e++]="<table cellspacing=0 cellpadding=0 border=0 width=100% height=100%><tr><td valign='top'>";
t[e++]=AjxImg.getImageHtml(DwtMessageDialog.ICON[o],null,"id='"+this._msgCellId+"_Image'");
t[e++]="</td><td class='DwtMsgArea' id='"+this._msgCellId+"_Msg'>";
t[e++]=a;
t[e++]="</td></tr></table>";
this._msgCell.innerHTML=t.join("")
}else{
this._msgCell.innerHTML=""
}};
DwtMessageDialog.prototype.setSize=function(t,e){
var a=document.getElementById(this._msgCellId);
if(a&&(t||e)){
Dwt.setSize(a,t,e)
}};
DwtMessageDialog.prototype.reset=function(){
this._msgCell.innerHTML="";
DwtDialog.prototype.reset.call(this)
};
DwtMessageDialog.prototype.handleKeyAction=function(e,t){
return DwtDialog.prototype.handleKeyAction.call(this,e,t)
};
DwtMessageDialog.prototype._contentHtml=function(){
return"<div id='"+this._msgCellId+"' class='DwtMsgDialog'></div>"
};
DwtMessageDialog.prototype._enterListener=function(e){
this._runEnterCallback()
}
}
if(AjxPackage.define("zimbra.csfe.ZmBatchCommand")){
ZmBatchCommand=function(e,t,a){
this._onError=(e===false)?ZmBatchCommand.STOP:ZmBatchCommand.CONTINUE;
this._accountName=t;
this._useJson=a;
this.curId=0;
this._cmds=[];
this._requests=[];
this._respCallbacks=[];
this._errorCallbacks=[]
};
ZmBatchCommand.prototype.toString=function(){
return"ZmBatchCommand"
};
ZmBatchCommand.prototype._sensitive=false;
ZmBatchCommand.prototype._noAuthToken=false;
ZmBatchCommand.STOP="stop";
ZmBatchCommand.CONTINUE="continue";
ZmBatchCommand.prototype.setSensitive=function(e){
this._sensitive=this._sensitive||e
};
ZmBatchCommand.prototype.setNoAuthToken=function(e){
this._noAuthToken=e
};
ZmBatchCommand.prototype.isSensitive=function(){
return this._sensitive
};
ZmBatchCommand.prototype.add=function(e){
this._cmds.push(e)
};
ZmBatchCommand.prototype.size=function(){
return this.curId||this._cmds.length
};
ZmBatchCommand.prototype.run=function(u,r){
for(var s=0;
s<this._cmds.length;
s++){
var a=this._cmds[s];
a.run(this);
this.curId++
}
var o={
sensitive:this._sensitive,noAuthToken:this._noAuthToken,asyncMode:true,callback:new AjxCallback(this,this._handleResponseRun,[u,r]),errorCallback:r,accountName:this._accountName};
if(this._useJson){
var m={
BatchRequest:{
_jsns:"urn:zimbra",onerror:this._onError}};
var e=m.BatchRequest;
var f=this.size();
if(f&&this._requests.length){
for(var s=0;
s<f;
s++){
var n=this._requests[s];
n.requestId=s;
var d=ZmCsfeCommand.getMethodName(n);
if(!e[d]){
e[d]=[]
}
n[d].requestId=s;
e[d].push(n[d])
}
o.jsonObj=m
}}else{
var l=AjxSoapDoc.create("BatchRequest","urn:zimbra");
l.setMethodAttribute("onerror",this._onError);
var f=this.size();
if(f>0){
for(var s=0;
s<f;
s++){
var c=this._requests[s];
var h=c.getMethod();
h.setAttribute("requestId",s);
var t=l.adoptNode(h);
l.getMethod().appendChild(t)
}
o.soapDoc=l
}}
if(o.jsonObj||o.soapDoc){
appCtxt.getAppController().sendRequest(o)
}else{
if(u){
u.run()
}}};
ZmBatchCommand.prototype._handleResponseRun=function(l,n,d){
var h=d.getResponse();
if(!h.BatchResponse){
return
}
var s=[];
for(var e in h.BatchResponse){
if(e.match(/^_/)){
continue
}
var c=h.BatchResponse[e];
for(var o=0;
o<c.length;
o++){
s[c[o].requestId]={
method:e,resp:c[o]}
}}
var t=[];
for(var o=0;
o<s.length;
o++){
var a=s[o];
try{
this._processResponse(a.method,a.resp)
}
catch(r){
t.push(r);
if(this._onError==ZmBatchCommand.STOP){
break
}}}
if(t.length>0&&n){
n.run.apply(n,t)
}else{
if(l){
l.run(d)
}}};
ZmBatchCommand.prototype.addRequestParams=function(t,a,e){
this._requests[this.curId]=t;
this._respCallbacks[this.curId]=a;
this._errorCallbacks[this.curId]=e
};
ZmBatchCommand.prototype.addNewRequestParams=function(t,a,e){
this.addRequestParams(t,a,e);
this.curId++
};
ZmBatchCommand.prototype._processResponse=function(r,n){
var s=n.requestId;
if(r=="Fault"){
var t=ZmCsfeCommand.faultToEx(n,"ZmBatchCommand.prototype.run");
if(this._errorCallbacks[s]){
var o=this._errorCallbacks[s].run(t);
if(!o){
appCtxt.getAppController()._handleException(t)
}}
throw t
}
if(this._respCallbacks[s]){
var a={};
a[r]=n;
var e=new ZmCsfeResult(a);
this._respCallbacks[s].run(e,n)
}}
}
if(AjxPackage.define("zimbra.csfe.ZmCsfeCommand")){
ZmCsfeCommand=function(){};
ZmCsfeCommand.prototype.isZmCsfeCommand=true;
ZmCsfeCommand.prototype.toString=function(){
return"ZmCsfeCommand"
};
ZmCsfeCommand._COOKIE_NAME="ZM_AUTH_TOKEN";
ZmCsfeCommand.serverUri=null;
ZmCsfeCommand._sessionId=null;
ZmCsfeCommand._staleSession={};
ZmCsfeCommand.REAUTH="reauth";
ZmCsfeCommand.RETRY="retry";
ZmCsfeCommand.getAuthToken=function(){
return AjxCookie.getCookie(document,ZmCsfeCommand._COOKIE_NAME)
};
ZmCsfeCommand.setCookieName=function(e){
ZmCsfeCommand._COOKIE_NAME=e
};
ZmCsfeCommand.setServerUri=function(e){
ZmCsfeCommand.serverUri=e
};
ZmCsfeCommand.setAuthToken=function(t,s,n,a){
ZmCsfeCommand._curAuthToken=t;
if(s!=null){
var o=null;
if(s>0){
o=new Date();
var e=parseInt(s);
o.setTime(o.getTime()+e)
}
AjxCookie.setCookie(document,ZmCsfeCommand._COOKIE_NAME,t,o,"/",null,a)
}else{
AjxCookie.deleteCookie(document,ZmCsfeCommand._COOKIE_NAME,"/")
}
if(n){
ZmCsfeCommand.setSessionId(n)
}};
ZmCsfeCommand.clearAuthToken=function(){
AjxCookie.deleteCookie(document,ZmCsfeCommand._COOKIE_NAME,"/")
};
ZmCsfeCommand.getSessionId=function(){
return ZmCsfeCommand._sessionId
};
ZmCsfeCommand.setSessionId=function(t){
var e=ZmCsfeCommand.extractSessionId(t);
if(e){
if(e&&!ZmCsfeCommand._staleSession[e]){
if(e!=ZmCsfeCommand._sessionId){
if(ZmCsfeCommand._sessionId){
ZmCsfeCommand._staleSession[ZmCsfeCommand._sessionId]=true
}
ZmCsfeCommand._sessionId=e
}}}};
ZmCsfeCommand.clearSessionId=function(){
ZmCsfeCommand._sessionId=null
};
ZmCsfeCommand.extractSessionId=function(e){
var t;
if(e instanceof Array){
e=e[0].id
}else{
if(e&&e.id){
e=e.id
}}
t=parseInt(e,10);
if(isNaN(t)){
t=null
}
return t
};
ZmCsfeCommand.faultToEx=function(t,a){
var o={
msg:AjxStringUtil.getAsString(t.Reason.Text),code:AjxStringUtil.getAsString(t.Detail.Error.Code),method:(a?a.methodNameStr:null),detail:AjxStringUtil.getAsString(t.Code.Value),data:t.Detail.Error.a,trace:(t.Detail.Error.Trace||"")};
var e;
if(a){
if(a.soapDoc){
o.request=a.soapDoc.getXml()
}else{
if(a.jsonRequestObj){
if(a.jsonRequestObj&&a.jsonRequestObj.Header&&a.jsonRequestObj.Header.context){
a.jsonRequestObj.Header.context.authToken="(removed)"
}
o.request=AjxStringUtil.prettyPrint(a.jsonRequestObj,true)
}}}
return new ZmCsfeException(o)
};
ZmCsfeCommand.getMethodName=function(t){
var e=(t&&t._methodEl&&t._methodEl.tagName)?t._methodEl.tagName:null;
if(!e){
for(var a in t){
if(/Request|Response$/.test(a)){
e=a;
break
}}}
return(e||"[unknown]")
};
ZmCsfeCommand.prototype.invoke=function(r){
this.cancelled=false;
if(!(r&&(r.soapDoc||r.jsonObj))){
return
}
var e=ZmCsfeCommand.getRequestStr(r);
var s;
try{
var n=(r.serverUri||ZmCsfeCommand.serverUri)+r.methodNameStr;
this._st=new Date();
var o={
"Content-Type":"application/soap+xml; charset=utf-8"};
if(AjxEnv.isIE6&&(location.protocol=="https:")){
o.Connection="Close"
}
if(r.asyncMode){
s=new AjxCallback(this,this._runCallback,[r]);
this._rpcId=AjxRpc.invoke(e,n,o,s)
}else{
var t=AjxRpc.invoke(e,n,o);
return(!r.returnXml)?(this._getResponseData(t,r)):t
}}
catch(a){
this._handleException(a,r,s)
}};
ZmCsfeCommand.prototype.invokeRest=function(o){
if(!(o&&o.restUri)){
return
}
var a;
try{
this._st=new Date();
if(o.asyncMode){
a=new AjxCallback(this,this._runCallback,[o]);
this._rpcId=AjxRpc.invoke(null,o.restUri,null,a,true)
}else{
var e=AjxRpc.invoke(null,o.restUri,null,null,true);
return e.text
}}
catch(t){
this._handleException(t,o,a)
}};
ZmCsfeCommand.prototype.cancel=function(){
if(!this._rpcId){
return
}
this.cancelled=true;
var e=AjxRpc.getRpcRequestById(this._rpcId);
if(e){
e.cancel();
if(AjxEnv.isFirefox3_5up){
AjxRpc.removeRpcCtxt(e)
}}};
ZmCsfeCommand.getRequestStr=function(e){
return e.soapDoc?ZmCsfeCommand._getSoapRequestStr(e):ZmCsfeCommand._getJsonRequestStr(e)
};
ZmCsfeCommand._getJsonRequestStr=function(r){
var n={
Header:{}
,Body:r.jsonObj};
var a=n.Header.context={
_jsns:"urn:zimbra"};
var o=["ZimbraWebClient - ",AjxEnv.browser," (",AjxEnv.platform,")"].join("");
a.userAgent={
name:o};
if(ZmCsfeCommand.clientVersion){
a.userAgent.version=ZmCsfeCommand.clientVersion
}
if(r.noSession){
a.nosession={}
}else{
var s=ZmCsfeCommand.getSessionId();
if(s){
a.session={
_content:s,id:s}
}else{
a.session={}
}}
if(r.targetServer){
a.targetServer={
_content:r.targetServer}
}
if(r.highestNotifySeen){
a.notify={
seq:r.highestNotifySeen}
}
if(r.changeToken){
a.change={
token:r.changeToken,type:"new"}
}
if(!r.skipAuthCheck){
if(r.accountId){
a.account={
_content:r.accountId,by:"id"}
}else{
if(r.accountName){
a.account={
_content:r.accountName,by:"name"}
}}}
if(r.useXml){
a.format={
type:"xml"}
}
r.methodNameStr=ZmCsfeCommand.getMethodName(r.jsonObj);
if(!r.noAuthToken){
var t=r.authToken||ZmCsfeCommand.getAuthToken();
if(!t){
throw new ZmCsfeException("AuthToken required",ZmCsfeException.NO_AUTH_TOKEN,r.methodNameStr)
}
if(ZmCsfeCommand._curAuthToken&&!r.skipAuthCheck&&(r.resend!=ZmCsfeCommand.REAUTH)&&(t!=ZmCsfeCommand._curAuthToken)){
throw new ZmCsfeException("AuthToken has changed",ZmCsfeException.AUTH_TOKEN_CHANGED,r.methodNameStr)
}
a.authToken=ZmCsfeCommand._curAuthToken=t
}else{
if(ZmCsfeCommand.noAuth){
throw new ZmCsfeException("Auth required",ZmCsfeException.NO_AUTH_TOKEN,r.methodNameStr)
}}
AjxDebug.logSoapMessage(r);
r.jsonRequestObj=n;
var e=(r.useStringify1?JSON.stringify1(n):JSON.stringify(n));
return AjxStringUtil.jsEncode(e)
};
ZmCsfeCommand._getSoapRequestStr=function(r){
var u=r.soapDoc;
if(!r.resend){
var f=u.createHeaderElement();
var n=u.set("context",null,f,"urn:zimbra");
var t=u.set("userAgent",null,n);
var a=["ZimbraWebClient - ",AjxEnv.browser," (",AjxEnv.platform,")"].join("");
t.setAttribute("name",a);
if(ZmCsfeCommand.clientVersion){
t.setAttribute("version",ZmCsfeCommand.clientVersion)
}
if(r.noSession){
u.set("nosession",null,n)
}else{
var h=ZmCsfeCommand.getSessionId();
var l=u.set("session",null,n);
if(h){
l.setAttribute("id",h)
}}
if(r.targetServer){
u.set("targetServer",r.targetServer,n)
}
if(r.highestNotifySeen){
var p=u.set("notify",null,n);
p.setAttribute("seq",r.highestNotifySeen)
}
if(r.changeToken){
var d=u.set("change",null,n);
d.setAttribute("token",r.changeToken);
d.setAttribute("type","new")
}
if(!r.skipAuthCheck){
if(r.accountId){
var s=u.set("account",r.accountId,n);
s.setAttribute("by","id")
}else{
if(r.accountName){
var s=u.set("account",r.accountName,n);
s.setAttribute("by","name")
}}}
if(r.skipExpiredToken){
var c=u.set("authTokenControl",null,n);
c.setAttribute("voidOnExpired","1")
}
if(!r.useXml){
var o=u.set("format",null,n);
o.setAttribute("type","js")
}}
r.methodNameStr=ZmCsfeCommand.getMethodName(u);
if(!r.noAuthToken){
var m=r.authToken||ZmCsfeCommand.getAuthToken();
if(!m){
throw new ZmCsfeException("AuthToken required",ZmCsfeException.NO_AUTH_TOKEN,r.methodNameStr)
}
if(ZmCsfeCommand._curAuthToken&&!r.skipAuthCheck&&(r.resend!=ZmCsfeCommand.REAUTH)&&(m!=ZmCsfeCommand._curAuthToken)){
throw new ZmCsfeException("AuthToken has changed",ZmCsfeException.AUTH_TOKEN_CHANGED,r.methodNameStr)
}
ZmCsfeCommand._curAuthToken=m;
if(r.resend==ZmCsfeCommand.REAUTH){
var e=u.getDoc().getElementsByTagName("authToken");
if(e&&e.length==1){
e[0].firstChild.data=m
}else{
e=u.getDoc().getElementsByTagName("context");
if(e&&e.length==1){
u.set("authToken",m,e[0])
}else{}}}else{
if(!r.resend){
u.set("authToken",m,n)
}}}else{
if(ZmCsfeCommand.noAuth&&!r.ignoreAuthToken){
throw new ZmCsfeException("Auth required",ZmCsfeException.NO_AUTH_TOKEN,r.methodNameStr)
}}
AjxDebug.logSoapMessage(r);
return u.getXml()
};
ZmCsfeCommand.prototype._runCallback=function(a,e){
if(!e){
return
}
if(this.cancelled&&a.skipCallbackIfCancelled){
return
}
var t;
if(e instanceof ZmCsfeResult){
t=e
}else{
t=this._getResponseData(e,a)
}
this._en=new Date();
if(a.callback&&t){
a.callback.run(t)
}else{
if(!a.emptyResponseOkay){}}};
ZmCsfeCommand.prototype._getResponseData=function(o,a){
this._en=new Date();
var c=new ZmCsfeResult();
var t=false;
var e=Boolean(a.restUri);
var s=null;
if(!o.success&&!o.xml&&(/<html/i.test(o.text))){
var h=new ZmCsfeException(null,ZmCsfeException.CSFE_SVC_ERROR,a.methodNameStr,"HTTP response status "+o.status);
if(a.asyncMode){
c.set(h,true);
return c
}else{
throw h
}}
if(typeof(o.text)=="string"&&o.text.indexOf("{")==0){
s=o.text
}else{
if(!e){
try{
t=true;
if(!(o.text||(o.xml&&(typeof o.xml)=="string"))){
if(a.emptyResponseOkay){
return null
}else{
throw new ZmCsfeException(null,ZmCsfeException.EMPTY_RESPONSE,a.methodNameStr)
}}
s=(AjxEnv.isIE||o.xml==null)?AjxSoapDoc.createFromXml(o.text):AjxSoapDoc.createFromDom(o.xml)
}
catch(h){
if(a.asyncMode){
c.set(h,true);
return c
}else{
throw h
}}
if(!s){
var h=new ZmCsfeException(null,ZmCsfeException.SOAP_ERROR,a.methodNameStr,"Bad XML response doc");
if(a.asyncMode){
c.set(h,true);
return c
}else{
throw h
}}}}
var n=e?o.text:{};
if(t){
n=s._xmlDoc.toJSObject(true,false,true)
}else{
if(!e){
try{
n=JSON.parse(s)
}
catch(h){
if(h.name=="SyntaxError"){
h=new ZmCsfeException(null,ZmCsfeException.BAD_JSON_RESPONSE,a.methodNameStr,s);
AjxDebug.println(AjxDebug.BAD_JSON,"bad json. respDoc="+s)
}
if(a.asyncMode){
c.set(h,true);
return c
}else{
throw h
}}}}
a.methodNameStr=ZmCsfeCommand.getMethodName(n.Body);
AjxDebug.logSoapMessage(a);
var r=n&&n.Body&&n.Body.Fault;
if(r){
if(AjxUtil.isString(r)&&r.indexOf("<")==0){
r=AjxXmlDoc.createFromXml(r).toJSObject(true,false,true)
}
var h=ZmCsfeCommand.faultToEx(r,a);
if(a.asyncMode){
c.set(h,true,n.Header);
return c
}else{
throw h
}}else{
if(!o.success){
var h=new ZmCsfeException(null,ZmCsfeException.CSFE_SVC_ERROR,a.methodNameStr,"HTTP response status "+o.status);
if(a.asyncMode){
c.set(h,true);
return c
}else{
throw h
}}else{
if(a.asyncMode){
c.set(n)
}}}
var l=n.Header&&n.Header.context&&n.Header.context.session;
ZmCsfeCommand.setSessionId(l);
return a.asyncMode?c:n
};
ZmCsfeCommand.prototype._handleException=function(e,a,o){
if(!(e&&(e instanceof ZmCsfeException||e instanceof AjxSoapException||e instanceof AjxException))){
var t=new ZmCsfeException();
t.method=a.methodNameStr||a.restUri;
t.detail=e?e.toString():"undefined exception";
t.code=ZmCsfeException.UNKNOWN_ERROR;
t.msg="Unknown Error";
e=t
}
if(a.asyncMode){
o.run(new ZmCsfeResult(e,true))
}else{
throw e
}}
}
if(AjxPackage.define("zimbra.csfe.ZmCsfeException")){
ZmCsfeException=function(o){
o=Dwt.getParams(arguments,ZmCsfeException.PARAMS);
AjxException.call(this,o.msg,o.code,o.method,o.detail);
if(o.data){
this.data={};
for(var t=0;
t<o.data.length;
t++){
var a=o.data[t];
var e=a.n;
if(!this.data[e]){
this.data[e]=[]
}
this.data[e].push(a._content)
}}
this.trace=o.trace;
this.request=o.request
};
ZmCsfeException.PARAMS=["msg","code","method","detail","data","trace"];
ZmCsfeException.prototype=new AjxException;
ZmCsfeException.prototype.constructor=ZmCsfeException;
ZmCsfeException.prototype.isZmCsfeException=true;
ZmCsfeException.prototype.toString=function(){
return"ZmCsfeException"
};
ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_INVALID="invalid";
ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_UNSENT="unsent";
ZmCsfeException.getErrorMsg=function(t,e){
var a=ZMsg[t];
if(!a){
ZmCsfeException._unknownFormat=ZmCsfeException._unknownFormat||new AjxMessageFormat(ZMsg.unknownError);
return ZmCsfeException._unknownFormat.format(t)
}
this.msg=this.msg||a;
return e?AjxMessageFormat.format(a,e):a
};
ZmCsfeException.prototype.getErrorMsg=function(e){
return ZmCsfeException.getErrorMsg(this.code,e)
};
ZmCsfeException.prototype.getData=function(e){
return this.data&&this.data[e]
};
ZmCsfeException.AUTH_TOKEN_CHANGED="AUTH_TOKEN_CHANGED";
ZmCsfeException.BAD_JSON_RESPONSE="BAD_JSON_RESPONSE";
ZmCsfeException.CSFE_SVC_ERROR="CSFE_SVC_ERROR";
ZmCsfeException.EMPTY_RESPONSE="EMPTY_RESPONSE";
ZmCsfeException.NETWORK_ERROR="NETWORK_ERROR";
ZmCsfeException.NO_AUTH_TOKEN="NO_AUTH_TOKEN";
ZmCsfeException.SOAP_ERROR="SOAP_ERROR";
ZmCsfeException.LICENSE_ERROR="service.LICENSE_ERROR";
ZmCsfeException.SVC_ALREADY_IN_PROGRESS="service.ALREADY_IN_PROGRESS";
ZmCsfeException.SVC_AUTH_EXPIRED="service.AUTH_EXPIRED";
ZmCsfeException.SVC_AUTH_REQUIRED="service.AUTH_REQUIRED";
ZmCsfeException.SVC_FAILURE="service.FAILURE";
ZmCsfeException.SVC_INVALID_REQUEST="service.INVALID_REQUEST";
ZmCsfeException.SVC_PARSE_ERROR="service.PARSE_ERROR";
ZmCsfeException.SVC_PERM_DENIED="service.PERM_DENIED";
ZmCsfeException.SVC_RESOURCE_UNREACHABLE="service.RESOURCE_UNREACHABLE";
ZmCsfeException.SVC_UNKNOWN_DOCUMENT="service.UNKNOWN_DOCUMENT";
ZmCsfeException.SVC_TEMPORARILY_UNAVAILABLE="service.TEMPORARILY_UNAVAILABLE";
ZmCsfeException.SVC_WRONG_HOST="service.WRONG_HOST";
ZmCsfeException.ACCT_AUTH_FAILED="account.AUTH_FAILED";
ZmCsfeException.ACCT_CHANGE_PASSWORD="account.CHANGE_PASSWORD";
ZmCsfeException.ACCT_EXISTS="account.ACCOUNT_EXISTS";
ZmCsfeException.ACCT_TOO_MANY_ACCOUNTS="account.TOO_MANY_ACCOUNTS";
ZmCsfeException.ACCT_INVALID_ATTR_VALUE="account.INVALID_ATTR_VALUE";
ZmCsfeException.ACCT_INVALID_PASSWORD="account.INVALID_PASSWORD";
ZmCsfeException.ACCT_INVALID_PREF_NAME="account.INVALID_PREF_NAME";
ZmCsfeException.ACCT_INVALID_PREF_VALUE="account.INVALID_PREF_VALUE";
ZmCsfeException.ACCT_MAINTENANCE_MODE="account.MAINTENANCE_MODE";
ZmCsfeException.ACCT_NO_SUCH_ACCOUNT="account.NO_SUCH_ACCOUNT";
ZmCsfeException.ACCT_NO_SUCH_SAVED_SEARCH="account.NO_SUCH_SAVED_SEARCH";
ZmCsfeException.ACCT_NO_SUCH_TAG="account.ACCT_NO_SUCH_TAG";
ZmCsfeException.ACCT_PASS_CHANGE_TOO_SOON="account.PASSWORD_CHANGE_TOO_SOON";
ZmCsfeException.ACCT_PASS_LOCKED="account.PASSWORD_LOCKED";
ZmCsfeException.ACCT_PASS_RECENTLY_USED="account.PASSWORD_RECENTLY_USED";
ZmCsfeException.COS_EXISTS="account.COS_EXISTS";
ZmCsfeException.DISTRIBUTION_LIST_EXISTS="account.DISTRIBUTION_LIST_EXISTS";
ZmCsfeException.DOMAIN_EXISTS="account.DOMAIN_EXISTS";
ZmCsfeException.DOMAIN_NOT_EMPTY="account.DOMAIN_NOT_EMPTY";
ZmCsfeException.IDENTITY_EXISTS="account.IDENTITY_EXISTS";
ZmCsfeException.NO_SUCH_DISTRIBUTION_LIST="account.NO_SUCH_DISTRIBUTION_LIST";
ZmCsfeException.NO_SUCH_DOMAIN="account.NO_SUCH_DOMAIN";
ZmCsfeException.MAINTENANCE_MODE="account.MAINTENANCE_MODE";
ZmCsfeException.TOO_MANY_IDENTITIES="account.TOO_MANY_IDENTITIES";
ZmCsfeException.TOO_MANY_SEARCH_RESULTS="account.TOO_MANY_SEARCH_RESULTS";
ZmCsfeException.NO_SUCH_COS="account.NO_SUCH_COS";
ZmCsfeException.SIGNATURE_EXISTS="account.SIGNATURE_EXISTS";
ZmCsfeException.CANNOT_CHANGE_VOLUME="volume.CANNOT_CHANGE_TYPE_OF_CURRVOL";
ZmCsfeException.CANNOT_DELETE_VOLUME_IN_USE="volume.CANNOT_DELETE_VOLUME_IN_USE";
ZmCsfeException.NO_SUCH_VOLUME="volume.NO_SUCH_VOLUME";
ZmCsfeException.ALREADY_EXISTS="volume.ALREADY_EXISTS";
ZmCsfeException.VOLUME_NO_SUCH_PATH="volume.NO_SUCH_PATH";
ZmCsfeException.MAIL_ALREADY_EXISTS="mail.ALREADY_EXISTS";
ZmCsfeException.MAIL_IMMUTABLE="mail.IMMUTABLE_OBJECT";
ZmCsfeException.MAIL_INVALID_NAME="mail.INVALID_NAME";
ZmCsfeException.MAIL_INVITE_OUT_OF_DATE="mail.INVITE_OUT_OF_DATE";
ZmCsfeException.MAIL_MAINTENANCE_MODE="mail.MAINTENANCE";
ZmCsfeException.MAIL_MESSAGE_TOO_BIG="mail.MESSAGE_TOO_BIG";
ZmCsfeException.MAIL_NO_SUCH_CALITEM="mail.NO_SUCH_CALITEM";
ZmCsfeException.MAIL_NO_SUCH_CONV="mail.NO_SUCH_CONV";
ZmCsfeException.MAIL_NO_SUCH_FOLDER="mail.NO_SUCH_FOLDER";
ZmCsfeException.MAIL_NO_SUCH_ITEM="mail.NO_SUCH_ITEM";
ZmCsfeException.MAIL_NO_SUCH_MOUNTPOINT="mail.NO_SUCH_MOUNTPOINT";
ZmCsfeException.MAIL_NO_SUCH_MSG="mail.NO_SUCH_MSG";
ZmCsfeException.MAIL_NO_SUCH_PART="mail.NO_SUCH_PART";
ZmCsfeException.MAIL_NO_SUCH_TAG="mail.NO_SUCH_TAG";
ZmCsfeException.MAIL_QUERY_PARSE_ERROR="mail.QUERY_PARSE_ERROR";
ZmCsfeException.MAIL_QUOTA_EXCEEDED="mail.QUOTA_EXCEEDED";
ZmCsfeException.MAIL_SEND_ABORTED_ADDRESS_FAILURE="mail.SEND_ABORTED_ADDRESS_FAILURE";
ZmCsfeException.MAIL_SEND_FAILURE="mail.SEND_FAILURE";
ZmCsfeException.MAIL_TOO_MANY_CONTACTS="mail.TOO_MANY_CONTACTS";
ZmCsfeException.MAIL_TOO_MANY_TERMS="mail.TOO_MANY_QUERY_TERMS_EXPANDED";
ZmCsfeException.MAIL_UNABLE_TO_IMPORT_APPOINTMENTS="mail.MAIL_UNABLE_TO_IMPORT_APPOINTMENTS";
ZmCsfeException.MAIL_UNABLE_TO_IMPORT_CONTACTS="mail.UNABLE_TO_IMPORT_CONTACTS";
ZmCsfeException.MODIFY_CONFLICT="mail.MODIFY_CONFLICT";
ZmCsfeException.TOO_MANY_TAGS="mail.TOO_MANY_TAGS";
ZmCsfeException.CANNOT_RENAME="mail.CANNOT_RENAME";
ZmCsfeException.CANNOT_UNLOCK="mail.CANNOT_UNLOCK";
ZmCsfeException.CANNOT_LOCK="mail.CANNOT_LOCK";
ZmCsfeException.LOCKED="mail.LOCKED";
ZmCsfeException.OFFLINE_ONLINE_ONLY_OP="offline.ONLINE_ONLY_OP"
}
if(AjxPackage.define("zimbra.csfe.ZmCsfeResult")){
ZmCsfeResult=function(e,t,a){
this.set(e,t,a)
};
ZmCsfeResult.prototype.isZmCsfeResult=true;
ZmCsfeResult.prototype.toString=function(){
return"ZmCsfeResult"
};
ZmCsfeResult.prototype.set=function(e,t,a){
this._data=e;
this._isException=(t===true);
this._header=a
};
ZmCsfeResult.prototype.getResponse=function(){
if(this._isException){
throw this._data
}else{
return this._data
}};
ZmCsfeResult.prototype.getException=function(){
return this._isException?this._data:null
};
ZmCsfeResult.prototype.isException=function(){
return this._isException
};
ZmCsfeResult.prototype.getHeader=function(){
return this._header
}
}
if(AjxPackage.define("zimbraMail.core.ZmId")){
ZmId=function(){};
ZmId.WIDGET="z";
ZmId.WIDGET_VIEW="zv";
ZmId.WIDGET_TOOLBAR="ztb";
ZmId.WIDGET_BUTTON="zb";
ZmId.WIDGET_INPUT="zi";
ZmId.WIDGET_MENU="zm";
ZmId.WIDGET_MENU_ITEM="zmi";
ZmId.WIDGET_SELECT="zs";
ZmId.WIDGET_OVERVIEW_CNTR="zovc";
ZmId.WIDGET_OVERVIEW="zov";
ZmId.WIDGET_TREE="zt";
ZmId.WIDGET_TREE_ITEM_HDR="ztih";
ZmId.WIDGET_TREE_ITEM="zti";
ZmId.WIDGET_TAB="ztab";
ZmId.WIDGET_AUTOCOMPLETE="zac";
ZmId.WIDGET_CHECKBOX="zcb";
ZmId.WIDGET_COMBOBOX="zcombo";
ZmId.WIDGET_CHOOSER="zchooser";
ZmId.WIDGET_CALENDAR="zcal";
ZmId.SKIN_APP_BOTTOM_TOOLBAR="skin_container_app_bottom_toolbar";
ZmId.SKIN_APP_CHOOSER="skin_container_app_chooser";
ZmId.SKIN_APP_MAIN_FULL="skin_container_app_main_full";
ZmId.SKIN_APP_MAIN="skin_container_app_main";
ZmId.SKIN_APP_MAIN_ROW_FULL="skin_tr_main_full";
ZmId.SKIN_APP_MAIN_ROW="skin_tr_main";
ZmId.SKIN_APP_TOP_TOOLBAR="skin_container_app_top_toolbar";
ZmId.SKIN_APP_NEW_BUTTON="skin_container_app_new_button";
ZmId.SKIN_LINKS="skin_container_links";
ZmId.SKIN_LOGO="skin_container_logo";
ZmId.SKIN_QUOTA_INFO="skin_container_quota";
ZmId.SKIN_SASH="skin_container_tree_app_sash";
ZmId.SKIN_SEARCH_BUILDER="skin_container_search_builder";
ZmId.SKIN_SEARCH_BUILDER_TOOLBAR="skin_container_search_builder_toolbar";
ZmId.SKIN_SEARCH_BUILDER_TR="skin_tr_search_builder";
ZmId.SKIN_SEARCH="skin_container_search";
ZmId.SKIN_SEARCH_RESULTS_TOOLBAR="skin_container_search_results_toolbar";
ZmId.SKIN_REFRESH="skin_container_refresh";
ZmId.SKIN_SHELL="skin_outer";
ZmId.SKIN_SPACING_SEARCH="skin_spacing_search";
ZmId.SKIN_SPLASH_SCREEN="skin_container_splash_screen";
ZmId.SKIN_STATUS="skin_container_status";
ZmId.SKIN_STATUS_ROW="skin_tr_status";
ZmId.SKIN_TREE_FOOTER="skin_container_tree_footer";
ZmId.SKIN_TREE="skin_container_tree";
ZmId.SKIN_USER_INFO="skin_container_username";
ZmId.SKIN_TASKBAR="skin_container_taskbar";
ZmId.SKIN_FOOTER="skin_footer";
ZmId.SKIN_AD="skin_adsrvc";
ZmId.SKIN_UNITTEST="skin_unittest";
ZmId.SHELL="z_shell";
ZmId.LOADING_VIEW="z_loading";
ZmId.MAIN_SASH="z_sash";
ZmId.BANNER="z_banner";
ZmId.SEARCH_TOOLBAR="ztb_search";
ZmId.SEARCHRESULTS_TOOLBAR="ztb_searchresults";
ZmId.SEARCHRESULTS_PANEL="z_filterPanel";
ZmId.USER_NAME="z_userName";
ZmId.USER_QUOTA="z_userQuota";
ZmId.PRESENCE="z_presence";
ZmId.TASKBAR="z_taskbar";
ZmId.NEW_FOLDER_BUTTON="zb_newFolder";
ZmId.STATUS_VIEW="z_status";
ZmId.TOAST="z_toast";
ZmId.APP_CHOOSER="ztb_appChooser";
ZmId.getToolbarId=function(t,e){
return DwtId.makeId(ZmId.WIDGET_TOOLBAR,t,e)
};
ZmId.TB_INVITE="Inv";
ZmId.TB_COUNTER="Cou";
ZmId.TB_NAV="Nav";
ZmId.TB_SHARE="Shr";
ZmId.TB_REPLY="Rep";
ZmId.TB_SUBSCRIBE="Sub";
ZmId.getButtonId=function(t,a,e){
return DwtId.makeId(ZmId.WIDGET_BUTTON,t,e,a)
};
ZmId.getMenuId=function(t,e){
return DwtId.makeId(ZmId.WIDGET_MENU,t,e)
};
ZmId.MENU_PARTICIPANT="Par";
ZmId.MENU_DRAFTS="Dra";
ZmId.getMenuItemId=function(t,a,e){
return DwtId.makeId(ZmId.WIDGET_MENU_ITEM,t,e,a)
};
ZmId.getOverviewContainerId=function(e){
return DwtId.makeId(ZmId.WIDGET_OVERVIEW_CNTR,e)
};
ZmId.getOverviewId=function(e){
return DwtId.makeId(ZmId.WIDGET_OVERVIEW,e)
};
ZmId.getTreeId=function(t,e){
return DwtId.makeId(ZmId.WIDGET_TREE,t,e)
};
ZmId.getTreeItemId=function(a,t,e){
if(!t&&!e){
return
}
if(e){
return DwtId.makeId(ZmId.WIDGET_TREE_ITEM_HDR,a,e)
}else{
return DwtId.makeId(ZmId.WIDGET_TREE_ITEM,a,t)
}};
ZmId.getViewId=function(e,t,a){
var o=DwtId.makeId(ZmId.WIDGET_VIEW,a,e);
return t?[o,t].join(""):o
};
ZmId.getComposeViewId=function(e){
var t=DwtId.makeId(ZmId.WIDGET,ZmId.COMPOSE_VIEW);
return e?[t,e].join(""):t
};
ZmId.getTabId=function(e,t){
return DwtId.makeId(ZmId.WIDGET_TAB,e,t)
};
ZmId.getPrefPageId=function(e){
return"PREF_PAGE_"+e
};
ZmId.SEARCH_INPUT="zi_search";
ZmId.SEARCH_INPUTFIELD=ZmId.SEARCH_INPUT+"_inputfield";
ZmId.SEARCH="Search";
ZmId.SEARCH_CUSTOM="CUSTOM";
ZmId.SEARCH_MENU="MENU";
ZmId.SEARCH_SEARCH="SEARCH";
ZmId.SEARCH_SAVE="SAVE";
ZmId.SEARCH_ADVANCED="ADV";
ZmId.SEARCH_LOCAL="LOCAL";
ZmId.SEARCH_ALL_ACCOUNTS="ALL_ACCOUNTS";
ZmId.SEARCH_GAL="GAL";
ZmId.SEARCH_MAIL="MAIL";
ZmId.SEARCH_SHARED="SHARED";
ZmId.SEARCHRESULTS_INPUT="zi_searchresults";
ZmId.SEARCHRESULTS_INPUTFIELD=ZmId.SEARCHRESULTS_INPUT+"_inputfield";
ZmId.SEARCHRESULTS="SearchResults";
ZmId.SEARCHRESULTS_SEARCH="SEARCH";
ZmId.SEARCHRESULTS_SAVE="SAVE";
ZmId.APP="App";
ZmId.TREEITEM_INBOX="zti|Mail|2";
ZmId.TREEITEM_JUNK="zti|Mail|4";
ZmId.TREEITEM_SENT="zti|Mail|5";
ZmId.TREEITEM_DRAFTS="zti|Mail|6";
ZmId.TREEITEM_TRASH_MAIL="zti|Mail|3";
ZmId.TREEITEM_TRASH_CONTACTS="zti|Contacts|3";
ZmId.TREEITEM_CONTACTS="zti|Contacts|7";
ZmId.TREEITEM_CALENDAR="zti|Calendar|10";
ZmId.TREEITEM_TASKS="zti|Tasks|15";
ZmId.TREEITEM_BRIEFCASE="zti|Briefcase|16";
ZmId.MV_HDR_TABLE="_hdrTable";
ZmId.MV_HDR_TABLE_TOP_ROW="_hdrTableTopRow";
ZmId.MV_REPORT_BTN_CELL="_reportBtnCell";
ZmId.MV_EXPAND_ROW="_expandRow";
ZmId.MV_EXPAND_HDR="_expandHeader";
ZmId.MV_ATT_LINKS="_attLinks";
ZmId.MV_CONTACT_AREA="_contactArea";
ZmId.MV_HIGHLIGHT_OBJ="_highlightObjects";
ZmId.MV_DISPLAY_IMAGES="_displayImages";
ZmId.MV_MSG_TRUNC="_msgTruncation";
ZmId.MV_INFO_BAR="_infoBar";
ZmId.MV_TAG_ROW="_tagRow";
ZmId.MV_TAG_CELL="_tagCell";
ZmId.MV_MSG_BODY="_body";
ZmId.MV_MSG_HEADER="_header";
ZmId.MV_MSG_FOOTER="_footer";
ZmId.MV_PRIORITY="_msgPriority";
ZmId.CMP_HEADER="_header";
ZmId.CMP_FROM_SELECT="_from_select";
ZmId.CMP_TO_ROW="_to_row";
ZmId.CMP_TO_PICKER="_to_picker";
ZmId.CMP_TO_INPUT="_to_control";
ZmId.CMP_CC_ROW="_cc_row";
ZmId.CMP_CC_PICKER="_cc_picker";
ZmId.CMP_CC_INPUT="_cc_control";
ZmId.CMP_BCC_ROW="_bcc_row";
ZmId.CMP_BCC_PICKER="_bcc_picker";
ZmId.CMP_BCC_INPUT="_bcc_control";
ZmId.CMP_BCC_TOGGLE="_toggle_bcc";
ZmId.CMP_OBO_CHECKBOX="_obo_checkbox";
ZmId.CMP_OBO_LABEL="_obo_label";
ZmId.CMP_OBO_ROW="_obo_row";
ZmId.CMP_SUBJECT_ROW="_subject_row";
ZmId.CMP_SUBJECT_INPUT="_subject_control";
ZmId.CMP_IDENTITY_ROW="_identity_row";
ZmId.CMP_IDENTITY_SELECT="_identity_control";
ZmId.CMP_PRIORITY="_priority";
ZmId.CMP_REPLY_ATT_ROW="_reply_attachments_link";
ZmId.CMP_ATT_ROW="_attachments_row";
ZmId.CMP_ATT_DIV="_attachments_div";
ZmId.CMP_ATT_BTN="_attachments_btn";
ZmId.CMP_ATT_INP="_file_input";
ZmId.CMP_ATT_INLINE_INP="_file_input_inline";
ZmId.CMP_ATT_INCL_ORIG_LINK="_show_orig";
ZmId.CMP_DND_TOOLTIP="_zdnd_tooltip";
ZmId.CMP_TO_CELL="_to_cell";
ZmId.CMP_CC_CELL="_cc_cell";
ZmId.CMP_BCC_CELL="_bcc_cell";
ZmId.CMP_TO="TO";
ZmId.CMP_CC="CC";
ZmId.CMP_BCC="BCC";
ZmId.APP_BRIEFCASE="Briefcase";
ZmId.APP_CALENDAR="Calendar";
ZmId.APP_CONTACTS="Contacts";
ZmId.APP_IM="IM";
ZmId.APP_MAIL="Mail";
ZmId.APP_PORTAL="Portal";
ZmId.APP_PREFERENCES="Options";
ZmId.APP_SEARCH="Search";
ZmId.APP_TASKS="Tasks";
ZmId.APP_VOICE="Voice";
ZmId.VIEW_ACCOUNT="ACCT";
ZmId.VIEW_APPOINTMENT="APPT";
ZmId.VIEW_SIMPLE_ADD_APPOINTMENT="SAPPT";
ZmId.VIEW_APPOINTMENT_READONLY="APPTRO";
ZmId.VIEW_APPT_SCHEDULE="APPTS";
ZmId.VIEW_BRIEFCASE="BC";
ZmId.VIEW_BRIEFCASE_DETAIL="BCD";
ZmId.VIEW_BRIEFCASE_COLUMN="BCC";
ZmId.VIEW_BRIEFCASE_ICON="BCI";
ZmId.VIEW_BRIEFCASE_PREVIEW="BCP";
ZmId.VIEW_BRIEFCASE_REVISION="BRLV";
ZmId.VIEW_BRIEFCASE_DETAIL="BDLV";
ZmId.VIEW_CAL="CAL";
ZmId.VIEW_CAL_APPT="CLA";
ZmId.VIEW_CAL_DAY="CLD";
ZmId.VIEW_CAL_LIST="CLL";
ZmId.VIEW_CAL_MONTH="CLM";
ZmId.VIEW_CAL_WEEK="CLW";
ZmId.VIEW_CAL_WORK_WEEK="CLWW";
ZmId.VIEW_CAL_FB="CLFB";
ZmId.VIEW_CAL_TRASH="CLT";
ZmId.VIEW_SUGGEST_TIME_PANE="CSTP";
ZmId.VIEW_SUGGEST_LOCATION_PANE="CSLP";
ZmId.VIEW_CALL_LIST="CLIST";
ZmId.VIEW_COMPOSE="COMPOSE";
ZmId.VIEW_CONTACT_SIMPLE="CNS";
ZmId.VIEW_CONTACT_SRC="CNSRC";
ZmId.VIEW_CONTACT_TGT="CNTGT";
ZmId.VIEW_CONTACT="CN";
ZmId.VIEW_CONV="CV";
ZmId.VIEW_CONV2="CV2";
ZmId.VIEW_CONVLIST="CLV";
ZmId.VIEW_FILTER_RULES="FRV";
ZmId.VIEW_GROUP="GRP";
ZmId.VIEW_IM_CHAT_MEMBER_LIST="IMCML";
ZmId.VIEW_IM_CHAT_MULTI_WINDOW="IMCMW";
ZmId.VIEW_IM_CHAT_TAB="IMCT";
ZmId.VIEW_LOADING="LOADING";
ZmId.VIEW_MAIL_CONFIRM="MAILCONFIRM";
ZmId.VIEW_MOBILE_DEVICES="MD";
ZmId.VIEW_MSG="MSG";
ZmId.VIEW_MSG_CAPSULE="MSGC";
ZmId.VIEW_PORTAL="PORTAL";
ZmId.VIEW_PREF="PREF";
ZmId.VIEW_SEARCH_RESULTS="SR";
ZmId.VIEW_SHARE_PENDING="SVP";
ZmId.VIEW_SHARE_MOUNTED="SVM";
ZmId.VIEW_SHARE_GRANTS="SVG";
ZmId.VIEW_SHORTCUTS="SHORTCUTS";
ZmId.VIEW_TASK="TKV";
ZmId.VIEW_TASK_NOT_STARTED="TKVN";
ZmId.VIEW_TASK_COMPLETED="TKVC";
ZmId.VIEW_TASK_IN_PROGRESS="TKVI";
ZmId.VIEW_TASK_WAITING="TKVW";
ZmId.VIEW_TASK_DEFERRED="TKVD";
ZmId.VIEW_TASK_ALL="TKVA";
ZmId.VIEW_TASK_TODO="TKVT";
ZmId.VIEW_TASKEDIT="TKE";
ZmId.VIEW_TASKLIST="TKL";
ZmId.VIEW_TRAD="TV";
ZmId.VIEW_VOICEMAIL="VM";
ZmId.VIEW_ATTACHMENTS="AV";
ZmId.ITEM_APPOINTMENT="APPT";
ZmId.ITEM_ATT="ATT";
ZmId.ITEM_BRIEFCASE="BRIEFCASE_ITEM";
ZmId.ITEM_BRIEFCASE_REV="BRIEFCASE_REVISION";
ZmId.ITEM_CALL="CALL";
ZmId.ITEM_CHAT="CHAT";
ZmId.ITEM_CONTACT="CONTACT";
ZmId.ITEM_CONV="CONV";
ZmId.ITEM_DATA_SOURCE="DATA_SOURCE";
ZmId.ITEM_DOCUMENT="DOCUMENT";
ZmId.ITEM_GROUP="GROUP";
ZmId.ITEM_MSG="MSG";
ZmId.ITEM_PAGE="PAGE";
ZmId.ITEM_RESOURCE="RESOURCE";
ZmId.ITEM_ROSTER="ROSTER_ITEM";
ZmId.ITEM_TASK="TASK";
ZmId.ITEM_VOICEMAIL="VOICEMAIL";
ZmId.ORG_ADDRBOOK="ADDRBOOK";
ZmId.ORG_BRIEFCASE="BRIEFCASE";
ZmId.ORG_CALENDAR="CALENDAR";
ZmId.ORG_FOLDER="FOLDER";
ZmId.ORG_PREF_PAGE="PREF_PAGE";
ZmId.ORG_ROSTER_TREE_ITEM="ROSTER_TREE_ITEM";
ZmId.ORG_ROSTER_TREE_GROUP="ROSTER_TREE_GROUP";
ZmId.ORG_SEARCH="SEARCH";
ZmId.ORG_TAG="TAG";
ZmId.ORG_TASKS="TASKS";
ZmId.ORG_ZIMLET="ZIMLET";
ZmId.FLD_ACCOUNT="ac";
ZmId.FLD_ATTACHMENT="at";
ZmId.FLD_CAPACITY="cp";
ZmId.FLD_COMPANY="co";
ZmId.FLD_DATE="dt";
ZmId.FLD_DEPARTMENT="de";
ZmId.FLD_EMAIL="em";
ZmId.FLD_EXPAND="ex";
ZmId.FLD_FILE_TYPE="ft";
ZmId.FLD_FLAG="fg";
ZmId.FLD_FOLDER="fo";
ZmId.FLD_FRAGMENT="fm";
ZmId.FLD_FROM="fr";
ZmId.FLD_HOME_PHONE="hp";
ZmId.FLD_ID="id";
ZmId.FLD_INDEX="ix";
ZmId.FLD_ITEM_ROW="rw";
ZmId.FLD_ITEM_ROW_3PANE="r3";
ZmId.FLD_LOCATION="lo";
ZmId.FLD_LOCK="loid";
ZmId.FLD_MSG_PRIORITY="mp";
ZmId.FLD_NAME="na";
ZmId.FLD_NOTES="no";
ZmId.FLD_PARTICIPANT="pa";
ZmId.FLD_PCOMPLETE="pc";
ZmId.FLD_PRIORITY="pr";
ZmId.FLD_RECURRENCE="re";
ZmId.FLD_SELECTION="se";
ZmId.FLD_SELECTION_CELL="sec";
ZmId.FLD_SIZE="sz";
ZmId.FLD_SORTED_BY="sb";
ZmId.FLD_STATUS="st";
ZmId.FLD_READ="rd";
ZmId.FLD_MUTE="mt";
ZmId.FLD_SUBJECT="su";
ZmId.FLD_TAG="tg";
ZmId.FLD_TAG_CELL="tc";
ZmId.FLD_TYPE="ty";
ZmId.FLD_TO="to";
ZmId.FLD_VERSION="ver";
ZmId.FLD_WORK_PHONE="wp";
ZmId.OP_ACCEPT_PROPOSAL="ACCEPT_PROPOSAL";
ZmId.OP_ADD="ADD";
ZmId.OP_ADD_FILTER_RULE="ADD_FILTER_RULE";
ZmId.OP_ADD_SIGNATURE="ADD_SIGNATURE";
ZmId.OP_ADD_EXTERNAL_CALENDAR="ADD_EXTERNAL_CALENDAR";
ZmId.OP_ATTACHMENT="ATTACHMENT";
ZmId.OP_ACTIONS_MENU="ACTIONS_MENU";
ZmId.OP_BROWSE="BROWSE";
ZmId.OP_BROWSE_FOLDER="BROWSE_FOLDER";
ZmId.OP_CALL="CALL";
ZmId.OP_CAL_REFRESH="CAL_REFRESH";
ZmId.OP_CAL_REPLY="CAL_REPLY";
ZmId.OP_CAL_REPLY_ALL="CAL_REPLY_ALL";
ZmId.OP_CAL_LIST_VIEW="CAL_LIST_VIEW";
ZmId.OP_CAL_VIEW_MENU="CAL_VIEW_MENU";
ZmId.OP_CANCEL="CANCEL";
ZmId.OP_CHECKIN="CHECKIN";
ZmId.OP_CHECKOUT="CHECKOUT";
ZmId.OP_CHECK_ALL="CHECK_ALL";
ZmId.OP_CHECK_MAIL="CHECK_MAIL";
ZmId.OP_CALL_BACK="CALL_BACK";
ZmId.OP_CLEAR_ALL="CLEAR_ALL";
ZmId.OP_CLOSE="CLOSE";
ZmId.OP_COMPOSE_FORMAT="COMPOSE_FORMAT";
ZmId.OP_COMPOSE_OPTIONS="COMPOSE_OPTIONS";
ZmId.OP_CONTACT="CONTACT";
ZmId.OP_CONTACTGROUP_MENU="CONTACTGROUP_MENU";
ZmId.OP_CREATE_APPT="CREATE_APPT";
ZmId.OP_CREATE_TASK="CREATE_TASK";
ZmId.OP_CREATE_SLIDE_SHOW="CREATE_SLIDE_SHOW";
ZmId.OP_DAY_VIEW="DAY_VIEW";
ZmId.OP_DECLINE_PROPOSAL="DECLINE_PROPOSAL";
ZmId.OP_DELETE="DELETE";
ZmId.OP_DELETE_WITHOUT_SHORTCUT="DELETE_WITHOUT_SHORTCUT";
ZmId.OP_DELETE_APPT_INSTANCE="DELETE_INSTANCE";
ZmId.OP_DELETE_APPT_SERIES="DELETE_SERIES";
ZmId.OP_DELETE_CONV="DELETE_CONV";
ZmId.OP_DELETE_MENU="DELETE_MENU";
ZmId.OP_DELETE_MSG="DELETE_MSG";
ZmId.OP_DELETE_VERSION="DELETE_VERSION";
ZmId.OP_DETACH="DETACH";
ZmId.OP_DETACH_WIN="DETACH_WIN";
ZmId.OP_DETACH_COMPOSE="DETACH_COMPOSE";
ZmId.OP_DISCARD_CHECKOUT="DISCARD_CHECKOUT";
ZmId.OP_DOWNLOAD_VOICEMAIL="DOWNLOAD_VOICEMAIL";
ZmId.OP_NEW_CALL="NEW_CALL";
ZmId.OP_DUPLICATE_APPT="DUPLICATE_APPT";
ZmId.OP_DRAFT="DRAFT";
ZmId.OP_EDIT="EDIT";
ZmId.OP_EDIT_AS_NEW="EDIT_AS_NEW";
ZmId.OP_EDIT_CONTACT="EDIT_CONTACT";
ZmId.OP_EDIT_FILE="EDIT_FILE";
ZmId.OP_EDIT_FILTER_RULE="EDIT_FILTER_RULE";
ZmId.OP_EDIT_PROPS="EDIT_PROPS";
ZmId.OP_EDIT_REPLY_ACCEPT="EDIT_REPLY_ACCEPT";
ZmId.OP_EDIT_REPLY_CANCEL="EDIT_REPLY_CANCEL";
ZmId.OP_EDIT_REPLY_DECLINE="EDIT_REPLY_DECLINE";
ZmId.OP_EDIT_REPLY_TENTATIVE="EDIT_REPLY_TENTATIVE";
ZmId.OP_EMPTY_FOLDER="EMPTY_FOLDER";
ZmId.OP_EXPAND="EXPAND";
ZmId.OP_EXPAND_ALL="EXPAND_ALL";
ZmId.OP_FB_VIEW="FB_VIEW";
ZmId.OP_FORMAT_HTML="FORMAT_HTML";
ZmId.OP_FORMAT_HTML_SOURCE="FORMAT_HTML_SOURCE";
ZmId.OP_FORMAT_MEDIA_WIKI="FORMAT_MEDIA_WIKI";
ZmId.OP_FORMAT_RICH_TEXT="FORMAT_RICH_TEXT";
ZmId.OP_FORMAT_TEXT="FORMAT_TEXT";
ZmId.OP_FORMAT_TWIKI="FORMAT_TWIKI";
ZmId.OP_FORWARD="FORWARD";
ZmId.OP_FORWARD_ATT="FORWARD_ATT";
ZmId.OP_FORWARD_BY_EMAIL="FORWARD_BY_EMAIL";
ZmId.OP_FORWARD_INLINE="FORWARD_INLINE";
ZmId.OP_FORWARD_MENU="FORWARD_MENU";
ZmId.OP_FORWARD_APPT="FORWARD_APPT";
ZmId.OP_FORWARD_APPT_INSTANCE="FORWARD_APPT_INSTANCE";
ZmId.OP_FORWARD_APPT_SERIES="FORWARD_APPT_SERIES";
ZmId.OP_FREE_BUSY_LINK="FREE_BUSY_LINK";
ZmId.OP_GROUPBY="GROUPBY";
ZmId.OP_GROUPBY_DATE="GROUPBY_DATE";
ZmId.OP_GROUPBY_NONE="GROUPBY_NONE";
ZmId.OP_GROUPBY_FROM="GROUPBY_FROM";
ZmId.OP_GROUPBY_PRIORITY="GROUPBY_PRIORITY";
ZmId.OP_GROUPBY_SIZE="GROUPBY_SIZE";
ZmId.OP_GROUPBY_TAG="GROUPBY_TAG";
ZmId.OP_GO_TO_URL="GO_TO_URL";
ZmId.OP_IM="IM";
ZmId.OP_IMPORT_FILE="IMPORT_FILE";
ZmId.OP_IM_ADD_TO_CONTACT="IM_ADD_TO_CONTACT";
ZmId.OP_IM_BLOCK_BUDDY="IM_BLOCK_BUDDY";
ZmId.OP_IM_BUDDY_ARCHIVE="IM_BUDDY_ARCHIVE";
ZmId.OP_IM_BUDDY_LIST="IM_BUDDY_LIST";
ZmId.OP_IM_CLOSE_ALL_CHATS="IM_CLOSE_ALL_CHATS";
ZmId.OP_IM_CLOSE_OTHER_CHATS="IM_CLOSE_OTHER_CHATS";
ZmId.OP_IM_CLOSE_CHAT="IM_CLOSE_CHATS";
ZmId.OP_IM_CREATE_CONTACT="IM_CREATE_CONTACT";
ZmId.OP_IM_EDIT_CONTACT="IM_EDIT_CONTACT";
ZmId.OP_IM_HTML="IM_HTML";
ZmId.OP_IM_DELETE_GROUP="IM_DELETE_GROUP";
ZmId.OP_IM_INVITE="IM_INVITE";
ZmId.OP_IM_NEW_CHAT="IM_NEW_CHAT";
ZmId.OP_IM_PRESENCE_AWAY="IM_PRESENCE_AWAY";
ZmId.OP_IM_PRESENCE_CHAT="IM_PRESENCE_CHAT";
ZmId.OP_IM_PRESENCE_CUSTOM_MSG="IM_PRESENCE_CUSTOM_MSG";
ZmId.OP_IM_PRESENCE_DND="IM_PRESENCE_DND";
ZmId.OP_IM_PRESENCE_INVISIBLE="IM_PRESENCE_INVISIBLE";
ZmId.OP_IM_PRESENCE_MENU="IM_PRESENCE_MENU";
ZmId.OP_IM_PRESENCE_OFFLINE="IM_PRESENCE_OFFLINE";
ZmId.OP_IM_PRESENCE_ONLINE="IM_PRESENCE_ONLINE";
ZmId.OP_IM_PRESENCE_XA="IM_PRESENCE_XA";
ZmId.OP_IM_LOGOUT_YAHOO="IM_LOGOUT_YAHOO";
ZmId.OP_IM_PRESENCE_CUSTOM_MRU="IM_PRESENCE_CUSTOM_MRU";
ZmId.OP_IM_PRESENCE_MENU="IM_PRESENCE_MENU";
ZmId.OP_IM_SORT_BY_NAME="IM_SORT_BY_NAME";
ZmId.OP_IM_SORT_BY_PRESENCE="IM_SORT_BY_PRESENCE";
ZmId.OP_IM_TOGGLE_BLOCKED="IM_TOGGLE_BLOCKED";
ZmId.OP_IM_TOGGLE_OFFLINE="IM_TOGGLE_OFFLINE";
ZmId.OP_IM_UNBLOCK_BUDDY="IM_UNBLOCK_BUDDY";
ZmId.OP_INC_ATTACHMENT="INC_ATTACHMENT";
ZmId.OP_INC_BODY="INC_BODY";
ZmId.OP_INC_NONE="INC_NONE";
ZmId.OP_INC_SMART="INC_SMART";
ZmId.OP_INCLUDE_HEADERS="INCLUDE_HEADERS";
ZmId.OP_INVITE_ATTENDEES="INVITE_ATTENDEES";
ZmId.OP_INVITE_REPLY_ACCEPT="INVITE_REPLY_ACCEPT";
ZmId.OP_INVITE_REPLY_DECLINE="INVITE_REPLY_DECLINE";
ZmId.OP_INVITE_REPLY_MENU="INVITE_REPLY_MENU";
ZmId.OP_INVITE_REPLY_TENTATIVE="INVITE_REPLY_TENTATIVE";
ZmId.OP_KEEP_READING="KEEP_READING";
ZmId.OP_MARK_ALL_READ="MARK_ALL_READ";
ZmId.OP_MARK_HEARD="MARK_HEARD";
ZmId.OP_MARK_READ="MARK_READ";
ZmId.OP_MARK_UNHEARD="MARK_UNHEARD";
ZmId.OP_MARK_UNREAD="MARK_UNREAD";
ZmId.OP_MARK_AS_COMPLETED="MARK_AS_COMPLETED";
ZmId.OP_MOBILE_REMOVE="MOBILE_REMOVE";
ZmId.OP_MOBILE_CANCEL_WIPE="MOBILE_CANCEL_WIPE";
ZmId.OP_MOBILE_RESUME_SYNC="MOBILE_RESUME_SYNC";
ZmId.OP_MOBILE_SUSPEND_SYNC="MOBILE_SUSPEND_SYNC";
ZmId.OP_MOBILE_WIPE="MOBILE_WIPE";
ZmId.OP_MONTH_VIEW="MONTH_VIEW";
ZmId.OP_MOUNT_ADDRBOOK="MOUNT_ADDRBOOK";
ZmId.OP_MOUNT_BRIEFCASE="MOUNT_BRIEFCASE";
ZmId.OP_MOUNT_CALENDAR="MOUNT_CALENDAR";
ZmId.OP_MOUNT_FOLDER="MOUNT_FOLDER";
ZmId.OP_MOUNT_TASK_FOLDER="MOUNT_TASK_FOLDER";
ZmId.OP_MOVE="MOVE";
ZmId.OP_MOVE_MENU="MOVE_MENU";
ZmId.OP_MOVE_DOWN_FILTER_RULE="MOVE_DOWN_FILTER_RULE";
ZmId.OP_MOVE_TO_BCC="MOVE_TO_BCC";
ZmId.OP_MOVE_TO_CC="MOVE_TO_CC";
ZmId.OP_MOVE_TO_TO="MOVE_TO_TO";
ZmId.OP_MOVE_UP_FILTER_RULE="MOVE_UP_FILTER_RULE";
ZmId.OP_MUTE_CONV="MUTE_CONV";
ZmId.OP_NEW_ADDRBOOK="NEW_ADDRBOOK";
ZmId.OP_NEW_ALLDAY_APPT="NEW_ALLDAY_APPT";
ZmId.OP_NEW_APPT="NEW_APPT";
ZmId.OP_NEW_BRIEFCASE="NEW_BRIEFCASE";
ZmId.OP_NEW_CALENDAR="NEW_CALENDAR";
ZmId.OP_NEW_CONTACT="NEW_CONTACT";
ZmId.OP_NEW_DISTRIBUTION_LIST="NEW_DISTRIBUTION_LIST";
ZmId.OP_NEW_DOC="NEW_DOC";
ZmId.OP_NEW_FILE="NEW_FILE";
ZmId.OP_NEW_FOLDER="NEW_FOLDER";
ZmId.OP_NEW_GROUP="NEW_GROUP";
ZmId.OP_NEW_MENU="NEW_MENU";
ZmId.OP_NEW_MESSAGE="NEW_MESSAGE";
ZmId.OP_NEW_MESSAGE_WIN="NEW_MESSAGE_WIN";
ZmId.OP_NEW_BRIEFCASE_WIN="NEW_BRIEFCASE_WIN";
ZmId.OP_NEW_PAGE="NEW_PAGE";
ZmId.OP_NEW_PRESENTATION="NEW_PRESENTATION";
ZmId.OP_NEW_ROSTER_GROUP="NEW_ROSTER_GROUP";
ZmId.OP_NEW_ROSTER_ITEM="NEW_ROSTER_ITEM";
ZmId.OP_NEW_SPREADSHEET="NEW_SPREADSHEET";
ZmId.OP_NEW_TAG="NEW_TAG";
ZmId.OP_NEW_TASK="NEW_TASK";
ZmId.OP_NOTIFY="NOTIFY";
ZmId.OP_NEW_TASK_FOLDER="NEW_TASK_FOLDER";
ZmId.OP_OPEN_APPT_INSTANCE="OPEN_APPT_INSTANCE";
ZmId.OP_OPEN_APPT_SERIES="OPEN_APPT_SERIES";
ZmId.OP_OPEN_FILE="OPEN_FILE";
ZmId.OP_PAGE_BACK="PAGE_BACK";
ZmId.OP_PAGE_FORWARD="PAGE_FORWARD";
ZmId.OP_PAUSE_TOGGLE="PAUSE_TOGGLE";
ZmId.OP_PRINT="PRINT";
ZmId.OP_PRINT_ADDRBOOK="PRINT_ADDRBOOK";
ZmId.OP_PRINT_CALENDAR="PRINT_CALENDAR";
ZmId.OP_PRINT_CONTACT="PRINT_CONTACT";
ZmId.OP_PRIORITY_FILTER="PRIORITY_FILTER";
ZmId.OP_PROPOSE_NEW_TIME="PROPOSE_NEW_TIME";
ZmId.OP_OPTS="OPTIONS";
ZmId.OP_RECOVER_DELETED_ITEMS="RECOVER_DELETED_ITEMS";
ZmId.OP_REDIRECT="REDIRECT";
ZmId.OP_REFRESH="REFRESH";
ZmId.OP_REINVITE_ATTENDEES="REINVITE_ATTENDEES";
ZmId.OP_REMOVE_FILTER_RULE="REMOVE_FILTER_RULE";
ZmId.OP_RENAME_FILE="RENAME_FILE";
ZmId.OP_RENAME_FOLDER="RENAME_FOLDER";
ZmId.OP_RENAME_SEARCH="RENAME_SEARCH";
ZmId.OP_RENAME_TAG="RENAME_TAG";
ZmId.OP_REPLY="REPLY";
ZmId.OP_REPLY_ACCEPT="REPLY_ACCEPT";
ZmId.OP_REPLY_ACCEPT_IGNORE="REPLY_ACCEPT_IGNORE";
ZmId.OP_REPLY_ACCEPT_NOTIFY="REPLY_ACCEPT_NOTIFY";
ZmId.OP_REPLY_ALL="REPLY_ALL";
ZmId.OP_REPLY_BY_EMAIL="REPLY_BY_EMAIL";
ZmId.OP_REPLY_CANCEL="REPLY_CANCEL";
ZmId.OP_REPLY_CANCEL="REPLY_CANCEL";
ZmId.OP_REPLY_DECLINE="REPLY_DECLINE";
ZmId.OP_REPLY_DECLINE_IGNORE="REPLY_DECLINE_IGNORE";
ZmId.OP_REPLY_DECLINE_NOTIFY="REPLY_DECLINE_NOTIFY";
ZmId.OP_REPLY_MENU="REPLY_MENU";
ZmId.OP_REPLY_MODIFY="REPLY_MODIFY";
ZmId.OP_REPLY_MODIFY="REPLY_MODIFY";
ZmId.OP_REPLY_NEW_TIME="REPLY_NEW_TIME";
ZmId.OP_REPLY_NEW_TIME="REPLY_NEW_TIME";
ZmId.OP_REPLY_TENTATIVE="REPLY_TENTATIVE";
ZmId.OP_REPLY_TENTATIVE_IGNORE="REPLY_TENTATIVE_IGNORE";
ZmId.OP_REPLY_TENTATIVE_NOTIFY="REPLY_TENTATIVE_NOTIFY";
ZmId.OP_REPORT="REPORT";
ZmId.OP_REQUEST_READ_RECEIPT="REQUEST_READ_RECEIPT";
ZmId.OP_RESET="RESET";
ZmId.OP_RESTORE_VERSION="RESTORE_VERSION";
ZmId.OP_REVERT_PAGE="REVERT_PAGE";
ZmId.OP_RUN_FILTER_RULE="RUN_FILTER_RULE";
ZmId.OP_SAVE="SAVE";
ZmId.OP_SAVE_DRAFT="SAVE_DRAFT";
ZmId.OP_SAVE_FILE="SAVE_FILE";
ZmId.OP_SEARCH="SEARCH";
ZmId.OP_SEARCH_MAIL="SEARCH_MAIL";
ZmId.OP_SEARCH_MENU="SEARCH_MENU";
ZmId.OP_SEARCH_TO="SEARCH_TO";
ZmId.OP_SEND="SEND";
ZmId.OP_SEND_FILE="SEND_FILE";
ZmId.OP_SEND_FILE_AS_ATT="SEND_FILE_AS_ATT";
ZmId.OP_SEND_FILE_MENU="SEND_FILE_MENU";
ZmId.OP_SEND_MENU="SEND_MENU";
ZmId.OP_SEND_LATER="SEND_LATER";
ZmId.OP_SEND_PAGE="SEND_PAGE";
ZmId.OP_SEND_INVITE="SEND_INVITE";
ZmId.OP_SEND_FB_HTML="SEND_FB_HTML";
ZmId.OP_SEND_FB_ICS="SEND_FB_ICS";
ZmId.OP_SEND_FB_ICS_EVENT="SEND_FB_ICS_EVENT";
ZmId.OP_SHARE="SHARE";
ZmId.OP_SHARE_ACCEPT="SHARE_ACCEPT";
ZmId.OP_SHARE_ADDRBOOK="SHARE_ADDRBOOK";
ZmId.OP_SHARE_BRIEFCASE="SHARE_BRIEFCASE";
ZmId.OP_SHARE_CALENDAR="SHARE_CALENDAR";
ZmId.OP_SHARE_DECLINE="SHARE_DECLINE";
ZmId.OP_SHARE_FOLDER="SHARE_FOLDER";
ZmId.OP_SHARE_TASKFOLDER="SHARE_TASKFOLDER";
ZmId.OP_SHOW_ALL_ITEM_TYPES="SHOW_ALL_ITEM_TYPES";
ZmId.OP_SHOW_BCC="SHOW_BCC";
ZmId.OP_SHOW_CONV="SHOW_CONV";
ZmId.OP_SHOW_ONLY_MAIL="SHOW_ONLY_MAIL";
ZmId.OP_SHOW_ORIG="SHOW_ORIG";
ZmId.OP_SORT_ASC="SORT_ASC";
ZmId.OP_SORT_DESC="SORT_DESC";
ZmId.OP_SPAM="SPAM";
ZmId.OP_SPELL_CHECK="SPELL_CHECK";
ZmId.OP_SUBSCRIBE_APPROVE="SUBSCRIBE_APPROVE";
ZmId.OP_SUBSCRIBE_REJECT="SUBSCRIBE_REJECT";
ZmId.OP_SYNC="SYNC";
ZmId.OP_SYNC_ALL="SYNC_ALL";
ZmId.OP_SYNC_OFFLINE_FOLDER="SYNC_OFFLINE_FOLDER";
ZmId.OP_TAG="TAG";
ZmId.OP_TAG_COLOR_MENU="TAG_COLOR_MENU";
ZmId.OP_TAG_MENU="TAG_MENU";
ZmId.OP_PRINT_TASK="PRINT_TASK";
ZmId.OP_PRINT_TASKFOLDER="PRINT_TASKFOLDER";
ZmId.OP_TEXT="TEXT";
ZmId.OP_TODAY="TODAY";
ZmId.OP_UNDELETE="UNDELETE";
ZmId.OP_UNMUTE_CONV="UNMUTE_CONV";
ZmId.OP_USE_PREFIX="USE_PREFIX";
ZmId.OP_VERSION_HISTORY="VERSION_HISTORY";
ZmId.OP_VIEW="VIEW";
ZmId.OP_VIEW_APPOINTMENT="VIEW_APPOINTMENT";
ZmId.OP_VIEW_APPT_INSTANCE="VIEW_APPT_INSTANCE";
ZmId.OP_VIEW_APPT_SERIES="VIEW_APPT_SERIES";
ZmId.OP_VIEW_BY_DATE="VIEW_BY_DATE";
ZmId.OP_VIEW_FILE_AS_HTML="VIEW_FILE_AS_HTML";
ZmId.OP_VIEW_MENU="VIEW_MENU";
ZmId.OP_SORTBY_MENU="SORTBY_MENU";
ZmId.OP_WEEK_VIEW="WEEK_VIEW";
ZmId.OP_WORK_WEEK_VIEW="WORK_WEEK_VIEW";
ZmId.OP_ZIMLET="ZIMLET";
ZmId.GROUPBY_DATE="GROUPBY_DATE";
ZmId.GROUPBY_FROM="GROUPBY_FROM";
ZmId.GROUPBY_NONE="GROUPBY_NONE";
ZmId.GROUPBY_PRIORITY="GROUPBY_PRIORITY";
ZmId.GROUPBY_SIZE="GROUPBY_SIZE";
ZmId.GROUPBY_TAG="GROUPBY_TAG"
}
if(AjxPackage.define("zimbraMail.share.model.events.ZmEvent")){
ZmEvent=function(e){
this.type=e;
this.event=null;
this.source=null;
this.item=null;
this._details={}
};
ZmEvent.L_MODIFY=1;
ZmEvent.L_PICKER=2;
ZmEvent.S_TAG="TAG";
ZmEvent.S_PICKER="PICKER";
ZmEvent.S_SEARCH="SEARCH";
ZmEvent.S_SETTING="SETTING";
ZmEvent.S_SETTINGS="SETTINGS";
ZmEvent.S_SHARE="SHARE";
ZmEvent.S_MOUNTPOINT="MOUNTPOINT";
ZmEvent.S_ZIMLET="ZIMLET";
ZmEvent.E_CREATE="CREATE";
ZmEvent.E_DELETE="DELETE";
ZmEvent.E_MODIFY="MODIFY";
ZmEvent.E_LOAD="LOAD";
ZmEvent.E_REMOVE="REMOVE";
ZmEvent.E_REMOVE_ALL="REMOVE ALL";
ZmEvent.E_MOVE="MOVE";
ZmEvent.E_FLAGS="FLAGS";
ZmEvent.E_TAGS="TAGS";
ZmEvent.E_ZIMLETS="ZIMLET";
ZmEvent.E_COMPLETE="COMPLETE";
ZmEvent.prototype.toString=function(){
return"ZmEvent"
};
ZmEvent.prototype.set=function(e,t){
this.event=e;
this.source=t;
this.handled=false
};
ZmEvent.prototype.setDetail=function(t,e){
this._details[t]=e
};
ZmEvent.prototype.getDetail=function(e){
return this._details[e]
};
ZmEvent.prototype.getItems=function(){
var e=this._details.items;
return e?e:[]
};
ZmEvent.prototype.setDetails=function(e){
this._details=e?e:{}
};
ZmEvent.prototype.getDetails=function(){
return this._details
}
}
if(AjxPackage.define("zimbraMail.share.model.events.ZmAppEvent")){
ZmAppEvent=function(e){
ZmEvent.call(this)
};
ZmAppEvent.prototype=new ZmEvent;
ZmAppEvent.prototype.constructor=ZmAppEvent;
ZmAppEvent.PRE_STARTUP="PRESTARTUP";
ZmAppEvent.POST_STARTUP="POSTSTARTUP";
ZmAppEvent.PRE_LAUNCH="PRELAUNCH";
ZmAppEvent.POST_LAUNCH="POSTLAUNCH";
ZmAppEvent.POST_RENDER="POSTRENDER";
ZmAppEvent.ACTIVATE="ACTIVATE";
ZmAppEvent.RESPONSE="RESPONSE";
ZmAppEvent.prototype.toString=function(){
return"ZmAppEvent"
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmModel")){
ZmModel=function(e){
if(arguments.length==0){
return
}
this._evt=new ZmEvent(e);
this._evtMgr=new AjxEventMgr()
};
ZmModel.prototype.isZmModel=true;
ZmModel.prototype.toString=function(){
return"ZmModel"
};
ZmModel.prototype.addChangeListener=function(e){
return this._evtMgr.addListener(ZmEvent.L_MODIFY,e)
};
ZmModel.prototype.removeChangeListener=function(e){
return this._evtMgr.removeListener(ZmEvent.L_MODIFY,e)
};
ZmModel.prototype.removeAllChangeListeners=function(){
return this._evtMgr.removeAll(ZmEvent.L_MODIFY)
};
ZmModel.prototype._notify=function(t,e){
if(this._evtMgr.isListenerRegistered(ZmEvent.L_MODIFY)){
this._evt.set(t,this);
this._evt.setDetails(e);
this._evtMgr.notifyListeners(ZmEvent.L_MODIFY,this._evt)
}};
ZmModel.notifyEach=function(o,a,t){
if(!(o&&o.length)){
return
}
for(var e=0;
e<o.length;
e++){
o[e]._notify(a,t)
}}
}
if(AjxPackage.define("zimbraMail.share.model.ZmSetting")){
ZmSetting=function(t,e){
if(arguments.length==0){
return
}
ZmModel.call(this,ZmEvent.S_SETTING);
this.id=t;
this.name=e.name;
this.type=e.type;
this.dataType=e.dataType||ZmSetting.D_STRING;
this.defaultValue=e.defaultValue;
this.canPreset=e.canPreset;
if(this.type==ZmSetting.T_METADATA){
this.section=e.section
}
if(e.isGlobal){
ZmSetting.IS_GLOBAL[t]=true
}
if(e.isImplicit){
ZmSetting.IS_IMPLICIT[t]=true
}
if(this.dataType==ZmSetting.D_HASH){
this.value={};
this.defaultValue={}
}else{
if(this.dataType==ZmSetting.D_LIST){
this.value=[];
this.defaultValue=[]
}else{
this.value=null
}}
this.dontSaveDefault=e.dontSaveDefault
};
ZmSetting.prototype=new ZmModel;
ZmSetting.prototype.constructor=ZmSetting;
ZmSetting.T_CONFIG="config";
ZmSetting.T_COS="cos";
ZmSetting.T_DOMAIN="domain";
ZmSetting.T_METADATA="meta";
ZmSetting.T_PREF="pref";
ZmSetting.T_PSEUDO="pseudo";
ZmSetting.M_IMPLICIT="implicit";
ZmSetting.M_OFFLINE="offline";
ZmSetting.M_ZIMLET="zimlet";
ZmSetting.D_STRING="string";
ZmSetting.D_INT="int";
ZmSetting.D_BOOLEAN="boolean";
ZmSetting.D_LDAP_TIME="ldap_time";
ZmSetting.D_HASH="hash";
ZmSetting.D_LIST="list";
ZmSetting.D_NONE="NONE";
ZmSetting.ACL_AUTH="all";
ZmSetting.ACL_GROUP="grp";
ZmSetting.ACL_NONE="none";
ZmSetting.ACL_PUBLIC="pub";
ZmSetting.ACL_DOMAIN="dom";
ZmSetting.ACL_USER="usr";
ZmSetting.CAL_DAY="day";
ZmSetting.CAL_LIST="list";
ZmSetting.CAL_MONTH="month";
ZmSetting.CAL_WEEK="week";
ZmSetting.CAL_WORK_WEEK="workWeek";
ZmSetting.CAL_VISIBILITY_PRIV="private";
ZmSetting.CAL_VISIBILITY_PUB="public";
ZmSetting.CLIENT_ADVANCED="advanced";
ZmSetting.CLIENT_STANDARD="standard";
ZmSetting.COMPOSE_FONT_COLOR="#000000";
ZmSetting.COMPOSE_FONT_FAM="arial,helvetica,sans-serif";
ZmSetting.COMPOSE_FONT_SIZE=AjxMessageFormat.format(ZmMsg.pt,"12");
ZmSetting.LTR="LTR";
ZmSetting.RTL="RTL";
ZmSetting.COMPOSE_TEXT="text";
ZmSetting.COMPOSE_HTML="html";
ZmSetting.CV_CARDS="cards";
ZmSetting.CV_LIST="list";
ZmSetting.DEDUPE_NONE="dedupeNone";
ZmSetting.DEDUPE_SECOND="secondCopyifOnToOrCC";
ZmSetting.DEDUPE_INBOX="moveSentMessageToInbox";
ZmSetting.DEDUPE_ALL="dedupeAll";
ZmSetting.DELETE_SELECT_NEXT="next";
ZmSetting.DELETE_SELECT_PREV="previous";
ZmSetting.DELETE_SELECT_ADAPT="adaptive";
ZmSetting.GROUP_BY_CONV="conversation";
ZmSetting.GROUP_BY_MESSAGE="message";
ZmSetting.HTTP_DEFAULT_PORT=80;
ZmSetting.HTTPS_DEFAULT_PORT=443;
ZmSetting.INC_NONE="includeNone";
ZmSetting.INC_ATTACH="includeAsAttachment";
ZmSetting.INC_BODY="includeBody";
ZmSetting.INC_BODY_ONLY="includeBodyOnly";
ZmSetting.INC_BODY_PRE="includeBodyWithPrefix";
ZmSetting.INC_BODY_HDR="includeBodyAndHeaders";
ZmSetting.INC_BODY_PRE_HDR="includeBodyAndHeadersWithPrefix";
ZmSetting.INC_SMART="includeSmart";
ZmSetting.INC_SMART_PRE="includeSmartWithPrefix";
ZmSetting.INC_SMART_HDR="includeSmartAndHeaders";
ZmSetting.INC_SMART_PRE_HDR="includeSmartAndHeadersWithPrefix";
ZmSetting.MARK_READ_NONE=-1;
ZmSetting.MARK_READ_NOW=0;
ZmSetting.MARK_READ_TIME=1;
ZmSetting.PRINT_FONT_SIZE=AjxMessageFormat.format(ZmMsg.pt,"12");
ZmSetting.PROTO_HTTP="http:";
ZmSetting.PROTO_HTTPS="https:";
ZmSetting.PROTO_MIXED="mixed:";
ZmSetting.RIGHT_VIEW_FREE_BUSY="viewFreeBusy";
ZmSetting.RIGHT_INVITE="invite";
ZmSetting.RP_BOTTOM="bottom";
ZmSetting.RP_OFF="off";
ZmSetting.RP_RIGHT="right";
ZmSetting.SIG_INTERNET="internet";
ZmSetting.SIG_OUTLOOK="outlook";
ZmSetting.LICENSE_GOOD="OK";
ZmSetting.LICENSE_NOT_INSTALLED="NOT_INSTALLED";
ZmSetting.LICENSE_NOT_ACTIVATED="NOT_ACTIVATED";
ZmSetting.LICENSE_FUTURE="IN_FUTURE";
ZmSetting.LICENSE_EXPIRED="EXPIRED";
ZmSetting.LICENSE_BAD="INVALID";
ZmSetting.LICENSE_GRACE="LICENSE_GRACE_PERIOD";
ZmSetting.LICENSE_ACTIV_GRACE="ACTIVATION_GRACE_PERIOD";
ZmSetting.LICENSE_MSG={};
ZmSetting.LICENSE_MSG[ZmSetting.LICENSE_NOT_INSTALLED]=ZmMsg.licenseNotInstalled;
ZmSetting.LICENSE_MSG[ZmSetting.LICENSE_NOT_ACTIVATED]=ZmMsg.licenseNotActivated;
ZmSetting.LICENSE_MSG[ZmSetting.LICENSE_FUTURE]=ZmMsg.licenseExpired;
ZmSetting.LICENSE_MSG[ZmSetting.LICENSE_EXPIRED]=ZmMsg.licenseExpired;
ZmSetting.LICENSE_MSG[ZmSetting.LICENSE_BAD]=ZmMsg.licenseExpired;
ZmSetting.LOCALE_NAME="LOCALE_NAME";
ZmSetting.COMPOSE_INIT_DIRECTION="COMPOSE_INIT_DIRECTION";
ZmSetting.SHOW_COMPOSE_DIRECTION_BUTTONS="SHOW_COMPOSE_DIRECTION_BUTTONS";
ZmSetting.FONT_NAME="FONT_NAME";
ZmSetting.SKIN_NAME="SKIN_NAME";
ZmSetting.BRIEFCASE_ENABLED="BRIEFCASE_ENABLED";
ZmSetting.CALENDAR_ENABLED="CALENDAR_ENABLED";
ZmSetting.CONTACTS_ENABLED="CONTACTS_ENABLED";
ZmSetting.IM_ENABLED="IM_ENABLED";
ZmSetting.MAIL_ENABLED="MAIL_ENABLED";
ZmSetting.OPTIONS_ENABLED="OPTIONS_ENABLED";
ZmSetting.PORTAL_ENABLED="PORTAL_ENABLED";
ZmSetting.SEARCH_ENABLED="SEARCH_ENABLED";
ZmSetting.TASKS_ENABLED="TASKS_ENABLED";
ZmSetting.VOICE_ENABLED="VOICE_ENABLED";
ZmSetting.TAGGING_ENABLED="TAGGING_ENABLED";
ZmSetting.CALENDAR_UPSELL_ENABLED="CALENDAR_UPSELL_ENABLED";
ZmSetting.CONTACTS_UPSELL_ENABLED="CONTACTS_UPSELL_ENABLED";
ZmSetting.MAIL_UPSELL_ENABLED="MAIL_UPSELL_ENABLED";
ZmSetting.VOICE_UPSELL_ENABLED="VOICE_UPSELL_ENABLED";
ZmSetting.MAIL_SEND_LATER_ENABLED="MAIL_SEND_LATER_ENABLED";
ZmSetting.FONT_CLASSIC="classic";
ZmSetting.FONT_MODERN="modern";
ZmSetting.FONT_WIDE="wide";
ZmSetting.FONT_SYSTEM="system";
ZmSetting.USER_FONT_CLASS="userFontPrefs";
ZmSetting.TASK_FILTER_ALL="";
ZmSetting.TASK_FILTER_TODO="TODO";
ZmSetting.TASK_FILTER_COMPLETED="COMPLETED";
ZmSetting.TASK_FILTER_WAITING="WAITING";
ZmSetting.TASK_FILTER_DEFERRED="DEFERRED";
ZmSetting.TASK_FILTER_INPROGRESS="INPROGRESS";
ZmSetting.TASK_FILTER_NOTSTARTED="NOTSTARTED";
ZmSetting.IS_GLOBAL={};
ZmSetting.IS_IMPLICIT={};
ZmSetting.CHANGED_IMPLICIT={};
ZmSetting.GRANT_RIGHTS_REQUEST="GrantRightsRequest";
ZmSetting.REVOKE_RIGHTS_REQUEST="RevokeRightsRequest";
ZmSetting.SEND_AS="sendAs";
ZmSetting.SEND_ON_BEHALF_OF="sendOnBehalfOf";
ZmSetting.ZM_GRANT_RIGHTS_DIALOG="ZmGrantRightsDialog";
ZmSetting.prototype.toString=function(){
return this.name+": "+this.value
};
ZmSetting.prototype.getValue=function(e,t){
var a=null;
if(this.value!=null){
a=e?this.value[e]:this.value
}else{
if(this.defaultValue!=null){
a=e?this.defaultValue[e]:this.defaultValue
}else{
return null
}}
if(this.dontSaveDefault&&t&&!e){
a=this.getRefinedValue(a)
}
return t?ZmSetting.serialize(a,this.dataType):a
};
ZmSetting.prototype.getRefinedValue=function(a){
if(this.dataType==ZmSetting.D_HASH){
var o={}
,e=this.defaultValue;
for(var t in a){
o[t]=(e[t]!=a[t])?a[t]:""
}
return o
}
return a
};
ZmSetting.prototype.getOrigValue=function(t,a){
var e=null;
if(this.origValue!=null){
e=t?this.origValue[t]:this.origValue
}else{
if(this.defaultValue!=null){
e=t?this.defaultValue[t]:this.defaultValue
}else{
return null
}}
return a?ZmSetting.serialize(e,this.dataType):e
};
ZmSetting.prototype.getDefaultValue=function(e,t){
var a=e?this.defaultValue[e]:this.defaultValue;
return t?ZmSetting.serialize(a,this.dataType):a
};
ZmSetting.prototype.setValue=function(s,r,n,o,l){
var e=s;
var t=Boolean(e!=this.value);
if(this.dataType==ZmSetting.D_STRING){
this.value=e
}else{
if(this.dataType==ZmSetting.D_INT){
e=parseInt(s);
if(isNaN(e)){
e=s
}
t=Boolean(e!=this.value);
this.value=e
}else{
if(this.dataType==ZmSetting.D_BOOLEAN){
if(typeof(e)=="string"){
e=(e.toLowerCase()==="true")
}
t=Boolean(e!=this.value);
this.value=e
}else{
if(this.dataType==ZmSetting.D_LDAP_TIME){
var h=(e.toLowerCase)?h=(e.toLowerCase()).charAt(e.length-1):null;
var a=parseInt(e);
if(h=="d"){
e=a*24*60*60
}else{
if(h=="h"){
e=a*60*60
}else{
if(h=="m"){
e=a*60
}else{
e=a
}}}
t=Boolean(e!=this.value);
this.value=e
}else{
if(this.dataType==ZmSetting.D_HASH){
t=true;
if(r){
if(e){
t=Boolean(e!=this.value[r]);
this.value[r]=e
}else{
delete this.value[r]
}}else{
this.value=e
}}else{
if(this.dataType==ZmSetting.D_LIST){
if(e instanceof Array){
this.value=e
}else{
this.value.push(e)
}
t=true
}}}}}}
if(n){
if(r){
this.defaultValue[r]=this.value[r]
}else{
this.defaultValue=this.value
}}
if(ZmSetting.IS_IMPLICIT[this.id]&&t&&!l){
if(o){
ZmSetting.CHANGED_IMPLICIT[this.id]=true
}else{
this._notify(ZmEvent.E_MODIFY,r);
return
}}
if(!this.name&&!o){
this._notify(ZmEvent.E_MODIFY,r)
}};
ZmSetting.prototype.notifyModify=function(e){
if(this.id==ZmSetting.QUOTA_USED&&e._name=="mbx"&&e.s!=null){
this.setValue(e.s);
this._notify(ZmEvent.E_MODIFY,{
account:e.account}
)
}};
ZmSetting.prototype.copyValue=function(){
if(this.dataType==ZmSetting.D_HASH){
return AjxUtil.hashCopy(this.value)
}else{
if(this.dataType==ZmSetting.D_LIST){
return this.value.concat()
}else{
return this.value
}}};
ZmSetting.serialize=function(s,e){
if(e==ZmSetting.D_BOOLEAN){
s=s?"TRUE":"FALSE"
}else{
if(e==ZmSetting.D_HASH){
var o=[];
for(var a in s){
o.push(a)
}
o.sort();
var n=[];
for(var t=0;
t<o.length;
t++){
var a=o[t];
n.push([a,s[a]].join(":"))
}
s=n.join(",")
}else{
if(e==ZmSetting.D_LIST){
s=s.join(",")
}}}
return s
}
}
if(AjxPackage.define("zimbraMail.core.ZmAppCtxt")){
ZmAppCtxt=function(){
this._trees={};
this.accountList=new ZmAccountList();
this.accountList.add(new ZmZimbraAccount(ZmAccountList.DEFAULT_ID,null,false));
this.inStartup=false;
this.currentRequestParams=null;
this.rememberMe=null;
this.userDomain="";
this.isFamilyMbox=false;
this.multiAccounts=false;
this.sendAsEmails=[];
this.sendOboEmails=[];
this._evtMgr=new AjxEventMgr();
this._itemCache={};
this._itemCacheDeferred={};
this._acCache={};
this._isExpandableDL={};
this._setAuthTokenWarning()
};
ZmAppCtxt.ONE_MINUTE=60*1000;
ZmAppCtxt.MAX_TIMEOUT_VALUE=2147483647;
ZmAppCtxt._ZIMLETS_EVENT="ZIMLETS";
ZmAppCtxt.prototype.toString=function(){
return"ZmAppCtxt"
};
ZmAppCtxt.prototype._setAuthTokenWarning=function(o){
var e=o||window.authTokenTimeLeftInMillis;
var a=Math.floor(e/ZmAppCtxt.ONE_MINUTE);
var t=Math.min(5,a-1);
if(t==0){
return
}
var n=e-ZmAppCtxt.ONE_MINUTE*t;
if(n>0){
if(n<=ZmAppCtxt.MAX_TIMEOUT_VALUE){
window.setTimeout(this._authTokenWarningTimeout.bind(this,t),n)
}else{
window.setTimeout(this._setAuthTokenWarning.bind(this,e-ZmAppCtxt.MAX_TIMEOUT_VALUE),ZmAppCtxt.MAX_TIMEOUT_VALUE)
}}};
ZmAppCtxt.prototype._authTokenWarningTimeout=function(a){
var t=AjxMessageFormat.format(ZmMsg.authTokenExpirationWarning,[a,a>1?ZmMsg.minutes:ZmMsg.minute]);
var e={
msg:t,level:ZmStatusView.LEVEL_WARNING,transitions:[{
type:"fade-in",duration:500}
,{
type:"pause",duration:ZmAppCtxt.ONE_MINUTE/4}
,{
type:"fade-out",duration:500}
]};
this.setStatusMsg(e);
if(a>1){
window.setTimeout(this._authTokenWarningTimeout.bind(this,a-1),ZmAppCtxt.ONE_MINUTE)
}};
ZmAppCtxt.prototype.setAppController=function(e){
this._appController=e
};
ZmAppCtxt.prototype.getAppController=function(){
return this._appController
};
ZmAppCtxt.prototype.getAppChooser=function(){
return this._appController.getAppChooser()
};
ZmAppCtxt.prototype.setRequestMgr=function(e){
this._requestMgr=e
};
ZmAppCtxt.prototype.getRequestMgr=function(){
return this._requestMgr
};
ZmAppCtxt.prototype.setStatusMsg=function(e){
e=Dwt.getParams(arguments,ZmStatusView.MSG_PARAMS);
this._appController.setStatusMsg(e)
};
ZmAppCtxt.prototype.dismissStatusMsg=function(e){
this._appController.dismissStatusMsg(e)
};
ZmAppCtxt.prototype.getSettings=function(e){
var t=this.accountList;
var a=e||t.activeAccount||t.mainAccount||t.getAccount(ZmAccountList.DEFAULT_ID);
return a&&a.settings
};
ZmAppCtxt.prototype.setSettings=function(e,t){
var a=this.accountList;
var n=t?t.id:a.activeAccount?a.activeAccount.id:ZmAccountList.DEFAULT_ID;
var o=a.getAccount(n);
if(o){
o.settings=e
}};
ZmAppCtxt.prototype.get=function(n,t,a){
if(n==ZmSetting.IM_ENABLED){
return false
}
var e=this.isChildWindow?parentAppCtxt:this;
var o=(e.multiAccounts&&ZmSetting.IS_GLOBAL[n])?e.accountList.mainAccount:a;
return e.getSettings(o).get(n,t)
};
ZmAppCtxt.prototype.set=function(e,s,r,n,a,t,l){
var o=(this.multiAccounts&&ZmSetting.IS_GLOBAL[e])?this.accountList.mainAccount:t;
var h=this.getSettings(o).getSetting(e);
if(h){
h.setValue(s,r,n,a,l)
}};
ZmAppCtxt.prototype.getApp=function(e){
return this._appController.getApp(e)
};
ZmAppCtxt.prototype.getCurrentAppName=function(){
var e=this.isChildWindow?parentAppCtxt:this;
return e._appController.getActiveApp()
};
ZmAppCtxt.prototype.getLoggedInUsername=function(){
return appCtxt.get(ZmSetting.USERNAME)
};
ZmAppCtxt.prototype.getCurrentApp=function(){
return this.getApp(this.getCurrentAppName())
};
ZmAppCtxt.prototype.getAppViewMgr=function(){
return this._appController.getAppViewMgr()
};
ZmAppCtxt.prototype.getClientCmdHandler=function(e){
if(!this._clientCmdHandler){
AjxDispatcher.require("Extras");
this._clientCmdHandler=new ZmClientCmdHandler()
}
return this._clientCmdHandler
};
ZmAppCtxt.prototype.getSearchController=function(){
if(!this._searchController){
this._searchController=new ZmSearchController(this._shell)
}
return this._searchController
};
ZmAppCtxt.prototype.getOverviewController=function(e){
if(!this._overviewController){
if(e){
return null
}
this._overviewController=new ZmOverviewController(this._shell)
}
return this._overviewController
};
ZmAppCtxt.prototype.getImportExportController=function(){
if(!this._importExportController){
AjxDispatcher.require("ImportExport");
this._importExportController=new ZmImportExportController()
}
return this._importExportController
};
ZmAppCtxt.prototype.getMsgDialog=function(){
if(!this._msgDialog){
this._msgDialog=new DwtMessageDialog({
parent:this._shell,id:"ZmMsgDialog"}
)
}
return this._msgDialog
};
ZmAppCtxt.prototype.getYesNoMsgDialog=function(e){
if(!this._yesNoMsgDialog){
this._yesNoMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],id:"YesNoMsgDialog"}
)
}
return this._yesNoMsgDialog
};
ZmAppCtxt.prototype.getYesNoCancelMsgDialog=function(){
if(!this._yesNoCancelMsgDialog){
this._yesNoCancelMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.CANCEL_BUTTON],id:"YesNoCancel"}
)
}
return this._yesNoCancelMsgDialog
};
ZmAppCtxt.prototype.getOkCancelMsgDialog=function(){
if(!this._okCancelMsgDialog){
this._okCancelMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON],id:"OkCancel"}
)
}
return this._okCancelMsgDialog
};
ZmAppCtxt.prototype.getCancelMsgDialog=function(){
if(!this._cancelMsgDialog){
this._cancelMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.CANCEL_BUTTON]}
)
}
return this._cancelMsgDialog
};
ZmAppCtxt.prototype.getErrorDialog=function(){
if(!this._errorDialog){
AjxDispatcher.require("Startup2");
this._errorDialog=new ZmErrorDialog(this._shell,ZmMsg)
}
return this._errorDialog
};
ZmAppCtxt.prototype.getNewTagDialog=function(){
if(!this._newTagDialog){
this._newTagDialog=new ZmNewTagDialog(this._shell)
}
return this._newTagDialog
};
ZmAppCtxt.prototype.getNewContactGroupDialog=function(){
if(!this._newContactGroupDialog){
this._newContactGroupDialog=new ZmNewContactGroupDialog(this._shell)
}
return this._newContactGroupDialog
};
ZmAppCtxt.prototype.getRenameTagDialog=function(){
if(!this._renameTagDialog){
AjxDispatcher.require("Extras");
this._renameTagDialog=new ZmRenameTagDialog(this._shell)
}
return this._renameTagDialog
};
ZmAppCtxt.prototype.getPasswordChangeDialog=function(){
if(!this._passwordUpdateDialog){
AjxDispatcher.require("Extras");
this._passwordUpdateDialog=new ZmPasswordUpdateDialog(this._shell)
}
return this._passwordUpdateDialog
};
ZmAppCtxt.prototype.getNewFolderDialog=function(){
if(!this._newFolderDialog){
var t=ZmMsg.createNewFolder;
var e=ZmOrganizer.FOLDER;
this._newFolderDialog=new ZmNewOrganizerDialog(this._shell,null,t,e)
}
return this._newFolderDialog
};
ZmAppCtxt.prototype.getNewAddrBookDialog=function(){
if(!this._newAddrBookDialog){
AjxDispatcher.require("Contacts");
this._newAddrBookDialog=new ZmNewAddrBookDialog(this._shell)
}
return this._newAddrBookDialog
};
ZmAppCtxt.prototype.getNewCalendarDialog=function(){
if(!this._newCalendarDialog){
AjxDispatcher.require(["CalendarCore","Calendar","CalendarAppt"]);
this._newCalendarDialog=new ZmNewCalendarDialog(this._shell)
}
return this._newCalendarDialog
};
ZmAppCtxt.prototype.getNewTaskFolderDialog=function(){
if(!this._newTaskFolderDialog){
AjxDispatcher.require(["TasksCore","Tasks"]);
this._newTaskFolderDialog=new ZmNewTaskFolderDialog(this._shell)
}
return this._newTaskFolderDialog
};
ZmAppCtxt.prototype.getSuggestionPreferenceDialog=function(){
if(!this._suggestionPrefDialog){
AjxDispatcher.require(["CalendarCore","Calendar"]);
this._suggestionPrefDialog=new ZmTimeSuggestionPrefDialog(this._shell)
}
return this._suggestionPrefDialog
};
ZmAppCtxt.prototype.getDialog=function(){
if(!this._dialog){
this._dialog=new DwtDialog({
parent:this._shell}
)
}
return this._dialog
};
ZmAppCtxt.prototype.getNewSearchDialog=function(){
if(!this._newSearchDialog){
this._newSearchDialog=new ZmNewSearchDialog(this._shell)
}
return this._newSearchDialog
};
ZmAppCtxt.prototype.getRenameFolderDialog=function(){
if(!this._renameFolderDialog){
AjxDispatcher.require("Extras");
this._renameFolderDialog=new ZmRenameFolderDialog(this._shell)
}
return this._renameFolderDialog
};
ZmAppCtxt.prototype.getChooseFolderDialog=function(){
if(!this._chooseFolderDialog){
AjxDispatcher.require("Extras");
this._chooseFolderDialog=new ZmChooseFolderDialog(this._shell)
}
return this._chooseFolderDialog
};
ZmAppCtxt.prototype.getChooseAccountDialog=function(){
if(!this._chooseAccountDialog){
AjxDispatcher.require("Extras");
this._chooseAccountDialog=new ZmChooseAccountDialog(this._shell)
}
return this._chooseAccountDialog
};
ZmAppCtxt.prototype.getPickTagDialog=function(){
if(!this._pickTagDialog){
AjxDispatcher.require("Extras");
this._pickTagDialog=new ZmPickTagDialog(this._shell)
}
return this._pickTagDialog
};
ZmAppCtxt.prototype.getFolderNotifyDialog=function(){
if(!this._folderNotifyDialog){
this._folderNotifyDialog=new ZmFolderNotifyDialog(this._shell)
}
return this._folderNotifyDialog
};
ZmAppCtxt.prototype.getFolderPropsDialog=function(){
if(!this._folderPropsDialog){
this._folderPropsDialog=new ZmFolderPropsDialog(this._shell)
}
return this._folderPropsDialog
};
ZmAppCtxt.prototype.getLinkPropsDialog=function(){
if(!this._linkPropsDialog){
AjxDispatcher.require("Extras");
this._linkPropsDialog=new ZmLinkPropsDialog(this._shell)
}
return this._linkPropsDialog
};
ZmAppCtxt.prototype.getSharePropsDialog=function(){
if(!this._sharePropsDialog){
AjxDispatcher.require("Share");
this._sharePropsDialog=new ZmSharePropsDialog(this._shell)
}
return this._sharePropsDialog
};
ZmAppCtxt.prototype.getShareSearchDialog=function(){
if(!this._shareSearchDialog){
AjxDispatcher.require("Share");
this._shareSearchDialog=new ZmShareSearchDialog({
parent:this._shell}
)
}
return this._shareSearchDialog
};
ZmAppCtxt.prototype.getAcceptShareDialog=function(){
if(!this._acceptShareDialog){
AjxDispatcher.require("Share");
this._acceptShareDialog=new ZmAcceptShareDialog(this._shell)
}
return this._acceptShareDialog
};
ZmAppCtxt.prototype.getDeclineShareDialog=function(){
if(!this._declineShareDialog){
AjxDispatcher.require("Share");
this._declineShareDialog=new ZmDeclineShareDialog(this._shell)
}
return this._declineShareDialog
};
ZmAppCtxt.prototype.getRevokeShareDialog=function(){
if(!this._revokeShareDialog){
AjxDispatcher.require("Share");
this._revokeShareDialog=new ZmRevokeShareDialog(this._shell)
}
return this._revokeShareDialog
};
ZmAppCtxt.prototype.getTimezonePickerDialog=function(){
if(!this._timezonePickerDialog){
AjxDispatcher.require("Share");
this._timezonePickerDialog=new ZmTimezonePicker(this._shell)
}
return this._timezonePickerDialog
};
ZmAppCtxt.prototype.getFilterRuleDialog=function(){
if(!this._filterRuleDialog){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
this._filterRuleDialog=new ZmFilterRuleDialog()
}
return this._filterRuleDialog
};
ZmAppCtxt.prototype.getPriorityMessageFilterDialog=function(){
if(!this._priorityMessageFilterDialog){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
this._priorityMessageFilterDialog=new ZmPriorityMessageFilterDialog()
}
return this._priorityMessageFilterDialog
};
ZmAppCtxt.prototype.getActivityStreamFilterDialog=function(){
if(!this._activityStreamFilterDialog){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
this._activityStreamFilterDialog=new ZmActivityStreamPromptDialog()
}
return this._activityStreamFilterDialog
};
ZmAppCtxt.prototype.getActivityToInboxFilterDialog=function(){
if(!this._activityToInboxFilterDialog){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
this._activityToInboxFilterDialog=new ZmActivityToInboxPromptDialog()
}
return this._activityToInboxFilterDialog
};
ZmAppCtxt.prototype.getContactQuickAddDialog=function(){
if(!this._contactQuickAddDialog){
AjxDispatcher.require(["ContactsCore","Contacts"]);
this._contactQuickAddDialog=new ZmContactQuickAddDialog()
}
return this._contactQuickAddDialog
};
ZmAppCtxt.prototype.getConfirmationDialog=function(e){
if(!this._confirmDialog){
this._confirmDialog=new DwtConfirmDialog(this._shell,null,"CONFIRM_DIALOG")
}
return this._confirmDialog
};
ZmAppCtxt.prototype.getUploadDialog=function(){
if(!this._uploadDialog){
AjxDispatcher.require(["Extras"]);
this._uploadDialog=new ZmUploadDialog(this._shell)
}
return this._uploadDialog
};
ZmAppCtxt.prototype.getAttachDialog=function(){
if(!this._attachDialog){
AjxDispatcher.require("Share");
this._attachDialog=new ZmAttachDialog(this._shell);
this.runAttachDialogCallbacks()
}
return this._attachDialog
};
ZmAppCtxt.prototype.getDumpsterDialog=function(){
if(!this._dumpsterDialog){
AjxDispatcher.require("Extras");
this._dumpsterDialog=new ZmDumpsterDialog(this._shell)
}
return this._dumpsterDialog
};
ZmAppCtxt.prototype.getMailRedirectDialog=function(){
if(!this._mailRedirectDialog){
this._mailRedirectDialog=new ZmMailRedirectDialog(this._shell)
}
return this._mailRedirectDialog
};
ZmAppCtxt.prototype.getRetentionWarningDialog=function(){
if(!this._retentionWarningDialog){
this._retentionWarningDialog=new ZmRetentionWarningDialog(this._shell)
}
return this._retentionWarningDialog
};
ZmAppCtxt.prototype.runAttachDialogCallbacks=function(){
while(this._attachDialogCallback&&this._attachDialogCallback.length>0){
var e=this._attachDialogCallback.shift();
if(e&&(e instanceof AjxCallback)){
e.run(this._attachDialog)
}}};
ZmAppCtxt.prototype.addAttachmentDialogCallback=function(e){
if(!this._attachDialogCallback){
this._attachDialogCallback=[]
}
this._attachDialogCallback.push(e)
};
ZmAppCtxt.prototype.getUploadConflictDialog=function(){
if(!this._uploadConflictDialog){
AjxDispatcher.require(["Extras"]);
this._uploadConflictDialog=new ZmUploadConflictDialog(this._shell)
}
return this._uploadConflictDialog
};
ZmAppCtxt.prototype.getNewBriefcaseDialog=function(){
if(!this._newBriefcaseDialog){
AjxDispatcher.require(["BriefcaseCore","Briefcase"]);
this._newBriefcaseDialog=new ZmNewBriefcaseDialog(this._shell)
}
return this._newBriefcaseDialog
};
ZmAppCtxt.prototype.getReplaceDialog=function(){
if(!this._replaceDialog){
AjxDispatcher.require("Share");
this._replaceDialog=new ZmFindnReplaceDialog(this._shell)
}
return this._replaceDialog
};
ZmAppCtxt.prototype.getAddrSelectDialog=function(){
if(!this._addrSelectDialog){
AjxDispatcher.require(["Startup2","MailCore","Mail"]);
this._addrSelectDialog=new ZmSelectAddrDialog(this._shell)
}
return this._addrSelectDialog
};
ZmAppCtxt.prototype.getDebugLogDialog=function(){
if(!this._debugLogDialog){
AjxDispatcher.require("Extras");
this._debugLogDialog=new ZmDebugLogDialog(this._shell)
}
return this._debugLogDialog
};
ZmAppCtxt.prototype.getRootTabGroup=function(){
if(this.isChildWindow){
if(!this._childWinTabGrp){
this._childWinTabGrp=new DwtTabGroup("CHILD_WINDOW")
}}else{
if(!this._rootTabGrp){
this._rootTabGrp=new DwtTabGroup("ROOT")
}}
return this.isChildWindow?this._childWinTabGrp:this._rootTabGrp
};
ZmAppCtxt.prototype.getShell=function(){
return this._shell
};
ZmAppCtxt.prototype.setShell=function(e){
this._shell=e
};
ZmAppCtxt.prototype.getActiveAccount=function(){
return this.isChildWindow?parentAppCtxt.accountList.activeAccount:this.accountList.activeAccount
};
ZmAppCtxt.prototype.isExternalAccount=function(){
return this.get(ZmSetting.IS_EXTERNAL)
};
ZmAppCtxt.prototype.getIdentityCollection=function(t){
var e=this.isChildWindow?window.opener:window;
return e.AjxDispatcher.run("GetIdentityCollection",t)
};
ZmAppCtxt.prototype.getDataSourceCollection=function(t){
var e=this.isChildWindow?window.opener:window;
return e.AjxDispatcher.run("GetDataSourceCollection",t)
};
ZmAppCtxt.prototype.getSignatureCollection=function(t){
var e=this.isChildWindow?window.opener:window;
return e.AjxDispatcher.run("GetSignatureCollection",t)
};
ZmAppCtxt.prototype.getTree=function(e,t){
if(this.isChildWindow){
return parentAppCtxt.getTree(e,t)
}
var a=this.accountList;
var n=t?t.id:a.activeAccount?a.activeAccount.id:ZmAccountList.DEFAULT_ID;
var o=a.getAccount(n);
return o&&o.trees[ZmOrganizer.TREE_TYPE[e]]
};
ZmAppCtxt.prototype.setTree=function(t,e,a){
var o=this.accountList;
var s=a?a.id:o.activeAccount?o.activeAccount.id:ZmAccountList.DEFAULT_ID;
var n=this.accountList.getAccount(s);
if(n){
n.trees[t]=e
}};
ZmAppCtxt.prototype.getFolderTree=function(e){
return this.getTree(ZmOrganizer.FOLDER,e)
};
ZmAppCtxt.prototype.getTagTree=function(e){
return this.getTree(ZmOrganizer.TAG,e)
};
ZmAppCtxt.prototype.getAccountTagList=function(e){
var t=(e&&appCtxt.multiAccounts)?e.getAccount():null;
return this.getTagTree(t).root
};
ZmAppCtxt.prototype.getZimletTree=function(e){
return this.getTree(ZmOrganizer.ZIMLET,e)
};
ZmAppCtxt.prototype.getUsername=function(e){
return this.get(ZmSetting.USERNAME,e)
};
ZmAppCtxt.prototype.getUserDomain=function(e){
if(!this.userDomain){
var a=this.getUsername(e);
if(a){
var t=a.split("@");
this.userDomain=(t&&t.length)?t[1]:""
}}
return this.userDomain
};
ZmAppCtxt.prototype.getUploadFrameId=function(){
if(!this._uploadManagerIframeId){
var a=Dwt.getNextId();
var e=["<iframe name='",a,"' id='",a,"' src='",(AjxEnv.isIE&&location.protocol=="https:")?appContextPath+"/public/blank.html":'javascript:""',"' style='position: absolute; top: 0; left: 0; visibility: hidden'></iframe>"];
var t=document.createElement("div");
t.innerHTML=e.join("");
document.body.appendChild(t.firstChild);
this._uploadManagerIframeId=a
}
return this._uploadManagerIframeId
};
ZmAppCtxt.prototype.getUploadManager=function(){
if(!this._uploadManager){
this._uploadManager=new AjxPost(this.getUploadFrameId())
}
return this._uploadManager
};
ZmAppCtxt.prototype.getCurrentSearch=function(){
var t=this.getCurrentApp();
if(t&&t.currentSearch){
return t.currentSearch
}
var e=this.getCurrentController();
return e&&e._currentSearch
};
ZmAppCtxt.prototype.getCurrentViewId=function(){
var e=this.getAppViewMgr().getCurrentViewId();
if(e&&e.indexOf(ZmId.VIEW_SEARCH_RESULTS)===0){
e=this.getCurrentController().getCurrentViewId()
}
return e
};
ZmAppCtxt.prototype.getCurrentViewType=function(){
var e=this.getAppViewMgr().getCurrentViewType();
if(e&&e.indexOf(ZmId.VIEW_SEARCH_RESULTS)===0){
e=this.getCurrentController().getCurrentViewType()
}
return e
};
ZmAppCtxt.prototype.getViewTypeFromId=function(e){
var t=e&&e.split(ZmController.SESSION_ID_SEP);
return t?t[0]:""
};
ZmAppCtxt.prototype.getCurrentView=function(){
return this.getAppViewMgr().getCurrentView()
};
ZmAppCtxt.prototype.getCurrentController=function(){
var e=this.getCurrentView();
return(e&&e.getController)?e.getController():null
};
ZmAppCtxt.prototype.setCurrentList=function(e){
this._list=e
};
ZmAppCtxt.prototype.getCurrentList=function(){
var e=this.getCurrentController();
return(e&&e.getList)?e.getList():this._list?this._list:null
};
ZmAppCtxt.prototype.getActionController=function(){
if(!this._actionController&&!this.isChildWindow){
this._actionController=new ZmActionController()
}
return this._actionController
};
ZmAppCtxt.prototype.getNewWindow=function(h,r,e,n){
var o=[];
var s=0;
o[s++]=document.location.protocol;
o[s++]="//";
o[s++]=location.hostname;
o[s++]=(!location.port||location.port=="80")?"":(":"+location.port);
o[s++]=appContextPath;
o[s++]="/public/launchNewWindow.jsp?skin=";
o[s++]=appCurrentSkin;
o[s++]="&localeId=";
o[s++]=AjxEnv.DEFAULT_LOCALE||"";
if(h){
o[s++]="&full=1"
}
if(window.appDevMode){
o[s++]="&dev=1"
}
if(window.appCoverageMode){
o[s++]="&coverage=1"
}
n=n||"_blank";
r=r||705;
e=e||465;
var a=["height=",e,",width=",r,",location=no,menubar=no,resizable=yes,scrollbars=no,status=yes,toolbar=no"].join("");
if(window.appDevMode){
a=["height=",e,",width=",r,",location=yes,menubar=yes,resizable=yes,scrollbars=no,status=yes,toolbar=yes"].join("")
}
var t=window.open(o.join(""),n,a);
this.handlePopupBlocker(t);
if(t){
return this.getAppController().addChildWindow(t)
}};
ZmAppCtxt.prototype.handlePopupBlocker=function(e){
if(!e){
this.setStatusMsg(ZmMsg.popupBlocker,ZmStatusView.LEVEL_CRITICAL)
}else{
if(e&&AjxEnv.isChrome){
setTimeout(function(){
if(e.innerHeight==0){
appCtxt.setStatusMsg(ZmMsg.popupBlocker,ZmStatusView.LEVEL_CRITICAL)
}}
,50)
}}};
ZmAppCtxt.prototype.cacheSet=function(e,t){
this._itemCache[e]=t;
delete this._itemCacheDeferred[e]
};
ZmAppCtxt.prototype.cacheSetDeferred=function(t,e){
this._itemCache[t]=this._itemCacheDeferred;
this._itemCacheDeferred[t]=e
};
ZmAppCtxt.prototype.cacheGet=function(t){
var a=this._itemCache[t];
if(a===this._itemCacheDeferred){
var e=this._itemCacheDeferred[t];
this.getApp(e).createDeferred();
a=this._itemCache[t]
}
return a
};
ZmAppCtxt.prototype.cacheRemove=function(e){
delete this._itemCache[e];
delete this._itemCacheDeferred[e]
};
ZmAppCtxt.prototype.getById=function(e){
return this.cacheGet(e)||(this.isChildWindow&&window.opener.appCtxt.getById(e))
};
ZmAppCtxt.prototype.getKeyboardMgr=function(){
return this._shell.getKeyboardMgr()
};
ZmAppCtxt.prototype.getHistoryMgr=function(){
if(!this._historyMgr){
this._historyMgr=new AjxHistoryMgr()
}
return this._historyMgr
};
ZmAppCtxt.prototype.zimletsPresent=function(){
return this._zimletsPresent
};
ZmAppCtxt.prototype.setZimletsPresent=function(e){
this._zimletsPresent=e
};
ZmAppCtxt.prototype.getZimletMgr=function(){
if(!this._zimletMgr){
AjxDispatcher.require("Zimlet");
if(!this._zimletMgr){
this._zimletMgr=new ZmZimletMgr()
}}
return this._zimletMgr
};
ZmAppCtxt.prototype.areZimletsLoaded=function(){
return this._zimletsLoaded
};
ZmAppCtxt.prototype.addZimletsLoadedListener=function(t,e){
if(!this._zimletsLoaded){
return this._evtMgr.addListener(ZmAppCtxt._ZIMLETS_EVENT,t,e)
}};
ZmAppCtxt.prototype.allZimletsLoaded=function(){
this._zimletsLoaded=true;
if(this._zimletMgr&&!this.isChildWindow&&appCtxt.get(ZmSetting.PORTAL_ENABLED)){
var e=this.getApp(ZmApp.PORTAL).getPortletMgr();
if(e){
e.allZimletsLoaded()
}}
if(this._evtMgr.isListenerRegistered(ZmAppCtxt._ZIMLETS_EVENT)){
this._evtMgr.notifyListeners(ZmAppCtxt._ZIMLETS_EVENT,new ZmEvent());
this._evtMgr.removeAll(ZmAppCtxt._ZIMLETS_EVENT)
}};
ZmAppCtxt.prototype.notifyZimlets=function(o,t,e){
this.notifySkin(o,t,e);
var a=this.isChildWindow?parentAppCtxt:this;
if(e&&e.noChildWindow&&this.isChildWindow){
return false
}
if(!a.areZimletsLoaded()){
if(e&&e.waitUntilLoaded){
a.addZimletsLoadedListener(new AjxListener(this,this.notifyZimlets,[o,t]))
}
return false
}
return this.getZimletMgr().notifyZimlets(o,t)
};
ZmAppCtxt.prototype.notifyZimlet=function(o,a,t,e){
if(e&&e.noChildWindow&&this.isChildWindow){
return false
}
return this.getZimletMgr().notifyZimlet(o,a,t)
};
ZmAppCtxt.prototype.notifySkin=function(n,a,t){
var o=this.isChildWindow?parentAppCtxt:this;
if(t&&t.noChildWindow&&this.isChildWindow){
return
}
try{
return window.skin&&AjxUtil.isFunction(window.skin.handleNotification)&&window.skin.handleNotification(n,a)
}
catch(s){}};
ZmAppCtxt.prototype.getCalManager=function(){
if(!this._calMgr){
this._calMgr=new ZmCalMgr(this._shell)
}
return this._calMgr
};
ZmAppCtxt.prototype.getTaskManager=function(){
if(!this._taskMgr){
this._taskMgr=new ZmTaskMgr(this._shell)
}
return this._taskMgr
};
ZmAppCtxt.prototype.getACL=function(e,n){
var t=this.accountList;
var o=e?e.id:t.activeAccount?t.activeAccount.id:ZmAccountList.DEFAULT_ID;
var a=t.getAccount(o);
return a&&a.acl
};
ZmAppCtxt.prototype.getShortcutHint=function(r,e){
var s=null;
r=r||"global";
while(!s&&r){
var o=[r,e,"display"].join(".");
var s=AjxKeys[o]||ZmKeys[o];
if(s){
var a=s.split(/;\s*/);
var n=a[0];
if(!n){
return null
}
n=n.replace(/\b[A-Z]\b/g,function(h){
return h.toLowerCase()
}
);
s=[" [",n.replace(",",""),"]"].join("")
}else{
var t=[r,"INHERIT"].join(".");
r=AjxKeys[t]||ZmKeys[t]
}}
return s
};
ZmAppCtxt.prototype.getShortcutsPanel=function(){
if(!this._shortcutsPanel){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
var e=this.isChildWindow?ZmShortcutList.WINDOW_STYLE:ZmShortcutList.PANEL_STYLE;
this._shortcutsPanel=new ZmShortcutsPanel(e)
}
return this._shortcutsPanel
};
ZmAppCtxt.prototype.getChangePasswordWindow=function(r){
var e=appCtxt.get(ZmSetting.CHANGE_PASSWORD_URL);
if(!e){
var o=appCtxt.get(ZmSetting.PROTOCOL_MODE)==ZmSetting.PROTO_HTTP;
var n=o?ZmSetting.PROTO_HTTP:ZmSetting.PROTO_HTTPS;
var t=appCtxt.get(o?ZmSetting.HTTP_PORT:ZmSetting.HTTPS_PORT);
var c=appContextPath+"/h/changepass";
var h=appCtxt.get(ZmSetting.PUBLIC_URL);
if(h){
var a=AjxStringUtil.parseURL(h);
c=a.path+"/h/changepass";
var l=(a.protocol=="http"&&n==ZmSetting.PROTO_HTTPS);
n=l?n:a.protocol;
t=l?t:a.port
}
e=AjxUtil.formatUrl({
protocol:n,port:t,path:c,qsReset:true}
)
}
var s="height=465,width=705,location=no,menubar=no,resizable=yes,scrollbars=no,status=yes,toolbar=no";
window.open(e,"ChangePasswordWindow",s)
};
ZmAppCtxt.prototype.getSkinHint=function(){
if(arguments.length==0){
return""
}
var a=window.skin&&window.skin.hints;
if(!a){
return""
}
for(var t=0;
t<arguments.length;
t++){
var e=arguments[t];
if(!a[e]){
return""
}
a=a[e]
}
return a
};
ZmAppCtxt.prototype.getAutocompleter=function(){
if(!this._autocompleter){
this._autocompleter=new ZmAutocomplete(null)
}
return this._autocompleter
};
ZmAppCtxt.prototype.isMyAddress=function(n,a,e){
if(a&&(n.indexOf("@")==-1)){
n=[n,this.getUserDomain()].join("@")
}
if(n==this.get(ZmSetting.USERNAME)){
return true
}
var o;
if(e){
o=appCtxt.get(ZmSetting.MAIL_ALIASES)
}else{
o=appCtxt.get(ZmSetting.MAIL_ALIASES).concat(appCtxt.get(ZmSetting.ALLOW_FROM_ADDRESSES))
}
if(o&&o.length){
for(var t=0;
t<o.length;
t++){
if(n==o[t]){
return true
}}}
return false
};
ZmAppCtxt.prototype.getOverviewId=function(t,e){
var a=(t instanceof Array)?t.join("_"):t;
if(appCtxt.multiAccounts&&(e!==null)){
e=e||appCtxt.getActiveAccount();
a=[e.name,a].join(":")
}
return a
};
ZmAppCtxt.prototype.getAutocompleteCache=function(a,n,o,t){
var e=null;
var s=o||this.getActiveAccount();
if(s){
if(this._acCache[s.id]&&this._acCache[s.id][a]){
e=this._acCache[s.id][a][n]
}}
if(!e&&t){
if(s&&!this._acCache[s.id]){
this._acCache[s.id]={}
}
if(!this._acCache[s.id][a]){
this._acCache[s.id][a]={}
}
e=this._acCache[s.id][a][n]={}
}
return e
};
ZmAppCtxt.prototype.clearAutocompleteCache=function(e,t){
var a=t||appCtxt.getActiveAccount();
if(this._acCache[a.id]){
if(e){
this._acCache[a.id][e]={}
}else{
this._acCache[a.id][ZmAutocomplete.AC_TYPE_CONTACT]={};
this._acCache[a.id][ZmAutocomplete.AC_TYPE_LOCATION]={};
this._acCache[a.id][ZmAutocomplete.AC_TYPE_EQUIPMENT]={}
}}};
ZmAppCtxt.prototype.getOutsideMouseEventMgr=function(){
return DwtOutsideMouseEventMgr.INSTANCE
};
ZmAppCtxt.prototype.getCharset=function(){
var e=AjxEnv.isIE?window.navigator.systemLanguage:window.navigator.language;
if((AjxEnv.DEFAULT_LOCALE=="ja"||e=="ja")&&AjxEnv.isWindows){
return"Windows-31J"
}else{
return"UTF-8"
}};
ZmAppCtxt.prototype.isExpandableDL=function(e){
return e&&this._isExpandableDL[e]&&this.get("EXPAND_DL_ENABLED")
};
ZmAppCtxt.prototype.setIsExpandableDL=function(t,e){
this._isExpandableDL[t]=e
};
ZmAppCtxt.prototype.getToolTipMgr=function(){
if(!this._toolTipMgr){
this._toolTipMgr=new ZmToolTipMgr()
}
return this._toolTipMgr
};
ZmAppCtxt.prototype.isZDOnline=function(){
var e=window.appCtxt.getAppController();
return !AjxEnv.isPrism||(e._isPrismOnline&&e._isUserOnline)
};
ZmAppCtxt.prototype.isTinyMCEEnabled=function(){
return true
};
ZmAppCtxt.handleWindowOpener=function(){
var t=appCtxt;
if(window.opener){
try{
t=window.opener.appCtxt
}
catch(e){
t=appCtxt
}}
return t
}
}
if(AjxPackage.define("zimbraMail.core.ZmOperation")){
ZmOperation=function(){};
ZmOperation.NONE="NONE";
ZmOperation.SEP="SEP";
ZmOperation.SPACER="SPACER";
ZmOperation.FILLER="FILLER";
ZmOperation.DIS="Dis";
ZmOperation.SETUP={};
ZmOperation.SETUP[ZmOperation.NONE]={};
ZmOperation.SETUP[ZmOperation.SEP]={};
ZmOperation.SETUP[ZmOperation.SPACER]={};
ZmOperation.SETUP[ZmOperation.FILLER]={};
ZmOperation.SETTING={};
ZmOperation.CALLBACK={};
ZmOperation.registerOp=function(o,t,e,a){
ZmOperation[o]=o;
ZmOperation.SETUP[o]=t||{};
if(e){
ZmOperation.SETTING[o]=e
}
if(a){
ZmOperation.CALLBACK[o]=a
}};
ZmOperation.KEY_ID="_opId";
ZmOperation.MENUITEM_ID="_menuItemId";
ZmOperation.NEW_ITEM_OPS=[];
ZmOperation.NEW_ITEM_KEY={};
ZmOperation.NEW_ORG_OPS=[];
ZmOperation.NEW_ORG_KEY={};
ZmOperation._operationDesc={};
ZmOperation.initialize=function(){
ZmOperation.registerOp(ZmId.OP_ACTIONS_MENU,{
textKey:"actions",tooltipKey:"",textPrecedence:40}
);
ZmOperation.registerOp(ZmId.OP_ATTACHMENT,{
textKey:"addAttachment",tooltipKey:"attachmentTooltip",image:"Attachment",shortcut:ZmKeyMap.ATTACHMENT,showImageInToolbar:true}
);
ZmOperation.registerOp(ZmId.OP_CALL,{
image:"Telephone"}
);
ZmOperation.registerOp(ZmId.OP_CANCEL,{
textKey:"cancel",tooltipKey:"cancelTooltip",image:"Cancel",shortcut:ZmKeyMap.CANCEL}
);
ZmOperation.registerOp(ZmId.OP_CHECK_ALL,{
textKey:"checkAll",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_CLEAR_ALL,{
textKey:"clearAll",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_CLOSE,{
textKey:"close",tooltipKey:"closeTooltip",image:"Close",shortcut:ZmKeyMap.CANCEL}
);
ZmOperation.registerOp(ZmId.OP_COMPOSE_FORMAT,{
textKey:"format",tooltipKey:"formatTooltip",image:"SwitchFormat",shortcut:ZmKeyMap.HTML_FORMAT}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_CONTACTGROUP_MENU,{
textKey:"AB_CONTACT_GROUP",tooltipKey:"contactGroupTooltip",image:"Group"}
,ZmSetting.TAGGING_ENABLED,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addContactGroupMenu,e,true)
}
));
ZmOperation.registerOp(ZmId.OP_DELETE,{
textKey:"del",tooltipKey:"deleteTooltip",image:"Delete",shortcut:ZmKeyMap.DEL,textPrecedence:60}
);
ZmOperation.registerOp(ZmId.OP_DELETE_WITHOUT_SHORTCUT,{
textKey:"del",tooltipKey:"deleteTooltip",image:"Delete",textPrecedence:60}
);
ZmOperation.registerOp(ZmId.OP_DETACH,{
textKey:"detachTT",tooltipKey:"detachTT",image:"OpenInNewWindow",showImageInToolbar:true}
);
ZmOperation.registerOp(ZmId.OP_DETACH_WIN,{
textKey:"detachTT",tooltipKey:"detachTT",image:"OpenInNewWindow"}
);
ZmOperation.registerOp(ZmId.OP_EDIT,{
textKey:"edit",tooltipKey:"editTooltip",image:"Edit",shortcut:ZmKeyMap.EDIT}
);
ZmOperation.registerOp(ZmId.OP_EDIT_AS_NEW,{
textKey:"editAsNew",tooltipKey:"editTooltip",image:"Edit",shortcut:ZmKeyMap.EDIT}
);
ZmOperation.registerOp(ZmId.OP_EDIT_PROPS,{
textKey:"editProperties",tooltipKey:"editPropertiesTooltip",image:"Properties"}
);
ZmOperation.registerOp(ZmId.OP_EXPAND,{
textKey:"expand",image:"Plus"}
);
ZmOperation.registerOp(ZmId.OP_EXPAND_ALL,{
textKey:"expandAll",image:"Plus"}
);
ZmOperation.registerOp(ZmId.OP_EMPTY_FOLDER,{
textKey:"emptyFolder",image:"EmptyFolder"}
);
ZmOperation.registerOp(ZmId.OP_FORMAT_HTML,{
textKey:"formatAsHtml",image:"HtmlDoc"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_FORMAT_TEXT,{
textKey:"formatAsText",image:"GenericDoc"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_GROUPBY,{
textKey:"groupBy"}
);
ZmOperation.registerOp(ZmId.OP_GROUPBY_NONE,{
textKey:"groupByNone"}
);
ZmOperation.registerOp(ZmId.OP_GROUPBY_DATE,{
textKey:"groupByDate"}
);
ZmOperation.registerOp(ZmId.OP_GROUPBY_FROM,{
textKey:"groupByFrom"}
);
ZmOperation.registerOp(ZmId.OP_GROUPBY_PRIORITY,{
textKey:"groupByPriority"}
);
ZmOperation.registerOp(ZmId.OP_GROUPBY_SIZE,{
textKey:"groupBySize"}
);
ZmOperation.registerOp(ZmId.OP_GROUPBY_TAG,{
textKey:"groupByTag"}
);
ZmOperation.registerOp(ZmId.OP_GO_TO_URL,{
image:"URL"}
);
ZmOperation.registerOp(ZmId.OP_MARK_ALL_READ,{
textKey:"markAllRead",image:"ReadMessage"}
);
ZmOperation.registerOp(ZmId.OP_MOVE,{
textKey:"move",tooltipKey:"moveTooltip",image:"MoveToFolder",textPrecedence:40,showImageInToolbar:true}
);
ZmOperation.registerOp(ZmId.OP_MOVE_MENU,{
tooltipKey:"moveTooltip",image:"MoveToFolder"}
,null,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addMoveMenu,e,true)
}
));
ZmOperation.registerOp(ZmId.OP_MUTE_CONV,{
textKey:"muteConv",tooltipKey:"muteConvTooltip",image:"Mute",shortcut:ZmKeyMap.MUTE_UNMUTE_CONV}
);
ZmOperation.registerOp(ZmId.OP_OPTS,{
textKey:"options",tooltipKey:"options",image:"ContextMenu"}
);
ZmOperation.registerOp(ZmId.OP_NEW_FOLDER,{
textKey:"newFolder",tooltipKey:"newFolderTooltip",image:"NewFolder",shortcut:ZmKeyMap.NEW_FOLDER}
,ZmSetting.USER_FOLDERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_NEW_MENU,{
textKey:"_new",shortcut:ZmKeyMap.NEW,textPrecedence:100}
,null,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addNewMenu,e)
}
));
ZmOperation.registerOp(ZmId.OP_NEW_TAG,{
textKey:"newTag",tooltipKey:"newTagTooltip",image:"NewTag",shortcut:ZmKeyMap.NEW_TAG}
,ZmSetting.TAGGING_ENABLED);
ZmOperation.registerOp(ZmId.OP_NOTIFY,{
textKey:"notify",image:"Feedback"}
);
ZmOperation.registerOp(ZmId.OP_PAGE_BACK,{
image:"LeftArrow",shortcut:ZmKeyMap.PREV_PAGE}
);
ZmOperation.registerOp(ZmId.OP_PAGE_FORWARD,{
image:"RightArrow",shortcut:ZmKeyMap.NEXT_PAGE}
);
ZmOperation.registerOp(ZmId.OP_PRINT,{
textKey:"print",tooltipKey:"printTooltip",image:"Print",shortcut:ZmKeyMap.PRINT,textPrecedence:30,showImageInToolbar:true}
,ZmSetting.PRINT_ENABLED);
ZmOperation.registerOp(ZmId.OP_PRIORITY_FILTER,{
image:"Priority",textKey:"activityStream"}
,ZmSetting.PRIORITY_INBOX_ENABLED);
ZmOperation.registerOp(ZmId.OP_RECOVER_DELETED_ITEMS,{
textKey:"recoverDeletedItems",image:"Trash",tooltipKey:"recoverDeletedItems"}
,ZmSetting.DUMPSTER_ENABLED);
ZmOperation.registerOp(ZmId.OP_REFRESH,{
textKey:"refresh",tooltipKey:"refreshTooltip"}
);
ZmOperation.registerOp(ZmId.OP_RENAME_FOLDER,{
textKey:"renameFolder",image:"Rename"}
);
ZmOperation.registerOp(ZmId.OP_RENAME_SEARCH,{
textKey:"renameSearch",image:"Rename"}
);
ZmOperation.registerOp(ZmId.OP_RENAME_TAG,{
textKey:"renameTag",image:"Rename"}
,ZmSetting.TAGGING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SAVE,{
textKey:"save",image:"Save",shortcut:ZmKeyMap.SAVE}
);
ZmOperation.registerOp(ZmId.OP_SEARCH,{
textKey:"findEmailFromSender",image:"Search"}
,ZmSetting.SEARCH_ENABLED);
ZmOperation.registerOp(ZmId.OP_SEARCH_TO,{
textKey:"findEmailToSender",image:"Search"}
,ZmSetting.SEARCH_ENABLED);
ZmOperation.registerOp(ZmId.OP_SEARCH_MENU,{
textKey:"findEmails",image:"Search"}
,ZmSetting.SEARCH_ENABLED,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addSearchMenu,e,true)
}
));
ZmOperation.registerOp(ZmId.OP_SEND,{
textKey:"send",tooltipKey:"sendTooltip",image:"Send",shortcut:ZmKeyMap.SEND}
);
ZmOperation.registerOp(ZmId.OP_FREE_BUSY_LINK,{
textKey:"freeBusyLink",tooltipKey:"freeBusyLinkTooltip",image:"Send"}
);
ZmOperation.registerOp(ZmId.OP_SEND_FB_HTML,{
textKey:"sendHTMLLink",tooltipKey:"freeBusyLinkTooltip"}
);
ZmOperation.registerOp(ZmId.OP_SEND_FB_ICS,{
textKey:"sendICSLink",tooltipKey:"freeBusyLinkTooltip"}
);
ZmOperation.registerOp(ZmId.OP_SEND_FB_ICS_EVENT,{
textKey:"sendICSEventLink",tooltipKey:"freeBusyLinkTooltip"}
);
ZmOperation.registerOp(ZmId.OP_SHARE,{
textKey:"share",tooltipKey:"shareTooltip"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHARE_ACCEPT,{
textKey:"acceptShare",image:"Check"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHARE_DECLINE,{
textKey:"declineShare",image:"Cancel"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SUBSCRIBE_APPROVE,{
textKey:"dlApprove",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_SUBSCRIBE_REJECT,{
textKey:"dlReject",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_SHARE_FOLDER,{
textKey:"shareFolder",image:"SharedMailFolder"}
);
ZmOperation.registerOp(ZmId.OP_SHOW_ALL_ITEM_TYPES,{
textKey:"showAllItemTypes",image:"Globe"}
);
ZmOperation.registerOp(ZmId.OP_SORT_ASC,{
textKey:"sortAscending"}
);
ZmOperation.registerOp(ZmId.OP_SORT_DESC,{
textKey:"sortDescending"}
);
ZmOperation.registerOp(ZmId.OP_SPELL_CHECK,{
textKey:"spellCheck",image:"SpellCheck",tooltipKey:"spellCheckTooltip",shortcut:ZmKeyMap.SPELLCHECK,showImageInToolbar:true}
,ZmSetting.SPELL_CHECK_ENABLED);
ZmOperation.registerOp(ZmId.OP_SYNC,{
textKey:"reload",image:"Refresh",shortcut:ZmKeyMap.REFRESH}
);
ZmOperation.registerOp(ZmId.OP_SYNC_ALL,{
textKey:"checkAllFeed",image:"Refresh"}
);
ZmOperation.registerOp(ZmId.OP_SYNC_OFFLINE_FOLDER,{
textKey:"syncOfflineFolderOff",image:"Refresh"}
,ZmSetting.OFFLINE_ENABLED);
ZmOperation.registerOp(ZmId.OP_TAG,null,ZmSetting.TAGGING_ENABLED);
ZmOperation.registerOp(ZmId.OP_TAG_COLOR_MENU,{
textKey:"tagColor",image:"TagStack"}
,ZmSetting.TAGGING_ENABLED,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addColorMenu,e)
}
));
ZmOperation.registerOp(ZmId.OP_TAG_MENU,{
tooltipKey:"tagTooltip",image:"Tag"}
,ZmSetting.TAGGING_ENABLED,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addTagMenu,e,true)
}
));
ZmOperation.registerOp(ZmId.OP_TEXT);
ZmOperation.registerOp(ZmId.OP_UNDELETE,{
textKey:"undelete",tooltipKey:"undelete",image:"MoveToFolder"}
);
ZmOperation.registerOp(ZmId.OP_UNMUTE_CONV,{
textKey:"unmuteConv",tooltipKey:"unmuteConvTooltip",image:"Unmute",shortcut:ZmKeyMap.MUTE_UNMUTE_CONV}
);
ZmOperation.registerOp(ZmId.OP_VIEW,{
textKey:"view",image:"SplitView"}
);
ZmOperation.registerOp(ZmId.OP_VIEW_MENU,{
tooltipKey:"viewTooltip",textKey:"view",image:"SplitPane",textPrecedence:80,showImageInToolbar:true,showTextInToolbar:true}
);
ZmOperation.registerOp(ZmId.OP_ZIMLET,{
image:"ZimbraIcon"}
);
ZmOperation.NEW_ORG_OPS.push(ZmOperation.NEW_FOLDER,ZmOperation.NEW_TAG);
ZmOperation.NEW_ORG_KEY[ZmOperation.NEW_FOLDER]="folder";
ZmOperation.NEW_ORG_KEY[ZmOperation.NEW_TAG]="tag"
};
ZmOperation.createOperations=function(t,e,o){
var a=new ZmOperation();
return a._createOperations(t,e,o)
};
ZmOperation.prototype._createOperations=function(a,e,n){
if(e==ZmOperation.NONE){
e=null
}
n=n||{};
var o={};
if(e&&e.length){
for(var t=0;
t<e.length;
t++){
var s=e[t];
ZmOperation.defineOperation(s,n[s]);
ZmOperation.addOperation(a,s,o,null,n[s]&&n[s].htmlElId)
}}
return o
};
ZmOperation.defineOperation=function(f,m){
var t=(m&&m.id)||(f&&f.id)||f||Dwt.getNextId();
var a=(m&&m.textKey)||ZmOperation.getProp(f,"textKey");
var p=a&&ZmMsg[a];
var c=(m&&m.tooltipKey)||ZmOperation.getProp(f,"tooltipKey");
var g=c&&ZmMsg[c];
var s=ZmOperation.getProp(f,"image");
var n=ZmOperation.getProp(f,"showImageInToolbar");
var u=ZmOperation.getProp(f,"showTextInToolbar");
var l=ZmOperation.getProp(f,"disImage");
var d=(m&&(m.enabled!==false));
var e=ZmOperation.getProp(f,"style");
var r=ZmOperation.getProp(f,"shortcut");
var o={
id:t,text:p,image:s,showImageInToolbar:n,showTextInToolbar:u,disImage:l,enabled:d,tooltip:g,style:e,shortcut:r};
if(m){
for(var h in m){
o[h]=m[h]
}}
ZmOperation._operationDesc[t]=o;
return o
};
ZmOperation.getProp=function(o,a){
var t=null;
var e=ZmOperation.SETUP[o];
if(e){
t=e[a];
if(!t&&(a=="disImage")&&e.image){
t=e.image
}}
return t
};
ZmOperation.isSep=function(e){
return(e==ZmOperation.SEP||e==ZmOperation.SPACER||e==ZmOperation.FILLER)
};
ZmOperation.addOperation=function(a,r,o,e,t){
var n=ZmOperation._operationDesc[r]||ZmOperation.defineOperation(r);
if(r==ZmOperation.SEP){
if(a instanceof DwtMenu){
a.createSeparator(e)
}else{
a.addSeparator(null,e)
}}else{
if(r==ZmOperation.SPACER){
a.addSpacer(null,e)
}else{
if(r==ZmOperation.FILLER){
a.addFiller(null,e)
}else{
if(e!=null){
n.index=e
}
o[r]=a.createOp(r,n,t)
}}}
var s=ZmOperation.CALLBACK[r];
if(s){
if(s.isAjxCallback){
s.run(o[r])
}else{
s(o[r])
}}};
ZmOperation.addDeferredMenu=function(e,o){
var t=[o];
for(var a=2;
a<arguments.length;
a++){
t.push(arguments[a])
}
var n=new AjxCallback(null,e,t);
o.setMenu(n)
};
ZmOperation.removeOperation=function(e,a,t){
e.getOp(a).dispose();
delete t[a]
};
ZmOperation.setOperation=function(t,s,e,n,o,a){
var r=t.getOp(s);
if(!r){
return
}
r.setText(n?n:ZmMsg[ZmOperation.getProp(e,"textKey")]);
r.setImage(o?o:ZmOperation.getProp(e,"image"))
};
ZmOperation.filterOperations=function(s){
var o=[];
if(!(s&&s.length)){
return o
}
for(var t=0;
t<s.length;
t++){
var r=s[t];
if(!r){
continue
}
var a=ZmOperation.SETTING[r];
if(!a||appCtxt.get(a)){
o.push(r)
}}
var e=[];
var n=false;
for(var t=0;
t<o.length;
t++){
var r=o[t];
if(r==ZmOperation.SEP||r==ZmOperation.SPACER){
if(!n){
e.push(r)
}
n=true
}else{
e.push(r);
n=false
}}
if(e&&e.length){
if(e[0]==ZmOperation.SEP||e[0]==ZmOperation.SPACER){
e.shift()
}
var t=e.length-1;
if(e[t]==ZmOperation.SEP||e[t]==ZmOperation.SPACER||e[t]==ZmOperation.FILLER){
e.pop()
}}
return e
};
ZmOperation.addNewMenu=function(a){
var n=ZmOperation.NEW_ITEM_OPS;
n.push(ZmOperation.SEP);
n=n.concat(ZmOperation.NEW_ORG_OPS);
var r={};
for(var t=0;
t<n.length;
t++){
var h=n[t];
var e=a._htmlElId+"_"+h;
r[h]={
htmlElId:e};
var o=ZmOperation.NEW_ITEM_KEY[h]||ZmOperation.NEW_ORG_KEY[h];
if(o){
r[h].textKey=o
}}
var s=new ZmActionMenu({
parent:a,menuItems:n,overrides:r}
);
a.setMenu(s);
return s
};
ZmOperation.addSearchMenu=function(e){
var t=[ZmOperation.SEARCH,ZmOperation.SEARCH_TO];
var a=new ZmActionMenu({
parent:e,menuItems:t}
);
e.setMenu(a);
return a
};
ZmOperation.addContactGroupMenu=function(t){
var e=new ZmContactGroupMenu(t);
t.setMenu(e);
return e
};
ZmOperation.addTagMenu=function(e){
var t=new ZmTagMenu(e);
e.setMenu(t);
return t
};
ZmOperation.addMoveMenu=function(e){
var t=new DwtMenu(e);
e.setMenu(t);
return t
};
ZmOperation.addColorMenu=function(e,a){
var t=new ZmColorMenu({
parent:e,image:"Tag",hideNone:true,hideNoFill:a}
);
e.setMenu(t);
return t
};
ZmOperation.getToolTip=function(n,o,e){
var t=ZmOperation._operationDesc[n]||ZmOperation.defineOperation(n);
e=e||t.tooltip;
var a=e&&t.shortcut&&appCtxt.getShortcutHint(o,t.shortcut);
return a?[e,a].join(""):e
}
}
if(AjxPackage.define("zimbraMail.core.ZmMimeTable")){
ZmMimeTable=function(){};
ZmMimeTable.APP="application";
ZmMimeTable.APP_ADOBE_PDF="application/pdf";
ZmMimeTable.APP_ADOBE_PS="application/postscript";
ZmMimeTable.APP_APPLE_DOUBLE="application/applefile";
ZmMimeTable.APP_EXE="application/exe";
ZmMimeTable.APP_MS_DOWNLOAD="application/x-msdownload";
ZmMimeTable.APP_MS_EXCEL="application/vnd.ms-excel";
ZmMimeTable.APP_MS_PPT="application/vnd.ms-powerpoint";
ZmMimeTable.APP_MS_PROJECT="application/vnd.ms-project";
ZmMimeTable.APP_MS_TNEF="application/ms-tnef";
ZmMimeTable.APP_MS_TNEF2="application/vnd.ms-tnef";
ZmMimeTable.APP_SIGNATURE="application/pkcs7-signature";
ZmMimeTable.APP_MS_VISIO="application/vnd.visio";
ZmMimeTable.APP_MS_WORD="application/msword";
ZmMimeTable.APP_OCTET_STREAM="application/octet-stream";
ZmMimeTable.APP_OPENXML_DOC="application/vnd.openxmlformats-officedocument.wordprocessingml.document";
ZmMimeTable.APP_OPENXML_EXCEL="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
ZmMimeTable.APP_OPENXML_PPT="application/vnd.openxmlformats-officedocument.presentationml.presentation";
ZmMimeTable.APP_XML="application/xml";
ZmMimeTable.APP_ZIMBRA_DOC="application/x-zimbra-doc";
ZmMimeTable.APP_ZIMBRA_SLIDES="application/x-zimbra-slides";
ZmMimeTable.APP_ZIMBRA_SPREADSHEET="application/x-zimbra-xls";
ZmMimeTable.APP_ZIP="application/zip";
ZmMimeTable.APP_ZIP2="application/x-zip-compressed";
ZmMimeTable.AUDIO="audio";
ZmMimeTable.AUDIO_WAV="audio/x-wav";
ZmMimeTable.AUDIO_MP3="audio/mpeg";
ZmMimeTable.IMG="image";
ZmMimeTable.IMG_GIF="image/gif";
ZmMimeTable.IMG_BMP="image/bmp";
ZmMimeTable.IMG_JPEG="image/jpeg";
ZmMimeTable.IMG_PJPEG="image/pjpeg";
ZmMimeTable.IMG_PNG="image/png";
ZmMimeTable.IMG_TIFF="image/tiff";
ZmMimeTable.MSG_RFC822="message/rfc822";
ZmMimeTable.MSG_READ_RECEIPT="message/disposition-notification";
ZmMimeTable.MULTI_ALT="multipart/alternative";
ZmMimeTable.MULTI_MIXED="multipart/mixed";
ZmMimeTable.MULTI_RELATED="multipart/related";
ZmMimeTable.MULTI_APPLE_DBL="multipart/appledouble";
ZmMimeTable.MULTI_DIGEST="multipart/digest";
ZmMimeTable.TEXT="text";
ZmMimeTable.TEXT_RTF="text/enriched";
ZmMimeTable.TEXT_HTML="text/html";
ZmMimeTable.TEXT_CAL="text/calendar";
ZmMimeTable.TEXT_JAVA="text/x-java";
ZmMimeTable.TEXT_VCARD="text/x-vcard";
ZmMimeTable.TEXT_DIRECTORY="text/directory";
ZmMimeTable.TEXT_PLAIN="text/plain";
ZmMimeTable.TEXT_XML="text/xml";
ZmMimeTable.VIDEO="video";
ZmMimeTable.VIDEO_WMV="video/x-ms-wmv";
ZmMimeTable.XML_ZIMBRA_SHARE="xml/x-zimbra-share";
ZmMimeTable._table=new Object();
ZmMimeTable._table[ZmMimeTable.APP]={
desc:ZmMsg.application,image:"ExeDoc",imageLarge:"ExeDoc_48",query:"application/*"};
ZmMimeTable._table[ZmMimeTable.APP_ADOBE_PDF]={
desc:ZmMsg.adobePdfDocument,image:"PDFDoc",imageLarge:"PDFDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ADOBE_PS]={
desc:ZmMsg.adobePsDocument,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_EXE]={
desc:ZmMsg.application,image:"ExeDoc",imageLarge:"ExeDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_DOWNLOAD]={
desc:ZmMsg.msDownload,image:"ExeDoc",imageLarge:"ExeDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_EXCEL]={
desc:ZmMsg.msExcelDocument,image:"MSExcelDoc",imageLarge:"MSExcelDoc_48",query:"excel"};
ZmMimeTable._table[ZmMimeTable.APP_MS_PPT]={
desc:ZmMsg.msPPTDocument,image:"MSPowerpointDoc",imageLarge:"MSPowerpointDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_PROJECT]={
desc:ZmMsg.msProjectDocument,image:"MSProjectDoc",imageLarge:"MSProjectDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_VISIO]={
desc:ZmMsg.msVisioDocument,image:"MSVisioDoc",imageLarge:"MSVisioDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_WORD]={
desc:ZmMsg.msWordDocument,image:"MSWordDoc",imageLarge:"MSWordDoc_48",query:"word"};
ZmMimeTable._table[ZmMimeTable.APP_OCTET_STREAM]={
desc:ZmMsg.unknownBinaryType,image:"UnknownDoc",imageLarge:"UnknownDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_OPENXML_DOC]={
desc:ZmMsg.msWordDocument,image:"MSWordDoc",imageLarge:"MSWordDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_OPENXML_EXCEL]={
desc:ZmMsg.msExcelDocument,image:"MSExcelDoc",imageLarge:"MSExcelDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_OPENXML_PPT]={
desc:ZmMsg.msPPTDocument,image:"MSPowerpointDoc",imageLarge:"MSPowerpointDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_XML]={
desc:ZmMsg.xmlDocument,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIMBRA_DOC]={
desc:ZmMsg.zimbraDocument,image:"Doc",imageLarge:"Doc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIMBRA_SLIDES]={
desc:ZmMsg.zimbraPresentation,image:"Presentation",imageLarge:"Presentation_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIMBRA_SPREADSHEET]={
desc:ZmMsg.zimbraSpreadsheet,image:"ZSpreadSheet",imageLarge:"ZSpreadSheet_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIP]={
desc:ZmMsg.zipFile,image:"ZipDoc",imageLarge:"ZipDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIP2]={
desc:ZmMsg.zipFile,image:"ZipDoc",imageLarge:"ZipDoc_48"};
ZmMimeTable._table[ZmMimeTable.AUDIO]={
desc:ZmMsg.audio,image:"AudioDoc",imageLarge:"Doc_48"};
ZmMimeTable._table[ZmMimeTable.AUDIO_WAV]={
desc:ZmMsg.waveAudio,image:"AudioDoc",imageLarge:"AudioDoc_48"};
ZmMimeTable._table[ZmMimeTable.AUDIO_MP3]={
desc:ZmMsg.mp3Audio,image:"AudioDoc",imageLarge:"AudioDoc_48"};
ZmMimeTable._table[ZmMimeTable.VIDEO]={
desc:ZmMsg.video,image:"VideoDoc",imageLarge:"VideoDoc_48"};
ZmMimeTable._table[ZmMimeTable.VIDEO_WMV]={
desc:ZmMsg.msWMV,image:"VideoDoc",imageLarge:"VideoDoc_48"};
ZmMimeTable._table[ZmMimeTable.IMG]={
desc:ZmMsg.image,image:"ImageDoc",imageLarge:"ImageDoc_48",query:"image/*"};
ZmMimeTable._table[ZmMimeTable.IMG_BMP]={
desc:ZmMsg.bmpImage,image:"ImageDoc",imageLarge:"ImageDoc_48",query:"bmp"};
ZmMimeTable._table[ZmMimeTable.IMG_GIF]={
desc:ZmMsg.gifImage,image:"ImageDoc",imageLarge:"ImageDoc_48",query:"gif"};
ZmMimeTable._table[ZmMimeTable.IMG_JPEG]={
desc:ZmMsg.jpegImage,image:"ImageDoc",imageLarge:"ImageDoc_48",query:"jpeg"};
ZmMimeTable._table[ZmMimeTable.IMG_PNG]={
desc:ZmMsg.pngImage,image:"ImageDoc",imageLarge:"ImageDoc_48",query:"png"};
ZmMimeTable._table[ZmMimeTable.IMG_TIFF]={
desc:ZmMsg.tiffImage,image:"ImageDoc",imageLarge:"ImageDoc_48"};
ZmMimeTable._table[ZmMimeTable.MSG_RFC822]={
desc:ZmMsg.mailMessage,image:"MessageDoc",imageLarge:"MessageDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT]={
desc:ZmMsg.textDocuments,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_RTF]={
desc:ZmMsg.enrichedText,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_HTML]={
desc:ZmMsg.htmlDocument,image:"HtmlDoc",imageLarge:"HtmlDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_JAVA]={
desc:ZmMsg.javaSource,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_PLAIN]={
desc:ZmMsg.textFile,image:"GenericDoc",imageLarge:"GenericDoc_48",query:"text"};
ZmMimeTable._table[ZmMimeTable.TEXT_XML]={
desc:ZmMsg.xmlDocument,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable.getInfo=function(t,e){
var a=ZmMimeTable._table[t];
if(!a&&e){
a=ZmMimeTable._table[t]={
desc:t,image:"UnknownDoc",imageLarge:"UnknownDoc_48"}
}
if(a){
if(!a.type){
a.type=t
}}else{
var o=t.split("/")[0];
if(o){
a=ZmMimeTable._table[o]
}}
return a
};
ZmMimeTable.isIgnored=function(e){
return(e==ZmMimeTable.MULTI_ALT||e==ZmMimeTable.MULTI_MIXED||e==ZmMimeTable.MULTI_RELATED||e==ZmMimeTable.MULTI_APPLE_DBL||e==ZmMimeTable.APP_MS_TNEF||e==ZmMimeTable.APP_MS_TNEF2||e==ZmMimeTable.APP_SIGNATURE)
};
ZmMimeTable.isRenderable=function(e,t){
return(e==ZmMimeTable.TEXT_HTML||e==ZmMimeTable.TEXT_PLAIN||(!t&&ZmMimeTable.isRenderableImage(e)))
};
ZmMimeTable.isTextType=function(e){
return(e.match(/^text\/.*/)&&e!=ZmMimeTable.TEXT_HTML&&e!=ZmMimeTable.TEXT_CAL)
};
ZmMimeTable.isRenderableImage=function(e){
return(e==ZmMimeTable.IMG_JPEG||e==ZmMimeTable.IMG_GIF||e==ZmMimeTable.IMG_BMP||e==ZmMimeTable.IMG_PNG)
};
ZmMimeTable.hasHtmlVersion=function(e){
return(!(ZmMimeTable.isIgnored(e)||e.match(/^text\/plain/)||e.match(/^image/)||e.match(/^audio/)||e.match(/^video/)))
};
ZmMimeTable.isMultiMedia=function(e){
return(e.match(/^audio/)||e.match(/^video/))
};
ZmMimeTable.isWebDoc=function(e){
return(e==ZmMimeTable.APP_ZIMBRA_SLIDES||e==ZmMimeTable.APP_ZIMBRA_SPREADSHEET||e==ZmMimeTable.APP_ZIMBRA_DOC)
}
}};
