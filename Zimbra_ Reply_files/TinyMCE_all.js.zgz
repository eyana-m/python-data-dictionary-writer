
/* Copyright (C) 2005-2009 Zimbra Inc. http://www.zimbra.com/ */
if(AjxPackage.define("TinyMCE")){
if(AjxPackage.define("ajax.3rdparty.tinymce.tiny_mce_src")){
(function(n){
var e=/^\s*|\s*$/g,t,o="B".replace(/A(.)|B/,"$1")==="$1";
var a={
majorVersion:"3",minorVersion:"5.4.1",releaseDate:"2012-06-24",_init:function(){
var k=this,g=document,f=navigator,r=f.userAgent,m,s,u,c,l,b;
k.isOpera=n.opera&&opera.buildNumber;
k.isWebKit=/WebKit/.test(r);
k.isIE=!k.isWebKit&&!k.isOpera&&(/MSIE/gi).test(r)&&(/Explorer/gi).test(f.appName);
k.isIE6=k.isIE&&/MSIE [56]/.test(r);
k.isIE7=k.isIE&&/MSIE [7]/.test(r);
k.isIE8=k.isIE&&/MSIE [8]/.test(r);
k.isIE9=k.isIE&&/MSIE [9]/.test(r);
k.isGecko=!k.isWebKit&&/Gecko/.test(r);
k.isMac=r.indexOf("Mac")!=-1;
k.isAir=/adobeair/i.test(r);
k.isIDevice=/(iPad|iPhone)/.test(r);
k.isIOS5=k.isIDevice&&r.match(/AppleWebKit\/(\d*)/)[1]>=534;
if(n.tinyMCEPreInit){
k.suffix=tinyMCEPreInit.suffix;
k.baseURL=tinyMCEPreInit.base;
k.query=tinyMCEPreInit.query;
return
}
k.suffix="";
s=g.getElementsByTagName("base");
for(m=0;
m<s.length;
m++){
b=s[m].href;
if(b){
if(/^https?:\/\/[^\/]+$/.test(b)){
b+="/"
}
c=b?b.match(/.*\//)[0]:""
}}
function h(d){
if(d.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(d.src)){
if(/_(src|dev)\.js/g.test(d.src)){
k.suffix="_src"
}
if((l=d.src.indexOf("?"))!=-1){
k.query=d.src.substring(l+1)
}
k.baseURL=d.src.substring(0,d.src.lastIndexOf("/"));
if(c&&k.baseURL.indexOf("://")==-1&&k.baseURL.indexOf("/")!==0){
k.baseURL=c+k.baseURL
}
return k.baseURL
}
return null
}
s=g.getElementsByTagName("script");
for(m=0;
m<s.length;
m++){
if(h(s[m])){
return
}}
u=g.getElementsByTagName("head")[0];
if(u){
s=u.getElementsByTagName("script");
for(m=0;
m<s.length;
m++){
if(h(s[m])){
return
}}}
return
}
,is:function(r,s){
if(!s){
return r!==t
}
if(s=="array"&&(r.hasOwnProperty&&r instanceof Array)){
return true
}
return typeof(r)==s
}
,makeMap:function(s,l,h){
var r;
s=s||[];
l=l||",";
if(typeof(s)=="string"){
s=s.split(l)
}
h=h||{};
r=s.length;
while(r--){
h[s[r]]={}
}
return h
}
,each:function(d,r,c){
var u,h;
if(!d){
return 0
}
c=c||d;
if(d.length!==t){
for(u=0,h=d.length;
u<h;
u++){
if(r.call(c,d[u],u,d)===false){
return 0
}}}else{
for(u in d){
if(d.hasOwnProperty(u)){
if(r.call(c,d[u],u,d)===false){
return 0
}}}}
return 1
}
,map:function(s,r){
var h=[];
a.each(s,function(l){
h.push(r(l))
}
);
return h
}
,grep:function(s,r){
var h=[];
a.each(s,function(l){
if(!r||r(l)){
h.push(l)
}}
);
return h
}
,inArray:function(r,h){
var c,s;
if(r){
for(c=0,s=r.length;
c<s;
c++){
if(r[c]===h){
return c
}}}
return -1
}
,extend:function(m,d){
var c,s,h,r=arguments,u;
for(c=1,s=r.length;
c<s;
c++){
d=r[c];
for(h in d){
if(d.hasOwnProperty(h)){
u=d[h];
if(u!==t){
m[h]=u
}}}}
return m
}
,trim:function(r){
return(r?""+r:"").replace(e,"")
}
,create:function(v,r,u){
var b=this,h,d,m,f,l,g=0;
v=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(v);
m=v[3].match(/(^|\.)(\w+)$/i)[2];
d=b.createNS(v[3].replace(/\.\w+$/,""),u);
if(d[m]){
return
}
if(v[2]=="static"){
d[m]=r;
if(this.onCreate){
this.onCreate(v[2],v[3],d[m])
}
return
}
if(!r[m]){
r[m]=function(){};
g=1
}
d[m]=r[m];
b.extend(d[m].prototype,r);
if(v[5]){
h=b.resolve(v[5]).prototype;
f=v[5].match(/\.(\w+)$/i)[1];
l=d[m];
if(g){
d[m]=function(){
return h[f].apply(this,arguments)
}
}else{
d[m]=function(){
this.parent=h[f];
return l.apply(this,arguments)
}
}
d[m].prototype[m]=d[m];
b.each(h,function(s,c){
d[m].prototype[c]=h[c]
}
);
b.each(r,function(s,c){
if(h[c]){
d[m].prototype[c]=function(){
this.parent=h[c];
return s.apply(this,arguments)
}
}else{
if(c!=m){
d[m].prototype[c]=s
}}}
)
}
b.each(r["static"],function(s,c){
d[m][c]=s
}
);
if(this.onCreate){
this.onCreate(v[2],v[3],d[m].prototype)
}}
,walk:function(l,h,c,r){
r=r||this;
if(l){
if(c){
l=l[c]
}
a.each(l,function(d,s){
if(h.call(r,d,s,c)===false){
return false
}
a.walk(d,h,c,r)
}
)
}}
,createNS:function(l,h){
var r,s;
h=h||n;
l=l.split(".");
for(r=0;
r<l.length;
r++){
s=l[r];
if(!h[s]){
h[s]={}
}
h=h[s]
}
return h
}
,resolve:function(c,h){
var r,s;
h=h||n;
c=c.split(".");
for(r=0,s=c.length;
r<s;
r++){
h=h[c[r]];
if(!h){
break
}}
return h
}
,addUnload:function(c,l){
var h=this,r;
r=function(){
var s=h.unloads,u,m;
if(s){
for(m in s){
u=s[m];
if(u&&u.func){
u.func.call(u.scope,1)
}}
if(n.detachEvent){
n.detachEvent("onbeforeunload",d);
n.detachEvent("onunload",r)
}else{
if(n.removeEventListener){
n.removeEventListener("unload",r,false)
}}
h.unloads=u=s=w=r=0;
if(n.CollectGarbage){
CollectGarbage()
}}};
function d(){
var u=document;
function s(){
u.detachEvent("onstop",s);
if(r){
r()
}
u=0
}
if(u.readyState=="interactive"){
if(u){
u.attachEvent("onstop",s)
}
n.setTimeout(function(){
if(u){
u.detachEvent("onstop",s)
}}
,0)
}}
c={
func:c,scope:l||this};
if(!h.unloads){
if(n.attachEvent){
n.attachEvent("onunload",r);
n.attachEvent("onbeforeunload",d)
}else{
if(n.addEventListener){
n.addEventListener("unload",r,false)
}}
h.unloads=[c]
}else{
h.unloads.push(c)
}
return c
}
,removeUnload:function(l){
var s=this.unloads,h=null;
a.each(s,function(c,r){
if(c&&c.func==l){
s.splice(r,1);
h=l;
return false
}}
);
return h
}
,explode:function(r,h){
if(!r||a.is(r,"array")){
return r
}
return a.map(r.split(h||","),a.trim)
}
,_addVer:function(r){
var s;
if(!this.query){
return r
}
s=(r.indexOf("?")==-1?"?":"&")+this.query;
if(r.indexOf("#")==-1){
return r+s
}
return r.replace("#",s+"#")
}
,_replace:function(h,s,r){
if(o){
return r.replace(h,function(){
var d=s,l=arguments,c;
for(c=0;
c<l.length-2;
c++){
if(l[c]===t){
d=d.replace(new RegExp("\\$"+c,"g"),"")
}else{
d=d.replace(new RegExp("\\$"+c,"g"),l[c])
}}
return d
}
)
}
return r.replace(h,s)
}};
a._init();
n.tinymce=n.tinyMCE=a
}
)(window);
tinymce.create("tinymce.util.Dispatcher",{
scope:null,listeners:null,inDispatch:false,Dispatcher:function(e){
this.scope=e||this;
this.listeners=[]
}
,add:function(t,e){
this.listeners.push({
cb:t,scope:e||this.scope}
);
return t
}
,addToTop:function(o,t){
var e=this,a={
cb:o,scope:t||e.scope};
if(e.inDispatch){
e.listeners=[a].concat(e.listeners)
}else{
e.listeners.unshift(a)
}
return o
}
,remove:function(a){
var t=this.listeners,e=null;
tinymce.each(t,function(n,o){
if(a==n.cb){
e=n;
t.splice(o,1);
return false
}}
);
return e
}
,dispatch:function(){
var e=this,n,t=arguments,a,o=e.listeners,s;
e.inDispatch=true;
for(a=0;
a<o.length;
a++){
s=o[a];
n=s.cb.apply(s.scope,t.length>0?t:[s.scope]);
if(n===false){
break
}}
e.inDispatch=false;
return n
}}
);
(function(){
var e=tinymce.each;
tinymce.create("tinymce.util.URI",{
URI:function(h,c){
var l=this,m,r,n,d;
h=tinymce.trim(h);
c=l.settings=c||{};
if(/^([\w\-]+):([^\/]{2})/i.test(h)||/^\s*#/.test(h)){
l.source=h;
return
}
if(h.indexOf("/")===0&&h.indexOf("//")!==0){
h=(c.base_uri?c.base_uri.protocol||"http":"http")+"://mce_host"+h
}
if(!/^[\w\-]*:?\/\//.test(h)){
d=c.base_uri?c.base_uri.path:new tinymce.util.URI(location.href).directory;
h=((c.base_uri&&c.base_uri.protocol)||"http")+"://mce_host"+l.toAbsPath(d,h)
}
h=h.replace(/@@/g,"(mce_at)");
h=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(h);
e(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(t,a){
var o=h[a];
if(o){
o=o.replace(/\(mce_at\)/g,"@@")
}
l[t]=o
}
);
n=c.base_uri;
if(n){
if(!l.protocol){
l.protocol=n.protocol
}
if(!l.userInfo){
l.userInfo=n.userInfo
}
if(!l.port&&l.host==="mce_host"){
l.port=n.port
}
if(!l.host||l.host==="mce_host"){
l.host=n.host
}
l.source=""
}}
,setPath:function(o){
var a=this;
o=/^(.*?)\/?(\w+)?$/.exec(o);
a.path=o[0];
a.directory=o[1];
a.file=o[2];
a.source="";
a.getURI()
}
,toRelative:function(a){
var s=this,h;
if(a==="./"){
return a
}
a=new tinymce.util.URI(a,{
base_uri:s}
);
if((a.host!="mce_host"&&s.host!=a.host&&a.host)||s.port!=a.port||s.protocol!=a.protocol){
return a.getURI()
}
var n=s.getURI(),r=a.getURI();
if(n==r||(n.charAt(n.length-1)=="/"&&n.substr(0,n.length-1)==r)){
return n
}
h=s.toRelPath(s.path,a.path);
if(a.query){
h+="?"+a.query
}
if(a.anchor){
h+="#"+a.anchor
}
return h
}
,toAbsolute:function(t,a){
t=new tinymce.util.URI(t,{
base_uri:this}
);
return t.getURI(this.host==t.host&&this.protocol==t.protocol?a:0)
}
,toRelPath:function(r,h){
var a,s=0,o="",n,t;
r=r.substring(0,r.lastIndexOf("/"));
r=r.split("/");
a=h.split("/");
if(r.length>=a.length){
for(n=0,t=r.length;
n<t;
n++){
if(n>=a.length||r[n]!=a[n]){
s=n+1;
break
}}}
if(r.length<a.length){
for(n=0,t=a.length;
n<t;
n++){
if(n>=r.length||r[n]!=a[n]){
s=n+1;
break
}}}
if(s===1){
return h
}
for(n=0,t=r.length-(s-1);
n<t;
n++){
o+="../"
}
for(n=s-1,t=a.length;
n<t;
n++){
if(n!=s-1){
o+="/"+a[n]
}else{
o+=a[n]
}}
return o
}
,toAbsPath:function(s,r){
var a,t=0,l=[],n,h;
n=/\/$/.test(r)?"/":"";
s=s.split("/");
r=r.split("/");
e(s,function(o){
if(o){
l.push(o)
}}
);
s=l;
for(a=r.length-1,l=[];
a>=0;
a--){
if(r[a].length===0||r[a]==="."){
continue
}
if(r[a]===".."){
t++;
continue
}
if(t>0){
t--;
continue
}
l.push(r[a])
}
a=s.length-t;
if(a<=0){
h=l.reverse().join("/")
}else{
h=s.slice(0,a).join("/")+"/"+l.reverse().join("/")
}
if(h.indexOf("/")!==0){
h="/"+h
}
if(n&&h.lastIndexOf("/")!==h.length-1){
h+=n
}
return h
}
,getURI:function(n){
var o,a=this;
if(!a.source||n){
o="";
if(!n){
if(a.protocol){
o+=a.protocol+"://"
}
if(a.userInfo){
o+=a.userInfo+"@"
}
if(a.host){
o+=a.host
}
if(a.port){
o+=":"+a.port
}}
if(a.path){
o+=a.path
}
if(a.query){
o+="?"+a.query
}
if(a.anchor){
o+="#"+a.anchor
}
a.source=o
}
return a.source
}}
)
}
)();
(function(){
var e=tinymce.each;
tinymce.create("static tinymce.util.Cookie",{
getHash:function(o){
var t=this.get(o),a;
if(t){
e(t.split("&"),function(n){
n=n.split("=");
a=a||{};
a[unescape(n[0])]=unescape(n[1])
}
)
}
return a
}
,setHash:function(u,t,h,r,c,a){
var l="";
e(t,function(n,o){
l+=(!l?"":"&")+escape(o)+"="+escape(n)
}
);
this.set(u,l,h,r,c,a)
}
,get:function(r){
var s=document.cookie,o,a=r+"=",t;
if(!s){
return
}
t=s.indexOf("; "+a);
if(t==-1){
t=s.indexOf(a);
if(t!==0){
return null
}}else{
t+=2
}
o=s.indexOf(";",t);
if(o==-1){
o=s.length
}
return unescape(s.substring(t+a.length,o))
}
,set:function(l,t,r,o,h,a){
document.cookie=l+"="+escape(t)+((r)?"; expires="+r.toGMTString():"")+((o)?"; path="+escape(o):"")+((h)?"; domain="+h:"")+((a)?"; secure":"")
}
,remove:function(a,n,o){
var t=new Date();
t.setTime(t.getTime()-1000);
this.set(a,"",t,n,o)
}}
)
}
)();
(function(){
function serialize(o,quote){
var i,v,t,name;
quote=quote||'"';
if(o==null){
return"null"
}
t=typeof o;
if(t=="string"){
v="\bb\tt\nn\ff\rr\"\"''\\\\";
return quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){
if(quote==='"'&&a==="'"){
return a
}
i=v.indexOf(b);
if(i+1){
return"\\"+v.charAt(i+1)
}
a=b.charCodeAt().toString(16);
return"\\u"+"0000".substring(a.length)+a
}
)+quote
}
if(t=="object"){
if(o.hasOwnProperty&&o instanceof Array){
for(i=0,v="[";
i<o.length;
i++){
v+=(i>0?",":"")+serialize(o[i],quote)
}
return v+"]"
}
v="{";
for(name in o){
if(o.hasOwnProperty(name)){
v+=typeof o[name]!="function"?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):""
}}
return v+"}"
}
return""+o
}
tinymce.util.JSON={
serialize:serialize,parse:function(s){
try{
return eval("("+s+")")
}
catch(ex){}}}
}
)();
tinymce.create("static tinymce.util.XHR",{
send:function(h){
var e,s,a=window,l=0;
function r(){
if(!h.async||e.readyState==4||l++>10000){
if(h.success&&l<10000&&e.status==200){
h.success.call(h.success_scope,""+e.responseText,e,h)
}else{
if(h.error){
h.error.call(h.error_scope,l>10000?"TIMED_OUT":"GENERAL",e,h)
}}
e=null
}else{
a.setTimeout(r,10)
}}
h.scope=h.scope||this;
h.success_scope=h.success_scope||h.scope;
h.error_scope=h.error_scope||h.scope;
h.async=h.async===false?false:true;
h.data=h.data||"";
function n(o){
e=0;
try{
e=new ActiveXObject(o)
}
catch(t){}
return e
}
e=a.XMLHttpRequest?new XMLHttpRequest():n("Microsoft.XMLHTTP")||n("Msxml2.XMLHTTP");
if(e){
if(e.overrideMimeType){
e.overrideMimeType(h.content_type)
}
e.open(h.type||(h.data?"POST":"GET"),h.url,h.async);
if(h.content_type){
e.setRequestHeader("Content-Type",h.content_type)
}
e.setRequestHeader("X-Requested-With","XMLHttpRequest");
e.send(h.data);
if(!h.async){
return r()
}
s=a.setTimeout(r,10)
}}}
);
(function(){
var a=tinymce.extend,t=tinymce.util.JSON,e=tinymce.util.XHR;
tinymce.create("tinymce.util.JSONRequest",{
JSONRequest:function(o){
this.settings=a({}
,o);
this.count=0
}
,send:function(r){
var s=r.error,n=r.success;
r=a(this.settings,r);
r.success=function(h,o){
h=t.parse(h);
if(typeof(h)=="undefined"){
h={
error:"JSON Parse error."}
}
if(h.error){
s.call(r.error_scope||r.scope,h.error,o)
}else{
n.call(r.success_scope||r.scope,h.result)
}};
r.error=function(h,o){
if(s){
s.call(r.error_scope||r.scope,h,o)
}};
r.data=t.serialize({
id:r.id||"c"+(this.count++),method:r.method,params:r.params}
);
r.content_type="application/json";
e.send(r)
}
,"static":{
sendRPC:function(n){
return new tinymce.util.JSONRequest().send(n)
}}}
)
}
());
(function(e){
e.VK={
BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(t){
return t.shiftKey||t.ctrlKey||t.altKey
}
,metaKeyPressed:function(t){
return e.isMac?t.metaKey:t.ctrlKey
}}
}
)(tinymce);
tinymce.util.Quirks=function(o){
var m=tinymce.VK,q=m.BACKSPACE,j=m.DELETE,g=o.dom,S=o.selection,k=o.settings;
function a(H,R){
try{
o.getDoc().execCommand(H,false,R)
}
catch(M){}}
function A(){
var M=o.getDoc().documentMode;
return M?M:6
}
function c(){
function M(I){
var R,E,H,Y;
R=S.getRng();
E=g.getParent(R.startContainer,g.isBlock);
if(I){
E=g.getNext(E,g.isBlock)
}
if(E){
H=E.firstChild;
while(H&&H.nodeType==3&&H.nodeValue.length===0){
H=H.nextSibling
}
if(H&&H.nodeName==="SPAN"){
Y=H.cloneNode(false)
}}
o.getDoc().execCommand(I?"ForwardDelete":"Delete",false,null);
E=g.getParent(R.startContainer,g.isBlock);
tinymce.each(g.select("span.Apple-style-span,font.Apple-style-span",E),function(G){
var L=S.getBookmark();
if(Y){
g.replace(Y.cloneNode(false),G,true)
}else{
g.remove(G,true)
}
S.moveToBookmark(L)
}
)
}
o.onKeyDown.add(function(R,I){
var H;
H=I.keyCode==j;
if(!I.isDefaultPrevented()&&(H||I.keyCode==q)&&!m.modifierPressed(I)){
I.preventDefault();
M(H)
}}
);
o.addCommand("Delete",function(){
M()
}
)
}
function F(){
function M(I){
var H=g.create("body");
var Y=I.cloneContents();
H.appendChild(Y);
return S.serializer.serialize(H,{
format:"html"}
)
}
function R(H){
var Y=M(H);
var E=g.createRng();
E.selectNode(o.getBody());
var I=M(E);
return Y===I
}
o.onKeyDown.add(function(I,E){
var Y=E.keyCode,H;
if(!E.isDefaultPrevented()&&(Y==j||Y==q)){
H=I.selection.isCollapsed();
if(H&&!g.isEmpty(I.getBody())){
return
}
if(tinymce.isIE&&!H){
return
}
if(!H&&!R(I.selection.getRng())){
return
}
I.setContent("");
I.selection.setCursorLocation(I.getBody(),0);
I.nodeChanged()
}}
)
}
function T(){
o.onKeyDown.add(function(M,R){
if(R.keyCode==65&&m.metaKeyPressed(R)){
R.preventDefault();
M.execCommand("SelectAll")
}}
)
}
function O(){
if(!o.settings.content_editable){
g.bind(o.getDoc(),"focusin",function(M){
S.setRng(S.getRng())
}
);
g.bind(o.getDoc(),"mousedown",function(M){
if(M.target==o.getDoc().documentElement){
o.getWin().focus();
S.setRng(S.getRng())
}}
)
}}
function f(){
o.onKeyDown.add(function(M,I){
if(!I.isDefaultPrevented()&&I.keyCode===q){
if(S.isCollapsed()&&S.getRng(true).startOffset===0){
var H=S.getNode();
var R=H.previousSibling;
if(R&&R.nodeName&&R.nodeName.toLowerCase()==="hr"){
g.remove(R);
tinymce.dom.Event.cancel(I)
}}}}
)
}
function t(){
if(!Range.prototype.getClientRects){
o.onMouseDown.add(function(R,H){
if(H.target.nodeName==="HTML"){
var M=R.getBody();
M.blur();
setTimeout(function(){
M.focus()
}
,0)
}}
)
}}
function B(){
o.onClick.add(function(M,R){
R=R.target;
if(/^(IMG|HR)$/.test(R.nodeName)){
S.getSel().setBaseAndExtent(R,0,R,1)
}
if(R.nodeName=="A"&&g.hasClass(R,"mceItemAnchor")){
S.select(R)
}
M.nodeChanged()
}
)
}
function C(){
function R(){
var I=g.getAttribs(S.getStart().cloneNode(false));
return function(){
var Y=S.getStart();
if(Y!==o.getBody()){
g.setAttrib(Y,"style",null);
tinymce.each(I,function(E){
Y.setAttributeNode(E.cloneNode(true))
}
)
}}
}
function M(){
return !S.isCollapsed()&&S.getStart()!=S.getEnd()
}
function H(I,Y){
Y.preventDefault();
return false
}
o.onKeyPress.add(function(I,E){
var Y;
if((E.keyCode==8||E.keyCode==46)&&M()){
Y=R();
I.getDoc().execCommand("delete",false,null);
Y();
E.preventDefault();
return false
}}
);
g.bind(o.getDoc(),"cut",function(Y){
var I;
if(M()){
I=R();
o.onKeyUp.addToTop(H);
setTimeout(function(){
I();
o.onKeyUp.remove(H)
}
,0)
}}
)
}
function d(){
var R,M;
g.bind(o.getDoc(),"selectionchange",function(){
if(M){
clearTimeout(M);
M=0
}
M=window.setTimeout(function(){
var H=S.getRng();
if(!R||!tinymce.dom.RangeUtils.compareRanges(H,R)){
o.nodeChanged();
R=H
}}
,50)
}
)
}
function D(){
document.body.setAttribute("role","application")
}
function W(){
o.onKeyDown.add(function(M,H){
if(!H.isDefaultPrevented()&&H.keyCode===q){
if(S.isCollapsed()&&S.getRng(true).startOffset===0){
var R=S.getNode().previousSibling;
if(R&&R.nodeName&&R.nodeName.toLowerCase()==="table"){
return tinymce.dom.Event.cancel(H)
}}}}
)
}
function h(){
if(A()>7){
return
}
a("RespectVisibilityInDesign",true);
o.contentStyles.push(".mceHideBrInPre pre br {display: none}");
g.addClass(o.getBody(),"mceHideBrInPre");
o.parser.addNodeFilter("pre",function(M,H){
var I=M.length,E,R,G,Y;
while(I--){
E=M[I].getAll("br");
R=E.length;
while(R--){
G=E[R];
Y=G.prev;
if(Y&&Y.type===3&&Y.value.charAt(Y.value-1)!="\n"){
Y.value+="\n"
}else{
G.parent.insert(new tinymce.html.Node("#text",3),G,true).value="\n"
}}}}
);
o.serializer.addNodeFilter("pre",function(M,H){
var I=M.length,E,R,G,Y;
while(I--){
E=M[I].getAll("br");
R=E.length;
while(R--){
G=E[R];
Y=G.prev;
if(Y&&Y.type==3){
Y.value=Y.value.replace(/\r?\n$/,"")
}}}}
)
}
function s(){
g.bind(o.getBody(),"mouseup",function(H){
var R,M=S.getNode();
if(M.nodeName=="IMG"){
if(R=g.getStyle(M,"width")){
g.setAttrib(M,"width",R.replace(/[^0-9%]+/g,""));
g.setStyle(M,"width","")
}
if(R=g.getStyle(M,"height")){
g.setAttrib(M,"height",R.replace(/[^0-9%]+/g,""));
g.setStyle(M,"height","")
}}}
)
}
function v(){
o.onKeyDown.add(function(G,L){
var E,M,R,I,Y,N,H;
E=L.keyCode==j;
if(!L.isDefaultPrevented()&&(E||L.keyCode==q)&&!m.modifierPressed(L)){
M=S.getRng();
R=M.startContainer;
I=M.startOffset;
H=M.collapsed;
if(R.nodeType==3&&R.nodeValue.length>0&&((I===0&&!H)||(H&&I===(E?0:1)))){
nonEmptyElements=G.schema.getNonEmptyElements();
L.preventDefault();
Y=g.create("br",{
id:"__tmp"}
);
R.parentNode.insertBefore(Y,R);
G.getDoc().execCommand(E?"ForwardDelete":"Delete",false,null);
R=S.getRng().startContainer;
N=R.previousSibling;
if(N&&N.nodeType==1&&!g.isBlock(N)&&g.isEmpty(N)&&!nonEmptyElements[N.nodeName.toLowerCase()]){
g.remove(N)
}
g.remove("__tmp")
}}}
)
}
function n(){
o.onKeyDown.add(function(Y,E){
var H,R,G,M,I;
if(E.isDefaultPrevented()||E.keyCode!=m.BACKSPACE){
return
}
H=S.getRng();
R=H.startContainer;
G=H.startOffset;
M=g.getRoot();
I=R;
if(!H.collapsed||G!==0){
return
}
while(I&&I.parentNode&&I.parentNode.firstChild==I&&I.parentNode!=M){
I=I.parentNode
}
if(I.tagName==="BLOCKQUOTE"){
Y.formatter.toggle("blockquote",null,I);
H.setStart(R,0);
H.setEnd(R,0);
S.setRng(H);
S.collapse(false)
}}
)
}
function u(){
function M(){
o._refreshContentEditable();
a("StyleWithCSS",false);
a("enableInlineTableEditing",false);
if(!k.object_resizing){
a("enableObjectResizing",false)
}}
if(!k.readonly){
o.onBeforeExecCommand.add(M);
o.onMouseDown.add(M)
}}
function p(){
function M(R,H){
tinymce.each(g.select("a"),function(E){
var I=E.parentNode,Y=g.getRoot();
if(I.lastChild===E){
while(I&&!g.isBlock(I)){
if(I.parentNode.lastChild!==I||I===Y){
return
}
I=I.parentNode
}
g.add(I,"br",{
"data-mce-bogus":1}
)
}}
)
}
o.onExecCommand.add(function(R,H){
if(H==="CreateLink"){
M(R)
}}
);
o.onSetContent.add(S.onSetContent.add(M))
}
function z(){
if(k.forced_root_block){
o.onInit.add(function(){
a("DefaultParagraphSeparator",k.forced_root_block)
}
)
}}
function e(){
function M(H,R){
if(!H||!R.initial){
o.execCommand("mceRepaint")
}}
o.onUndo.add(M);
o.onRedo.add(M);
o.onSetContent.add(M)
}
function b(){
o.onKeyDown.add(function(R,H){
var M;
if(!H.isDefaultPrevented()&&H.keyCode==q){
M=R.getDoc().selection.createRange();
if(M&&M.item){
H.preventDefault();
R.undoManager.beforeChange();
g.remove(M.item(0));
R.undoManager.add()
}}}
)
}
function l(){
var M;
if(A()>=10){
M="";
tinymce.each("p div h1 h2 h3 h4 h5 h6".split(" "),function(R,H){
M+=(H>0?",":"")+R+":empty"
}
);
o.contentStyles.push(M+"{padding-right: 1px !important}")
}}
function r(){
var Y,R,M,H,I;
if(!k.object_resizing||k.webkit_fake_resize===false){
return
}
o.contentStyles.push(".mceResizeImages img {cursor: se-resize !important}");
function E(J){
var N,L,U,P,G;
if(Y){
N=J.screenX-R;
L=J.screenY-M;
U=Math.max((H+N)/H,(I+L)/I);
if(Math.abs(N)>1||Math.abs(L)>1){
P=Math.round(H*U);
G=Math.round(I*U);
if(Y.style.width){
g.setStyle(Y,"width",P)
}else{
g.setAttrib(Y,"width",P)
}
if(Y.style.height){
g.setStyle(Y,"height",G)
}else{
g.setAttrib(Y,"height",G)
}
if(!g.hasClass(o.getBody(),"mceResizeImages")){
g.addClass(o.getBody(),"mceResizeImages")
}}}}
o.onMouseDown.add(function(G,N){
var L=N.target;
if(L.nodeName=="IMG"){
Y=L;
R=N.screenX;
M=N.screenY;
H=Y.clientWidth;
I=Y.clientHeight;
g.bind(G.getDoc(),"mousemove",E);
N.preventDefault()
}}
);
o.onNodeChange.add(function(){
if(Y){
Y=null;
g.unbind(o.getDoc(),"mousemove",E)
}
if(S.getNode().nodeName=="IMG"){
g.addClass(o.getBody(),"mceResizeImages")
}else{
g.removeClass(o.getBody(),"mceResizeImages")
}}
)
}
W();
n();
F();
if(tinymce.isWebKit){
v();
c();
O();
B();
z();
if(tinymce.isIDevice){
d()
}else{
r();
T()
}}
if(tinymce.isIE){
f();
D();
h();
s();
b();
l()
}
if(tinymce.isGecko){
f();
t();
C();
u();
p();
e()
}};
(function(c){
var e,r,o,d=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,t=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,s=/[<>&\"\']/g,a=/&(#x|#)?([\w]+);/g,l={
128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"};
r={
'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};
o={
"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};
function h(u){
var m;
m=document.createElement("div");
m.innerHTML=u;
return m.textContent||m.innerText||u
}
function n(m,g){
var f,p,u,b={};
if(m){
m=m.split(",");
g=g||10;
for(f=0;
f<m.length;
f+=2){
p=String.fromCharCode(parseInt(m[f],g));
if(!r[p]){
u="&"+m[f+1]+";";
b[p]=u;
b[u]=p
}}
return b
}}
e=n("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);
c.html=c.html||{};
c.html.Entities={
encodeRaw:function(m,u){
return m.replace(u?d:t,function(f){
return r[f]||f
}
)
}
,encodeAllRaw:function(u){
return(""+u).replace(s,function(m){
return r[m]||m
}
)
}
,encodeNumeric:function(m,u){
return m.replace(u?d:t,function(f){
if(f.length>1){
return"&#"+(((f.charCodeAt(0)-55296)*1024)+(f.charCodeAt(1)-56320)+65536)+";"
}
return r[f]||"&#"+f.charCodeAt(0)+";"
}
)
}
,encodeNamed:function(f,u,m){
m=m||e;
return f.replace(u?d:t,function(p){
return r[p]||m[p]||p
}
)
}
,getEncodeFunc:function(u,p){
var g=c.html.Entities;
p=n(p)||e;
function m(v,b){
return v.replace(b?d:t,function(k){
return r[k]||p[k]||"&#"+k.charCodeAt(0)+";"||k
}
)
}
function f(v,b){
return g.encodeNamed(v,b,p)
}
u=c.makeMap(u.replace(/\+/g,","));
if(u.named&&u.numeric){
return m
}
if(u.named){
if(p){
return f
}
return g.encodeNamed
}
if(u.numeric){
return g.encodeNumeric
}
return g.encodeRaw
}
,decode:function(u){
return u.replace(a,function(f,m,p){
if(m){
p=parseInt(p,m.length===2?16:10);
if(p>65535){
p-=65536;
return String.fromCharCode(55296+(p>>10),56320+(p&1023))
}else{
return l[p]||String.fromCharCode(p)
}}
return o[f]||e[f]||h(f)
}
)
}}
}
)(tinymce);
tinymce.html.Styles=function(o,s){
var c=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,h=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,t=/\s*([^:]+):\s*([^;]+);?/g,d=/\s+$/,u=/rgb/,n,r,e={}
,l;
o=o||{};
l="\\\" \\' \\; \\: ; : \uFEFF".split(" ");
for(r=0;
r<l.length;
r++){
e[l[r]]="\uFEFF"+r;
e["\uFEFF"+r]=l[r]
}
function a(f,k,v,m){
function p(g){
g=parseInt(g).toString(16);
return g.length>1?g:"0"+g
}
return"#"+p(k)+p(v)+p(m)
}
return{
toHex:function(m){
return m.replace(c,a)
}
,parse:function(k){
var A={}
,b,f,T,v,z=o.url_converter,O=o.url_converter_scope||this;
function g(D,M){
var F,C,B,S;
F=A[D+"-top"+M];
if(!F){
return
}
C=A[D+"-right"+M];
if(F!=C){
return
}
B=A[D+"-bottom"+M];
if(C!=B){
return
}
S=A[D+"-left"+M];
if(B!=S){
return
}
A[D+M]=S;
delete A[D+"-top"+M];
delete A[D+"-right"+M];
delete A[D+"-bottom"+M];
delete A[D+"-left"+M]
}
function j(C){
var D=A[C],B;
if(!D||D.indexOf(" ")<0){
return
}
D=D.split(" ");
B=D.length;
while(B--){
if(D[B]!==D[0]){
return false
}}
A[C]=D[0];
return true
}
function W(D,C,B,S){
if(!j(C)){
return
}
if(!j(B)){
return
}
if(!j(S)){
return
}
A[D]=A[C]+" "+A[B]+" "+A[S];
delete A[C];
delete A[B];
delete A[S]
}
function q(B){
v=true;
return e[B]
}
function m(C,B){
if(v){
C=C.replace(/\uFEFF[0-9]/g,function(D){
return e[D]
}
)
}
if(!B){
C=C.replace(/\\([\'\";:])/g,"$1")
}
return C
}
function p(C,B,F,S,M,D){
M=M||D;
if(M){
M=m(M);
return"'"+M.replace(/\'/g,"\\'")+"'"
}
B=m(B||F||S);
if(z){
B=z.call(O,B,"style")
}
return"url('"+B.replace(/\'/g,"\\'")+"')"
}
if(k){
k=k.replace(/\\[\"\';:\uFEFF]/g,q).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(B){
return B.replace(/[;:]/g,q)
}
);
while(b=t.exec(k)){
f=b[1].replace(d,"").toLowerCase();
T=b[2].replace(d,"");
if(f&&T.length>0){
if(f==="font-weight"&&T==="700"){
T="bold"
}else{
if(f==="color"||f==="background-color"){
T=T.toLowerCase()
}}
T=T.replace(c,a);
T=T.replace(h,p);
A[f]=v?m(T,true):T
}
t.lastIndex=b.index+b[0].length
}
g("border","");
g("border","-width");
g("border","-color");
g("border","-style");
g("padding","");
g("margin","");
W("border","border-width","border-style","border-color");
if(A.border==="medium none"){
delete A.border
}}
return A
}
,serialize:function(g,v){
var p="",f,b;
function m(q){
var T,j,k,z;
T=s.styles[q];
if(T){
for(j=0,k=T.length;
j<k;
j++){
q=T[j];
z=g[q];
if(z!==n&&z.length>0){
p+=(p.length>0?" ":"")+q+": "+z+";"
}}}}
if(v&&s&&s.styles){
m("*");
m(v)
}else{
for(f in g){
b=g[f];
if(b!==n&&b.length>0){
p+=(p.length>0?" ":"")+f+": "+b+";"
}}}
return p
}}
};
(function(s){
var e={}
,n=s.makeMap,r=s.each;
function o(c,l){
return c.split(l||",")
}
function h(m,u){
var c,d={};
function l(f){
return f.replace(/[A-Z]+/g,function(p){
return l(m[p])
}
)
}
for(c in m){
if(m.hasOwnProperty(c)){
m[c]=l(m[c])
}}
l(u).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(b,p,f,g){
f=o(f,"|");
d[p]={
attributes:n(f),attributesOrder:f,children:n(g,"|",{
"#comment":{}}
)}
}
);
return d
}
function t(){
var l=e.html5;
if(!l){
l=e.html5=h({
A:"id|accesskey|class|dir|draggable|item|hidden|itemprop|role|spellcheck|style|subject|title|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"#|a|abbr|area|audio|b|bdo|br|button|canvas|cite|code|command|datalist|del|dfn|em|embed|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|meta|meter|noscript|object|output|progress|q|ruby|samp|script|select|small|span|strong|sub|sup|svg|textarea|time|var|video|wbr",C:"#|a|abbr|area|address|article|aside|audio|b|bdo|blockquote|br|button|canvas|cite|code|command|datalist|del|details|dfn|dialog|div|dl|em|embed|fieldset|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|menu|meta|meter|nav|noscript|ol|object|output|p|pre|progress|q|ruby|samp|script|section|select|small|span|strong|style|sub|sup|svg|table|textarea|time|ul|var|video"}
,"html[A|manifest][body|head]head[A][base|command|link|meta|noscript|script|style|title]title[A][#]base[A|href|target][]link[A|href|rel|media|type|sizes][]meta[A|http-equiv|name|content|charset][]style[A|type|media|scoped][#]script[A|charset|type|src|defer|async][#]noscript[A][C]body[A][C]section[A][C]nav[A][C]article[A][C]aside[A][C]h1[A][B]h2[A][B]h3[A][B]h4[A][B]h5[A][B]h6[A][B]hgroup[A][h1|h2|h3|h4|h5|h6]header[A][C]footer[A][C]address[A][C]p[A][B]br[A][]pre[A][B]dialog[A][dd|dt]blockquote[A|cite][C]ol[A|start|reversed][li]ul[A][li]li[A|value][C]dl[A][dd|dt]dt[A][B]dd[A][C]a[A|href|target|ping|rel|media|type][B]em[A][B]strong[A][B]small[A][B]cite[A][B]q[A|cite][B]dfn[A][B]abbr[A][B]code[A][B]var[A][B]samp[A][B]kbd[A][B]sub[A][B]sup[A][B]i[A][B]b[A][B]mark[A][B]progress[A|value|max][B]meter[A|value|min|max|low|high|optimum][B]time[A|datetime][B]ruby[A][B|rt|rp]rt[A][B]rp[A][B]bdo[A][B]span[A][B]ins[A|cite|datetime][B]del[A|cite|datetime][B]figure[A][C|legend|figcaption]figcaption[A][C]img[A|alt|src|height|width|usemap|ismap][]iframe[A|name|src|height|width|sandbox|seamless][]embed[A|src|height|width|type][]object[A|data|type|height|width|usemap|name|form|classid][param]param[A|name|value][]details[A|open][C|legend]command[A|type|label|icon|disabled|checked|radiogroup][]menu[A|type|label][C|li]legend[A][C|B]div[A][C]source[A|src|type|media][]audio[A|src|autobuffer|autoplay|loop|controls][source]video[A|src|autobuffer|autoplay|loop|controls|width|height|poster][source]hr[A][]form[A|accept-charset|action|autocomplete|enctype|method|name|novalidate|target][C]fieldset[A|disabled|form|name][C|legend]label[A|form|for][B]input[A|type|accept|alt|autocomplete|checked|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|height|list|max|maxlength|min|multiple|pattern|placeholder|readonly|required|size|src|step|width|files|value|name][]button[A|autofocus|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|name|value|type][B]select[A|autofocus|disabled|form|multiple|name|size][option|optgroup]datalist[A][B|option]optgroup[A|disabled|label][option]option[A|disabled|selected|label|value][]textarea[A|autofocus|disabled|form|maxlength|name|placeholder|readonly|required|rows|cols|wrap][]keygen[A|autofocus|challenge|disabled|form|keytype|name][]output[A|for|form|name][B]canvas[A|width|height][]map[A|name][B|C]area[A|shape|coords|href|alt|target|media|rel|ping|type][]mathml[A][]svg[A][]table[A|border][caption|colgroup|thead|tfoot|tbody|tr]caption[A][C]colgroup[A|span][col]col[A|span][]thead[A][tr]tfoot[A][tr]tbody[A][tr]tr[A][th|td]th[A|headers|rowspan|colspan|scope][B]td[A|headers|rowspan|colspan][C]wbr[A][]")
}
return l
}
function a(){
var l=e.html4;
if(!l){
l=e.html4=h({
Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"}
,"script[id|charset|type|language|src|defer|xml:space][]style[B|id|type|media|title|xml:space][]object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]param[id|name|value|valuetype|type][]p[E|align][#|S]a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]br[A|clear][]span[E][#|S]bdo[A|C|B][#|S]applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]h1[E|align][#|S]img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]map[B|C|A|name][X|form|Q|area]h2[E|align][#|S]iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]h3[E|align][#|S]tt[E][#|S]i[E][#|S]b[E][#|S]u[E][#|S]s[E][#|S]strike[E][#|S]big[E][#|S]small[E][#|S]font[A|B|size|color|face][#|S]basefont[id|size|color|face][]em[E][#|S]strong[E][#|S]dfn[E][#|S]code[E][#|S]q[E|cite][#|S]samp[E][#|S]kbd[E][#|S]var[E][#|S]cite[E][#|S]abbr[E][#|S]acronym[E][#|S]sub[E][#|S]sup[E][#|S]input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]optgroup[E|disabled|label][option]option[E|selected|disabled|label|value][]textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]label[E|for|accesskey|onfocus|onblur][#|S]button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[E|align][#|S]ins[E|cite|datetime][#|Y]h5[E|align][#|S]del[E|cite|datetime][#|Y]h6[E|align][#|S]div[E|align][#|Y]ul[E|type|compact][li]li[E|type|value][#|Y]ol[E|type|compact|start][li]dl[E|compact][dt|dd]dt[E][#|S]dd[E][#|Y]menu[E|compact][li]dir[E|compact][li]pre[E|width|xml:space][#|ZA]hr[E|align|noshade|size|width][]blockquote[E|cite][#|Y]address[E][#|S|p]center[E][#|Y]noframes[E][#|Y]isindex[A|B|prompt][]fieldset[E][#|legend|Y]legend[E|accesskey|align][#|S]table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]caption[E|align][#|S]col[ZG][]colgroup[ZG][col]thead[ZF][tr]tr[ZF|bgcolor][th|td]th[E|ZE][#|Y]form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]noscript[E][#|Y]td[E|ZE][#|Y]tfoot[ZF][tr]tbody[ZF][tr]area[E|D|shape|coords|href|nohref|alt|target][]base[id|href|target][]body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]")
}
return l
}
s.html.Schema=function(W){
var j=this,k={}
,d={}
,c=[],D,O;
var p,b,A,v,z,f,g={};
function m(F,S,R){
var M=W[F];
if(!M){
M=e[F];
if(!M){
M=n(S," ",n(S.toUpperCase()," "));
M=s.extend(M,R);
e[F]=M
}}else{
M=n(M,",",n(M.toUpperCase()," "))
}
return M
}
W=W||{};
O=W.schema=="html5"?t():a();
if(W.verify_html===false){
W.valid_elements="*[*]"
}
if(W.valid_styles){
D={};
r(W.valid_styles,function(F,S){
D[S]=s.explode(F)
}
)
}
p=m("whitespace_elements","pre script style textarea");
b=m("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");
A=m("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr");
v=m("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");
f=m("non_empty_elements","td th iframe video audio object",A);
z=m("block_elements","h1 h2 h3 h4 h5 h6 hr p div address pre form table tbody thead tfoot th tr td li ol ul caption blockquote center dl dt dd dir fieldset noscript menu isindex samp header footer article section hgroup aside nav figure option datalist select optgroup");
function l(S){
return new RegExp("^"+S.replace(/([?+*])/g,".$1")+"$")
}
function C(E){
var Y,M,_a,Z,_i,F,H,V,_e,U,_t,_n,N,I,X,S,K,R,_o,_s,P,Q,L=/^([#+\-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,J=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,G=/[*?+]/;
if(E){
E=o(E);
if(k["@"]){
K=k["@"].attributes;
R=k["@"].attributesOrder
}
for(Y=0,M=E.length;
Y<M;
Y++){
F=L.exec(E[Y]);
if(F){
X=F[1];
U=F[2];
S=F[3];
_e=F[4];
N={};
I=[];
H={
attributes:N,attributesOrder:I};
if(X==="#"){
H.paddEmpty=true
}
if(X==="-"){
H.removeEmpty=true
}
if(K){
for(_s in K){
N[_s]=K[_s]
}
I.push.apply(I,R)
}
if(_e){
_e=o(_e,"|");
for(_a=0,Z=_e.length;
_a<Z;
_a++){
F=J.exec(_e[_a]);
if(F){
V={};
_n=F[1];
_t=F[2].replace(/::/g,":");
X=F[3];
Q=F[4];
if(_n==="!"){
H.attributesRequired=H.attributesRequired||[];
H.attributesRequired.push(_t);
V.required=true
}
if(_n==="-"){
delete N[_t];
I.splice(s.inArray(I,_t),1);
continue
}
if(X){
if(X==="="){
H.attributesDefault=H.attributesDefault||[];
H.attributesDefault.push({
name:_t,value:Q}
);
V.defaultValue=Q
}
if(X===":"){
H.attributesForced=H.attributesForced||[];
H.attributesForced.push({
name:_t,value:Q}
);
V.forcedValue=Q
}
if(X==="<"){
V.validValues=n(Q,"?")
}}
if(G.test(_t)){
H.attributePatterns=H.attributePatterns||[];
V.pattern=l(_t);
H.attributePatterns.push(V)
}else{
if(!N[_t]){
I.push(_t)
}
N[_t]=V
}}}}
if(!K&&U=="@"){
K=N;
R=I
}
if(S){
H.outputName=U;
k[S]=H
}
if(G.test(U)){
H.pattern=l(U);
c.push(H)
}else{
k[U]=H
}}}}}
function q(S){
k={};
c=[];
C(S);
r(O,function(M,F){
d[F]=M.children
}
)
}
function u(F){
var S=/^(~)?(.+)$/;
if(F){
r(o(F),function(I){
var R=S.exec(I),H=R[1]==="~",Y=H?"span":"div",M=R[2];
d[M]=d[Y];
g[M]=Y;
if(!H){
z[M]={}
}
r(d,function(E,G){
if(E[Y]){
E[M]=E[Y]
}}
)
}
)
}}
function T(F){
var S=/^([+\-]?)(\w+)\[([^\]]+)\]$/;
if(F){
r(o(F),function(I){
var H=S.exec(I),M,R;
if(H){
R=H[1];
if(R){
M=d[H[2]]
}else{
M=d[H[2]]={
"#comment":{}}
}
M=d[H[2]];
r(o(H[3],"|"),function(Y){
if(R==="-"){
delete M[Y]
}else{
M[Y]={}
}}
)
}}
)
}}
function B(S){
var M=k[S],F;
if(M){
return M
}
F=c.length;
while(F--){
M=c[F];
if(M.pattern.test(S)){
return M
}}}
if(!W.valid_elements){
r(O,function(F,S){
k[S]={
attributes:F.attributes,attributesOrder:F.attributesOrder};
d[S]=F.children
}
);
if(W.schema!="html5"){
r(o("strong/b,em/i"),function(S){
S=o(S,"/");
k[S[1]].outputName=S[0]
}
)
}
k.img.attributesDefault=[{
name:"alt",value:""}
];
r(o("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr,strong,em,b,i"),function(S){
if(k[S]){
k[S].removeEmpty=true
}}
);
r(o("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(S){
k[S].paddEmpty=true
}
)
}else{
q(W.valid_elements)
}
u(W.custom_elements);
T(W.valid_children);
C(W.extended_valid_elements);
T("+ol[ul|ol],+ul[ul|ol]");
if(W.invalid_elements){
s.each(s.explode(W.invalid_elements),function(S){
if(k[S]){
delete k[S]
}}
)
}
if(!B("span")){
C("span[!data-mce-type|*]")
}
j.children=d;
j.styles=D;
j.getBoolAttrs=function(){
return v
};
j.getBlockElements=function(){
return z
};
j.getShortEndedElements=function(){
return A
};
j.getSelfClosingElements=function(){
return b
};
j.getNonEmptyElements=function(){
return f
};
j.getWhiteSpaceElements=function(){
return p
};
j.isValidChild=function(S,M){
var F=d[S];
return !!(F&&F[M])
};
j.isValid=function(F,S){
var R,M,H=B(F);
if(H){
if(S){
if(H.attributes[S]){
return true
}
R=H.attributePatterns;
if(R){
M=R.length;
while(M--){
if(R[M].pattern.test(F)){
return true
}}}}else{
return true
}}
return false
};
j.getElementRule=B;
j.getCustomElements=function(){
return g
};
j.addValidElements=C;
j.setValidElements=q;
j.addCustomElements=u;
j.addValidChildren=T
}
}
)(tinymce);
(function(e){
e.html.SaxParser=function(a,n){
var t=this,o=function(){};
a=a||{};
t.schema=n=n||new e.html.Schema();
if(a.fix_self_closing!==false){
a.fix_self_closing=true
}
e.each("comment cdata text start end pi doctype".split(" "),function(s){
if(s){
t[s]=a[s]||o
}}
);
t.parse=function(D){
var m=this,r,F=0,R,W,A=[],G,P,B,b,O,v,E,M,L,j,u,c,k,U,f,N,S,J,Y,s,H,d,C,I,h,z=0,l=e.html.Entities.decode,T,g;
function q(K){
var V,Q;
V=A.length;
while(V--){
if(A[V].name===K){
break
}}
if(V>=0){
for(Q=A.length-1;
Q>=V;
Q--){
K=A[Q];
if(K.valid){
m.end(K.name)
}}
A.length=V
}}
function p(Q,K,_e,X,Z){
var _t,V;
K=K.toLowerCase();
_e=K in M?K:l(_e||X||Z||"");
if(j&&!O&&K.indexOf("data-")!==0){
_t=N[K];
if(!_t&&S){
V=S.length;
while(V--){
_t=S[V];
if(_t.pattern.test(K)){
break
}}
if(V===-1){
_t=null
}}
if(!_t){
return
}
if(_t.validValues&&!(_e in _t.validValues)){
return
}}
G.map[K]=_e;
G.push({
name:K,value:_e}
)
}
d=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g");
C=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;
I={
script:/<\/script[^>]*>/gi,style:/<\/style[^>]*>/gi,noscript:/<\/noscript[^>]*>/gi};
E=n.getShortEndedElements();
H=a.self_closing_elements||n.getSelfClosingElements();
M=n.getBoolAttrs();
j=a.validate;
v=a.remove_internals;
T=a.fix_self_closing;
g=e.isIE;
f=/^:/;
while(r=d.exec(D)){
if(F<r.index){
m.text(l(D.substr(F,r.index-F)))
}
if(R=r[6]){
R=R.toLowerCase();
if(g&&f.test(R)){
R=R.substr(1)
}
q(R)
}else{
if(R=r[7]){
R=R.toLowerCase();
if(g&&f.test(R)){
R=R.substr(1)
}
L=R in E;
if(T&&H[R]&&A.length>0&&A[A.length-1].name===R){
q(R)
}
if(!j||(u=n.getElementRule(R))){
c=true;
if(j){
N=u.attributes;
S=u.attributePatterns
}
if(U=r[8]){
O=U.indexOf("data-mce-type")!==-1;
if(O&&v){
c=false
}
G=[];
G.map={};
U.replace(C,p)
}else{
G=[];
G.map={}
}
if(j&&!O){
J=u.attributesRequired;
Y=u.attributesDefault;
s=u.attributesForced;
if(s){
P=s.length;
while(P--){
k=s[P];
b=k.name;
h=k.value;
if(h==="{$uid}"){
h="mce_"+z++
}
G.map[b]=h;
G.push({
name:b,value:h}
)
}}
if(Y){
P=Y.length;
while(P--){
k=Y[P];
b=k.name;
if(!(b in G.map)){
h=k.value;
if(h==="{$uid}"){
h="mce_"+z++
}
G.map[b]=h;
G.push({
name:b,value:h}
)
}}}
if(J){
P=J.length;
while(P--){
if(J[P] in G.map){
break
}}
if(P===-1){
c=false
}}
if(G.map["data-mce-bogus"]){
c=false
}}
if(c){
m.start(R,G,L)
}}else{
c=false
}
if(W=I[R]){
W.lastIndex=F=r.index+r[0].length;
if(r=W.exec(D)){
if(c){
B=D.substr(F,r.index-F)
}
F=r.index+r[0].length
}else{
B=D.substr(F);
F=D.length
}
if(c&&B.length>0){
m.text(B,true)
}
if(c){
m.end(R)
}
d.lastIndex=F;
continue
}
if(!L){
if(!U||U.indexOf("/")!=U.length-1){
A.push({
name:R,valid:c}
)
}else{
if(c){
m.end(R)
}}}}else{
if(R=r[1]){
m.comment(R)
}else{
if(R=r[2]){
m.cdata(R)
}else{
if(R=r[3]){
m.doctype(R)
}else{
if(R=r[4]){
m.pi(R,r[5])
}}}}}}
F=r.index+r[0].length
}
if(F<D.length){
m.text(l(D.substr(F)))
}
for(P=A.length-1;
P>=0;
P--){
R=A[P];
if(R.valid){
m.end(R.name)
}}}
}
}
)(tinymce);
(function(o){
var a=/^[ \t\r\n]*$/,n={
"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};
function e(d,u,c){
var l,h,s=c?"lastChild":"firstChild",r=c?"prev":"next";
if(d[s]){
return d[s]
}
if(d!==u){
l=d[r];
if(l){
return l
}
for(h=d.parent;
h&&h!==u;
h=h.parent){
l=h[r];
if(l){
return l
}}}}
function t(s,r){
this.name=s;
this.type=r;
if(r===1){
this.attributes=[];
this.attributes.map={}
}}
o.extend(t.prototype,{
replace:function(r){
var s=this;
if(r.parent){
r.remove()
}
s.insert(r,s);
s.remove();
return s
}
,attr:function(h,d){
var s=this,r,l,c;
if(typeof h!=="string"){
for(l in h){
s.attr(l,h[l])
}
return s
}
if(r=s.attributes){
if(d!==c){
if(d===null){
if(h in r.map){
delete r.map[h];
l=r.length;
while(l--){
if(r[l].name===h){
r=r.splice(l,1);
return s
}}}
return s
}
if(h in r.map){
l=r.length;
while(l--){
if(r[l].name===h){
r[l].value=d;
break
}}}else{
r.push({
name:h,value:d}
)
}
r.map[h]=d;
return s
}else{
return r.map[h]
}}}
,clone:function(){
var r=this,m=new t(r.name,r.type),h,s,u,c,d;
if(u=r.attributes){
d=[];
d.map={};
for(h=0,s=u.length;
h<s;
h++){
c=u[h];
if(c.name!=="id"){
d[d.length]={
name:c.name,value:c.value};
d.map[c.name]=c.value
}}
m.attributes=d
}
m.value=r.value;
m.shortEnded=r.shortEnded;
return m
}
,wrap:function(r){
var s=this;
s.parent.insert(r,s);
r.append(s);
return s
}
,unwrap:function(){
var s=this,h,r;
for(h=s.firstChild;
h;
){
r=h.next;
s.insert(h,s,true);
h=r
}
s.remove()
}
,remove:function(){
var s=this,h=s.parent,r=s.next,l=s.prev;
if(h){
if(h.firstChild===s){
h.firstChild=r;
if(r){
r.prev=null
}}else{
l.next=r
}
if(h.lastChild===s){
h.lastChild=l;
if(l){
l.next=null
}}else{
r.prev=l
}
s.parent=s.next=s.prev=null
}
return s
}
,append:function(h){
var s=this,r;
if(h.parent){
h.remove()
}
r=s.lastChild;
if(r){
r.next=h;
h.prev=r;
s.lastChild=h
}else{
s.lastChild=s.firstChild=h
}
h.parent=s;
return h
}
,insert:function(h,s,l){
var r;
if(h.parent){
h.remove()
}
r=s.parent||this;
if(l){
if(s===r.firstChild){
r.firstChild=h
}else{
s.prev.next=h
}
h.prev=s.prev;
h.next=s;
s.prev=h
}else{
if(s===r.lastChild){
r.lastChild=h
}else{
s.next.prev=h
}
h.next=s.next;
h.prev=s;
s.next=h
}
h.parent=r;
return h
}
,getAll:function(r){
var s=this,h,l=[];
for(h=s.firstChild;
h;
h=e(h,s)){
if(h.name===r){
l.push(h)
}}
return l
}
,empty:function(){
var r=this,s,h,l;
if(r.firstChild){
s=[];
for(l=r.firstChild;
l;
l=e(l,r)){
s.push(l)
}
h=s.length;
while(h--){
l=s[h];
l.parent=l.firstChild=l.lastChild=l.next=l.prev=null
}}
r.firstChild=r.lastChild=null;
return r
}
,isEmpty:function(c){
var s=this,l=s.firstChild,h,r;
if(l){
do{
if(l.type===1){
if(l.attributes.map["data-mce-bogus"]){
continue
}
if(c[l.name]){
return false
}
h=l.attributes.length;
while(h--){
r=l.attributes[h].name;
if(r==="name"||r.indexOf("data-")===0){
return false
}}}
if(l.type===8){
return false
}
if((l.type===3&&!a.test(l.value))){
return false
}}
while(l=e(l,s))
}
return true
}
,walk:function(s){
return e(this,null,s)
}}
);
o.extend(t,{
create:function(r,s){
var l,h;
l=new t(r,n[r]||1);
if(s){
for(h in s){
l.attr(h,s[h])
}}
return l
}}
);
o.html.Node=t
}
)(tinymce);
(function(t){
var e=t.html.Node;
t.html.DomParser=function(r,h){
var s=this,n={}
,o=[],l={}
,a={};
r=r||{};
r.validate="validate" in r?r.validate:true;
r.root_name=r.root_name||"body";
s.schema=h=h||new t.html.Schema();
function c(m){
var p,g,T,z,A,f,b,u,q,j,d,k,O,v;
k=t.makeMap("tr,td,th,tbody,thead,tfoot,table");
d=h.getNonEmptyElements();
for(p=0;
p<m.length;
p++){
g=m[p];
if(!g.parent){
continue
}
z=[g];
for(T=g.parent;
T&&!h.isValidChild(T.name,g.name)&&!k[T.name];
T=T.parent){
z.push(T)
}
if(T&&z.length>1){
z.reverse();
A=f=s.filterNode(z[0].clone());
for(q=0;
q<z.length-1;
q++){
if(h.isValidChild(f.name,z[q].name)){
b=s.filterNode(z[q].clone());
f.append(b)
}else{
b=f
}
for(u=z[q].firstChild;
u&&u!=z[q+1];
){
v=u.next;
b.append(u);
u=v
}
f=b
}
if(!A.isEmpty(d)){
T.insert(A,z[0],true);
T.insert(g,A)
}else{
T.insert(g,z[0],true)
}
T=z[0];
if(T.isEmpty(d)||T.firstChild===T.lastChild&&T.firstChild.name==="br"){
T.empty().remove()
}}else{
if(g.parent){
if(g.name==="li"){
O=g.prev;
if(O&&(O.name==="ul"||O.name==="ul")){
O.append(g);
continue
}
O=g.next;
if(O&&(O.name==="ul"||O.name==="ul")){
O.insert(g,O.firstChild,true);
continue
}
g.wrap(s.filterNode(new e("ul",1)));
continue
}
if(h.isValidChild(g.parent.name,"div")&&h.isValidChild("div",g.name)){
g.wrap(s.filterNode(new e("div",1)))
}else{
if(g.name==="style"||g.name==="script"){
g.empty().remove()
}else{
g.unwrap()
}}}}}}
s.filterNode=function(m){
var u,d,f;
if(d in n){
f=l[d];
if(f){
f.push(m)
}else{
l[d]=[m]
}}
u=o.length;
while(u--){
d=o[u].name;
if(d in m.attributes.map){
f=a[d];
if(f){
f.push(m)
}else{
a[d]=[m]
}}}
return m
};
s.addNodeFilter=function(d,u){
t.each(t.explode(d),function(m){
var f=n[m];
if(!f){
n[m]=f=[]
}
f.push(u)
}
)
};
s.addAttributeFilter=function(d,u){
t.each(t.explode(d),function(m){
var f;
for(f=0;
f<o.length;
f++){
if(o[f].name===m){
o[f].callbacks.push(u);
return
}}
o.push({
name:m,callbacks:[u]}
)
}
)
};
s.parse=function(j,u){
var m,H,W,A,C,B,z,b,S,G,O,f,D,E=[],Y,k,d,T,v,p,q,g;
u=u||{};
l={};
a={};
f=t.extend(t.makeMap("script,style,head,html,body,title,meta,param"),h.getBlockElements());
q=h.getNonEmptyElements();
p=h.children;
O=r.validate;
g="forced_root_block" in u?u.forced_root_block:r.forced_root_block;
v=h.getWhiteSpaceElements();
D=/^[ \t\r\n]+/;
k=/[ \t\r\n]+$/;
d=/[ \t\r\n]+/g;
T=/^[ \t\r\n]+$/;
function F(){
var N=H.firstChild,L,P;
while(N){
L=N.next;
if(N.type==3||(N.type==1&&N.name!=="p"&&!f[N.name]&&!N.attr("data-mce-type"))){
if(!P){
P=I(g,1);
H.insert(P,N);
P.append(N)
}else{
P.append(N)
}}else{
P=null
}
N=L
}}
function I(L,N){
var P=new e(L,N),U;
if(L in n){
U=l[L];
if(U){
U.push(P)
}else{
l[L]=[P]
}}
return P
}
function R(P){
var U,L,N;
for(U=P.prev;
U&&U.type===3;
){
L=U.value.replace(k,"");
if(L.length>0){
U.value=L;
U=U.prev
}else{
N=U.prev;
U.remove();
U=N
}}}
function M(N){
var P,L={};
for(P in N){
if(P!=="li"&&P!="p"){
L[P]=N[P]
}}
return L
}
m=new t.html.SaxParser({
validate:O,self_closing_elements:M(h.getSelfClosingElements()),cdata:function(L){
W.append(I("#cdata",4)).value=L
}
,text:function(P,L){
var N;
if(!Y){
P=P.replace(d," ");
if(W.lastChild&&f[W.lastChild.name]){
P=P.replace(D,"")
}}
if(P.length!==0){
N=I("#text",3);
N.raw=!!L;
W.append(N).value=P
}}
,comment:function(L){
W.append(I("#comment",8)).value=L
}
,pi:function(L,N){
W.append(I(L,7)).value=N;
R(W)
}
,doctype:function(N){
var L;
L=W.append(I("#doctype",10));
L.value=N;
R(W)
}
,start:function(L,X,P){
var V,J,U,N,K,_e,Z,Q;
U=O?h.getElementRule(L):{};
if(U){
V=I(U.outputName||L,1);
V.attributes=X;
V.shortEnded=P;
W.append(V);
Q=p[W.name];
if(Q&&p[V.name]&&!Q[V.name]){
E.push(V)
}
J=o.length;
while(J--){
K=o[J].name;
if(K in X.map){
S=a[K];
if(S){
S.push(V)
}else{
a[K]=[V]
}}}
if(f[L]){
R(V)
}
if(!P){
W=V
}
if(!Y&&v[L]){
Y=true
}}}
,end:function(L){
var K,P,J,N,U;
P=O?h.getElementRule(L):{};
if(P){
if(f[L]){
if(!Y){
K=W.firstChild;
if(K&&K.type===3){
J=K.value.replace(D,"");
if(J.length>0){
K.value=J;
K=K.next
}else{
N=K.next;
K.remove();
K=N
}
while(K&&K.type===3){
J=K.value;
N=K.next;
if(J.length===0||T.test(J)){
K.remove();
K=N
}
K=N
}}
K=W.lastChild;
if(K&&K.type===3){
J=K.value.replace(k,"");
if(J.length>0){
K.value=J;
K=K.prev
}else{
N=K.prev;
K.remove();
K=N
}
while(K&&K.type===3){
J=K.value;
N=K.prev;
if(J.length===0||T.test(J)){
K.remove();
K=N
}
K=N
}}}
K=W.prev;
if(K&&K.type===3){
J=K.value.replace(D,"");
if(J.length>0){
K.value=J
}else{
K.remove()
}}}
if(Y&&v[L]){
Y=false
}
if(P.removeEmpty||P.paddEmpty){
if(W.isEmpty(q)){
if(P.paddEmpty){
W.empty().append(new e("#text","3")).value="\u00a0"
}else{
if(!W.attributes.map.name&&!W.attributes.map.id){
U=W.parent;
W.empty().remove();
W=U;
return
}}}}
W=W.parent
}}}
,h);
H=W=new e(u.context||r.root_name,11);
m.parse(j);
if(O&&E.length){
if(!u.context){
c(E)
}else{
u.invalid=true
}}
if(g&&H.name=="body"){
F()
}
if(!u.invalid){
for(G in l){
S=n[G];
A=l[G];
z=A.length;
while(z--){
if(!A[z].parent){
A.splice(z,1)
}}
for(C=0,B=S.length;
C<B;
C++){
S[C](A,G,u)
}}
for(C=0,B=o.length;
C<B;
C++){
S=o[C];
if(S.name in a){
A=a[S.name];
z=A.length;
while(z--){
if(!A[z].parent){
A.splice(z,1)
}}
for(z=0,b=S.callbacks.length;
z<b;
z++){
S.callbacks[z](A,S.name,u)
}}}}
return H
};
if(r.remove_trailing_brs){
s.addNodeFilter("br",function(m,u){
var b,g=m.length,f,j=t.extend({}
,h.getBlockElements()),d=h.getNonEmptyElements(),k,v,p,q;
j.body=1;
for(b=0;
b<g;
b++){
f=m[b];
k=f.parent;
if(j[f.parent.name]&&f===k.lastChild){
p=f.prev;
while(p){
q=p.name;
if(q!=="span"||p.attr("data-mce-type")!=="bookmark"){
if(q!=="br"){
break
}
if(q==="br"){
f=null;
break
}}
p=p.prev
}
if(f){
f.remove();
if(k.isEmpty(d)){
elementRule=h.getElementRule(k.name);
if(elementRule){
if(elementRule.removeEmpty){
k.remove()
}else{
if(elementRule.paddEmpty){
k.empty().append(new t.html.Node("#text",3)).value="\u00a0"
}}}}}}else{
v=f;
while(k.firstChild===v&&k.lastChild===v){
v=k;
if(j[k.name]){
break
}
k=k.parent
}
if(v===k){
textNode=new t.html.Node("#text",3);
textNode.value="\u00a0";
f.replace(textNode)
}}}}
)
}
if(!r.allow_html_in_named_anchor){
s.addAttributeFilter("id,name",function(d,u){
var f=d.length,g,m,p,b;
while(f--){
b=d[f];
if(b.name==="a"&&b.firstChild&&!b.attr("href")){
p=b.parent;
g=b.lastChild;
do{
m=g.prev;
p.insert(g,b);
g=m
}
while(g)
}}}
)
}}
}
)(tinymce);
tinymce.html.Writer=function(n){
var a=[],e,t,o,s,r;
n=n||{};
e=n.indent;
t=tinymce.makeMap(n.indent_before||"");
o=tinymce.makeMap(n.indent_after||"");
s=tinymce.html.Entities.getEncodeFunc(n.entity_encoding||"raw",n.entities);
r=n.element_format=="html";
return{
start:function(u,d,p){
var m,c,h,f;
if(e&&t[u]&&a.length>0){
f=a[a.length-1];
if(f.length>0&&f!=="\n"){
a.push("\n")
}}
a.push("<",u);
if(d){
for(m=0,c=d.length;
m<c;
m++){
h=d[m];
a.push(" ",h.name,'="',s(h.value,true),'"')
}}
if(!p||r){
a[a.length]=">"
}else{
a[a.length]=" />"
}
if(p&&e&&o[u]&&a.length>0){
f=a[a.length-1];
if(f.length>0&&f!=="\n"){
a.push("\n")
}}}
,end:function(h){
var l;
a.push("</",h,">");
if(e&&o[h]&&a.length>0){
l=a[a.length-1];
if(l.length>0&&l!=="\n"){
a.push("\n")
}}}
,text:function(l,h){
if(l.length>0){
a[a.length]=h?l:s(l)
}}
,cdata:function(h){
a.push("<![CDATA[",h,"]]>")
}
,comment:function(h){
a.push("<!--",h,"-->")
}
,pi:function(h,l){
if(l){
a.push("<?",h," ",l,"?>")
}else{
a.push("<?",h,"?>")
}
if(e){
a.push("\n")
}}
,doctype:function(h){
a.push("<!DOCTYPE",h,">",e?"\n":"")
}
,reset:function(){
a.length=0
}
,getContent:function(){
return a.join("").replace(/\n$/,"")
}}
};
(function(e){
e.html.Serializer=function(a,o){
var t=this,n=new e.html.Writer(a);
a=a||{};
a.validate="validate" in a?a.validate:true;
t.schema=o=o||new e.html.Schema();
t.writer=n;
t.serialize=function(h){
var r,l;
l=a.validate;
r={
3:function(d,c){
n.text(d.value,d.raw)
}
,8:function(c){
n.comment(c.value)
}
,7:function(c){
n.pi(c.name,c.value)
}
,10:function(c){
n.doctype(c.value)
}
,4:function(c){
n.cdata(c.value)
}
,11:function(c){
if((c=c.firstChild)){
do{
s(c)
}
while(c=c.next)
}}};
n.reset();
function s(d){
var k=r[d.type],c,f,v,b,p,q,m,u,g;
if(!k){
c=d.name;
f=d.shortEnded;
v=d.attributes;
if(l&&v&&v.length>1){
q=[];
q.map={};
g=o.getElementRule(d.name);
for(m=0,u=g.attributesOrder.length;
m<u;
m++){
b=g.attributesOrder[m];
if(b in v.map){
p=v.map[b];
q.map[b]=p;
q.push({
name:b,value:p}
)
}}
for(m=0,u=v.length;
m<u;
m++){
b=v[m].name;
if(!(b in q.map)){
p=v.map[b];
q.map[b]=p;
q.push({
name:b,value:p}
)
}}
v=q
}
n.start(d.name,v,f);
if(!f){
if((d=d.firstChild)){
do{
s(d)
}
while(d=d.next)
}
n.end(c)
}}else{
k(d)
}}
if(h.type==1&&!a.inner){
s(h)
}else{
r[11](h)
}
return n.getContent()
}
}
}
)(tinymce);
tinymce.dom={};
(function(t,h){
var r=!!document.addEventListener;
function a(d,c,u,l){
if(d.addEventListener){
d.addEventListener(c,u,l||false)
}else{
if(d.attachEvent){
d.attachEvent("on"+c,u)
}}}
function n(d,c,u,l){
if(d.removeEventListener){
d.removeEventListener(c,u,l||false)
}else{
if(d.detachEvent){
d.detachEvent("on"+c,u)
}}}
function e(f,u){
var l,d=u||{};
function c(){
return false
}
function m(){
return true
}
for(l in f){
if(l!=="layerX"&&l!=="layerY"){
d[l]=f[l]
}}
if(!d.target){
d.target=d.srcElement||document
}
d.preventDefault=function(){
d.isDefaultPrevented=m;
if(f){
if(f.preventDefault){
f.preventDefault()
}else{
f.returnValue=false
}}};
d.stopPropagation=function(){
d.isPropagationStopped=m;
if(f){
if(f.stopPropagation){
f.stopPropagation()
}else{
f.cancelBubble=true
}}};
d.stopImmediatePropagation=function(){
d.isImmediatePropagationStopped=m;
d.stopPropagation()
};
if(!d.isDefaultPrevented){
d.isDefaultPrevented=c;
d.isPropagationStopped=c;
d.isImmediatePropagationStopped=c
}
return d
}
function o(m,f,u){
var d=m.document,c={
type:"ready"};
function l(){
if(!u.domLoaded){
u.domLoaded=true;
f(c)
}}
if(r){
a(m,"DOMContentLoaded",l)
}else{
a(d,"readystatechange",function(){
if(d.readyState==="complete"){
n(d,"readystatechange",arguments.callee);
l()
}}
);
if(d.documentElement.doScroll&&m===m.top){
(function(){
try{
d.documentElement.doScroll("left")
}
catch(p){
setTimeout(arguments.callee,0);
return
}
l()
}
)()
}}
a(m,"load",l)
}
function s(d){
var b=this,g={}
,l,p,f,m,u;
m="onmouseenter" in document.documentElement;
f="onfocusin" in document.documentElement;
u={
mouseenter:"mouseover",mouseleave:"mouseout"};
l=1;
b.domLoaded=false;
b.events=g;
function c(q,T){
var k,j,v,z;
k=g[T][q.type];
if(k){
for(j=0,v=k.length;
j<v;
j++){
z=k[j];
if(z&&z.func.call(z.scope,q)===false){
q.preventDefault()
}
if(q.isImmediatePropagationStopped()){
return
}}}}
b.bind=function(T,W,D,S){
var k,q,j,v,B,A,C,z=window;
function O(F){
c(e(F||z.event),k)
}
if(!T||T.nodeType===3||T.nodeType===8){
return
}
if(!T[h]){
k=l++;
T[h]=k;
g[k]={}
}else{
k=T[h];
if(!g[k]){
g[k]={}
}}
S=S||T;
W=W.split(" ");
j=W.length;
while(j--){
v=W[j];
A=O;
B=C=false;
if(v==="DOMContentLoaded"){
v="ready"
}
if((b.domLoaded||T.readyState=="complete")&&v==="ready"){
b.domLoaded=true;
D.call(S,e({
type:v}
));
continue
}
if(!m){
B=u[v];
if(B){
A=function(F){
var R,M;
R=F.currentTarget;
M=F.relatedTarget;
if(M&&R.contains){
M=R.contains(M)
}else{
while(M&&M!==R){
M=M.parentNode
}}
if(!M){
F=e(F||z.event);
F.type=F.type==="mouseout"?"mouseleave":"mouseenter";
F.target=R;
c(F,k)
}}
}}
if(!f&&(v==="focusin"||v==="focusout")){
C=true;
B=v==="focusin"?"focus":"blur";
A=function(F){
F=e(F||z.event);
F.type=F.type==="focus"?"focusin":"focusout";
c(F,k)
}
}
q=g[k][v];
if(!q){
g[k][v]=q=[{
func:D,scope:S}
];
q.fakeName=B;
q.capture=C;
q.nativeHandler=A;
if(!r){
q.proxyHandler=d(k)
}
if(v==="ready"){
o(T,A,b)
}else{
a(T,B||v,r?A:q.proxyHandler,C)
}}else{
q.push({
func:D,scope:S}
)
}}
T=q=0;
return D
};
b.unbind=function(T,A,W){
var k,j,z,B,v,q;
if(!T||T.nodeType===3||T.nodeType===8){
return b
}
k=T[h];
if(k){
q=g[k];
if(A){
A=A.split(" ");
z=A.length;
while(z--){
v=A[z];
j=q[v];
if(j){
if(W){
B=j.length;
while(B--){
if(j[B].func===W){
j.splice(B,1)
}}}
if(!W||j.length===0){
delete q[v];
n(T,j.fakeName||v,r?j.nativeHandler:j.proxyHandler,j.capture)
}}}}else{
for(v in q){
j=q[v];
n(T,j.fakeName||v,r?j.nativeHandler:j.proxyHandler,j.capture)
}
q={}
}
for(v in q){
return b
}
delete g[k];
try{
delete T[h]
}
catch(O){
T[h]=null
}}
return b
};
b.fire=function(j,k,v){
var z,q;
if(!j||j.nodeType===3||j.nodeType===8){
return b
}
q=e(null,v);
q.type=k;
do{
z=j[h];
if(z){
c(q,z)
}
j=j.parentNode||j.ownerDocument||j.defaultView||j.parentWindow
}
while(j&&!q.isPropagationStopped());
return b
};
b.clean=function(j){
var k,v,q=b.unbind;
if(!j||j.nodeType===3||j.nodeType===8){
return b
}
if(j[h]){
q(j)
}
if(!j.getElementsByTagName){
j=j.document
}
if(j&&j.getElementsByTagName){
q(j);
v=j.getElementsByTagName("*");
k=v.length;
while(k--){
j=v[k];
if(j[h]){
q(j)
}}}
return b
};
b.callNativeHandler=function(k,v){
if(g){
g[k][v.type].nativeHandler(v)
}};
b.destory=function(){
g={}
};
b.add=function(z,k,j,q){
if(typeof(z)==="string"){
z=document.getElementById(z)
}
if(z&&z instanceof Array){
var v=z.length;
while(v--){
b.add(z[v],k,j,q)
}
return
}
if(k==="init"){
k="ready"
}
return b.bind(z,k instanceof Array?k.join(" "):k,j,q)
};
b.remove=function(z,k,j,q){
if(!z){
return b
}
if(typeof(z)==="string"){
z=document.getElementById(z)
}
if(z instanceof Array){
var v=z.length;
while(v--){
b.remove(z[v],k,j,q)
}
return b
}
return b.unbind(z,k instanceof Array?k.join(" "):k,j)
};
b.clear=function(v){
if(typeof(v)==="string"){
v=document.getElementById(v)
}
return b.clean(v)
};
b.cancel=function(v){
if(v){
b.prevent(v);
b.stop(v)
}
return false
};
b.prevent=function(v){
if(!v.preventDefault){
v=e(v)
}
v.preventDefault();
return false
};
b.stop=function(v){
if(!v.stopPropagation){
v=e(v)
}
v.stopPropagation();
return false
}
}
t.EventUtils=s;
t.Event=new s(function(l){
return function(c){
tinymce.dom.Event.callNativeHandler(l,c)
}
}
);
t.Event.bind(window,"ready",function(){}
);
t=0
}
)(tinymce.dom,"data-mce-expando");
tinymce.dom.TreeWalker=function(e,a){
var t=e;
function o(l,s,n,c){
var h,r;
if(l){
if(!c&&l[s]){
return l[s]
}
if(l!=a){
h=l[n];
if(h){
return h
}
for(r=l.parentNode;
r&&r!=a;
r=r.parentNode){
h=r[n];
if(h){
return h
}}}}}
this.current=function(){
return t
};
this.next=function(n){
return(t=o(t,"firstChild","nextSibling",n))
};
this.prev=function(n){
return(t=o(t,"lastChild","previousSibling",n))
}
};
(function(n){
var r=n.each,o=n.is,s=n.isWebKit,t=n.isIE,h=n.html.Entities,a=/^([a-z0-9],?)+$/i,e=/^[ \t\r\n]*$/;
n.create("tinymce.dom.DOMUtils",{
doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{
"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"}
,DOMUtils:function(g,m){
var u=this,l,c,p;
u.doc=g;
u.win=window;
u.files={};
u.cssFlicker=false;
u.counter=0;
u.stdMode=!n.isIE||g.documentMode>=8;
u.boxModel=!n.isIE||g.compatMode=="CSS1Compat"||u.stdMode;
u.hasOuterHTML="outerHTML" in g.createElement("a");
u.settings=m=n.extend({
keep_values:false,hex_colors:1}
,m);
u.schema=m.schema;
u.styles=new n.html.Styles({
url_converter:m.url_converter,url_converter_scope:m.url_converter_scope}
,m.schema);
if(n.isIE6){
try{
g.execCommand("BackgroundImageCache",false,true)
}
catch(f){
u.cssFlicker=true
}}
u.fixDoc(g);
u.events=m.ownEvents?new n.dom.EventUtils(m.proxy):n.dom.Event;
n.addUnload(u.destroy,u);
p=m.schema?m.schema.getBlockElements():{};
u.isBlock=function(b){
var d=b.nodeType;
if(d){
return !!(d===1&&p[b.nodeName])
}
return !!p[b]
}
}
,fixDoc:function(d){
var c=this.settings,l;
if(t&&c.schema){
("abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video").replace(/\w+/g,function(u){
d.createElement(u)
}
);
for(l in c.schema.getCustomElements()){
d.createElement(l)
}}}
,clone:function(d,l){
var c=this,m,u;
if(!t||d.nodeType!==1||l){
return d.cloneNode(l)
}
u=c.doc;
if(!l){
m=u.createElement(d.nodeName);
r(c.getAttribs(d),function(f){
c.setAttrib(m,f.nodeName,c.getAttrib(d,f.nodeName))
}
);
return m
}
return m.firstChild
}
,getRoot:function(){
var l=this,c=l.settings;
return(c&&l.get(c.root_element))||l.doc.body
}
,getViewPort:function(c){
var u,l;
c=!c?this.win:c;
u=c.document;
l=this.boxModel?u.documentElement:u.body;
return{
x:c.pageXOffset||l.scrollLeft,y:c.pageYOffset||l.scrollTop,w:c.innerWidth||l.clientWidth,h:c.innerHeight||l.clientHeight}
}
,getRect:function(u){
var d,l=this,c;
u=l.get(u);
d=l.getPos(u);
c=l.getSize(u);
return{
x:d.x,y:d.y,w:c.w,h:c.h}
}
,getSize:function(u){
var c=this,l,d;
u=c.get(u);
l=c.getStyle(u,"width");
d=c.getStyle(u,"height");
if(l.indexOf("px")===-1){
l=0
}
if(d.indexOf("px")===-1){
d=0
}
return{
w:parseInt(l,10)||u.offsetWidth||u.clientWidth,h:parseInt(d,10)||u.offsetHeight||u.clientHeight}
}
,getParent:function(d,c,l){
return this.getParents(d,c,l,false)
}
,getParents:function(v,p,u,b){
var d=this,l,m=d.settings,g=[];
v=d.get(v);
b=b===undefined;
if(m.strict_root){
u=u||d.getRoot()
}
if(o(p,"string")){
l=p;
if(p==="*"){
p=function(c){
return c.nodeType==1
}
}else{
p=function(c){
return d.is(c,l)
}
}}
while(v){
if(v==u||!v.nodeType||v.nodeType===9){
break
}
if(!p||p(v)){
if(b){
g.push(v)
}else{
return v
}}
v=v.parentNode
}
return b?g:null
}
,get:function(l){
var c;
if(l&&this.doc&&typeof(l)=="string"){
c=l;
l=this.doc.getElementById(l);
if(l&&l.id!==c){
return this.doc.getElementsByName(c)[1]
}}
return l
}
,getNext:function(c,l){
return this._findSib(c,l,"nextSibling")
}
,getPrev:function(c,l){
return this._findSib(c,l,"previousSibling")
}
,select:function(d,c){
var l=this;
return n.dom.Sizzle(d,l.get(c)||l.get(l.settings.root_element)||l.doc,[])
}
,is:function(d,l){
var c;
if(d.length===undefined){
if(l==="*"){
return d.nodeType==1
}
if(a.test(l)){
l=l.toLowerCase().split(/,/);
d=d.nodeName.toLowerCase();
for(c=l.length-1;
c>=0;
c--){
if(l[c]==d){
return true
}}
return false
}}
return n.dom.Sizzle.matches(l,d.nodeType?[d]:d).length>0
}
,add:function(m,g,l,u,f){
var d=this;
return this.run(m,function(v){
var b,c;
b=o(g,"string")?d.doc.createElement(g):g;
d.setAttribs(b,l);
if(u){
if(u.nodeType){
b.appendChild(u)
}else{
d.setHTML(b,u)
}}
return !f?v.appendChild(b):b
}
)
}
,create:function(d,l,c){
return this.add(this.doc.createElement(d),d,l,c,1)
}
,createHTML:function(f,l,u){
var m="",d=this,c;
m+="<"+f;
for(c in l){
if(l.hasOwnProperty(c)){
m+=" "+c+'="'+d.encode(l[c])+'"'
}}
if(typeof(u)!="undefined"){
return m+">"+u+"</"+f+">"
}
return m+" />"
}
,remove:function(l,c){
return this.run(l,function(u){
var m,d=u.parentNode;
if(!d){
return null
}
if(c){
while(m=u.firstChild){
if(!n.isIE||m.nodeType!==3||m.nodeValue){
d.insertBefore(m,u)
}else{
u.removeChild(m)
}}}
return d.removeChild(u)
}
)
}
,setStyle:function(u,l,c){
var d=this;
return d.run(u,function(p){
var f,m;
f=p.style;
l=l.replace(/-(\D)/g,function(v,g){
return g.toUpperCase()
}
);
if(d.pixelStyles.test(l)&&(n.is(c,"number")||/^[\-0-9\.]+$/.test(c))){
c+="px"
}
switch(l){
case"opacity":if(t){
f.filter=c===""?"":"alpha(opacity="+(c*100)+")";
if(!u.currentStyle||!u.currentStyle.hasLayout){
f.display="inline-block"
}}
f[l]=f["-moz-opacity"]=f["-khtml-opacity"]=c||"";
break;
case"float":t?f.styleFloat=c:f.cssFloat=c;
break;
default:f[l]=c||""
}
if(d.settings.update_styles){
d.setAttrib(p,"data-mce-style")
}}
)
}
,getStyle:function(m,l,u){
m=this.get(m);
if(!m){
return
}
if(this.doc.defaultView&&u){
l=l.replace(/[A-Z]/g,function(c){
return"-"+c
}
);
try{
return this.doc.defaultView.getComputedStyle(m,null).getPropertyValue(l)
}
catch(d){
return null
}}
l=l.replace(/-(\D)/g,function(f,c){
return c.toUpperCase()
}
);
if(l=="float"){
l=t?"styleFloat":"cssFloat"
}
if(m.currentStyle&&u){
return m.currentStyle[l]
}
return m.style?m.style[l]:undefined
}
,setStyles:function(u,m){
var c=this,d=c.settings,l;
l=d.update_styles;
d.update_styles=0;
r(m,function(f,p){
c.setStyle(u,p,f)
}
);
d.update_styles=l;
if(d.update_styles){
c.setAttrib(u,d.cssText)
}}
,removeAllAttribs:function(l){
return this.run(l,function(u){
var d,c=u.attributes;
for(d=c.length-1;
d>=0;
d--){
u.removeAttributeNode(c.item(d))
}}
)
}
,setAttrib:function(d,u,l){
var c=this;
if(!d||!u){
return
}
if(c.settings.strict){
u=u.toLowerCase()
}
return this.run(d,function(g){
var p=c.settings;
var m=g.getAttribute(u);
if(l!==null){
switch(u){
case"style":if(!o(l,"string")){
r(l,function(b,k){
c.setStyle(g,k,b)
}
);
return
}
if(p.keep_values){
if(l&&!c._isRes(l)){
g.setAttribute("data-mce-style",l,2)
}else{
g.removeAttribute("data-mce-style",2)
}}
g.style.cssText=l;
break;
case"class":g.className=l||"";
break;
case"src":case"href":if(p.keep_values){
if(p.url_converter){
l=p.url_converter.call(p.url_converter_scope||c,l,u,g)
}
c.setAttrib(g,"data-mce-"+u,l,2)
}
break;
case"shape":g.setAttribute("data-mce-style",l);
break
}}
if(o(l)&&l!==null&&l.length!==0){
g.setAttribute(u,""+l,2)
}else{
g.removeAttribute(u,2)
}
if(tinyMCE.activeEditor&&m!=l){
var f=tinyMCE.activeEditor;
f.onSetAttrib.dispatch(f,g,u,l)
}}
)
}
,setAttribs:function(c,d){
var l=this;
return this.run(c,function(u){
r(d,function(m,f){
l.setAttrib(u,f,m)
}
)
}
)
}
,getAttrib:function(m,f,d){
var l,c=this,u;
m=c.get(m);
if(!m||m.nodeType!==1){
return d===u?false:d
}
if(!o(d)){
d=""
}
if(/^(src|href|style|coords|shape)$/.test(f)){
l=m.getAttribute("data-mce-"+f);
if(l){
return l
}}
if(t&&c.props[f]){
l=m[c.props[f]];
l=l&&l.nodeValue?l.nodeValue:l
}
if(!l){
l=m.getAttribute(f,2)
}
if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(f)){
if(m[c.props[f]]===true&&l===""){
return f
}
return l?f:""
}
if(m.nodeName==="FORM"&&m.getAttributeNode(f)){
return m.getAttributeNode(f).nodeValue
}
if(f==="style"){
l=l||m.style.cssText;
if(l){
l=c.serializeStyle(c.parseStyle(l),m.nodeName);
if(c.settings.keep_values&&!c._isRes(l)){
m.setAttribute("data-mce-style",l)
}}}
if(s&&f==="class"&&l){
l=l.replace(/(apple|webkit)\-[a-z\-]+/gi,"")
}
if(t){
switch(f){
case"rowspan":case"colspan":if(l===1){
l=""
}
break;
case"size":if(l==="+0"||l===20||l===0){
l=""
}
break;
case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":if(l===0){
l=""
}
break;
case"hspace":if(l===-1){
l=""
}
break;
case"maxlength":case"tabindex":if(l===32768||l===2147483647||l==="32768"){
l=""
}
break;
case"multiple":case"compact":case"noshade":case"nowrap":if(l===65535){
return f
}
return d;
case"shape":l=l.toLowerCase();
break;
default:if(f.indexOf("on")===0&&l){
l=n._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+l)
}}}
return(l!==u&&l!==null&&l!=="")?""+l:d
}
,getPos:function(b,m){
var c=this,l=0,g=0,f,p=c.doc,u;
b=c.get(b);
m=m||p.body;
if(b){
if(b.getBoundingClientRect){
b=b.getBoundingClientRect();
f=c.boxModel?p.documentElement:p.body;
l=b.left+(p.documentElement.scrollLeft||p.body.scrollLeft)-f.clientTop;
g=b.top+(p.documentElement.scrollTop||p.body.scrollTop)-f.clientLeft;
return{
x:l,y:g}
}
u=b;
while(u&&u!=m&&u.nodeType){
l+=u.offsetLeft||0;
g+=u.offsetTop||0;
u=u.offsetParent
}
u=b.parentNode;
while(u&&u!=m&&u.nodeType){
l-=u.scrollLeft||0;
g-=u.scrollTop||0;
u=u.parentNode
}}
return{
x:l,y:g}
}
,parseStyle:function(l){
return this.styles.parse(l)
}
,serializeStyle:function(c,l){
return this.styles.serialize(c,l)
}
,addStyle:function(c){
var d=this.doc,l;
styleElm=d.getElementById("mceDefaultStyles");
if(!styleElm){
styleElm=d.createElement("style"),styleElm.id="mceDefaultStyles";
styleElm.type="text/css";
l=d.getElementsByTagName("head")[0];
if(l.firstChild){
l.insertBefore(styleElm,l.firstChild)
}else{
l.appendChild(styleElm)
}}
if(styleElm.styleSheet){
styleElm.styleSheet.cssText+=c
}else{
styleElm.appendChild(d.createTextNode(c))
}}
,loadCSS:function(l){
var m=this,f=m.doc,c;
if(!l){
l=""
}
c=f.getElementsByTagName("head")[0];
r(l.split(","),function(d){
var p;
if(m.files[d]){
return
}
m.files[d]=true;
p=m.create("link",{
rel:"stylesheet",href:n._addVer(d)}
);
if(t&&f.documentMode&&f.recalc){
p.onload=function(){
if(f.recalc){
f.recalc()
}
p.onload=null
}
}
c.appendChild(p)
}
)
}
,addClass:function(l,d){
return this.run(l,function(c){
var u;
if(!d){
return 0
}
if(this.hasClass(c,d)){
return c.className
}
u=this.removeClass(c,d);
return c.className=(u!=""?(u+" "):"")+d
}
)
}
,removeClass:function(u,m){
var l=this,d;
return l.run(u,function(f){
var c;
if(l.hasClass(f,m)){
if(!d){
d=new RegExp("(^|\\s+)"+m+"(\\s+|$)","g")
}
c=f.className.replace(d," ");
c=n.trim(c!=" "?c:"");
f.className=c;
if(!c){
f.removeAttribute("class");
f.removeAttribute("className")
}
return c
}
return f.className
}
)
}
,hasClass:function(d,l){
d=this.get(d);
if(!d||!l){
return false
}
return(" "+d.className+" ").indexOf(" "+l+" ")!==-1
}
,show:function(l){
return this.setStyle(l,"display","block")
}
,hide:function(l){
return this.setStyle(l,"display","none")
}
,isHidden:function(l){
l=this.get(l);
return !l||l.style.display=="none"||this.getStyle(l,"display")=="none"
}
,uniqueId:function(l){
return(!l?"mce_":l)+(this.counter++)
}
,setHTML:function(d,c){
var l=this;
return l.run(d,function(m){
if(t){
while(m.firstChild){
m.removeChild(m.firstChild)
}
try{
m.innerHTML="<br />"+c;
m.removeChild(m.firstChild)
}
catch(u){
var f=l.create("div");
f.innerHTML="<br />"+c;
r(n.grep(f.childNodes),function(g,p){
if(p&&m.canHaveHTML){
m.appendChild(g)
}}
)
}}else{
m.innerHTML=c
}
return c
}
)
}
,getOuterHTML:function(d){
var c,l=this;
d=l.get(d);
if(!d){
return null
}
if(d.nodeType===1&&l.hasOuterHTML){
return d.outerHTML
}
c=(d.ownerDocument||l.doc).createElement("body");
c.appendChild(d.cloneNode(true));
return c.innerHTML
}
,setOuterHTML:function(m,c,f){
var l=this;
function u(g,p,v){
var k,b;
b=v.createElement("body");
b.innerHTML=p;
k=b.lastChild;
while(k){
l.insertAfter(k.cloneNode(true),g);
k=k.previousSibling
}
l.remove(g)
}
return this.run(m,function(p){
p=l.get(p);
if(p.nodeType==1){
f=f||p.ownerDocument||l.doc;
if(t){
try{
if(t&&p.nodeType==1){
p.outerHTML=c
}else{
u(p,c,f)
}}
catch(d){
u(p,c,f)
}}else{
u(p,c,f)
}}}
)
}
,decode:h.decode,encode:h.encodeAllRaw,insertAfter:function(l,c){
c=this.get(c);
return this.run(l,function(u){
var d,m;
d=c.parentNode;
m=c.nextSibling;
if(m){
d.insertBefore(u,m)
}else{
d.appendChild(u)
}
return u
}
)
}
,replace:function(u,d,l){
var c=this;
if(o(d,"array")){
u=u.cloneNode(true)
}
return c.run(d,function(m){
if(l){
r(n.grep(m.childNodes),function(f){
u.appendChild(f)
}
)
}
return m.parentNode.replaceChild(u,m)
}
)
}
,rename:function(u,l){
var d=this,c;
if(u.nodeName!=l.toUpperCase()){
c=d.create(l);
r(d.getAttribs(u),function(m){
d.setAttrib(c,m.nodeName,d.getAttrib(u,m.nodeName))
}
);
d.replace(c,u,1)
}
return c||u
}
,findCommonAncestor:function(d,l){
var u=d,c;
while(u){
c=l;
while(c&&u!=c){
c=c.parentNode
}
if(u==c){
break
}
u=u.parentNode
}
if(!u&&d.ownerDocument){
return d.ownerDocument.documentElement
}
return u
}
,toHex:function(l){
var u=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(l);
function d(c){
c=parseInt(c,10).toString(16);
return c.length>1?c:"0"+c
}
if(u){
l="#"+d(u[1])+d(u[2])+d(u[3]);
return l
}
return l
}
,getClasses:function(){
var m=this,l=[],u,p={}
,g=m.settings.class_filter,d;
if(m.classes){
return m.classes
}
function b(f){
r(f.imports,function(v){
b(v)
}
);
r(f.cssRules||f.rules,function(v){
switch(v.type||1){
case 1:if(v.selectorText){
r(v.selectorText.split(","),function(k){
k=k.replace(/^\s*|\s*$|^\s\./g,"");
if(/\.mce/.test(k)||!/\.[\w\-]+$/.test(k)){
return
}
d=k;
k=n._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",k);
if(g&&!(k=g(k,d))){
return
}
if(!p[k]){
l.push({
"class":k}
);
p[k]=1
}}
)
}
break;
case 3:b(v.styleSheet);
break
}}
)
}
try{
r(m.doc.styleSheets,b)
}
catch(c){}
if(l.length>0){
m.classes=l
}
return l
}
,run:function(u,d,c){
var l=this,m;
if(l.doc&&typeof(u)==="string"){
u=l.get(u)
}
if(!u){
return false
}
c=c||this;
if(!u.nodeType&&(u.length||u.length===0)){
m=[];
r(u,function(p,f){
if(p){
if(typeof(p)=="string"){
p=l.doc.getElementById(p)
}
m.push(d.call(c,p,f))
}}
);
return m
}
return d.call(c,u)
}
,getAttribs:function(c){
var l;
c=this.get(c);
if(!c){
return[]
}
if(t){
l=[];
if(c.nodeName=="OBJECT"){
return c.attributes
}
if(c.nodeName==="OPTION"&&this.getAttrib(c,"selected")){
l.push({
specified:1,nodeName:"selected"}
)
}
c.cloneNode(false).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(d){
l.push({
specified:1,nodeName:d}
)
}
);
return l
}
return c.attributes
}
,isEmpty:function(u,c){
var b=this,f,m,g,l,d,p=0;
u=u.firstChild;
if(u){
l=new n.dom.TreeWalker(u,u.parentNode);
c=c||b.schema?b.schema.getNonEmptyElements():null;
do{
g=u.nodeType;
if(g===1){
if(u.getAttribute("data-mce-bogus")){
continue
}
d=u.nodeName.toLowerCase();
if(c&&c[d]){
if(d==="br"){
p++;
continue
}
return false
}
m=b.getAttribs(u);
f=u.attributes.length;
while(f--){
d=u.attributes[f].nodeName;
if(d==="name"||d==="data-mce-bookmark"){
return false
}}}
if(g==8){
return false
}
if((g===3&&!e.test(u.nodeValue))){
return false
}}
while(u=l.next())
}
return p<=1
}
,destroy:function(c){
var l=this;
l.win=l.doc=l.root=l.events=l.frag=null;
if(!c){
n.removeUnload(l.destroy)
}}
,createRng:function(){
var l=this.doc;
return l.createRange?l.createRange():new n.dom.Range(this)
}
,nodeIndex:function(m,f){
var l=0,d,u,c;
if(m){
for(d=m.nodeType,m=m.previousSibling,u=m;
m;
m=m.previousSibling){
c=m.nodeType;
if(f&&c==3){
if(c==d||!m.nodeValue.length){
continue
}}
l++;
d=c
}}
return l
}
,split:function(m,u,g){
var b=this,l=b.createRng(),f,d,p;
function c(z){
var q,k=z.childNodes,j=z.nodeType;
function T(W){
var A=W.previousSibling&&W.previousSibling.nodeName=="SPAN";
var O=W.nextSibling&&W.nextSibling.nodeName=="SPAN";
return A&&O
}
if(j==1&&z.getAttribute("data-mce-type")=="bookmark"){
return
}
for(q=k.length-1;
q>=0;
q--){
c(k[q])
}
if(j!=9){
if(j==3&&z.nodeValue.length>0){
var v=n.trim(z.nodeValue).length;
if(!b.isBlock(z.parentNode)||v>0||v===0&&T(z)){
return
}}else{
if(j==1){
k=z.childNodes;
if(k.length==1&&k[0]&&k[0].nodeType==1&&k[0].getAttribute("data-mce-type")=="bookmark"){
z.parentNode.insertBefore(k[0],z)
}
if(k.length||/^(br|hr|input|img)$/i.test(z.nodeName)){
return
}}}
b.remove(z)
}
return z
}
if(m&&u){
l.setStart(m.parentNode,b.nodeIndex(m));
l.setEnd(u.parentNode,b.nodeIndex(u));
f=l.extractContents();
l=b.createRng();
l.setStart(u.parentNode,b.nodeIndex(u)+1);
l.setEnd(m.parentNode,b.nodeIndex(m)+1);
d=l.extractContents();
p=m.parentNode;
p.insertBefore(c(f),m);
if(g){
p.replaceChild(g,u)
}else{
p.insertBefore(u,m)
}
p.insertBefore(c(d),m);
b.remove(m);
return g||u
}}
,bind:function(u,l,d,c){
return this.events.add(u,l,d,c||this)
}
,unbind:function(d,l,c){
return this.events.remove(d,l,c)
}
,fire:function(d,c,l){
return this.events.fire(d,c,l)
}
,getContentEditable:function(c){
var l;
if(c.nodeType!=1){
return null
}
l=c.getAttribute("data-mce-contenteditable");
if(l&&l!=="inherit"){
return l
}
return c.contentEditable!=="inherit"?c.contentEditable:null
}
,_findSib:function(u,l,c){
var d=this,m=l;
if(u){
if(o(m,"string")){
m=function(f){
return d.is(f,l)
}
}
for(u=u[c];
u;
u=u[c]){
if(m(u)){
return u
}}}
return null
}
,_isRes:function(l){
return/^(top|left|bottom|right|width|height)/i.test(l)||/;\s*(top|left|bottom|right|width|height)/i.test(l)
}}
);
n.DOM=new n.dom.DOMUtils(document,{
process_html:0}
)
}
)(tinymce);
(function(e){
function t(a){
var L=this,n=a.doc,Q=0,S=1,c=2,D=true,J=false,Z="startOffset",h="startContainer",P="endContainer",A="endOffset",d=tinymce.extend,f=a.nodeIndex;
d(L,{
startContainer:n,startOffset:0,endContainer:n,endOffset:0,collapsed:D,commonAncestorContainer:n,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:b,setEnd:k,setStartBefore:r,setStartAfter:H,setEndBefore:I,setEndAfter:q,collapse:W,selectNode:T,selectNodeContents:F,compareBoundaryPoints:j,deleteContents:g,extractContents:R,cloneContents:o,insertNode:C,surroundContents:G,cloneRange:Y,toStringIE:K}
);
function z(){
return n.createDocumentFragment()
}
function b(_e,X){
B(D,_e,X)
}
function k(_e,X){
B(J,_e,X)
}
function r(X){
b(X.parentNode,f(X))
}
function H(X){
b(X.parentNode,f(X)+1)
}
function I(X){
k(X.parentNode,f(X))
}
function q(X){
k(X.parentNode,f(X)+1)
}
function W(X){
if(X){
L[P]=L[h];
L[A]=L[Z]
}else{
L[h]=L[P];
L[Z]=L[A]
}
L.collapsed=D
}
function T(X){
r(X);
q(X)
}
function F(X){
b(X,0);
k(X,X.nodeType===1?X.childNodes.length:X.nodeValue.length)
}
function j(_i,X){
var _s=L[h],_t=L[Z],_n=L[P],_e=L[A],_o=X.startContainer,_h=X.startOffset,_a=X.endContainer,_r=X.endOffset;
if(_i===0){
return M(_s,_t,_o,_h)
}
if(_i===1){
return M(_n,_e,_o,_h)
}
if(_i===2){
return M(_n,_e,_a,_r)
}
if(_i===3){
return M(_s,_t,_a,_r)
}}
function g(){
u(c)
}
function R(){
return u(Q)
}
function o(){
return u(S)
}
function C(_i){
var _e=this[h],X=this[Z],_a,_t;
if((_e.nodeType===3||_e.nodeType===4)&&_e.nodeValue){
if(!X){
_e.parentNode.insertBefore(_i,_e)
}else{
if(X>=_e.nodeValue.length){
a.insertAfter(_i,_e)
}else{
_a=_e.splitText(X);
_e.parentNode.insertBefore(_i,_a)
}}}else{
if(_e.childNodes.length>0){
_t=_e.childNodes[X]
}
if(_t){
_e.insertBefore(_i,_t)
}else{
_e.appendChild(_i)
}}}
function G(_e){
var X=L.extractContents();
L.insertNode(_e);
_e.appendChild(X);
L.selectNode(_e)
}
function Y(){
return d(new t(a),{
startContainer:L[h],startOffset:L[Z],endContainer:L[P],endOffset:L[A],collapsed:L.collapsed,commonAncestorContainer:L.commonAncestorContainer}
)
}
function N(X,_e){
var _t;
if(X.nodeType==3){
return X
}
if(_e<0){
return X
}
_t=X.firstChild;
while(_t&&_e>0){
--_e;
_t=_t.nextSibling
}
if(_t){
return _t
}
return X
}
function m(){
return(L[h]==L[P]&&L[Z]==L[A])
}
function M(_a,_o,_e,_i){
var _n,_t,X,_s,_h,_r;
if(_a==_e){
if(_o==_i){
return 0
}
if(_o<_i){
return -1
}
return 1
}
_n=_e;
while(_n&&_n.parentNode!=_a){
_n=_n.parentNode
}
if(_n){
_t=0;
X=_a.firstChild;
while(X!=_n&&_t<_o){
_t++;
X=X.nextSibling
}
if(_o<=_t){
return -1
}
return 1
}
_n=_a;
while(_n&&_n.parentNode!=_e){
_n=_n.parentNode
}
if(_n){
_t=0;
X=_e.firstChild;
while(X!=_n&&_t<_i){
_t++;
X=X.nextSibling
}
if(_t<_i){
return -1
}
return 1
}
_s=a.findCommonAncestor(_a,_e);
_h=_a;
while(_h&&_h.parentNode!=_s){
_h=_h.parentNode
}
if(!_h){
_h=_s
}
_r=_e;
while(_r&&_r.parentNode!=_s){
_r=_r.parentNode
}
if(!_r){
_r=_s
}
if(_h==_r){
return 0
}
X=_s.firstChild;
while(X){
if(X==_h){
return -1
}
if(X==_r){
return 1
}
X=X.nextSibling
}}
function B(_e,_i,_a){
var X,_t;
if(_e){
L[h]=_i;
L[Z]=_a
}else{
L[P]=_i;
L[A]=_a
}
X=L[P];
while(X.parentNode){
X=X.parentNode
}
_t=L[h];
while(_t.parentNode){
_t=_t.parentNode
}
if(_t==X){
if(M(L[h],L[Z],L[P],L[A])>0){
L.collapse(_e)
}}else{
L.collapse(_e)
}
L.collapsed=m();
L.commonAncestorContainer=a.findCommonAncestor(L[h],L[P])
}
function u(_s){
var _n,_a=0,_h=0,_e,_o,_t,_i,X,_r;
if(L[h]==L[P]){
return s(_s)
}
for(_n=L[P],_e=_n.parentNode;
_e;
_n=_e,_e=_e.parentNode){
if(_e==L[h]){
return v(_n,_s)
}
++_a
}
for(_n=L[h],_e=_n.parentNode;
_e;
_n=_e,_e=_e.parentNode){
if(_e==L[P]){
return V(_n,_s)
}
++_h
}
_o=_h-_a;
_t=L[h];
while(_o>0){
_t=_t.parentNode;
_o--
}
_i=L[P];
while(_o<0){
_i=_i.parentNode;
_o++
}
for(X=_t.parentNode,_r=_i.parentNode;
X!=_r;
X=X.parentNode,_r=_r.parentNode){
_t=X;
_i=_r
}
return p(_t,_i,_s)
}
function s(_n){
var _r,_h,X,_t,_a,_s,_i,_e,_o;
if(_n!=c){
_r=z()
}
if(L[Z]==L[A]){
return _r
}
if(L[h].nodeType==3){
_h=L[h].nodeValue;
X=_h.substring(L[Z],L[A]);
if(_n!=S){
_t=L[h];
_e=L[Z];
_o=L[A]-L[Z];
if(_e===0&&_o>=_t.nodeValue.length-1){
_t.parentNode.removeChild(_t)
}else{
_t.deleteData(_e,_o)
}
L.collapse(D)
}
if(_n==c){
return
}
if(X.length>0){
_r.appendChild(n.createTextNode(X))
}
return _r
}
_t=N(L[h],L[Z]);
_a=L[A]-L[Z];
while(_t&&_a>0){
_s=_t.nextSibling;
_i=O(_t,_n);
if(_r){
_r.appendChild(_i)
}
--_a;
_t=_s
}
if(_n!=S){
L.collapse(D)
}
return _r
}
function v(_s,_i){
var _n,_o,_e,X,_a,_t;
if(_i!=c){
_n=z()
}
_o=l(_s,_i);
if(_n){
_n.appendChild(_o)
}
_e=f(_s);
X=_e-L[Z];
if(X<=0){
if(_i!=S){
L.setEndBefore(_s);
L.collapse(J)
}
return _n
}
_o=_s.previousSibling;
while(X>0){
_a=_o.previousSibling;
_t=O(_o,_i);
if(_n){
_n.insertBefore(_t,_n.firstChild)
}
--X;
_o=_a
}
if(_i!=S){
L.setEndBefore(_s);
L.collapse(J)
}
return _n
}
function V(_o,_i){
var _s,_e,_n,X,_a,_t;
if(_i!=c){
_s=z()
}
_n=U(_o,_i);
if(_s){
_s.appendChild(_n)
}
_e=f(_o);
++_e;
X=L[A]-_e;
_n=_o.nextSibling;
while(_n&&X>0){
_a=_n.nextSibling;
_t=O(_n,_i);
if(_s){
_s.appendChild(_t)
}
--X;
_n=_a
}
if(_i!=S){
L.setStartAfter(_o);
L.collapse(D)
}
return _s
}
function p(_o,X,_r){
var _t,_l,_i,_n,_s,_e,_h,_a;
if(_r!=c){
_l=z()
}
_t=U(_o,_r);
if(_l){
_l.appendChild(_t)
}
_i=_o.parentNode;
_n=f(_o);
_s=f(X);
++_n;
_e=_s-_n;
_h=_o.nextSibling;
while(_e>0){
_a=_h.nextSibling;
_t=O(_h,_r);
if(_l){
_l.appendChild(_t)
}
_h=_a;
--_e
}
_t=l(X,_r);
if(_l){
_l.appendChild(_t)
}
if(_r!=S){
L.setStartAfter(_o);
L.collapse(D)
}
return _l
}
function l(_n,_s){
var _t=N(L[P],L[A]-1),_r,_o,_i,X,_e,_a=_t!=L[P];
if(_t==_n){
return E(_t,_a,J,_s)
}
_r=_t.parentNode;
_o=E(_r,J,J,_s);
while(_r){
while(_t){
_i=_t.previousSibling;
X=E(_t,_a,J,_s);
if(_s!=c){
_o.insertBefore(X,_o.firstChild)
}
_a=D;
_t=_i
}
if(_r==_n){
return _o
}
_t=_r.previousSibling;
_r=_r.parentNode;
_e=E(_r,J,J,_s);
if(_s!=c){
_e.appendChild(_o)
}
_o=_e
}}
function U(_n,_s){
var _a=N(L[h],L[Z]),_i=_a!=L[h],_r,_o,_t,X,_e;
if(_a==_n){
return E(_a,_i,D,_s)
}
_r=_a.parentNode;
_o=E(_r,J,D,_s);
while(_r){
while(_a){
_t=_a.nextSibling;
X=E(_a,_i,D,_s);
if(_s!=c){
_o.appendChild(X)
}
_i=D;
_a=_t
}
if(_r==_n){
return _o
}
_a=_r.nextSibling;
_r=_r.parentNode;
_e=E(_r,J,D,_s);
if(_s!=c){
_e.appendChild(_o)
}
_o=_e
}}
function E(X,_i,_s,_r){
var _a,_t,_o,_e,_n;
if(_i){
return O(X,_r)
}
if(X.nodeType==3){
_a=X.nodeValue;
if(_s){
_e=L[Z];
_t=_a.substring(_e);
_o=_a.substring(0,_e)
}else{
_e=L[A];
_t=_a.substring(0,_e);
_o=_a.substring(_e)
}
if(_r!=S){
X.nodeValue=_o
}
if(_r==c){
return
}
_n=a.clone(X,J);
_n.nodeValue=_t;
return _n
}
if(_r==c){
return
}
return a.clone(X,J)
}
function O(_e,X){
if(X!=c){
return X==S?a.clone(_e,D):_e
}
_e.parentNode.removeChild(_e)
}
function K(){
return a.create("body",null,o()).outerText
}
return L
}
e.Range=t;
t.prototype.toString=function(){
return this.toStringIE()
}
}
)(tinymce.dom);
(function(){
function e(o){
var t=this,h=o.dom,a=true,s=false;
function n(l,c){
var d,q=0,b,f,m,u,p,v,g=-1,k;
d=l.duplicate();
d.collapse(c);
k=d.parentElement();
if(k.ownerDocument!==o.dom.doc){
return
}
while(k.contentEditable==="false"){
k=k.parentNode
}
if(!k.hasChildNodes()){
return{
node:k,inside:1}
}
m=k.children;
b=m.length-1;
while(q<=b){
v=Math.floor((q+b)/2);
u=m[v];
d.moveToElementText(u);
g=d.compareEndPoints(c?"StartToStart":"EndToEnd",l);
if(g>0){
b=v-1
}else{
if(g<0){
q=v+1
}else{
return{
node:u}
}}}
if(g<0){
if(!u){
d.moveToElementText(k);
d.collapse(true);
u=k;
f=true
}else{
d.collapse(false)
}
p=0;
while(d.compareEndPoints(c?"StartToStart":"StartToEnd",l)!==0){
if(d.move("character",1)===0||k!=d.parentElement()){
break
}
p++
}}else{
d.collapse(true);
p=0;
while(d.compareEndPoints(c?"StartToStart":"StartToEnd",l)!==0){
if(d.move("character",-1)===0||k!=d.parentElement()){
break
}
p++
}}
return{
node:u,position:g,offset:p,inside:f}
}
function r(){
var l=o.getRng(),v=h.createRng(),u,d,g,b,m,c;
u=l.item?l.item(0):l.parentElement();
if(u.ownerDocument!=h.doc){
return v
}
d=o.isCollapsed();
if(l.item){
v.setStart(u.parentNode,h.nodeIndex(u));
v.setEnd(v.startContainer,v.startOffset+1);
return v
}
function p(W){
var j=n(l,W),k,O,A=0,T,z,q;
k=j.node;
O=j.offset;
if(j.inside&&!k.hasChildNodes()){
v[W?"setStart":"setEnd"](k,0);
return
}
if(O===z){
v[W?"setStartBefore":"setEndAfter"](k);
return
}
if(j.position<0){
T=j.inside?k.firstChild:k.nextSibling;
if(!T){
v[W?"setStartAfter":"setEndAfter"](k);
return
}
if(!O){
if(T.nodeType==3){
v[W?"setStart":"setEnd"](T,0)
}else{
v[W?"setStartBefore":"setEndBefore"](T)
}
return
}
while(T){
q=T.nodeValue;
A+=q.length;
if(A>=O){
k=T;
A-=O;
A=q.length-A;
break
}
T=T.nextSibling
}}else{
T=k.previousSibling;
if(!T){
return v[W?"setStartBefore":"setEndBefore"](k)
}
if(!O){
if(k.nodeType==3){
v[W?"setStart":"setEnd"](T,k.nodeValue.length)
}else{
v[W?"setStartAfter":"setEndAfter"](T)
}
return
}
while(T){
A+=T.nodeValue.length;
if(A>=O){
k=T;
A-=O;
break
}
T=T.previousSibling
}}
v[W?"setStart":"setEnd"](k,A)
}
try{
p(true);
if(!d){
p()
}}
catch(f){
if(f.number==-2147024809){
m=t.getBookmark(2);
g=l.duplicate();
g.collapse(true);
u=g.parentElement();
if(!d){
g=l.duplicate();
g.collapse(false);
b=g.parentElement();
b.innerHTML=b.innerHTML
}
u.innerHTML=u.innerHTML;
t.moveToBookmark(m);
l=o.getRng();
p(true);
if(!d){
p()
}}else{
throw f
}}
return v
}
this.getBookmark=function(m){
var c=o.getRng(),p,l,u={};
function f(j){
var q,g,k,v,b=[];
q=j.parentNode;
g=h.getRoot().parentNode;
while(q!=g&&q.nodeType!==9){
k=q.children;
v=k.length;
while(v--){
if(j===k[v]){
b.push(v);
break
}}
j=q;
q=q.parentNode
}
return b
}
function d(b){
var g;
g=n(c,b);
if(g){
return{
position:g.position,offset:g.offset,indexes:f(g.node),inside:g.inside}
}}
if(m===2){
if(!c.item){
u.start=d(true);
if(!o.isCollapsed()){
u.end=d()
}}else{
u.start={
ctrl:true,indexes:f(c.item(0))}
}}
return u
};
this.moveToBookmark=function(d){
var c,l=h.doc.body;
function m(p){
var v,b,f,g;
v=h.getRoot();
for(b=p.length-1;
b>=0;
b--){
g=v.children;
f=p[b];
if(f<=g.length-1){
v=g[f]
}}
return v
}
function u(v){
var f=d[v?"start":"end"],b,g,p;
if(f){
b=f.position>0;
g=l.createTextRange();
g.moveToElementText(m(f.indexes));
offset=f.offset;
if(offset!==p){
g.collapse(f.inside||b);
g.moveStart("character",b?-offset:offset)
}else{
g.collapse(v)
}
c.setEndPoint(v?"StartToStart":"EndToStart",g);
if(v){
c.collapse(true)
}}}
if(d.start){
if(d.start.ctrl){
c=l.createControlRange();
c.addElement(m(d.start.indexes));
c.select()
}else{
c=l.createTextRange();
u(true);
u();
c.select()
}}};
this.addRange=function(l){
var f,u,d,g,q,b,k,v=o.dom.doc,m=v.body;
function c(W){
var z,A,j,O,T;
j=h.create("a");
z=W?d:q;
A=W?g:b;
O=f.duplicate();
if(z==v||z==v.documentElement){
z=m;
A=0
}
if(z.nodeType==3){
z.parentNode.insertBefore(j,z);
O.moveToElementText(j);
O.moveStart("character",A);
h.remove(j);
f.setEndPoint(W?"StartToStart":"EndToEnd",O)
}else{
T=z.childNodes;
if(T.length){
if(A>=T.length){
h.insertAfter(j,T[T.length-1])
}else{
z.insertBefore(j,T[A])
}
O.moveToElementText(j)
}else{
if(z.canHaveHTML){
z.innerHTML="<span>\uFEFF</span>";
j=z.firstChild;
O.moveToElementText(j);
O.collapse(s)
}}
f.setEndPoint(W?"StartToStart":"EndToEnd",O);
h.remove(j)
}}
d=l.startContainer;
g=l.startOffset;
q=l.endContainer;
b=l.endOffset;
f=m.createTextRange();
if(d==q&&d.nodeType==1){
if(g==b&&!d.hasChildNodes()){
if(d.canHaveHTML){
k=d.previousSibling;
if(k&&!k.hasChildNodes()&&h.isBlock(k)){
k.innerHTML="\uFEFF"
}else{
k=null
}
d.innerHTML="<span>\uFEFF</span><span>\uFEFF</span>";
f.moveToElementText(d.lastChild);
f.select();
h.doc.selection.clear();
d.innerHTML="";
if(k){
k.innerHTML=""
}
return
}else{
g=h.nodeIndex(d);
d=d.parentNode
}}
if(g==b-1){
try{
u=m.createControlRange();
u.addElement(d.childNodes[g]);
u.select();
return
}
catch(p){}}}
c(true);
c();
f.select()
};
this.getRangeAt=r
}
tinymce.dom.TridentSelection=e
}
)();
(function(){
var f=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,l="sizcache",p=0,v=Object.prototype.toString,h=false,r=true,b=/\\/g,j=/\r\n/g,T=/\W/;
[0,0].sort(function(){
r=false;
return 0
}
);
var n=function(C,e,F,M){
F=F||[];
e=e||document;
var H=e;
if(e.nodeType!==1&&e.nodeType!==9){
return[]
}
if(!C||typeof C!=="string"){
return F
}
var A,Y,L,O,I,G,E,S,B=true,W=n.isXML(e),D=[],R=C;
do{
f.exec("");
A=f.exec(R);
if(A){
R=A[3];
D.push(A[1]);
if(A[2]){
O=A[3];
break
}}}
while(A);
if(D.length>1&&c.exec(C)){
if(D.length===2&&d.relative[D[0]]){
Y=k(D[0]+D[1],e,M)
}else{
Y=d.relative[D[0]]?[e]:n(D.shift(),e);
while(D.length){
C=D.shift();
if(d.relative[C]){
C+=D.shift()
}
Y=k(C,Y,M)
}}}else{
if(!M&&D.length>1&&e.nodeType===9&&!W&&d.match.ID.test(D[0])&&!d.match.ID.test(D[D.length-1])){
I=n.find(D.shift(),e,W);
e=I.expr?n.filter(I.expr,I.set)[0]:I.set[0]
}
if(e){
I=M?{
expr:D.pop(),set:u(M)}
:n.find(D.pop(),D.length===1&&(D[0]==="~"||D[0]==="+")&&e.parentNode?e.parentNode:e,W);
Y=I.expr?n.filter(I.expr,I.set):I.set;
if(D.length>0){
L=u(Y)
}else{
B=false
}
while(D.length){
G=D.pop();
E=G;
if(!d.relative[G]){
G=""
}else{
E=D.pop()
}
if(E==null){
E=e
}
d.relative[G](L,E,W)
}}else{
L=D=[]
}}
if(!L){
L=Y
}
if(!L){
n.error(G||C)
}
if(v.call(L)==="[object Array]"){
if(!B){
F.push.apply(F,L)
}else{
if(e&&e.nodeType===1){
for(S=0;
L[S]!=null;
S++){
if(L[S]&&(L[S]===true||L[S].nodeType===1&&n.contains(e,L[S]))){
F.push(Y[S])
}}}else{
for(S=0;
L[S]!=null;
S++){
if(L[S]&&L[S].nodeType===1){
F.push(Y[S])
}}}}}else{
u(L,F)
}
if(O){
n(O,H,F,M);
n.uniqueSort(F)
}
return F
};
n.uniqueSort=function(O){
if(g){
h=r;
O.sort(g);
if(h){
for(var e=1;
e<O.length;
e++){
if(O[e]===O[e-1]){
O.splice(e--,1)
}}}}
return O
};
n.matches=function(e,O){
return n(e,null,null,O)
};
n.matchesSelector=function(e,O){
return n(O,null,null,[e]).length>0
};
n.find=function(S,e,F){
var D,A,B,W,C,O;
if(!S){
return[]
}
for(A=0,B=d.order.length;
A<B;
A++){
C=d.order[A];
if((W=d.leftMatch[C].exec(S))){
O=W[1];
W.splice(1,1);
if(O.substr(O.length-1)!=="\\"){
W[1]=(W[1]||"").replace(b,"");
D=d.find[C](W,e,F);
if(D!=null){
S=S.replace(d.match[C],"");
break
}}}}
if(!D){
D=typeof e.getElementsByTagName!=="undefined"?e.getElementsByTagName("*"):[]
}
return{
set:D,expr:S}
};
n.filter=function(H,R,E,B){
var D,e,M,L,Y,O,W,C,I,A=H,G=[],F=R,S=R&&R[0]&&n.isXML(R[0]);
while(H&&R.length){
for(M in d.filter){
if((D=d.leftMatch[M].exec(H))!=null&&D[2]){
O=d.filter[M];
W=D[1];
e=false;
D.splice(1,1);
if(W.substr(W.length-1)==="\\"){
continue
}
if(F===G){
G=[]
}
if(d.preFilter[M]){
D=d.preFilter[M](D,F,E,G,B,S);
if(!D){
e=L=true
}else{
if(D===true){
continue
}}}
if(D){
for(C=0;
(Y=F[C])!=null;
C++){
if(Y){
L=O(Y,D,C,F);
I=B^L;
if(E&&L!=null){
if(I){
e=true
}else{
F[C]=false
}}else{
if(I){
G.push(Y);
e=true
}}}}}
if(L!==undefined){
if(!E){
F=G
}
H=H.replace(d.match[M],"");
if(!e){
return[]
}
break
}}}
if(H===A){
if(e==null){
n.error(H)
}else{
break
}}
A=H
}
return F
};
n.error=function(e){
throw new Error("Syntax error, unrecognized expression: "+e)
};
var a=n.getText=function(B){
var A,W,e=B.nodeType,O="";
if(e){
if(e===1||e===9||e===11){
if(typeof B.textContent==="string"){
return B.textContent
}else{
if(typeof B.innerText==="string"){
return B.innerText.replace(j,"")
}else{
for(B=B.firstChild;
B;
B=B.nextSibling){
O+=a(B)
}}}}else{
if(e===3||e===4){
return B.nodeValue
}}}else{
for(A=0;
(W=B[A]);
A++){
if(W.nodeType!==8){
O+=a(W)
}}}
return O
};
var d=n.selectors={
order:["ID","NAME","TAG"],match:{
ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/}
,leftMatch:{}
,attrMap:{
"class":"className","for":"htmlFor"}
,attrHandle:{
href:function(e){
return e.getAttribute("href")
}
,type:function(e){
return e.getAttribute("type")
}}
,relative:{
"+":function(D,O){
var W=typeof O==="string",C=W&&!T.test(O),S=W&&!C;
if(C){
O=O.toLowerCase()
}
for(var A=0,e=D.length,B;
A<e;
A++){
if((B=D[A])){
while((B=B.previousSibling)&&B.nodeType!==1){}
D[A]=S||B&&B.nodeName.toLowerCase()===O?B||false:B===O
}}
if(S){
n.filter(O,D,true)
}}
,">":function(D,O){
var C,B=typeof O==="string",A=0,e=D.length;
if(B&&!T.test(O)){
O=O.toLowerCase();
for(;
A<e;
A++){
C=D[A];
if(C){
var W=C.parentNode;
D[A]=W.nodeName.toLowerCase()===O?W:false
}}}else{
for(;
A<e;
A++){
C=D[A];
if(C){
D[A]=B?C.parentNode:C.parentNode===O
}}
if(B){
n.filter(O,D,true)
}}}
,"":function(W,O,C){
var B,A=p++,e=q;
if(typeof O==="string"&&!T.test(O)){
O=O.toLowerCase();
B=O;
e=t
}
e("parentNode",O,A,W,B,C)
}
,"~":function(W,O,C){
var B,A=p++,e=q;
if(typeof O==="string"&&!T.test(O)){
O=O.toLowerCase();
B=O;
e=t
}
e("previousSibling",O,A,W,B,C)
}}
,find:{
ID:function(O,A,W){
if(typeof A.getElementById!=="undefined"&&!W){
var e=A.getElementById(O[1]);
return e&&e.parentNode?[e]:[]
}}
,NAME:function(A,C){
if(typeof C.getElementsByName!=="undefined"){
var O=[],B=C.getElementsByName(A[1]);
for(var W=0,e=B.length;
W<e;
W++){
if(B[W].getAttribute("name")===A[1]){
O.push(B[W])
}}
return O.length===0?null:O
}}
,TAG:function(e,O){
if(typeof O.getElementsByTagName!=="undefined"){
return O.getElementsByTagName(e[1])
}}}
,preFilter:{
CLASS:function(W,O,A,e,D,S){
W=" "+W[1].replace(b,"")+" ";
if(S){
return W
}
for(var B=0,C;
(C=O[B])!=null;
B++){
if(C){
if(D^(C.className&&(" "+C.className+" ").replace(/[\t\n\r]/g," ").indexOf(W)>=0)){
if(!A){
e.push(C)
}}else{
if(A){
O[B]=false
}}}}
return false
}
,ID:function(e){
return e[1].replace(b,"")
}
,TAG:function(O,e){
return O[1].replace(b,"").toLowerCase()
}
,CHILD:function(e){
if(e[1]==="nth"){
if(!e[2]){
n.error(e[0])
}
e[2]=e[2].replace(/^\+|\s*/g,"");
var O=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);
e[2]=(O[1]+(O[2]||1))-0;
e[3]=O[3]-0
}else{
if(e[2]){
n.error(e[0])
}}
e[0]=p++;
return e
}
,ATTR:function(B,O,A,e,C,D){
var W=B[1]=B[1].replace(b,"");
if(!D&&d.attrMap[W]){
B[1]=d.attrMap[W]
}
B[4]=(B[4]||B[5]||"").replace(b,"");
if(B[2]==="~="){
B[4]=" "+B[4]+" "
}
return B
}
,PSEUDO:function(B,O,A,e,C){
if(B[1]==="not"){
if((f.exec(B[3])||"").length>1||/^\w/.test(B[3])){
B[3]=n(B[3],null,null,O)
}else{
var W=n.filter(B[3],O,A,true^C);
if(!A){
e.push.apply(e,W)
}
return false
}}else{
if(d.match.POS.test(B[0])||d.match.CHILD.test(B[0])){
return true
}}
return B
}
,POS:function(e){
e.unshift(true);
return e
}}
,filters:{
enabled:function(e){
return e.disabled===false&&e.type!=="hidden"
}
,disabled:function(e){
return e.disabled===true
}
,checked:function(e){
return e.checked===true
}
,selected:function(e){
if(e.parentNode){
e.parentNode.selectedIndex
}
return e.selected===true
}
,parent:function(e){
return !!e.firstChild
}
,empty:function(e){
return !e.firstChild
}
,has:function(A,O,e){
return !!n(e[3],A).length
}
,header:function(e){
return(/h\d/i).test(e.nodeName)
}
,text:function(A){
var e=A.getAttribute("type"),O=A.type;
return A.nodeName.toLowerCase()==="input"&&"text"===O&&(e===O||e===null)
}
,radio:function(e){
return e.nodeName.toLowerCase()==="input"&&"radio"===e.type
}
,checkbox:function(e){
return e.nodeName.toLowerCase()==="input"&&"checkbox"===e.type
}
,file:function(e){
return e.nodeName.toLowerCase()==="input"&&"file"===e.type
}
,password:function(e){
return e.nodeName.toLowerCase()==="input"&&"password"===e.type
}
,submit:function(O){
var e=O.nodeName.toLowerCase();
return(e==="input"||e==="button")&&"submit"===O.type
}
,image:function(e){
return e.nodeName.toLowerCase()==="input"&&"image"===e.type
}
,reset:function(O){
var e=O.nodeName.toLowerCase();
return(e==="input"||e==="button")&&"reset"===O.type
}
,button:function(O){
var e=O.nodeName.toLowerCase();
return e==="input"&&"button"===O.type||e==="button"
}
,input:function(e){
return(/input|select|textarea|button/i).test(e.nodeName)
}
,focus:function(e){
return e===e.ownerDocument.activeElement
}}
,setFilters:{
first:function(O,e){
return e===0
}
,last:function(A,O,e,W){
return O===W.length-1
}
,even:function(O,e){
return e%2===0
}
,odd:function(O,e){
return e%2===1
}
,lt:function(A,O,e){
return O<e[3]-0
}
,gt:function(A,O,e){
return O>e[3]-0
}
,nth:function(A,O,e){
return e[3]-0===O
}
,eq:function(A,O,e){
return e[3]-0===O
}}
,filter:{
PSEUDO:function(A,S,D,F){
var e=S[1],O=d.filters[e];
if(O){
return O(A,D,S,F)
}else{
if(e==="contains"){
return(A.textContent||A.innerText||a([A])||"").indexOf(S[3])>=0
}else{
if(e==="not"){
var W=S[3];
for(var C=0,B=W.length;
C<B;
C++){
if(W[C]===A){
return false
}}
return true
}else{
n.error(e)
}}}}
,CHILD:function(A,B){
var W,R,D,M,e,C,F,S=B[1],O=A;
switch(S){
case"only":case"first":while((O=O.previousSibling)){
if(O.nodeType===1){
return false
}}
if(S==="first"){
return true
}
O=A;
case"last":while((O=O.nextSibling)){
if(O.nodeType===1){
return false
}}
return true;
case"nth":W=B[2];
R=B[3];
if(W===1&&R===0){
return true
}
D=B[0];
M=A.parentNode;
if(M&&(M[l]!==D||!A.nodeIndex)){
C=0;
for(O=M.firstChild;
O;
O=O.nextSibling){
if(O.nodeType===1){
O.nodeIndex=++C
}}
M[l]=D
}
F=A.nodeIndex-R;
if(W===0){
return F===0
}else{
return(F%W===0&&F/W>=0)
}}}
,ID:function(O,e){
return O.nodeType===1&&O.getAttribute("id")===e
}
,TAG:function(O,e){
return(e==="*"&&O.nodeType===1)||!!O.nodeName&&O.nodeName.toLowerCase()===e
}
,CLASS:function(O,e){
return(" "+(O.className||O.getAttribute("class"))+" ").indexOf(e)>-1
}
,ATTR:function(C,W){
var A=W[1],e=n.attr?n.attr(C,A):d.attrHandle[A]?d.attrHandle[A](C):C[A]!=null?C[A]:C.getAttribute(A),D=e+"",B=W[2],O=W[4];
return e==null?B==="!=":!B&&n.attr?e!=null:B==="="?D===O:B==="*="?D.indexOf(O)>=0:B==="~="?(" "+D+" ").indexOf(O)>=0:!O?D&&e!==false:B==="!="?D!==O:B==="^="?D.indexOf(O)===0:B==="$="?D.substr(D.length-O.length)===O:B==="|="?D===O||D.substr(0,O.length+1)===O+"-":false
}
,POS:function(B,O,A,C){
var e=O[2],W=d.setFilters[e];
if(W){
return W(B,A,O,C)
}}}};
var c=d.match.POS,o=function(O,e){
return"\\"+(e-0+1)
};
for(var s in d.match){
d.match[s]=new RegExp(d.match[s].source+(/(?![^\[]*\])(?![^\(]*\))/.source));
d.leftMatch[s]=new RegExp(/(^(?:.|\r|\n)*?)/.source+d.match[s].source.replace(/\\(\d+)/g,o))
}
d.match.globalPOS=c;
var u=function(O,e){
O=Array.prototype.slice.call(O,0);
if(e){
e.push.apply(e,O);
return e
}
return O
};
try{
Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType
}
catch(z){
u=function(B,W){
var A=0,O=W||[];
if(v.call(B)==="[object Array]"){
Array.prototype.push.apply(O,B)
}else{
if(typeof B.length==="number"){
for(var e=B.length;
A<e;
A++){
O.push(B[A])
}}else{
for(;
B[A];
A++){
O.push(B[A])
}}}
return O
}
}
var g,m;
if(document.documentElement.compareDocumentPosition){
g=function(O,e){
if(O===e){
h=true;
return 0
}
if(!O.compareDocumentPosition||!e.compareDocumentPosition){
return O.compareDocumentPosition?-1:1
}
return O.compareDocumentPosition(e)&4?-1:1
}
}else{
g=function(F,S){
if(F===S){
h=true;
return 0
}else{
if(F.sourceIndex&&S.sourceIndex){
return F.sourceIndex-S.sourceIndex
}}
var C,O,A=[],e=[],B=F.parentNode,D=S.parentNode,M=B;
if(B===D){
return m(F,S)
}else{
if(!B){
return -1
}else{
if(!D){
return 1
}}}
while(M){
A.unshift(M);
M=M.parentNode
}
M=D;
while(M){
e.unshift(M);
M=M.parentNode
}
C=A.length;
O=e.length;
for(var W=0;
W<C&&W<O;
W++){
if(A[W]!==e[W]){
return m(A[W],e[W])
}}
return W===C?m(F,e[W],-1):m(A[W],S,1)
};
m=function(O,e,A){
if(O===e){
return A
}
var W=O.nextSibling;
while(W){
if(W===e){
return -1
}
W=W.nextSibling
}
return 1
}
}
(function(){
var O=document.createElement("div"),A="script"+(new Date()).getTime(),e=document.documentElement;
O.innerHTML="<a name='"+A+"'/>";
e.insertBefore(O,e.firstChild);
if(document.getElementById(A)){
d.find.ID=function(B,C,D){
if(typeof C.getElementById!=="undefined"&&!D){
var W=C.getElementById(B[1]);
return W?W.id===B[1]||typeof W.getAttributeNode!=="undefined"&&W.getAttributeNode("id").nodeValue===B[1]?[W]:undefined:[]
}};
d.filter.ID=function(C,W){
var B=typeof C.getAttributeNode!=="undefined"&&C.getAttributeNode("id");
return C.nodeType===1&&B&&B.nodeValue===W
}
}
e.removeChild(O);
e=O=null
}
)();
(function(){
var e=document.createElement("div");
e.appendChild(document.createComment(""));
if(e.getElementsByTagName("*").length>0){
d.find.TAG=function(O,C){
var B=C.getElementsByTagName(O[1]);
if(O[1]==="*"){
var W=[];
for(var A=0;
B[A];
A++){
if(B[A].nodeType===1){
W.push(B[A])
}}
B=W
}
return B
}
}
e.innerHTML="<a href='#'></a>";
if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#"){
d.attrHandle.href=function(O){
return O.getAttribute("href",2)
}
}
e=null
}
)();
if(document.querySelectorAll){
(function(){
var e=n,W=document.createElement("div"),A="__sizzle__";
W.innerHTML="<p class='TEST'></p>";
if(W.querySelectorAll&&W.querySelectorAll(".TEST").length===0){
return
}
n=function(E,C,M,Y){
C=C||document;
if(!Y&&!n.isXML(C)){
var I=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(E);
if(I&&(C.nodeType===1||C.nodeType===9)){
if(I[1]){
return u(C.getElementsByTagName(E),M)
}else{
if(I[2]&&d.find.CLASS&&C.getElementsByClassName){
return u(C.getElementsByClassName(I[2]),M)
}}}
if(C.nodeType===9){
if(E==="body"&&C.body){
return u([C.body],M)
}else{
if(I&&I[3]){
var F=C.getElementById(I[3]);
if(F&&F.parentNode){
if(F.id===I[3]){
return u([F],M)
}}else{
return u([],M)
}}}
try{
return u(C.querySelectorAll(E),M)
}
catch(R){}}else{
if(C.nodeType===1&&C.nodeName.toLowerCase()!=="object"){
var D=C,S=C.getAttribute("id"),B=S||A,L=C.parentNode,G=/^\s*[+~]/.test(E);
if(!S){
C.setAttribute("id",B)
}else{
B=B.replace(/'/g,"\\$&")
}
if(G&&L){
C=C.parentNode
}
try{
if(!G||L){
return u(C.querySelectorAll("[id='"+B+"'] "+E),M)
}}
catch(H){}
finally{
if(!S){
D.removeAttribute("id")
}}}}}
return e(E,C,M,Y)
};
for(var O in e){
n[O]=e[O]
}
W=null
}
)()
}
(function(){
var e=document.documentElement,A=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;
if(A){
var B=!A.call(document.createElement("div"),"div"),O=false;
try{
A.call(document.documentElement,"[test!='']:sizzle")
}
catch(W){
O=true
}
n.matchesSelector=function(D,F){
F=F.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");
if(!n.isXML(D)){
try{
if(O||!d.match.PSEUDO.test(F)&&!/!=/.test(F)){
var C=A.call(D,F);
if(C||!B||D.document&&D.document.nodeType!==11){
return C
}}}
catch(S){}}
return n(F,null,null,[D]).length>0
}
}}
)();
(function(){
var e=document.createElement("div");
e.innerHTML="<div class='test e'></div><div class='test'></div>";
if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0){
return
}
e.lastChild.className="e";
if(e.getElementsByClassName("e").length===1){
return
}
d.order.splice(1,0,"CLASS");
d.find.CLASS=function(O,A,W){
if(typeof A.getElementsByClassName!=="undefined"&&!W){
return A.getElementsByClassName(O[1])
}};
e=null
}
)();
function t(O,D,C,M,S,F){
for(var W=0,A=M.length;
W<A;
W++){
var e=M[W];
if(e){
var B=false;
e=e[O];
while(e){
if(e[l]===C){
B=M[e.sizset];
break
}
if(e.nodeType===1&&!F){
e[l]=C;
e.sizset=W
}
if(e.nodeName.toLowerCase()===D){
B=e;
break
}
e=e[O]
}
M[W]=B
}}}
function q(O,D,C,M,S,F){
for(var W=0,A=M.length;
W<A;
W++){
var e=M[W];
if(e){
var B=false;
e=e[O];
while(e){
if(e[l]===C){
B=M[e.sizset];
break
}
if(e.nodeType===1){
if(!F){
e[l]=C;
e.sizset=W
}
if(typeof D!=="string"){
if(e===D){
B=true;
break
}}else{
if(n.filter(D,[e]).length>0){
B=e;
break
}}}
e=e[O]
}
M[W]=B
}}}
if(document.documentElement.contains){
n.contains=function(O,e){
return O!==e&&(O.contains?O.contains(e):true)
}
}else{
if(document.documentElement.compareDocumentPosition){
n.contains=function(O,e){
return !!(O.compareDocumentPosition(e)&16)
}
}else{
n.contains=function(){
return false
}
}}
n.isXML=function(e){
var O=(e?e.ownerDocument||e:0).documentElement;
return O?O.nodeName!=="HTML":false
};
var k=function(A,e,D){
var C,S=[],B="",F=e.nodeType?[e]:e;
while((C=d.match.PSEUDO.exec(A))){
B+=C[0];
A=A.replace(d.match.PSEUDO,"")
}
A=d.relative[A]?A+"*":A;
for(var W=0,O=F.length;
W<O;
W++){
n(A,F[W],S,D)
}
return n.filter(B,S)
};
window.tinymce.dom.Sizzle=n
}
)();
(function(e){
e.dom.Element=function(r,n){
var a=this,s,o;
a.settings=n=n||{};
a.id=r;
a.dom=s=n.dom||e.DOM;
if(!e.isIE){
o=s.get(a.id)
}
e.each(("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get").split(/,/),function(t){
a[t]=function(){
var h=[r],l;
for(l=0;
l<arguments.length;
l++){
h.push(arguments[l])
}
h=s[t].apply(s,h);
a.update(t);
return h
}
}
);
e.extend(a,{
on:function(l,h,t){
return e.dom.Event.add(a.id,l,h,t)
}
,getXY:function(){
return{
x:parseInt(a.getStyle("left")),y:parseInt(a.getStyle("top"))}
}
,getSize:function(){
var t=s.get(a.id);
return{
w:parseInt(a.getStyle("width")||t.clientWidth),h:parseInt(a.getStyle("height")||t.clientHeight)}
}
,moveTo:function(t,h){
a.setStyles({
left:t,top:h}
)
}
,moveBy:function(t,l){
var h=a.getXY();
a.moveTo(h.x+t,h.y+l)
}
,resizeTo:function(t,l){
a.setStyles({
width:t,height:l}
)
}
,resizeBy:function(t,c){
var l=a.getSize();
a.resizeTo(l.w+t,l.h+c)
}
,update:function(h){
var t;
if(e.isIE6&&n.blocker){
h=h||"";
if(h.indexOf("get")===0||h.indexOf("has")===0||h.indexOf("is")===0){
return
}
if(h=="remove"){
s.remove(a.blocker);
return
}
if(!a.blocker){
a.blocker=s.uniqueId();
t=s.add(n.container||s.getRoot(),"iframe",{
id:a.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'}
);
s.setStyle(t,"opacity",0)
}else{
t=s.get(a.blocker)
}
s.setStyles(t,{
left:a.getStyle("left",1),top:a.getStyle("top",1),width:a.getStyle("width",1),height:a.getStyle("height",1),display:a.getStyle("display",1),zIndex:parseInt(a.getStyle("zIndex",1)||0)-1}
)
}}}
)
}
}
)(tinymce);
(function(o){
function s(r){
return r.replace(/[\n\r]+/g,"")
}
var a=o.is,t=o.isIE,n=o.each,e=o.dom.TreeWalker;
o.create("tinymce.dom.Selection",{
Selection:function(d,c,l,h){
var r=this;
r.dom=d;
r.win=c;
r.serializer=l;
r.editor=h;
n(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(u){
r[u]=new o.util.Dispatcher(r)
}
);
if(!r.win.getSelection){
r.tridentSel=new o.dom.TridentSelection(r)
}
if(o.isIE&&d.boxModel){
this._fixIESelection()
}
o.addUnload(r.destroy,r)
}
,setCursorLocation:function(c,d){
var h=this;
var l=h.dom.createRng();
l.setStart(c,d);
l.setEnd(c,d);
h.setRng(l);
h.collapse(false)
}
,getContent:function(l){
var h=this,c=h.getRng(),f=h.dom.create("body"),u=h.getSel(),d,m,p;
l=l||{};
d=m="";
l.get=true;
l.format=l.format||"html";
l.forced_root_block="";
h.onBeforeGetContent.dispatch(h,l);
if(l.format=="text"){
return h.isCollapsed()?"":(c.text||(u.toString?u.toString():""))
}
if(c.cloneContents){
p=c.cloneContents();
if(p){
f.appendChild(p)
}}else{
if(a(c.item)||a(c.htmlText)){
f.innerHTML="<br>"+(c.item?c.item(0).outerHTML:c.htmlText);
f.removeChild(f.firstChild)
}else{
f.innerHTML=c.toString()
}}
if(/^\s/.test(f.innerHTML)){
d=" "
}
if(/\s+$/.test(f.innerHTML)){
m=" "
}
l.getInner=true;
l.content=h.isCollapsed()?"":d+h.serializer.serialize(f,l)+m;
h.onGetContent.dispatch(h,l);
return l.content
}
,setContent:function(h,c){
var p=this,r=p.getRng(),d,u=p.win.document,f,m;
c=c||{
format:"html"};
c.set=true;
h=c.content=h;
if(!c.no_events){
p.onBeforeSetContent.dispatch(p,c)
}
h=c.content;
if(r.insertNode){
h+='<span id="__caret">_</span>';
if(r.startContainer==u&&r.endContainer==u){
u.body.innerHTML=h
}else{
r.deleteContents();
if(u.body.childNodes.length===0){
u.body.innerHTML=h
}else{
if(r.createContextualFragment){
r.insertNode(r.createContextualFragment(h))
}else{
f=u.createDocumentFragment();
m=u.createElement("div");
f.appendChild(m);
m.outerHTML=h;
r.insertNode(f)
}}}
d=p.dom.get("__caret");
r=u.createRange();
r.setStartBefore(d);
r.setEndBefore(d);
p.setRng(r);
p.dom.remove("__caret");
try{
p.setRng(r)
}
catch(l){}}else{
if(r.item){
u.execCommand("Delete",false,null);
r=p.getRng()
}
if(/^\s+/.test(h)){
r.pasteHTML('<span id="__mce_tmp">_</span>'+h);
p.dom.remove("__mce_tmp")
}else{
r.pasteHTML(h)
}}
if(!c.no_events){
p.onSetContent.dispatch(p,c)
}}
,getStart:function(){
var l=this,h=l.getRng(),c,r,u,d;
if(h.duplicate||h.item){
if(h.item){
return h.item(0)
}
u=h.duplicate();
u.collapse(1);
c=u.parentElement();
if(c.ownerDocument!==l.dom.doc){
c=l.dom.getRoot()
}
r=d=h.parentElement();
while(d=d.parentNode){
if(d==c){
c=r;
break
}}
return c
}else{
c=h.startContainer;
if(c.nodeType==1&&c.hasChildNodes()){
c=c.childNodes[Math.min(c.childNodes.length-1,h.startOffset)]
}
if(c&&c.nodeType==3){
return c.parentNode
}
return c
}}
,getEnd:function(){
var h=this,r=h.getRng(),c,l;
if(r.duplicate||r.item){
if(r.item){
return r.item(0)
}
r=r.duplicate();
r.collapse(0);
c=r.parentElement();
if(c.ownerDocument!==h.dom.doc){
c=h.dom.getRoot()
}
if(c&&c.nodeName=="BODY"){
return c.lastChild||c
}
return c
}else{
c=r.endContainer;
l=r.endOffset;
if(c.nodeType==1&&c.hasChildNodes()){
c=c.childNodes[l>0?l-1:l]
}
if(c&&c.nodeType==3){
return c.parentNode
}
return c
}}
,getBookmark:function(k,j){
var T=this,f=T.dom,h,d,c,p,l,g,b,m="\uFEFF",z;
function r(A,W){
var O=0;
n(f.select(A),function(C,B){
if(C==W){
O=B
}}
);
return O
}
function q(O){
function A(S){
var W,D,C,B=S?"start":"end";
W=O[B+"Container"];
D=O[B+"Offset"];
if(W.nodeType==1&&W.nodeName=="TR"){
C=W.childNodes;
W=C[Math.min(S?D:D-1,C.length-1)];
if(W){
D=S?0:W.childNodes.length;
O["set"+(S?"Start":"End")](W,D)
}}}
A(true);
A();
return O
}
function u(){
var A=T.getRng(true),O=f.getRoot(),W={};
function B(S,I){
var D=S[I?"startContainer":"endContainer"],H=S[I?"startOffset":"endOffset"],C=[],F,R,M=0;
if(D.nodeType==3){
if(j){
for(F=D.previousSibling;
F&&F.nodeType==3;
F=F.previousSibling){
H+=F.nodeValue.length
}}
C.push(H)
}else{
R=D.childNodes;
if(H>=R.length&&R.length){
M=1;
H=Math.max(0,R.length-1)
}
C.push(T.dom.nodeIndex(R[H],j)+M)
}
for(;
D&&D!=O;
D=D.parentNode){
C.push(T.dom.nodeIndex(D,j))
}
return C
}
W.start=B(A,true);
if(!T.isCollapsed()){
W.end=B(A)
}
return W
}
if(k==2){
if(T.tridentSel){
return T.tridentSel.getBookmark(k)
}
return u()
}
if(k){
return{
rng:T.getRng()}
}
h=T.getRng();
c=f.uniqueId();
p=tinyMCE.activeEditor.selection.isCollapsed();
z="overflow:hidden;line-height:0px";
if(h.duplicate||h.item){
if(!h.item){
d=h.duplicate();
try{
h.collapse();
h.pasteHTML('<span data-mce-type="bookmark" id="'+c+'_start" style="'+z+'">'+m+"</span>");
if(!p){
d.collapse(false);
h.moveToElementText(d.parentElement());
if(h.compareEndPoints("StartToEnd",d)===0){
d.move("character",-1)
}
d.pasteHTML('<span data-mce-type="bookmark" id="'+c+'_end" style="'+z+'">'+m+"</span>")
}}
catch(v){
return null
}}else{
g=h.item(0);
l=g.nodeName;
return{
name:l,index:r(l,g)}
}}else{
g=T.getNode();
l=g.nodeName;
if(l=="IMG"){
return{
name:l,index:r(l,g)}
}
d=q(h.cloneRange());
if(!p){
d.collapse(false);
d.insertNode(f.create("span",{
"data-mce-type":"bookmark",id:c+"_end",style:z}
,m))
}
h=q(h);
h.collapse(true);
h.insertNode(f.create("span",{
"data-mce-type":"bookmark",id:c+"_start",style:z}
,m))
}
T.moveToBookmark({
id:c,keep:1}
);
return{
id:c}
}
,moveToBookmark:function(p){
var k=this,m=k.dom,c,l,r,v,d,q,g,b;
function h(W){
var j=p[W?"start":"end"],T,O,A,z;
if(j){
A=j[0];
for(O=v,T=j.length-1;
T>=1;
T--){
z=O.childNodes;
if(j[T]>z.length-1){
return
}
O=z[j[T]]
}
if(O.nodeType===3){
A=Math.min(j[0],O.nodeValue.length)
}
if(O.nodeType===1){
A=Math.min(j[0],O.childNodes.length)
}
if(W){
r.setStart(O,A)
}else{
r.setEnd(O,A)
}}
return true
}
function u(B){
var z=m.get(p.id+"_"+B),W,j,O,A,T=p.keep;
if(z){
W=z.parentNode;
if(B=="start"){
if(!T){
j=m.nodeIndex(z)
}else{
W=z.firstChild;
j=1
}
d=q=W;
g=b=j
}else{
if(!T){
j=m.nodeIndex(z)
}else{
W=z.firstChild;
j=1
}
q=W;
b=j
}
if(!T){
A=z.previousSibling;
O=z.nextSibling;
n(o.grep(z.childNodes),function(C){
if(C.nodeType==3){
C.nodeValue=C.nodeValue.replace(/\uFEFF/g,"")
}}
);
while(z=m.get(p.id+"_"+B)){
m.remove(z,1)
}
if(A&&O&&A.nodeType==O.nodeType&&A.nodeType==3&&!o.isOpera){
j=A.nodeValue.length;
A.appendData(O.nodeValue);
m.remove(O);
if(B=="start"){
d=q=A;
g=b=j
}else{
q=A;
b=j
}}}}}
function f(j){
if(m.isBlock(j)&&!j.innerHTML&&!t){
j.innerHTML='<br data-mce-bogus="1" />'
}
return j
}
if(p){
if(p.start){
r=m.createRng();
v=m.getRoot();
if(k.tridentSel){
return k.tridentSel.moveToBookmark(p)
}
if(h(true)&&h()){
k.setRng(r)
}}else{
if(p.id){
u("start");
u("end");
if(d){
r=m.createRng();
r.setStart(f(d),g);
r.setEnd(f(q),b);
k.setRng(r)
}}else{
if(p.name){
k.select(m.select(p.name)[p.index])
}else{
if(p.rng){
k.setRng(p.rng)
}}}}}}
,select:function(u,d){
var c=this,m=c.dom,h=m.createRng(),r;
function l(f,g){
var p=new e(f,f);
do{
if(f.nodeType==3&&o.trim(f.nodeValue).length!==0){
if(g){
h.setStart(f,0)
}else{
h.setEnd(f,f.nodeValue.length)
}
return
}
if(f.nodeName=="BR"){
if(g){
h.setStartBefore(f)
}else{
h.setEndBefore(f)
}
return
}}
while(f=(g?p.next():p.prev()))
}
if(u){
r=m.nodeIndex(u);
h.setStart(u.parentNode,r);
h.setEnd(u.parentNode,r+1);
if(d){
l(u,1);
l(u)
}
c.setRng(h)
}
return u
}
,isCollapsed:function(){
var h=this,c=h.getRng(),l=h.getSel();
if(!c||c.item){
return false
}
if(c.compareEndPoints){
return c.compareEndPoints("StartToEnd",c)===0
}
return !l||c.collapsed
}
,collapse:function(r){
var l=this,h=l.getRng(),c;
if(h.item){
c=h.item(0);
h=l.win.document.body.createTextRange();
h.moveToElementText(c)
}
h.collapse(!!r);
l.setRng(h)
}
,getSel:function(){
var h=this,r=this.win;
return r.getSelection?r.getSelection():r.document.selection
}
,getRng:function(m){
var h=this,c,r,u,d=h.win.document;
if(m&&h.tridentSel){
return h.tridentSel.getRangeAt(0)
}
try{
if(c=h.getSel()){
r=c.rangeCount>0?c.getRangeAt(0):(c.createRange?c.createRange():d.createRange())
}}
catch(l){}
if(o.isIE&&r&&r.setStart&&d.selection.createRange().item){
u=d.selection.createRange().item(0);
r=d.createRange();
r.setStartBefore(u);
r.setEndAfter(u)
}
if(!r){
r=d.createRange?d.createRange():d.body.createTextRange()
}
if(r.setStart&&r.startContainer.nodeType===9&&r.collapsed){
u=h.dom.getRoot();
r.setStart(u,0);
r.setEnd(u,0)
}
if(h.selectedRange&&h.explicitRange){
if(r.compareBoundaryPoints(r.START_TO_START,h.selectedRange)===0&&r.compareBoundaryPoints(r.END_TO_END,h.selectedRange)===0){
r=h.explicitRange
}else{
h.selectedRange=null;
h.explicitRange=null
}}
return r
}
,setRng:function(u,h){
var d,c=this;
if(!c.tridentSel){
d=c.getSel();
if(d){
c.explicitRange=u;
try{
d.removeAllRanges()
}
catch(l){}
d.addRange(u);
if(h===false&&d.extend){
d.collapse(u.endContainer,u.endOffset);
d.extend(u.startContainer,u.startOffset)
}
c.selectedRange=d.rangeCount>0?d.getRangeAt(0):null
}}else{
if(u.cloneRange){
try{
c.tridentSel.addRange(u);
return
}
catch(l){}}
try{
u.select()
}
catch(l){}}}
,setNode:function(h){
var r=this;
r.setContent(r.dom.getOuterHTML(h));
return h
}
,getNode:function(){
var l=this,h=l.getRng(),c=l.getSel(),m,u=h.startContainer,r=h.endContainer;
function d(g,f){
var p=g;
while(g&&g.nodeType===3&&g.length===0){
g=f?g.nextSibling:g.previousSibling
}
return g||p
}
if(!h){
return l.dom.getRoot()
}
if(h.setStart){
m=h.commonAncestorContainer;
if(!h.collapsed){
if(h.startContainer==h.endContainer){
if(h.endOffset-h.startOffset<2){
if(h.startContainer.hasChildNodes()){
m=h.startContainer.childNodes[h.startOffset]
}}}
if(u.nodeType===3&&r.nodeType===3){
if(u.length===h.startOffset){
u=d(u.nextSibling,true)
}else{
u=u.parentNode
}
if(h.endOffset===0){
r=d(r.previousSibling,false)
}else{
r=r.parentNode
}
if(u&&u===r){
return u
}}}
if(m&&m.nodeType==3){
return m.parentNode
}
return m
}
return h.item?h.item(0):h.parentElement()
}
,getSelectedBlocks:function(p,h){
var f=this,d=f.dom,m,u,l,c=[];
m=d.getParent(p||f.getStart(),d.isBlock);
u=d.getParent(h||f.getEnd(),d.isBlock);
if(m){
c.push(m)
}
if(m&&u&&m!=u){
l=m;
var r=new e(m,d.getRoot());
while((l=r.next())&&l!=u){
if(d.isBlock(l)){
c.push(l)
}}}
if(u&&m!=u){
c.push(u)
}
return c
}
,isForward:function(){
var l=this.dom,r=this.getSel(),c,h;
if(!r||r.anchorNode==null||r.focusNode==null){
return true
}
c=l.createRng();
c.setStart(r.anchorNode,r.anchorOffset);
c.collapse(true);
h=l.createRng();
h.setStart(r.focusNode,r.focusOffset);
h.collapse(true);
return c.compareBoundaryPoints(c.START_TO_START,h)<=0
}
,normalize:function(){
var h=this,r,m,u,c,l;
function d(g){
var p,v,f,k=h.dom,j=k.getRoot(),b,q,z;
function O(A,W){
var B=new e(A,k.getParent(A.parentNode,k.isBlock)||j);
while(A=B[W?"prev":"next"]()){
if(A.nodeName==="BR"){
return true
}}}
function T(B,A){
var C,W;
A=A||p;
C=new e(A,k.getParent(A.parentNode,k.isBlock)||j);
while(b=C[B?"prev":"next"]()){
if(b.nodeType===3&&b.nodeValue.length>0){
p=b;
v=B?b.nodeValue.length:0;
m=true;
return
}
if(k.isBlock(b)||q[b.nodeName.toLowerCase()]){
return
}
W=b
}
if(u&&W){
p=W;
m=true;
v=0
}}
p=r[(g?"start":"end")+"Container"];
v=r[(g?"start":"end")+"Offset"];
q=k.schema.getNonEmptyElements();
if(p.nodeType===9){
p=k.getRoot();
v=0
}
if(p===j){
if(g){
b=p.childNodes[v>0?v-1:0];
if(b){
z=b.nodeName.toLowerCase();
if(q[b.nodeName]||b.nodeName=="TABLE"){
return
}}}
if(p.hasChildNodes()){
p=p.childNodes[Math.min(!g&&v>0?v-1:v,p.childNodes.length-1)];
v=0;
if(p.hasChildNodes()&&!/TABLE/.test(p.nodeName)){
b=p;
f=new e(p,j);
do{
if(b.nodeType===3&&b.nodeValue.length>0){
v=g?0:b.nodeValue.length;
p=b;
m=true;
break
}
if(q[b.nodeName.toLowerCase()]){
v=k.nodeIndex(b);
p=b.parentNode;
if(b.nodeName=="IMG"&&!g){
v++
}
m=true;
break
}}
while(b=(g?f.next():f.prev()))
}}}
if(u){
if(p.nodeType===3&&v===0){
T(true)
}
if(p.nodeType===1){
b=p.childNodes[v];
if(b&&b.nodeName==="BR"&&!O(b)&&!O(b,true)){
T(true,p.childNodes[v])
}}}
if(g&&!u&&p.nodeType===3&&v===p.nodeValue.length){
T(false)
}
if(m){
r["set"+(g?"Start":"End")](p,v)
}}
if(o.isIE){
return
}
r=h.getRng();
u=r.collapsed;
d(true);
if(!u){
d()
}
if(m){
if(u){
r.collapse(true)
}
h.setRng(r,h.isForward())
}}
,selectorChanged:function(r,c){
var h=this,l;
if(!h.selectorChangedData){
h.selectorChangedData={};
l={};
h.editor.onNodeChange.addToTop(function(u,d,p){
var g=h.dom,m=g.getParents(p,null,g.getRoot()),f={};
n(h.selectorChangedData,function(v,b){
n(m,function(k){
if(g.is(k,b)){
if(!l[b]){
n(v,function(q){
q(true,{
node:k,selector:b,parents:m}
)
}
);
l[b]=v
}
f[b]=v;
return false
}}
)
}
);
n(l,function(v,b){
if(!f[b]){
delete l[b];
n(v,function(k){
k(false,{
node:p,selector:b,parents:m}
)
}
)
}}
)
}
)
}
if(!h.selectorChangedData[r]){
h.selectorChangedData[r]=[]
}
h.selectorChangedData[r].push(c);
return h
}
,destroy:function(h){
var r=this;
r.win=null;
if(!h){
o.removeUnload(r.destroy)
}}
,_fixIESelection:function(){
var h=this.dom,f=h.doc,l=f.body,d,p,r;
function c(g,k){
var b=l.createTextRange();
try{
b.moveToPoint(g,k)
}
catch(v){
b=null
}
return b
}
function m(b){
var g;
if(b.button){
g=c(b.x,b.y);
if(g){
if(g.compareEndPoints("StartToStart",p)>0){
g.setEndPoint("StartToStart",p)
}else{
g.setEndPoint("EndToEnd",p)
}
g.select()
}}else{
u()
}}
function u(){
var g=f.selection.createRange();
if(p&&!g.item&&g.compareEndPoints("StartToEnd",g)===0){
p.select()
}
h.unbind(f,"mouseup",u);
h.unbind(f,"mousemove",m);
p=d=0
}
f.documentElement.unselectable=true;
h.bind(f,["mousedown","contextmenu"],function(g){
if(g.target.nodeName==="HTML"){
if(d){
u()
}
r=f.documentElement;
if(r.scrollHeight>r.clientHeight){
return
}
d=1;
p=c(g.x,g.y);
if(p){
h.bind(f,"mouseup",u);
h.bind(f,"mousemove",m);
h.win.focus();
p.select()
}}}
)
}}
)
}
)(tinymce);
(function(e){
e.dom.Serializer=function(n,l,s){
var h,t,o=e.isIE,r=e.each,a;
if(!n.apply_source_formatting){
n.indent=false
}
l=l||e.DOM;
s=s||new e.html.Schema(n);
n.entity_encoding=n.entity_encoding||"named";
n.remove_trailing_brs="remove_trailing_brs" in n?n.remove_trailing_brs:true;
h=new e.util.Dispatcher(self);
t=new e.util.Dispatcher(self);
a=new e.html.DomParser(n,s);
a.addAttributeFilter("src,href,style",function(d,c){
var p=d.length,u,b,f="data-mce-"+c,g=n.url_converter,v=n.url_converter_scope,m;
while(p--){
u=d[p];
b=u.attributes.map[f];
if(b!==m){
u.attr(c,b.length>0?b:null);
u.attr(f,null)
}else{
b=u.attributes.map[c];
if(c==="style"){
b=l.serializeStyle(l.parseStyle(b),u.name)
}else{
if(g){
b=g.call(v,b,c,u.name)
}}
u.attr(c,b.length>0?b:null)
}}}
);
a.addAttributeFilter("class",function(c,d){
var u=c.length,m,f;
while(u--){
m=c[u];
f=m.attr("class").replace(/(?:^|\s)mce(Item\w+|Selected)(?!\S)/g,"");
m.attr("class",f.length>0?f:null)
}}
);
a.addAttributeFilter("data-mce-type",function(c,u,d){
var m=c.length,f;
while(m--){
f=c[m];
if(f.attributes.map["data-mce-type"]==="bookmark"&&!d.cleanup){
f.remove()
}}}
);
a.addAttributeFilter("data-mce-expando",function(c,u,d){
var m=c.length;
while(m--){
c[m].attr(u,null)
}}
);
a.addNodeFilter("script,style",function(d,u){
var m=d.length,f,p;
function c(g){
return g.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")
}
while(m--){
f=d[m];
p=f.firstChild?f.firstChild.value:"";
if(u==="script"){
f.attr("type",(f.attr("type")||"text/javascript").replace(/^mce\-/,""));
if(p.length>0){
f.firstChild.value="// <![CDATA[\n"+c(p)+"\n// ]]>"
}}else{
if(p.length>0){
f.firstChild.value="<!--\n"+c(p)+"\n-->"
}}}}
);
a.addNodeFilter("#comment",function(c,d){
var u=c.length,m;
while(u--){
m=c[u];
if(m.value.indexOf("[CDATA[")===0){
m.name="#cdata";
m.type=4;
m.value=m.value.replace(/^\[CDATA\[|\]\]$/g,"")
}else{
if(m.value.indexOf("mce:protected ")===0){
m.name="#text";
m.type=3;
m.raw=true;
m.value=unescape(m.value).substr(14)
}}}}
);
a.addNodeFilter("xml:namespace,input",function(c,d){
var u=c.length,m;
while(u--){
m=c[u];
if(m.type===7){
m.remove()
}else{
if(m.type===1){
if(d==="input"&&!("type" in m.attributes.map)){
m.attr("type","text")
}}}}}
);
if(n.fix_list_elements){
a.addNodeFilter("ul,ol",function(d,u){
var m=d.length,f,c;
while(m--){
f=d[m];
c=f.parent;
if(c.name==="ul"||c.name==="ol"){
if(f.prev&&f.prev.name==="li"){
f.prev.append(f)
}}}}
)
}
a.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(c,d){
var u=c.length;
while(u--){
c[u].attr(d,null)
}}
);
return{
schema:s,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,onPreProcess:h,onPostProcess:t,serialize:function(p,m){
var u,g,d,c,f;
if(o&&l.select("script,style,select,map").length>0){
f=p.innerHTML;
p=p.cloneNode(false);
l.setHTML(p,f)
}else{
p=p.cloneNode(true)
}
u=p.ownerDocument.implementation;
if(u.createHTMLDocument){
g=u.createHTMLDocument("");
r(p.nodeName=="BODY"?p.childNodes:[p],function(b){
g.body.appendChild(g.importNode(b,true))
}
);
if(p.nodeName!="BODY"){
p=g.body.firstChild
}else{
p=g.body
}
d=l.doc;
l.doc=g
}
m=m||{};
m.format=m.format||"html";
if(!m.no_events){
m.node=p;
h.dispatch(self,m)
}
c=new e.html.Serializer(n,s);
m.content=c.serialize(a.parse(e.trim(m.getInner?p.innerHTML:l.getOuterHTML(p)),m));
if(!m.cleanup){
m.content=m.content.replace(/\uFEFF|\u200B/g,"")
}
if(!m.no_events){
t.dispatch(self,m)
}
if(d){
l.doc=d
}
m.node=null;
return m.content
}
,addRules:function(c){
s.addValidElements(c)
}
,setRules:function(c){
s.setValidElements(c)
}}
}
}
)(tinymce);
(function(e){
e.dom.ScriptLoader=function(h){
var a=0,d=1,l=2,u={}
,c=[],n={}
,o=[],r=0,s;
function t(m,j){
var z=this,b=e.DOM,k,p,v,f;
function g(){
b.remove(f);
if(k){
k.onreadystatechange=k.onload=k=null
}
j()
}
function q(){
if(typeof(console)!=="undefined"&&console.log){
console.log("Failed to load: "+m)
}}
f=b.uniqueId();
if(e.isIE6){
p=new e.util.URI(m);
v=location;
if(p.host==v.hostname&&p.port==v.port&&(p.protocol+":")==v.protocol&&p.protocol.toLowerCase()!="file"){
e.util.XHR.send({
url:e._addVer(p.getURI()),success:function(O){
var T=b.create("script",{
type:"text/javascript"}
);
T.text=O;
document.getElementsByTagName("head")[0].appendChild(T);
b.remove(T);
g()
}
,error:q}
);
return
}}
k=document.createElement("script");
k.id=f;
k.type="text/javascript";
k.src=e._addVer(m);
if(!e.isIE){
k.onload=g
}
k.onerror=q;
if(!e.isOpera){
k.onreadystatechange=function(){
var T=k.readyState;
if(T=="complete"||T=="loaded"){
g()
}}
}
(document.getElementsByTagName("head")[0]||document.body).appendChild(k)
}
this.isDone=function(m){
return u[m]==l
};
this.markDone=function(m){
u[m]=l
};
this.add=this.load=function(m,b,f){
var p,g=u[m];
if(g==s){
c.push(m);
u[m]=a
}
if(b){
if(!n[m]){
n[m]=[]
}
n[m].push({
func:b,scope:f||this}
)
}};
this.loadQueue=function(f,m){
this.loadScripts(c,f,m)
};
this.loadScripts=function(m,b,g){
var p;
function f(v){
e.each(n[v],function(k){
k.func.call(k.scope)
}
);
n[v]=s
}
o.push({
func:b,scope:g||this}
);
p=function(){
var v=e.grep(m);
m.length=0;
e.each(v,function(k){
if(u[k]==l){
f(k);
return
}
if(u[k]!=d){
u[k]=d;
r++;
t(k,function(){
u[k]=l;
r--;
f(k);
p()
}
)
}}
);
if(!r){
e.each(o,function(k){
k.func.call(k.scope)
}
);
o.length=0
}};
p()
}
};
e.ScriptLoader=new e.dom.ScriptLoader()
}
)(tinymce);
(function(e){
e.dom.RangeUtils=function(a){
var t="\uFEFF";
this.walk=function(o,k){
var l=o.startContainer,u=o.startOffset,q=o.endContainer,m=o.endOffset,c,r,p,h,v,b,n;
n=a.select("td.mceSelected,th.mceSelected");
if(n.length>0){
e.each(n,function(j){
k([j])
}
);
return
}
function s(j){
var z;
z=j[0];
if(z.nodeType===3&&z===l&&u>=z.nodeValue.length){
j.splice(0,1)
}
z=j[j.length-1];
if(m===0&&j.length>0&&z===q&&z.nodeType===3){
j.splice(j.length-1,1)
}
return j
}
function g(T,z,j){
var O=[];
for(;
T&&T!=j;
T=T[z]){
O.push(T)
}
return O
}
function f(z,j){
do{
if(z.parentNode==j){
return z
}
z=z.parentNode
}
while(z)
}
function d(T,z,O){
var j=O?"nextSibling":"previousSibling";
for(h=T,v=h.parentNode;
h&&h!=z;
h=v){
v=h.parentNode;
b=g(h==T?h:h[j],j);
if(b.length){
if(!O){
b.reverse()
}
k(s(b))
}}}
if(l.nodeType==1&&l.hasChildNodes()){
l=l.childNodes[u]
}
if(q.nodeType==1&&q.hasChildNodes()){
q=q.childNodes[Math.min(m-1,q.childNodes.length-1)]
}
if(l==q){
return k(s([l]))
}
c=a.findCommonAncestor(l,q);
for(h=l;
h;
h=h.parentNode){
if(h===q){
return d(l,c,true)
}
if(h===c){
break
}}
for(h=q;
h;
h=h.parentNode){
if(h===l){
return d(q,c)
}
if(h===c){
break
}}
r=f(l,c)||l;
p=f(q,c)||q;
d(l,r,true);
b=g(r==l?r:r.nextSibling,"nextSibling",p==q?p.nextSibling:p);
if(b.length){
k(s(b))
}
d(q,p)
};
this.split=function(n){
var h=n.startContainer,o=n.startOffset,l=n.endContainer,r=n.endOffset;
function s(c,d){
return c.splitText(d)
}
if(h==l&&h.nodeType==3){
if(o>0&&o<h.nodeValue.length){
l=s(h,o);
h=l.previousSibling;
if(r>o){
r=r-o;
h=l=s(l,r).previousSibling;
r=l.nodeValue.length;
o=0
}else{
r=0
}}}else{
if(h.nodeType==3&&o>0&&o<h.nodeValue.length){
h=s(h,o);
o=0
}
if(l.nodeType==3&&r>0&&r<l.nodeValue.length){
l=s(l,r).previousSibling;
r=l.nodeValue.length
}}
return{
startContainer:h,startOffset:o,endContainer:l,endOffset:r}
}
};
e.dom.RangeUtils.compareRanges=function(a,t){
if(a&&t){
if(a.item||a.duplicate){
if(a.item&&t.item&&a.item(0)===t.item(0)){
return true
}
if(a.isEqual&&t.isEqual&&t.isEqual(a)){
return true
}}else{
return a.startContainer==t.startContainer&&a.startOffset==t.startOffset
}}
return false
}
}
)(tinymce);
(function(t){
var e=t.dom.Event,a=t.each;
t.create("tinymce.ui.KeyboardNavigation",{
KeyboardNavigation:function(n,s){
var b=this,f=n.root,m=n.items,p=n.enableUpDown,l=n.enableLeftRight||!n.enableUpDown,u=n.excludeFromTabOrder,d,h,g,o,r;
s=s||t.DOM;
d=function(v){
r=v.target.id
};
h=function(v){
s.setAttrib(v.target.id,"tabindex","-1")
};
o=function(v){
var k=s.get(r);
s.setAttrib(k,"tabindex","0");
k.focus()
};
b.focus=function(){
s.get(r).focus()
};
b.destroy=function(){
a(m,function(k){
var q=s.get(k.id);
s.unbind(q,"focus",d);
s.unbind(q,"blur",h)
}
);
var v=s.get(f);
s.unbind(v,"focus",o);
s.unbind(v,"keydown",g);
m=s=f=b.focus=d=h=g=o=null;
b.destroy=function(){}
};
b.moveFocus=function(z,k){
var v=-1,j=b.controls,q;
if(!r){
return
}
a(m,function(O,T){
if(O.id===r){
v=T;
return false
}}
);
v+=z;
if(v<0){
v=m.length-1
}else{
if(v>=m.length){
v=0
}}
q=m[v];
s.setAttrib(r,"tabindex","-1");
s.setAttrib(q.id,"tabindex","0");
s.get(q.id).focus();
if(n.actOnFocus){
n.onAction(q.id)
}
if(k){
e.cancel(k)
}};
g=function(A){
var z=37,j=39,O=38,W=40,v=27,q=14,k=13,T=32;
switch(A.keyCode){
case z:if(l){
b.moveFocus(-1)
}
break;
case j:if(l){
b.moveFocus(1)
}
break;
case O:if(p){
b.moveFocus(-1)
}
break;
case W:if(p){
b.moveFocus(1)
}
break;
case v:if(n.onCancel){
n.onCancel();
e.cancel(A)
}
break;
case q:case k:case T:if(n.onAction){
n.onAction(r);
e.cancel(A)
}
break
}};
a(m,function(q,v){
var k,j;
if(!q.id){
q.id=s.uniqueId("_mce_item_")
}
j=s.get(q.id);
if(u){
s.bind(j,"blur",h);
k="-1"
}else{
k=(v===0?"0":"-1")
}
j.setAttribute("tabindex",k);
s.bind(j,"focus",d)
}
);
if(m[0]){
r=m[0].id
}
s.setAttrib(f,"tabindex","-1");
var c=s.get(f);
s.bind(c,"focus",o);
s.bind(c,"keydown",g)
}}
)
}
)(tinymce);
(function(a){
var t=a.DOM,e=a.is;
a.create("tinymce.ui.Control",{
Control:function(r,n,o){
this.id=r;
this.settings=n=n||{};
this.rendered=false;
this.onRender=new a.util.Dispatcher(this);
this.classPrefix="";
this.scope=n.scope||this;
this.disabled=0;
this.active=0;
this.editor=o
}
,setAriaProperty:function(s,n){
var o=t.get(this.id+"_aria")||t.get(this.id);
if(o){
t.setAttrib(o,"aria-"+s,!!n)
}}
,focus:function(){
t.get(this.id).focus()
}
,setDisabled:function(o){
if(o!=this.disabled){
this.setAriaProperty("disabled",o);
this.setState("Disabled",o);
this.setState("Enabled",!o);
this.disabled=o
}}
,isDisabled:function(){
return this.disabled
}
,setActive:function(o){
if(o!=this.active){
this.setState("Active",o);
this.active=o;
this.setAriaProperty("pressed",o)
}}
,isActive:function(){
return this.active
}
,setState:function(h,o){
var r=t.get(this.id);
h=this.classPrefix+h;
if(o){
t.addClass(r,h)
}else{
t.removeClass(r,h)
}}
,isRendered:function(){
return this.rendered
}
,renderHTML:function(){}
,renderTo:function(o){
t.setHTML(o,this.renderHTML())
}
,postRender:function(){
var n=this,o;
if(e(n.disabled)){
o=n.disabled;
n.disabled=-1;
n.setDisabled(o)
}
if(e(n.active)){
o=n.active;
n.active=-1;
n.setActive(o)
}}
,remove:function(){
t.remove(this.id);
this.destroy()
}
,destroy:function(){
a.dom.Event.clear(this.id)
}}
)
}
)(tinymce);
tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{
Container:function(a,t,e){
this.parent(a,t,e);
this.controls=[];
this.lookup={}
}
,add:function(e){
this.lookup[e.id]=e;
this.controls.push(e);
return e
}
,get:function(e){
return this.lookup[e]
}}
);
tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{
Separator:function(t,e){
this.parent(t,e);
this.classPrefix="mceSeparator";
this.setDisabled(true)
}
,renderHTML:function(){
return tinymce.DOM.createHTML("span",{
"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"}
)
}}
);
(function(o){
var a=o.is,t=o.DOM,n=o.each,e=o.walk;
o.create("tinymce.ui.MenuItem:tinymce.ui.Control",{
MenuItem:function(h,r){
this.parent(h,r);
this.classPrefix="mceMenuItem"
}
,setSelected:function(r){
this.setState("Selected",r);
this.setAriaProperty("checked",!!r);
this.selected=r
}
,isSelected:function(){
return this.selected
}
,postRender:function(){
var s=this;
s.parent();
if(a(s.selected)){
s.setSelected(s.selected)
}}}
)
}
)(tinymce);
(function(o){
var a=o.is,t=o.DOM,n=o.each,e=o.walk;
o.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{
Menu:function(l,h){
var r=this;
r.parent(l,h);
r.items={};
r.collapsed=false;
r.menuCount=0;
r.onAddItem=new o.util.Dispatcher(this)
}
,expand:function(r){
var s=this;
if(r){
e(s,function(h){
if(h.expand){
h.expand()
}}
,"items",s)
}
s.collapsed=false
}
,collapse:function(r){
var s=this;
if(r){
e(s,function(h){
if(h.collapse){
h.collapse()
}}
,"items",s)
}
s.collapsed=true
}
,isCollapsed:function(){
return this.collapsed
}
,add:function(s){
if(!s.settings){
s=new o.ui.MenuItem(s.id||t.uniqueId(),s)
}
this.onAddItem.dispatch(this,s);
return this.items[s.id]=s
}
,addSeparator:function(){
return this.add({
separator:true}
)
}
,addMenu:function(s){
if(!s.collapse){
s=this.createMenu(s)
}
this.menuCount++;
return this.add(s)
}
,hasMenus:function(){
return this.menuCount!==0
}
,remove:function(s){
delete this.items[s.id]
}
,removeAll:function(){
var s=this;
e(s,function(r){
if(r.removeAll){
r.removeAll()
}else{
r.remove()
}
r.destroy()
}
,"items",s);
s.items={}
}
,createMenu:function(r){
var s=new o.ui.Menu(r.id||t.uniqueId(),r);
s.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);
return s
}}
)
}
)(tinymce);
(function(n){
var o=n.is,a=n.DOM,s=n.each,e=n.dom.Event,t=n.dom.Element;
n.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{
DropMenu:function(h,r){
r=r||{};
r.container=r.container||a.doc.body;
r.offset_x=r.offset_x||0;
r.offset_y=r.offset_y||0;
r.vp_offset_x=r.vp_offset_x||0;
r.vp_offset_y=r.vp_offset_y||0;
if(o(r.icons)&&!r.icons){
r["class"]+=" mceNoIcons"
}
this.parent(h,r);
this.onShowMenu=new n.util.Dispatcher(this);
this.onHideMenu=new n.util.Dispatcher(this);
this.classPrefix="mceMenu"
}
,createMenu:function(c){
var h=this,l=h.settings,r;
c.container=c.container||l.container;
c.parent=h;
c.constrain=c.constrain||l.constrain;
c["class"]=c["class"]||l["class"];
c.vp_offset_x=c.vp_offset_x||l.vp_offset_x;
c.vp_offset_y=c.vp_offset_y||l.vp_offset_y;
c.keyboard_focus=l.keyboard_focus;
r=new n.ui.DropMenu(c.id||a.uniqueId(),c);
r.onAddItem.add(h.onAddItem.dispatch,h.onAddItem);
return r
}
,focus:function(){
var r=this;
if(r.keyboardNav){
r.keyboardNav.focus()
}}
,update:function(){
var l=this,c=l.settings,r=a.get("menu_"+l.id+"_tbl"),u=a.get("menu_"+l.id+"_co"),h,d;
h=c.max_width?Math.min(r.offsetWidth,c.max_width):r.offsetWidth;
d=c.max_height?Math.min(r.offsetHeight,c.max_height):r.offsetHeight;
if(!a.boxModel){
l.element.setStyles({
width:h+2,height:d+2}
)
}else{
l.element.setStyles({
width:h,height:d}
)
}
if(c.max_width){
a.setStyle(u,"width",h)
}
if(c.max_height){
a.setStyle(u,"height",d);
if(r.clientHeight<c.max_height){
a.setStyle(u,"overflow","hidden")
}}}
,showMenu:function(g,f,v){
var j=this,z=j.settings,p,r=a.getViewPort(),k,u,q,b,l=2,d,c,m=j.classPrefix;
j.collapse(1);
if(j.isMenuVisible){
return
}
if(!j.rendered){
p=a.add(j.settings.container,j.renderNode());
s(j.items,function(h){
h.postRender()
}
);
j.element=new t("menu_"+j.id,{
blocker:1,container:z.container}
)
}else{
p=a.get("menu_"+j.id)
}
if(!n.isOpera){
a.setStyles(p,{
left:-65535,top:-65535}
)
}
a.show(p);
j.update();
g+=z.offset_x||0;
f+=z.offset_y||0;
r.w-=4;
r.h-=4;
if(z.constrain){
k=p.clientWidth-l;
u=p.clientHeight-l;
q=r.x+r.w;
b=r.y+r.h;
if((g+z.vp_offset_x+k)>q){
g=v?v-k:Math.max(0,(q-z.vp_offset_x)-k)
}
if((f+z.vp_offset_y+u)>b){
f=Math.max(0,(b-z.vp_offset_y)-u)
}}
a.setStyles(p,{
left:g,top:f}
);
j.element.update();
j.isMenuVisible=1;
j.mouseClickFunc=e.add(p,"click",function(T){
var h;
T=T.target;
if(T&&(T=a.getParent(T,"tr"))&&!a.hasClass(T,m+"ItemSub")){
h=j.items[T.id];
if(h.isDisabled()){
return
}
d=j;
while(d){
if(d.hideMenu){
d.hideMenu()
}
d=d.settings.parent
}
if(h.settings.onclick){
h.settings.onclick(T)
}
return false
}}
);
if(j.hasMenus()){
j.mouseOverFunc=e.add(p,"mouseover",function(A){
var h,O,T;
A=A.target;
if(A&&(A=a.getParent(A,"tr"))){
h=j.items[A.id];
if(j.lastMenu){
j.lastMenu.collapse(1)
}
if(h.isDisabled()){
return
}
if(A&&a.hasClass(A,m+"ItemSub")){
O=a.getRect(A);
h.showMenu((O.x+O.w-l),O.y-l,O.x);
j.lastMenu=h;
a.addClass(a.get(h.id).firstChild,m+"ItemActive")
}}}
)
}
e.add(p,"keydown",j._keyHandler,j);
j.onShowMenu.dispatch(j);
if(z.keyboard_focus){
j._setupKeyboardNav()
}}
,hideMenu:function(d){
var r=this,l=a.get("menu_"+r.id),h;
if(!r.isMenuVisible){
return
}
if(r.keyboardNav){
r.keyboardNav.destroy()
}
e.remove(l,"mouseover",r.mouseOverFunc);
e.remove(l,"click",r.mouseClickFunc);
e.remove(l,"keydown",r._keyHandler);
a.hide(l);
r.isMenuVisible=0;
if(!d){
r.collapse(1)
}
if(r.element){
r.element.hide()
}
if(h=a.get(r.id)){
a.removeClass(h.firstChild,r.classPrefix+"ItemActive")
}
r.onHideMenu.dispatch(r)
}
,add:function(l){
var r=this,h;
l=r.parent(l);
if(r.isRendered&&(h=a.get("menu_"+r.id))){
r._add(a.select("tbody",h)[0],l)
}
return l
}
,collapse:function(r){
this.parent(r);
this.hideMenu(1)
}
,remove:function(r){
a.remove(r.id);
this.destroy();
return this.parent(r)
}
,destroy:function(){
var r=this,h=a.get("menu_"+r.id);
if(r.keyboardNav){
r.keyboardNav.destroy()
}
e.remove(h,"mouseover",r.mouseOverFunc);
e.remove(a.select("a",h),"focus",r.mouseOverFunc);
e.remove(h,"click",r.mouseClickFunc);
e.remove(h,"keydown",r._keyHandler);
if(r.element){
r.element.remove()
}
a.remove(h)
}
,renderNode:function(){
var l=this,c=l.settings,u,h,d,r;
r=a.create("div",{
role:"listbox",id:"menu_"+l.id,"class":c["class"],style:"position:absolute;left:0;top:0;z-index:200000;outline:0"}
);
if(l.settings.parent){
a.setAttrib(r,"aria-parent","menu_"+l.settings.parent.id)
}
d=a.add(r,"div",{
role:"presentation",id:"menu_"+l.id+"_co","class":l.classPrefix+(c["class"]?" "+c["class"]:"")}
);
l.element=new t("menu_"+l.id,{
blocker:1,container:c.container}
);
if(c.menu_line){
a.add(d,"span",{
"class":l.classPrefix+"Line"}
)
}
u=a.add(d,"table",{
role:"presentation",id:"menu_"+l.id+"_tbl",border:0,cellPadding:0,cellSpacing:0}
);
h=a.add(u,"tbody");
s(l.items,function(m){
l._add(h,m)
}
);
l.rendered=true;
return r
}
,_setupKeyboardNav:function(){
var l,h,r=this;
l=a.get("menu_"+r.id);
h=a.select("a[role=option]","menu_"+r.id);
h.splice(0,0,l);
r.keyboardNav=new n.ui.KeyboardNavigation({
root:"menu_"+r.id,items:h,onCancel:function(){
r.hideMenu()
}
,enableUpDown:true}
);
l.focus()
}
,_keyHandler:function(r){
var h=this,l;
switch(r.keyCode){
case 37:if(h.settings.parent){
h.hideMenu();
h.settings.parent.focus();
e.cancel(r)
}
break;
case 39:if(h.mouseOverFunc){
h.mouseOverFunc(r)
}
break
}}
,_add:function(c,h){
var l,p=h.settings,f,u,d,m=this.classPrefix,r;
if(p.separator){
u=a.add(c,"tr",{
id:h.id,"class":m+"ItemSeparator"}
);
a.add(u,"td",{
"class":m+"ItemSeparator"}
);
if(l=u.previousSibling){
a.addClass(l,"mceLast")
}
return
}
l=u=a.add(c,"tr",{
id:h.id,"class":m+"Item "+m+"ItemEnabled"}
);
l=d=a.add(l,p.titleItem?"th":"td");
l=f=a.add(l,"a",{
id:h.id+"_aria",role:p.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"}
);
if(p.parent){
a.setAttrib(f,"aria-haspopup","true");
a.setAttrib(f,"aria-owns","menu_"+h.id)
}
a.addClass(d,p["class"]);
r=a.add(l,"span",{
"class":"mceIcon"+(p.icon?" mce_"+p.icon:"")}
);
if(p.icon_src){
a.add(r,"img",{
src:p.icon_src}
)
}
l=a.add(l,p.element||"span",{
"class":"mceText",title:h.settings.title}
,h.settings.title);
if(h.settings.style){
if(typeof h.settings.style=="function"){
h.settings.style=h.settings.style()
}
a.setAttrib(l,"style",h.settings.style)
}
if(c.childNodes.length==1){
a.addClass(u,"mceFirst")
}
if((l=u.previousSibling)&&a.hasClass(l,m+"ItemSeparator")){
a.addClass(u,"mceFirst")
}
if(h.collapse){
a.addClass(u,m+"ItemSub")
}
if(l=u.previousSibling){
a.removeClass(l,"mceLast")
}
a.addClass(u,"mceLast")
}}
)
}
)(tinymce);
(function(t){
var e=t.DOM;
t.create("tinymce.ui.Button:tinymce.ui.Control",{
Button:function(n,o,a){
this.parent(n,o,a);
this.classPrefix="mceButton"
}
,renderHTML:function(){
var r=this.classPrefix,n=this.settings,o,a;
a=e.encode(n.label||"");
o='<a role="button" id="'+this.id+'" href="javascript:;" class="'+r+" "+r+"Enabled "+n["class"]+(a?" "+r+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+e.encode(n.title)+'">';
if(n.image&&!(this.editor&&this.editor.forcedHighContrastMode)){
o+='<span class="mceIcon '+n["class"]+'"><img class="mceIcon" src="'+n.image+'" alt="'+e.encode(n.title)+'" /></span>'+(a?'<span class="'+r+'Label">'+a+"</span>":"")
}else{
o+='<span class="mceIcon '+n["class"]+'"></span>'+(a?'<span class="'+r+'Label">'+a+"</span>":"")
}
o+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+n.title+"</span>";
o+="</a>";
return o
}
,postRender:function(){
var o=this,n=o.settings,a;
if(t.isIE&&o.editor){
t.dom.Event.add(o.id,"mousedown",function(s){
var r=o.editor.selection.getNode().nodeName;
a=r==="IMG"?o.editor.selection.getBookmark():null
}
)
}
t.dom.Event.add(o.id,"click",function(s){
if(!o.isDisabled()){
if(t.isIE&&o.editor&&a!==null){
o.editor.selection.moveToBookmark(a)
}
return n.onclick.call(n.scope,s)
}}
);
t.dom.Event.add(o.id,"keyup",function(s){
if(!o.isDisabled()&&s.keyCode==t.VK.SPACEBAR){
return n.onclick.call(n.scope,s)
}}
)
}}
)
}
)(tinymce);
(function(n){
var o=n.DOM,t=n.dom.Event,s=n.each,e=n.util.Dispatcher,a;
n.create("tinymce.ui.ListBox:tinymce.ui.Control",{
ListBox:function(c,l,r){
var h=this;
h.parent(c,l,r);
h.items=[];
h.onChange=new e(h);
h.onPostRender=new e(h);
h.onAdd=new e(h);
h.onRenderMenu=new n.util.Dispatcher(this);
h.classPrefix="mceListBox";
h.marked={}
}
,select:function(h){
var r=this,c,l;
r.marked={};
if(h==a){
return r.selectByIndex(-1)
}
if(h&&typeof(h)=="function"){
l=h
}else{
l=function(d){
return d==h
}
}
if(h!=r.selectedValue){
s(r.items,function(u,d){
if(l(u.value)){
c=1;
r.selectByIndex(d);
return false
}}
);
if(!c){
r.selectByIndex(-1)
}}}
,selectByIndex:function(r){
var l=this,c,d,h;
l.marked={};
if(r!=l.selectedIndex){
c=o.get(l.id+"_text");
h=o.get(l.id+"_voiceDesc");
d=l.items[r];
if(d){
l.selectedValue=d.value;
l.selectedIndex=r;
o.setHTML(c,o.encode(d.title));
o.setHTML(h,l.settings.title+" - "+d.title);
o.removeClass(c,"mceTitle");
o.setAttrib(l.id,"aria-valuenow",d.title)
}else{
o.setHTML(c,o.encode(l.settings.title));
o.setHTML(h,o.encode(l.settings.title));
o.addClass(c,"mceTitle");
l.selectedValue=l.selectedIndex=null;
o.setAttrib(l.id,"aria-valuenow",l.settings.title)
}
c=0
}}
,mark:function(r){
this.marked[r]=true
}
,add:function(c,r,l){
var h=this;
l=l||{};
l=n.extend(l,{
title:c,value:r}
);
h.items.push(l);
h.onAdd.dispatch(h,l)
}
,getLength:function(){
return this.items.length
}
,renderHTML:function(){
var c="",r=this,l=r.settings,d=r.classPrefix;
c='<span role="listbox" aria-haspopup="true" aria-labelledby="'+r.id+'_voiceDesc" aria-describedby="'+r.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+r.id+'" cellpadding="0" cellspacing="0" class="'+d+" "+d+"Enabled"+(l["class"]?(" "+l["class"]):"")+'"><tbody><tr>';
c+="<td>"+o.createHTML("span",{
id:r.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"}
,r.settings.title);
c+=o.createHTML("a",{
id:r.id+"_text",tabindex:-1,href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"}
,o.encode(r.settings.title))+"</td>";
c+="<td>"+o.createHTML("a",{
id:r.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"}
,'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25BC</span></span>')+"</td>";
c+="</tr></tbody></table></span>";
return c
}
,showMenu:function(){
var h=this,c,l=o.get(this.id),r;
if(h.isDisabled()||h.items.length===0){
return
}
if(h.menu&&h.menu.isMenuVisible){
return h.hideMenu()
}
if(!h.isMenuRendered){
h.renderMenu();
h.isMenuRendered=true
}
c=o.getPos(l);
r=h.menu;
r.settings.offset_x=c.x;
r.settings.offset_y=c.y;
r.settings.keyboard_focus=!n.isOpera;
s(h.items,function(d){
if(r.items[d.id]){
r.items[d.id].setSelected(0)
}}
);
s(h.items,function(d){
if(r.items[d.id]&&h.marked[d.value]){
r.items[d.id].setSelected(1)
}
if(d.value===h.selectedValue){
r.items[d.id].setSelected(1)
}}
);
r.showMenu(0,l.clientHeight);
t.add(o.doc,"mousedown",h.hideMenu,h);
o.addClass(h.id,h.classPrefix+"Selected")
}
,hideMenu:function(h){
var r=this;
if(r.menu&&r.menu.isMenuVisible){
o.removeClass(r.id,r.classPrefix+"Selected");
if(h&&h.type=="mousedown"&&(h.target.id==r.id+"_text"||h.target.id==r.id+"_open")){
return
}
if(!h||!o.getParent(h.target,".mceMenu")){
o.removeClass(r.id,r.classPrefix+"Selected");
t.remove(o.doc,"mousedown",r.hideMenu,r);
r.menu.hideMenu()
}}}
,renderMenu:function(){
var h=this,r;
r=h.settings.control_manager.createDropMenu(h.id+"_menu",{
menu_line:1,"class":h.classPrefix+"Menu mceNoIcons",max_width:250,max_height:150}
);
r.onHideMenu.add(function(){
h.hideMenu();
h.focus()
}
);
r.add({
title:h.settings.title,"class":"mceMenuItemTitle",onclick:function(){
if(h.settings.onselect("")!==false){
h.select("")
}}}
);
s(h.items,function(l){
if(l.value===a){
r.add({
title:l.title,role:"option","class":"mceMenuItemTitle",onclick:function(){
if(h.settings.onselect("")!==false){
h.select("")
}}}
)
}else{
l.id=o.uniqueId();
l.role="option";
l.onclick=function(){
if(h.settings.onselect(l.value)!==false){
h.select(l.value)
}};
r.add(l)
}}
);
h.onRenderMenu.dispatch(h,r);
h.menu=r
}
,postRender:function(){
var r=this,h=r.classPrefix;
t.add(r.id,"click",r.showMenu,r);
t.add(r.id,"keydown",function(l){
if(l.keyCode==32){
r.showMenu(l);
t.cancel(l)
}}
);
t.add(r.id,"focus",function(){
if(!r._focused){
r.keyDownHandler=t.add(r.id,"keydown",function(l){
if(l.keyCode==40){
r.showMenu();
t.cancel(l)
}}
);
r.keyPressHandler=t.add(r.id,"keypress",function(c){
var l;
if(c.keyCode==13){
l=r.selectedValue;
r.selectedValue=null;
t.cancel(c);
r.settings.onselect(l)
}}
)
}
r._focused=1
}
);
t.add(r.id,"blur",function(){
t.remove(r.id,"keydown",r.keyDownHandler);
t.remove(r.id,"keypress",r.keyPressHandler);
r._focused=0
}
);
if(n.isIE6||!o.boxModel){
t.add(r.id,"mouseover",function(){
if(!o.hasClass(r.id,h+"Disabled")){
o.addClass(r.id,h+"Hover")
}}
);
t.add(r.id,"mouseout",function(){
if(!o.hasClass(r.id,h+"Disabled")){
o.removeClass(r.id,h+"Hover")
}}
)
}
r.onPostRender.dispatch(r,o.get(r.id))
}
,destroy:function(){
this.parent();
t.clear(this.id+"_text");
t.clear(this.id+"_open")
}}
)
}
)(tinymce);
(function(n){
var o=n.DOM,t=n.dom.Event,s=n.each,e=n.util.Dispatcher,a;
n.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{
NativeListBox:function(h,r){
this.parent(h,r);
this.classPrefix="mceNativeListBox"
}
,setDisabled:function(r){
o.get(this.id).disabled=r;
this.setAriaProperty("disabled",r)
}
,isDisabled:function(){
return o.get(this.id).disabled
}
,select:function(h){
var r=this,c,l;
if(h==a){
return r.selectByIndex(-1)
}
if(h&&typeof(h)=="function"){
l=h
}else{
l=function(d){
return d==h
}
}
if(h!=r.selectedValue){
s(r.items,function(u,d){
if(l(u.value)){
c=1;
r.selectByIndex(d);
return false
}}
);
if(!c){
r.selectByIndex(-1)
}}}
,selectByIndex:function(r){
o.get(this.id).selectedIndex=r+1;
this.selectedValue=this.items[r]?this.items[r].value:null
}
,add:function(d,h,r){
var c,l=this;
r=r||{};
r.value=h;
if(l.isRendered()){
o.add(o.get(this.id),"option",r,d)
}
c={
title:d,value:h,attribs:r};
l.items.push(c);
l.onAdd.dispatch(l,c)
}
,getLength:function(){
return this.items.length
}
,renderHTML:function(){
var l,r=this;
l=o.createHTML("option",{
value:""}
,"-- "+r.settings.title+" --");
s(r.items,function(h){
l+=o.createHTML("option",{
value:h.value}
,h.title)
}
);
l=o.createHTML("select",{
id:r.id,"class":"mceNativeListBox","aria-labelledby":r.id+"_aria"}
,l);
l+=o.createHTML("span",{
id:r.id+"_aria",style:"display: none"}
,r.settings.title);
return l
}
,postRender:function(){
var h=this,l,c=true;
h.rendered=true;
function r(u){
var d=h.items[u.target.selectedIndex-1];
if(d&&(d=d.value)){
h.onChange.dispatch(h,d);
if(h.settings.onselect){
h.settings.onselect(d)
}}}
t.add(h.id,"change",r);
t.add(h.id,"keydown",function(u){
var d;
t.remove(h.id,"change",l);
c=false;
d=t.add(h.id,"blur",function(){
if(c){
return
}
c=true;
t.add(h.id,"change",r);
t.remove(h.id,"blur",d)
}
);
if(n.isWebKit&&(u.keyCode==37||u.keyCode==39)){
return t.prevent(u)
}
if(u.keyCode==13||u.keyCode==32){
r(u);
return t.cancel(u)
}}
);
h.onPostRender.dispatch(h,o.get(h.id))
}}
)
}
)(tinymce);
(function(a){
var t=a.DOM,e=a.dom.Event,o=a.each;
a.create("tinymce.ui.MenuButton:tinymce.ui.Button",{
MenuButton:function(h,r,n){
this.parent(h,r,n);
this.onRenderMenu=new a.util.Dispatcher(this);
r.menu_container=r.menu_container||t.doc.body
}
,showMenu:function(){
var s=this,l,h,r=t.get(s.id),n;
if(s.isDisabled()){
return
}
if(!s.isMenuRendered){
s.renderMenu();
s.isMenuRendered=true
}
if(s.isMenuVisible){
return s.hideMenu()
}
l=t.getPos(s.settings.menu_container);
h=t.getPos(r);
n=s.menu;
n.settings.offset_x=h.x;
n.settings.offset_y=h.y;
n.settings.vp_offset_x=h.x;
n.settings.vp_offset_y=h.y;
n.settings.keyboard_focus=s._focused;
n.showMenu(0,r.firstChild.clientHeight);
e.add(t.doc,"mousedown",s.hideMenu,s);
s.setState("Selected",1);
s.isMenuVisible=1
}
,renderMenu:function(){
var s=this,n;
n=s.settings.control_manager.createDropMenu(s.id+"_menu",{
menu_line:1,"class":this.classPrefix+"Menu",icons:s.settings.icons}
);
n.onHideMenu.add(function(){
s.hideMenu();
s.focus()
}
);
s.onRenderMenu.dispatch(s,n);
s.menu=n
}
,hideMenu:function(s){
var n=this;
if(s&&s.type=="mousedown"&&t.getParent(s.target,function(r){
return r.id===n.id||r.id===n.id+"_open"
}
)){
return
}
if(!s||!t.getParent(s.target,".mceMenu")){
n.setState("Selected",0);
e.remove(t.doc,"mousedown",n.hideMenu,n);
if(n.menu){
n.menu.hideMenu()
}}
n.isMenuVisible=0
}
,postRender:function(){
var n=this,r=n.settings;
e.add(n.id,"click",function(){
if(!n.isDisabled()){
if(r.onclick){
r.onclick(n.value)
}
n.showMenu()
}}
)
}}
)
}
)(tinymce);
(function(a){
var t=a.DOM,e=a.dom.Event,o=a.each;
a.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{
SplitButton:function(h,r,n){
this.parent(h,r,n);
this.classPrefix="mceSplitButton"
}
,renderHTML:function(){
var c,r=this,l=r.settings,n;
c="<tbody><tr>";
if(l.image){
n=t.createHTML("img ",{
src:l.image,role:"presentation","class":"mceAction "+l["class"]}
)
}else{
n=t.createHTML("span",{
"class":"mceAction "+l["class"]}
,"")
}
n+=t.createHTML("span",{
"class":"mceVoiceLabel mceIconOnly",id:r.id+"_voice",style:"display:none;"}
,l.title);
c+="<td >"+t.createHTML("a",{
role:"button",id:r.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+l["class"],onclick:"return false;",onmousedown:"return false;",title:l.title}
,n)+"</td>";
n=t.createHTML("span",{
"class":"mceOpen "+l["class"]}
,'<span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25BC</span>');
c+="<td >"+t.createHTML("a",{
role:"button",id:r.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+l["class"],onclick:"return false;",onmousedown:"return false;",title:l.title}
,n)+"</td>";
c+="</tr></tbody>";
c=t.createHTML("table",{
role:"presentation","class":"mceSplitButton mceSplitButtonEnabled "+l["class"],cellpadding:"0",cellspacing:"0",title:l.title}
,c);
return t.createHTML("div",{
id:r.id,role:"button",tabindex:"0","aria-labelledby":r.id+"_voice","aria-haspopup":"true"}
,c)
}
,postRender:function(){
var n=this,h=n.settings,r;
if(h.onclick){
r=function(s){
if(!n.isDisabled()){
h.onclick(n.value);
e.cancel(s)
}};
e.add(n.id+"_action","click",r);
e.add(n.id,["click","keydown"],function(s){
var d=32,m=14,l=13,c=38,u=40;
if((s.keyCode===32||s.keyCode===13||s.keyCode===14)&&!s.altKey&&!s.ctrlKey&&!s.metaKey){
r();
e.cancel(s)
}else{
if(s.type==="click"||s.keyCode===u){
n.showMenu();
e.cancel(s)
}}}
)
}
e.add(n.id+"_open","click",function(s){
n.showMenu();
e.cancel(s)
}
);
e.add([n.id,n.id+"_open"],"focus",function(){
n._focused=1
}
);
e.add([n.id,n.id+"_open"],"blur",function(){
n._focused=0
}
);
if(a.isIE6||!t.boxModel){
e.add(n.id,"mouseover",function(){
if(!t.hasClass(n.id,"mceSplitButtonDisabled")){
t.addClass(n.id,"mceSplitButtonHover")
}}
);
e.add(n.id,"mouseout",function(){
if(!t.hasClass(n.id,"mceSplitButtonDisabled")){
t.removeClass(n.id,"mceSplitButtonHover")
}}
)
}}
,destroy:function(){
this.parent();
e.clear(this.id+"_action");
e.clear(this.id+"_open");
e.clear(this.id)
}}
)
}
)(tinymce);
(function(o){
var a=o.DOM,e=o.dom.Event,t=o.is,n=o.each;
o.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{
ColorSplitButton:function(c,l,r){
var h=this;
h.parent(c,l,r);
h.settings=l=o.extend({
colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"}
,h.settings);
h.onShowMenu=new o.util.Dispatcher(h);
h.onHideMenu=new o.util.Dispatcher(h);
h.value=l.default_color
}
,showMenu:function(){
var s=this,h,d,c,l;
if(s.isDisabled()){
return
}
if(!s.isMenuRendered){
s.renderMenu();
s.isMenuRendered=true
}
if(s.isMenuVisible){
return s.hideMenu()
}
c=a.get(s.id);
a.show(s.id+"_menu");
a.addClass(c,"mceSplitButtonSelected");
l=a.getPos(c);
a.setStyles(s.id+"_menu",{
left:l.x,top:l.y+c.firstChild.clientHeight,zIndex:200000}
);
c=0;
e.add(a.doc,"mousedown",s.hideMenu,s);
s.onShowMenu.dispatch(s);
if(s._focused){
s._keyHandler=e.add(s.id+"_menu","keydown",function(r){
if(r.keyCode==27){
s.hideMenu()
}}
);
a.select("a",s.id+"_menu")[0].focus()
}
s.keyboardNav=new o.ui.KeyboardNavigation({
root:s.id+"_menu",items:a.select("a",s.id+"_menu"),onCancel:function(){
s.hideMenu();
s.focus()
}}
);
s.keyboardNav.focus();
s.isMenuVisible=1
}
,hideMenu:function(r){
var s=this;
if(s.isMenuVisible){
if(r&&r.type=="mousedown"&&a.getParent(r.target,function(h){
return h.id===s.id+"_open"
}
)){
return
}
if(!r||!a.getParent(r.target,".mceSplitButtonMenu")){
a.removeClass(s.id,"mceSplitButtonSelected");
e.remove(a.doc,"mousedown",s.hideMenu,s);
e.remove(s.id+"_menu","keydown",s._keyHandler);
a.hide(s.id+"_menu")
}
s.isMenuVisible=0;
s.onHideMenu.dispatch();
s.keyboardNav.destroy()
}}
,renderMenu:function(){
var p=this,l,d=0,g=p.settings,h,c,u,f,r;
f=a.add(g.menu_container,"div",{
role:"listbox",id:p.id+"_menu","class":g.menu_class+" "+g["class"],style:"position:absolute;left:0;top:-1000px;"}
);
l=a.add(f,"div",{
"class":g["class"]+" mceSplitButtonMenu"}
);
a.add(l,"span",{
"class":"mceMenuLine"}
);
h=a.add(l,"table",{
role:"presentation","class":"mceColorSplitMenu"}
);
c=a.add(h,"tbody");
d=0;
n(t(g.colors,"array")?g.colors:g.colors.split(","),function(m){
m=m.replace(/^#/,"");
if(!d--){
u=a.add(c,"tr");
d=g.grid_width-1
}
h=a.add(u,"td");
var s={
href:"javascript:;",style:{
backgroundColor:"#"+m}
,title:p.editor.getLang("colors."+m,m),"data-mce-color":"#"+m};
if(!o.isIE){
s.role="option"
}
h=a.add(h,"a",s);
if(p.editor.forcedHighContrastMode){
h=a.add(h,"canvas",{
width:16,height:16,"aria-hidden":"true"}
);
if(h.getContext&&(r=h.getContext("2d"))){
r.fillStyle="#"+m;
r.fillRect(0,0,16,16)
}else{
a.remove(h)
}}}
);
if(g.more_colors_func){
h=a.add(c,"tr");
h=a.add(h,"td",{
colspan:g.grid_width,"class":"mceMoreColors"}
);
h=a.add(h,"a",{
role:"option",id:p.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"}
,g.more_colors_title);
e.add(h,"click",function(s){
g.more_colors_func.call(g.more_colors_scope||this);
return e.cancel(s)
}
)
}
a.addClass(l,"mceColorSplitMenu");
e.add(p.id+"_menu","mousedown",function(s){
return e.cancel(s)
}
);
e.add(p.id+"_menu","click",function(s){
var m;
s=a.getParent(s.target,"a",c);
if(s&&s.nodeName.toLowerCase()=="a"&&(m=s.getAttribute("data-mce-color"))){
p.setColor(m)
}
return false
}
);
return f
}
,setColor:function(s){
this.displayColor(s);
this.hideMenu();
this.settings.onselect(s)
}
,displayColor:function(r){
var s=this;
a.setStyle(s.id+"_preview","backgroundColor",r);
s.value=r
}
,postRender:function(){
var s=this,r=s.id;
s.parent();
a.add(r+"_action","div",{
id:r+"_preview","class":"mceColorPreview"}
);
a.setStyle(s.id+"_preview","backgroundColor",s.value)
}
,destroy:function(){
var s=this;
s.parent();
e.clear(s.id+"_menu");
e.clear(s.id+"_more");
a.remove(s.id+"_menu");
if(s.keyboardNav){
s.keyboardNav.destroy()
}}}
)
}
)(tinymce);
(function(t){
var o=t.DOM,a=t.each,e=t.dom.Event;
t.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{
renderHTML:function(){
var s=this,l=[],n=s.controls,c=t.each,r=s.settings;
l.push('<div id="'+s.id+'" role="group" aria-labelledby="'+s.id+'_voice">');
l.push("<span role='application'>");
l.push('<span id="'+s.id+'_voice" class="mceVoiceLabel" style="display:none;">'+o.encode(r.name)+"</span>");
c(n,function(h){
l.push(h.renderHTML())
}
);
l.push("</span>");
l.push("</div>");
return l.join("")
}
,focus:function(){
var n=this;
o.get(n.id).focus()
}
,postRender:function(){
var s=this,n=[];
a(s.controls,function(r){
a(r.controls,function(h){
if(h.id){
n.push(h)
}}
)
}
);
s.keyNav=new t.ui.KeyboardNavigation({
root:s.id,items:n,onCancel:function(){
if(t.isWebKit){
o.get(s.editor.id+"_ifr").focus()
}
s.editor.focus()
}
,excludeFromTabOrder:!s.settings.tab_focus_toolbar}
)
}
,destroy:function(){
var n=this;
n.parent();
n.keyNav.destroy();
e.clear(n.id)
}}
)
}
)(tinymce);
(function(e){
var a=e.DOM,t=e.each;
e.create("tinymce.ui.Toolbar:tinymce.ui.Container",{
renderHTML:function(){
var f=this,r="",d,u,p=f.settings,n,o,l,m;
m=f.controls;
for(n=0;
n<m.length;
n++){
u=m[n];
o=m[n-1];
l=m[n+1];
if(n===0){
d="mceToolbarStart";
if(u.Button){
d+=" mceToolbarStartButton"
}else{
if(u.SplitButton){
d+=" mceToolbarStartSplitButton"
}else{
if(u.ListBox){
d+=" mceToolbarStartListBox"
}}}
r+=a.createHTML("td",{
"class":d}
,a.createHTML("span",null,"<!-- IE -->"))
}
if(o&&u.ListBox){
if(o.Button||o.SplitButton){
r+=a.createHTML("td",{
"class":"mceToolbarEnd"}
,a.createHTML("span",null,"<!-- IE -->"))
}}
if(a.stdMode){
r+='<td style="position: relative">'+u.renderHTML()+"</td>"
}else{
r+="<td>"+u.renderHTML()+"</td>"
}
if(l&&u.ListBox){
if(l.Button||l.SplitButton){
r+=a.createHTML("td",{
"class":"mceToolbarStart"}
,a.createHTML("span",null,"<!-- IE -->"))
}}}
d="mceToolbarEnd";
if(u.Button){
d+=" mceToolbarEndButton"
}else{
if(u.SplitButton){
d+=" mceToolbarEndSplitButton"
}else{
if(u.ListBox){
d+=" mceToolbarEndListBox"
}}}
r+=a.createHTML("td",{
"class":d}
,a.createHTML("span",null,"<!-- IE -->"));
return a.createHTML("table",{
id:f.id,"class":"mceToolbar"+(p["class"]?" "+p["class"]:""),cellpadding:"0",cellspacing:"0",align:f.settings.align||"",role:"presentation",tabindex:"-1"}
,"<tbody><tr>"+r+"</tr></tbody>")
}}
)
}
)(tinymce);
(function(t){
var e=t.util.Dispatcher,a=t.each;
t.create("tinymce.AddOnManager",{
AddOnManager:function(){
var o=this;
o.items=[];
o.urls={};
o.lookup={};
o.onAdd=new e(o)
}
,get:function(o){
if(this.lookup[o]){
return this.lookup[o].instance
}else{
return undefined
}}
,dependencies:function(s){
var o;
if(this.lookup[s]){
o=this.lookup[s].dependencies
}
return o||[]
}
,requireLangPack:function(r){
var o=t.settings;
if(o&&o.language&&o.language_load!==false){
t.ScriptLoader.add(this.urls[r]+"/langs/"+o.language+".js")
}}
,add:function(r,s,n){
this.items.push(s);
this.lookup[r]={
instance:s,dependencies:n};
this.onAdd.dispatch(this,r,s);
return s
}
,createUrl:function(o,n){
if(typeof n==="object"){
return n
}else{
return{
prefix:o.prefix,resource:n,suffix:o.suffix}
}}
,addComponents:function(s,o){
var n=this.urls[s];
t.each(o,function(r){
t.ScriptLoader.add(n+"/"+r)
}
)
}
,load:function(m,h,o,c){
var l=this,r=h;
function d(){
var n=l.dependencies(m);
t.each(n,function(u){
var s=l.createUrl(h,u);
l.load(s.resource,s,undefined,undefined)
}
);
if(o){
if(c){
o.call(c)
}else{
o.call(t.ScriptLoader)
}}}
if(l.urls[m]){
return
}
if(typeof h==="object"){
r=h.prefix+h.resource+h.suffix
}
if(r.indexOf("/")!==0&&r.indexOf("://")==-1){
r=t.baseURL+"/"+r
}
l.urls[m]=r.substring(0,r.lastIndexOf("/"));
if(l.lookup[m]){
d()
}else{
t.ScriptLoader.add(r,d,c)
}}}
);
t.PluginManager=new t.AddOnManager();
t.ThemeManager=new t.AddOnManager()
}
(tinymce));
(function(c){
var r=c.each,o=c.extend,d=c.DOM,l=c.dom.Event,s=c.ThemeManager,t=c.PluginManager,n=c.explode,h=c.util.Dispatcher,e,a=0;
c.documentBaseURL=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");
if(!/[\/\\]$/.test(c.documentBaseURL)){
c.documentBaseURL+="/"
}
c.baseURL=new c.util.URI(c.documentBaseURL).toAbsolute(c.baseURL);
c.baseURI=new c.util.URI(c.baseURL);
c.onBeforeUnload=new h(c);
l.add(window,"beforeunload",function(u){
c.onBeforeUnload.dispatch(c,u)
}
);
c.onAddEditor=new h(c);
c.onRemoveEditor=new h(c);
c.EditorManager=o(c,{
editors:[],i18n:{}
,activeEditor:null,init:function(j){
var q=this,p,f=c.ScriptLoader,k,u=[],v;
function b(T){
var z=T.id;
if(!z){
z=T.name;
if(z&&!d.get(z)){
z=T.name
}else{
z=d.uniqueId()
}
T.setAttribute("id",z)
}
return z
}
function m(O,A,z){
var T=O[A];
if(!T){
return
}
if(c.is(T,"string")){
z=T.replace(/\.\w+$/,"");
z=z?c.resolve(z):0;
T=c.resolve(T)
}
return T.apply(z||this,Array.prototype.slice.call(arguments,2))
}
function g(T,z){
return z.constructor===RegExp?z.test(T.className):d.hasClass(T,z)
}
q.settings=j;
l.bind(window,"ready",function(){
var z,T;
m(j,"onpageload");
switch(j.mode){
case"exact":z=j.elements||"";
if(z.length>0){
r(n(z),function(O){
if(d.get(O)){
v=new c.Editor(O,j);
u.push(v);
v.render(1)
}else{
r(document.forms,function(A){
r(A.elements,function(W){
if(W.name===O){
O="mce_editor_"+a++;
d.setAttrib(W,"id",O);
v=new c.Editor(O,j);
u.push(v);
v.render(1)
}}
)
}
)
}}
)
}
break;
case"textareas":case"specific_textareas":r(d.select("textarea"),function(O){
if(j.editor_deselector&&g(O,j.editor_deselector)){
return
}
if(!j.editor_selector||g(O,j.editor_selector)){
v=new c.Editor(b(O),j);
u.push(v);
v.render(1)
}}
);
break;
default:if(j.types){
r(j.types,function(O){
r(d.select(O.selector),function(W){
var A=new c.Editor(b(W),c.extend({}
,j,O));
u.push(A);
A.render(1)
}
)
}
)
}else{
if(j.selector){
r(d.select(j.selector),function(A){
var O=new c.Editor(b(A),j);
u.push(O);
O.render(1)
}
)
}}}
if(j.oninit){
z=T=0;
r(u,function(O){
T++;
if(!O.initialized){
O.onInit.add(function(){
z++;
if(z==T){
m(j,"oninit")
}}
)
}else{
z++
}
if(z==T){
m(j,"oninit")
}}
)
}}
)
}
,get:function(u){
if(u===e){
return this.editors
}
return this.editors[u]
}
,getInstanceById:function(u){
return this.get(u)
}
,add:function(m){
var u=this,f=u.editors;
f[m.id]=m;
f.push(m);
u._setActive(m);
u.onAddEditor.dispatch(u,m);
return m
}
,remove:function(f){
var m=this,u,p=m.editors;
if(!p[f.id]){
return null
}
delete p[f.id];
for(u=0;
u<p.length;
u++){
if(p[u]==f){
p.splice(u,1);
break
}}
if(m.activeEditor==f){
m._setActive(p[0])
}
f.destroy();
m.onRemoveEditor.dispatch(m,f);
return f
}
,execCommand:function(q,b,g){
var k=this,p=k.get(g),m;
function f(){
p.destroy();
m.detachEvent("onunload",f);
m=m.tinyMCE=m.tinymce=null
}
switch(q){
case"mceFocus":p.focus();
return true;
case"mceAddEditor":case"mceAddControl":if(!k.get(g)){
new c.Editor(g,k.settings).render()
}
return true;
case"mceAddFrameControl":m=g.window;
m.tinyMCE=tinyMCE;
m.tinymce=c;
c.DOM.doc=m.document;
c.DOM.win=m;
p=new c.Editor(g.element_id,g);
p.render();
if(c.isIE){
m.attachEvent("onunload",f)
}
g.page_window=null;
return true;
case"mceRemoveEditor":case"mceRemoveControl":if(p){
p.remove()
}
return true;
case"mceToggleEditor":if(!p){
k.execCommand("mceAddControl",0,g);
return true
}
if(p.isHidden()){
p.show()
}else{
p.hide()
}
return true
}
if(k.activeEditor){
return k.activeEditor.execCommand(q,b,g)
}
return false
}
,execInstanceCommand:function(b,g,p,f){
var m=this.get(b);
if(m){
return m.execCommand(g,p,f)
}
return false
}
,triggerSave:function(){
r(this.editors,function(u){
u.save()
}
)
}
,addI18n:function(f,g){
var u,m=this.i18n;
if(!c.is(f,"string")){
r(f,function(b,p){
r(b,function(k,v){
r(k,function(j,q){
if(v==="common"){
m[p+"."+q]=j
}else{
m[p+"."+v+"."+q]=j
}}
)
}
)
}
)
}else{
r(g,function(b,p){
m[f+"."+p]=b
}
)
}}
,_setActive:function(u){
this.selectedInstance=this.activeEditor=u
}}
)
}
)(tinymce);
(function(d){
var u=d.DOM,c=d.dom.Event,s=d.extend,l=d.each,e=d.isGecko,t=d.isIE,n=d.isWebKit,o=d.is,h=d.ThemeManager,a=d.PluginManager,r=d.explode;
d.create("tinymce.Editor",{
Editor:function(g,p){
var m=this,f=true;
m.settings=p=s({
id:g,language:"en",theme:"advanced",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:d.documentBaseURL,add_form_submit_trigger:f,submit_patch:f,add_unload_trigger:f,convert_urls:f,relative_urls:f,remove_script_host:f,table_inline_editing:false,object_resizing:f,accessibility_focus:f,doctype:d.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual:f,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",apply_source_formatting:f,directionality:"ltr",forced_root_block:"p",hidden_input:f,padd_empty_editor:f,render_ui:f,indentation:"30px",fix_table_elements:f,inline_styles:f,convert_fonts_to_spans:f,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",validate:f,entity_encoding:"named",url_converter:m.convertURL,url_converter_scope:m,ie7_compat:f}
,p);
m.id=m.editorId=g;
m.isNotDirty=false;
m.plugins={};
m.documentBaseURI=new d.util.URI(p.document_base_url||d.documentBaseURL,{
base_uri:tinyMCE.baseURI}
);
m.baseURI=d.baseURI;
m.contentCSS=[];
m.contentStyles=[];
m.setupEvents();
m.execCommands={};
m.queryStateCommands={};
m.queryValueCommands={};
m.execCallback("setup",m)
}
,render:function(p){
var g=this,b=g.settings,v=g.id,m=d.ScriptLoader;
if(!c.domLoaded){
c.add(window,"ready",function(){
g.render()
}
);
return
}
tinyMCE.settings=b;
if(!g.getElement()){
return
}
if(d.isIDevice&&!d.isIOS5){
return
}
if(!/TEXTAREA|INPUT/i.test(g.getElement().nodeName)&&b.hidden_input&&u.getParent(v,"form")){
u.insertAfter(u.create("input",{
type:"hidden",name:v}
),v)
}
if(!b.content_editable){
g.orgVisibility=g.getElement().style.visibility;
g.getElement().style.visibility="hidden"
}
if(d.WindowManager){
g.windowManager=new d.WindowManager(g)
}
if(b.encoding=="xml"){
g.onGetContent.add(function(k,q){
if(q.save){
q.content=u.encode(q.content)
}}
)
}
if(b.add_form_submit_trigger){
g.onSubmit.addToTop(function(){
if(g.initialized){
g.save();
g.isNotDirty=1
}}
)
}
if(b.add_unload_trigger){
g._beforeUnload=tinyMCE.onBeforeUnload.add(function(){
if(g.initialized&&!g.destroyed&&!g.isHidden()){
g.save({
format:"raw",no_events:true}
)
}}
)
}
d.addUnload(g.destroy,g);
if(b.submit_patch){
g.onBeforeRenderUI.add(function(){
var k=g.getElement().form;
if(!k){
return
}
if(k._mceOldSubmit){
return
}
if(!k.submit.nodeType&&!k.submit.length){
g.formElement=k;
k._mceOldSubmit=k.submit;
k.submit=function(){
d.triggerSave();
g.isNotDirty=1;
return g.formElement._mceOldSubmit(g.formElement)
}
}
k=null
}
)
}
function f(){
if(b.language&&b.language_load!==false){
m.add(d.baseURL+"/langs/"+b.language+".js")
}
if(b.theme&&typeof b.theme!="function"&&b.theme.charAt(0)!="-"&&!h.urls[b.theme]){
h.load(b.theme,"themes/"+b.theme+"/editor_template"+d.suffix+".js")
}
l(r(b.plugins),function(q){
if(q&&!a.urls[q]){
if(q.charAt(0)=="-"){
q=q.substr(1,q.length);
var k=a.dependencies(q);
l(k,function(z){
var j={
prefix:"plugins/",resource:z,suffix:"/editor_plugin"+d.suffix+".js"};
z=a.createUrl(j,z);
a.load(z.resource,z)
}
)
}else{
if(q=="safari"){
return
}
a.load(q,{
prefix:"plugins/",resource:q,suffix:"/editor_plugin"+d.suffix+".js"}
)
}}}
);
m.loadQueue(function(){
if(!g.removed){
g.init()
}}
)
}
f()
}
,init:function(){
var p,B=this,C=B.settings,O,k,q,T=B.getElement(),f,m,A,b,z,W,v,g=[];
d.add(B);
C.aria_label=C.aria_label||u.getAttrib(T,"aria-label",B.getLang("aria.rich_text_area"));
if(C.theme){
if(typeof C.theme!="function"){
C.theme=C.theme.replace(/-/,"");
f=h.get(C.theme);
B.theme=new f();
if(B.theme.init){
B.theme.init(B,h.urls[C.theme]||d.documentBaseURL.replace(/\/$/,""))
}}else{
B.theme=C.theme
}}
function j(F){
var M=a.get(F),S=a.urls[F]||d.documentBaseURL.replace(/\/$/,""),D;
if(M&&d.inArray(g,F)===-1){
l(a.dependencies(F),function(R){
j(R)
}
);
D=new M(B,S);
B.plugins[F]=D;
if(D.init){
D.init(B,S);
g.push(F)
}}}
l(r(C.plugins.replace(/\-/g,"")),j);
if(C.popup_css!==false){
if(C.popup_css){
C.popup_css=B.documentBaseURI.toAbsolute(C.popup_css)
}else{
C.popup_css=B.baseURI.toAbsolute("themes/"+C.theme+"/skins/"+C.skin+"/dialog.css")
}}
if(C.popup_css_add){
C.popup_css+=","+B.documentBaseURI.toAbsolute(C.popup_css_add)
}
B.controlManager=new d.ControlManager(B);
B.onBeforeRenderUI.dispatch(B,B.controlManager);
if(C.render_ui&&B.theme){
B.orgDisplay=T.style.display;
if(typeof C.theme!="function"){
O=C.width||T.style.width||T.offsetWidth;
k=C.height||T.style.height||T.offsetHeight;
q=C.min_height||100;
W=/^[0-9\.]+(|px)$/i;
if(W.test(""+O)){
O=Math.max(parseInt(O,10)+(f.deltaWidth||0),100)
}
if(W.test(""+k)){
k=Math.max(parseInt(k,10)+(f.deltaHeight||0),q)
}
f=B.theme.renderUI({
targetNode:T,width:O,height:k,deltaWidth:C.delta_width,deltaHeight:C.delta_height}
);
u.setStyles(f.sizeContainer||f.editorContainer,{
width:O,height:k}
);
k=(f.iframeHeight||k)+(typeof(k)=="number"?(f.deltaHeight||0):"");
if(k<q){
k=q
}}else{
f=C.theme(B,T);
if(f.editorContainer.nodeType){
f.editorContainer=f.editorContainer.id=f.editorContainer.id||B.id+"_parent"
}
if(f.iframeContainer.nodeType){
f.iframeContainer=f.iframeContainer.id=f.iframeContainer.id||B.id+"_iframecontainer"
}
k=f.iframeHeight||T.offsetHeight;
if(t){
B.onInit.add(function(D){
D.dom.bind(D.getBody(),"beforedeactivate keydown",function(){
D.lastIERng=D.selection.getRng()
}
)
}
)
}}
B.editorContainer=f.editorContainer
}
if(C.content_css){
l(r(C.content_css),function(D){
B.contentCSS.push(B.documentBaseURI.toAbsolute(D))
}
)
}
if(C.content_editable){
T=p=f=null;
return B.initContentBody()
}
if(document.domain&&location.hostname!=document.domain){
d.relaxedDomain=document.domain
}
B.iframeHTML=C.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';
if(C.document_base_url!=d.documentBaseURL){
B.iframeHTML+='<base href="'+B.documentBaseURI.getURI()+'" />'
}
if(C.ie7_compat){
B.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'
}else{
B.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=edge" />'
}
B.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';
for(v=0;
v<B.contentCSS.length;
v++){
B.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+B.contentCSS[v]+'" />'
}
B.contentCSS=[];
b=C.body_id||"tinymce";
if(b.indexOf("=")!=-1){
b=B.getParam("body_id","","hash");
b=b[B.id]||b
}
z=C.body_class||"";
if(z.indexOf("=")!=-1){
z=B.getParam("body_class","","hash");
z=z[B.id]||""
}
B.iframeHTML+='</head><body id="'+b+'" class="mceContentBody '+z+'" onload="window.parent.tinyMCE.get(\''+B.id+"').onLoad.dispatch();\"><br></body></html>";
if(d.relaxedDomain&&(t||(d.isOpera&&parseFloat(opera.version())<11))){
A='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+B.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody();})()'
}
p=u.add(f.iframeContainer,"iframe",{
id:B.id+"_ifr",src:A||'javascript:""',frameBorder:"0",allowTransparency:"true",title:C.aria_label,style:{
width:"100%",height:k,display:"block"}}
);
B.contentAreaContainer=f.iframeContainer;
if(f.editorContainer){
u.get(f.editorContainer).style.display=B.orgDisplay
}
T.style.visibility=B.orgVisibility;
u.get(B.id).style.display="none";
u.setAttrib(B.id,"aria-hidden",true);
if(!d.relaxedDomain||!A){
B.initContentBody()
}
T=p=f=null
}
,initContentBody:function(){
var f=this,g=f.settings,b=u.get(f.id),v=f.getDoc(),p,m,k;
if((!t||!d.relaxedDomain)&&!g.content_editable){
v.open();
v.write(f.iframeHTML);
v.close();
if(d.relaxedDomain){
v.domain=d.relaxedDomain
}}
if(g.content_editable){
u.addClass(b,"mceContentBody");
f.contentDocument=v=g.content_document||document;
f.contentWindow=g.content_window||window;
f.bodyElement=b;
g.content_document=g.content_window=null
}
m=f.getBody();
m.disabled=true;
if(!g.readonly){
m.contentEditable=f.getParam("content_editable_state",true)
}
m.disabled=false;
f.schema=new d.html.Schema(g);
f.dom=new d.dom.DOMUtils(v,{
keep_values:true,url_converter:f.convertURL,url_converter_scope:f,hex_colors:g.force_hex_style_colors,class_filter:g.class_filter,update_styles:true,root_element:g.content_editable?f.id:null,schema:f.schema}
);
f.parser=new d.html.DomParser(g,f.schema);
f.parser.addAttributeFilter("src,href,style",function(q,j){
var z=q.length,O,W=f.dom,A,T;
while(z--){
O=q[z];
A=O.attr(j);
T="data-mce-"+j;
if(!O.attributes.map[T]){
if(j==="style"){
O.attr(T,W.serializeStyle(W.parseStyle(A),O.name))
}else{
O.attr(T,f.convertURL(A,j,O.name))
}}}}
);
f.parser.addNodeFilter("script",function(q,j){
var z=q.length,T;
while(z--){
T=q[z];
T.attr("type","mce-"+(T.attr("type")||"text/javascript"))
}}
);
f.parser.addNodeFilter("#cdata",function(q,j){
var z=q.length,T;
while(z--){
T=q[z];
T.type=8;
T.name="#comment";
T.value="[CDATA["+T.value+"]]"
}}
);
f.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(j,z){
var T=j.length,O,q=f.schema.getNonEmptyElements();
while(T--){
O=j[T];
if(O.isEmpty(q)){
O.empty().append(new d.html.Node("br",1)).shortEnded=true
}}}
);
f.serializer=new d.dom.Serializer(g,f.dom,f.schema);
f.selection=new d.dom.Selection(f.dom,f.getWin(),f.serializer,f);
f.formatter=new d.Formatter(f);
f.undoManager=new d.UndoManager(f);
f.forceBlocks=new d.ForceBlocks(f);
f.enterKey=new d.EnterKey(f);
f.editorCommands=new d.EditorCommands(f);
f.onExecCommand.add(function(q,j){
if(!/^(FontName|FontSize)$/.test(j)){
f.nodeChanged()
}}
);
f.serializer.onPreProcess.add(function(q,j){
return f.onPreProcess.dispatch(f,j,q)
}
);
f.serializer.onPostProcess.add(function(q,j){
return f.onPostProcess.dispatch(f,j,q)
}
);
f.onPreInit.dispatch(f);
if(!g.browser_spellcheck&&!g.gecko_spellcheck){
v.body.spellcheck=false
}
if(!g.readonly){
f.bindNativeEvents()
}
f.controlManager.onPostRender.dispatch(f,f.controlManager);
f.onPostRender.dispatch(f);
f.quirks=d.util.Quirks(f);
if(g.directionality){
m.dir=g.directionality
}
if(g.nowrap){
m.style.whiteSpace="nowrap"
}
if(g.protect){
f.onBeforeSetContent.add(function(q,j){
l(g.protect,function(z){
j.content=j.content.replace(z,function(T){
return"<!--mce:protected "+escape(T)+"-->"
}
)
}
)
}
)
}
f.onSetContent.add(function(){
f.addVisual(f.getBody())
}
);
if(g.padd_empty_editor){
f.onPostProcess.add(function(q,j){
j.content=j.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")
}
)
}
f.load({
initial:true,format:"html"}
);
f.startContent=f.getContent({
format:"raw"}
);
f.initialized=true;
f.onInit.dispatch(f);
f.execCallback("setupcontent_callback",f.id,m,v);
f.execCallback("init_instance_callback",f);
f.focus(true);
f.nodeChanged({
initial:true}
);
if(f.contentStyles.length>0){
k="";
l(f.contentStyles,function(q){
k+=q+"\r\n"
}
);
f.dom.addStyle(k)
}
l(f.contentCSS,function(q){
f.dom.loadCSS(q)
}
);
if(g.auto_focus){
setTimeout(function(){
var q=d.get(g.auto_focus);
q.selection.select(q.getBody(),1);
q.selection.collapse(1);
q.getBody().focus();
q.getWin().focus()
}
,100)
}
b=v=m=null
}
,focus:function(g){
var p,j=this,q=j.selection,b=j.settings.content_editable,f,v,k=j.getDoc(),m;
if(!g){
if(j.lastIERng){
q.setRng(j.lastIERng)
}
f=q.getRng();
if(f.item){
v=f.item(0)
}
j._refreshContentEditable();
if(!b){
j.getWin().focus()
}
if(d.isGecko||b){
m=j.getBody();
if(m.setActive){
m.setActive()
}else{
m.focus()
}
if(b){
q.normalize()
}}
if(v&&v.ownerDocument==k){
f=k.body.createControlRange();
f.addElement(v);
f.select()
}}
if(d.activeEditor!=j){
if((p=d.activeEditor)!=null){
p.onDeactivate.dispatch(p,j)
}
j.onActivate.dispatch(j,p)
}
d._setActive(j)
}
,execCallback:function(b){
var m=this,g=m.settings[b],p;
if(!g){
return
}
if(m.callbackLookup&&(p=m.callbackLookup[b])){
g=p.func;
p=p.scope
}
if(o(g,"string")){
p=g.replace(/\.\w+$/,"");
p=p?d.resolve(p):0;
g=d.resolve(g);
m.callbackLookup=m.callbackLookup||{};
m.callbackLookup[b]={
func:g,scope:p}
}
return g.apply(p||m,Array.prototype.slice.call(arguments,1))
}
,translate:function(m){
var p=this.settings.language||"en",f=d.i18n;
if(!m){
return""
}
return f[p+"."+m]||m.replace(/\{\#([^\}]+)\}/g,function(v,g){
return f[p+"."+g]||"{#"+g+"}"
}
)
}
,getLang:function(f,m){
return d.i18n[(this.settings.language||"en")+"."+f]||(o(m)?m:"{#"+f+"}")
}
,getParam:function(k,p,m){
var g=d.trim,f=o(this.settings[k])?this.settings[k]:p,b;
if(m==="hash"){
b={};
if(o(f,"string")){
l(f.indexOf("=")>0?f.split(/[;,](?![^=;,]*(?:[;,]|$))/):f.split(","),function(q){
q=q.split("=");
if(q.length>1){
b[g(q[0])]=g(q[1])
}else{
b[g(q[0])]=g(q)
}}
)
}else{
b=f
}
return b
}
return f
}
,nodeChanged:function(g){
var m=this,f=m.selection,p;
if(m.initialized){
g=g||{};
p=f.getStart()||m.getBody();
p=t&&p.ownerDocument!=m.getDoc()?m.getBody():p;
g.parents=[];
m.dom.getParent(p,function(b){
if(b.nodeName=="BODY"){
return true
}
g.parents.push(b)
}
);
m.onNodeChange.dispatch(m,g?g.controlManager||m.controlManager:m.controlManager,p,f.isCollapsed(),g)
}}
,addButton:function(f,p){
var m=this;
m.buttons=m.buttons||{};
m.buttons[f]=p
}
,addCommand:function(m,p,f){
this.execCommands[m]={
func:p,scope:f||this}
}
,addQueryStateHandler:function(m,p,f){
this.queryStateCommands[m]={
func:p,scope:f||this}
}
,addQueryValueHandler:function(m,p,f){
this.queryValueCommands[m]={
func:p,scope:f||this}
}
,addShortcut:function(p,b,m,g){
var f=this,v;
if(f.settings.custom_shortcuts===false){
return false
}
f.shortcuts=f.shortcuts||{};
if(o(m,"string")){
v=m;
m=function(){
f.execCommand(v,false,null)
}
}
if(o(m,"object")){
v=m;
m=function(){
f.execCommand(v[0],v[1],v[2])
}
}
l(r(p),function(k){
var q={
func:m,scope:g||this,desc:f.translate(b),alt:false,ctrl:false,shift:false};
l(r(k,"+"),function(j){
switch(j){
case"alt":case"ctrl":case"shift":q[j]=true;
break;
default:q.charCode=j.charCodeAt(0);
q.keyCode=j.toUpperCase().charCodeAt(0)
}}
);
f.shortcuts[(q.ctrl?"ctrl":"")+","+(q.alt?"alt":"")+","+(q.shift?"shift":"")+","+q.keyCode]=q
}
);
return true
}
,execCommand:function(v,b,q,m){
var p=this,g=0,k,f;
if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(v)&&(!m||!m.skip_focus)){
p.focus()
}
m=s({}
,m);
p.onBeforeExecCommand.dispatch(p,v,b,q,m);
if(m.terminate){
return false
}
if(p.execCallback("execcommand_callback",p.id,p.selection.getNode(),v,b,q)){
p.onExecCommand.dispatch(p,v,b,q,m);
return true
}
if(k=p.execCommands[v]){
f=k.func.call(k.scope,b,q);
if(f!==true){
p.onExecCommand.dispatch(p,v,b,q,m);
return f
}}
l(p.plugins,function(j){
if(j.execCommand&&j.execCommand(v,b,q)){
p.onExecCommand.dispatch(p,v,b,q,m);
g=1;
return false
}}
);
if(g){
return true
}
if(p.theme&&p.theme.execCommand&&p.theme.execCommand(v,b,q)){
p.onExecCommand.dispatch(p,v,b,q,m);
return true
}
if(p.editorCommands.execCommand(v,b,q)){
p.onExecCommand.dispatch(p,v,b,q,m);
return true
}
p.getDoc().execCommand(v,b,q);
p.onExecCommand.dispatch(p,v,b,q,m)
}
,queryCommandState:function(g){
var f=this,b,p;
if(f._isHidden()){
return
}
if(b=f.queryStateCommands[g]){
p=b.func.call(b.scope);
if(p!==true){
return p
}}
b=f.editorCommands.queryCommandState(g);
if(b!==-1){
return b
}
try{
return this.getDoc().queryCommandState(g)
}
catch(m){}}
,queryCommandValue:function(b){
var f=this,g,p;
if(f._isHidden()){
return
}
if(g=f.queryValueCommands[b]){
p=g.func.call(g.scope);
if(p!==true){
return p
}}
g=f.editorCommands.queryCommandValue(b);
if(o(g)){
return g
}
try{
return this.getDoc().queryCommandValue(b)
}
catch(m){}}
,show:function(){
var m=this;
u.show(m.getContainer());
u.hide(m.id);
m.load()
}
,hide:function(){
var m=this,f=m.getDoc();
if(t&&f){
f.execCommand("SelectAll")
}
m.save();
u.hide(m.getContainer());
u.setStyle(m.id,"display",m.orgDisplay)
}
,isHidden:function(){
return !u.isHidden(this.id)
}
,setProgressState:function(m,f,p){
this.onSetProgressState.dispatch(this,m,f,p);
return m
}
,load:function(g){
var m=this,p=m.getElement(),f;
if(p){
g=g||{};
g.load=true;
f=m.setContent(o(p.value)?p.value:p.innerHTML,g);
g.element=p;
if(!g.no_events){
m.onLoadContent.dispatch(m,g)
}
g.element=p=null;
return f
}}
,save:function(v){
var m=this,b=m.getElement(),p,g;
if(!b||!m.initialized){
return
}
v=v||{};
v.save=true;
v.element=b;
p=v.content=m.getContent(v);
if(!v.no_events){
m.onSaveContent.dispatch(m,v)
}
p=v.content;
if(!/TEXTAREA|INPUT/i.test(b.nodeName)){
b.innerHTML=p;
if(g=u.getParent(m.id,"form")){
l(g.elements,function(f){
if(f.name==m.id){
f.value=p;
return false
}}
)
}}else{
b.value=p
}
v.element=b=null;
return p
}
,setContent:function(v,g){
var p=this,f,m=p.getBody(),b;
g=g||{};
g.format=g.format||"html";
g.set=true;
g.content=v;
if(!g.no_events){
p.onBeforeSetContent.dispatch(p,g)
}
v=g.content;
if(!d.isIE&&(v.length===0||/^\s+$/.test(v))){
b=p.settings.forced_root_block;
if(b){
v="<"+b+'><br data-mce-bogus="1"></'+b+">"
}else{
v='<br data-mce-bogus="1">'
}
m.innerHTML=v;
p.selection.select(m,true);
p.selection.collapse(true);
return
}
if(g.format!=="raw"){
v=new d.html.Serializer({}
,p.schema).serialize(p.parser.parse(v))
}
g.content=d.trim(v);
p.dom.setHTML(m,g.content);
if(!g.no_events){
p.onSetContent.dispatch(p,g)
}
if(!p.settings.content_editable||document.activeElement===p.getBody()){
p.selection.normalize()
}
return g.content
}
,getContent:function(f){
var m=this,p;
f=f||{};
f.format=f.format||"html";
f.get=true;
f.getInner=true;
if(!f.no_events){
m.onBeforeGetContent.dispatch(m,f)
}
if(f.format=="raw"){
p=m.getBody().innerHTML
}else{
p=m.serializer.serialize(m.getBody(),f)
}
f.content=d.trim(p);
if(!f.no_events){
m.onGetContent.dispatch(m,f)
}
return f.content
}
,isDirty:function(){
var m=this;
return d.trim(m.startContent)!=d.trim(m.getContent({
format:"raw",no_events:1}
))&&!m.isNotDirty
}
,getContainer:function(){
var m=this;
if(!m.container){
m.container=u.get(m.editorContainer||m.id+"_parent")
}
return m.container
}
,getContentAreaContainer:function(){
return this.contentAreaContainer
}
,getElement:function(){
return u.get(this.settings.content_element||this.id)
}
,getWin:function(){
var m=this,f;
if(!m.contentWindow){
f=u.get(m.id+"_ifr");
if(f){
m.contentWindow=f.contentWindow
}}
return m.contentWindow
}
,getDoc:function(){
var m=this,f;
if(!m.contentDocument){
f=m.getWin();
if(f){
m.contentDocument=f.document
}}
return m.contentDocument
}
,getBody:function(){
return this.bodyElement||this.getDoc().body
}
,convertURL:function(p,f,b){
var m=this,g=m.settings;
if(g.urlconverter_callback){
return m.execCallback("urlconverter_callback",p,b,true,f)
}
if(!g.convert_urls||(b&&b.nodeName=="LINK")||p.indexOf("file:")===0){
return p
}
if(g.relative_urls){
return m.documentBaseURI.toRelative(p)
}
p=m.documentBaseURI.toAbsolute(p,g.remove_script_host);
return p
}
,addVisual:function(b){
var f=this,p=f.settings,g=f.dom,m;
b=b||f.getBody();
if(!o(f.hasVisual)){
f.hasVisual=p.visual
}
l(g.select("table,a",b),function(k){
var v;
switch(k.nodeName){
case"TABLE":m=p.visual_table_class||"mceItemTable";
v=g.getAttrib(k,"border");
if(!v||v=="0"){
if(f.hasVisual){
g.addClass(k,m)
}else{
g.removeClass(k,m)
}}
return;
case"A":if(!g.getAttrib(k,"href",false)){
v=g.getAttrib(k,"name")||k.id;
m="mceItemAnchor";
if(v){
if(f.hasVisual){
g.addClass(k,m)
}else{
g.removeClass(k,m)
}}}
return
}}
);
f.onVisualAid.dispatch(f,b,f.hasVisual)
}
,remove:function(){
var m=this,f=m.getContainer();
if(!m.removed){
m.removed=1;
m.hide();
if(!m.settings.content_editable){
c.unbind(m.getWin());
c.unbind(m.getDoc())
}
c.unbind(m.getBody());
c.clear(f);
m.execCallback("remove_instance_callback",m);
m.onRemove.dispatch(m);
m.onExecCommand.listeners=[];
d.remove(m);
u.remove(f)
}}
,destroy:function(f){
var m=this;
if(m.destroyed){
return
}
if(e){
c.unbind(m.getDoc());
c.unbind(m.getWin());
c.unbind(m.getBody())
}
if(!f){
d.removeUnload(m.destroy);
tinyMCE.onBeforeUnload.remove(m._beforeUnload);
if(m.theme&&m.theme.destroy){
m.theme.destroy()
}
m.controlManager.destroy();
m.selection.destroy();
m.dom.destroy()
}
if(m.formElement){
m.formElement.submit=m.formElement._mceOldSubmit;
m.formElement._mceOldSubmit=null
}
m.contentAreaContainer=m.formElement=m.container=m.settings.content_element=m.bodyElement=m.contentDocument=m.contentWindow=null;
if(m.selection){
m.selection=m.selection.win=m.selection.dom=m.selection.dom.doc=null
}
m.destroyed=1
}
,_refreshContentEditable:function(){
var f=this,m,p;
if(f._isHidden()){
m=f.getBody();
p=m.parentNode;
p.removeChild(m);
p.appendChild(m);
m.focus()
}}
,_isHidden:function(){
var m;
if(!e){
return 0
}
m=this.selection.getSel();
return(!m||!m.rangeCount||m.rangeCount===0)
}}
)
}
)(tinymce);
(function(e){
var t=e.each;
e.Editor.prototype.setupEvents=function(){
var a=this,o=a.settings;
t(["onPreInit","onBeforeRenderUI","onPostRender","onLoad","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp","onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent","onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState","onSetAttrib"],function(n){
a[n]=new e.util.Dispatcher(a)
}
);
if(o.cleanup_callback){
a.onBeforeSetContent.add(function(n,s){
s.content=n.execCallback("cleanup_callback","insert_to_editor",s.content,s)
}
);
a.onPreProcess.add(function(n,s){
if(s.set){
n.execCallback("cleanup_callback","insert_to_editor_dom",s.node,s)
}
if(s.get){
n.execCallback("cleanup_callback","get_from_editor_dom",s.node,s)
}}
);
a.onPostProcess.add(function(n,s){
if(s.set){
s.content=n.execCallback("cleanup_callback","insert_to_editor",s.content,s)
}
if(s.get){
s.content=n.execCallback("cleanup_callback","get_from_editor",s.content,s)
}}
)
}
if(o.save_callback){
a.onGetContent.add(function(n,s){
if(s.save){
s.content=n.execCallback("save_callback",n.id,s.content,n.getBody())
}}
)
}
if(o.handle_event_callback){
a.onEvent.add(function(n,s,r){
if(a.execCallback("handle_event_callback",s,n,r)===false){
s.preventDefault();
s.stopPropagation()
}}
)
}
if(o.handle_node_change_callback){
a.onNodeChange.add(function(r,s,h){
r.execCallback("handle_node_change_callback",r.id,h,-1,-1,true,r.selection.isCollapsed())
}
)
}
if(o.save_callback){
a.onSaveContent.add(function(n,r){
var s=n.execCallback("save_callback",n.id,r.content,n.getBody());
if(s){
r.content=s
}}
)
}
if(o.onchange_callback){
a.onChange.add(function(s,n){
s.execCallback("onchange_callback",s,n)
}
)
}};
e.Editor.prototype.bindNativeEvents=function(){
var d=this,s,o=d.settings,n=d.dom,h;
h={
mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};
function a(u,m){
var f=u.type;
if(d.removed){
return
}
if(d.onEvent.dispatch(d,u,m)!==false){
d[h[u.fakeType||u.type]].dispatch(d,u,m)
}}
function l(u){
d.focus(true)
}
function c(u,m){
if(m.keyCode!=65||!e.VK.metaKeyPressed(m)){
d.selection.normalize()
}
d.nodeChanged()
}
t(h,function(m,f){
var u=o.content_editable?d.getBody():d.getDoc();
switch(f){
case"contextmenu":n.bind(u,f,a);
break;
case"paste":n.bind(d.getBody(),f,a);
break;
case"submit":case"reset":n.bind(d.getElement().form||e.DOM.getParent(d.id,"form"),f,a);
break;
default:n.bind(u,f,a)
}}
);
n.bind(o.content_editable?d.getBody():(e.isGecko?d.getDoc():d.getWin()),"focus",function(u){
d.focus(true)
}
);
if(o.content_editable&&e.isOpera){
n.bind(d.getBody(),"click",l);
n.bind(d.getBody(),"keydown",l)
}
d.onMouseUp.add(c);
d.onKeyUp.add(function(u,f){
var m=f.keyCode;
if((m>=33&&m<=36)||(m>=37&&m<=40)||m==13||m==45||m==46||m==8||(e.isMac&&(m==91||m==93))||f.ctrlKey){
c(u,f)
}}
);
d.onReset.add(function(){
d.setContent(d.startContent,{
format:"raw"}
)
}
);
function r(m,u){
if(m.altKey||m.ctrlKey||m.metaKey){
t(d.shortcuts,function(f){
var p=e.isMac?m.metaKey:m.ctrlKey;
if(f.ctrl!=p||f.alt!=m.altKey||f.shift!=m.shiftKey){
return
}
if(m.keyCode==f.keyCode||(m.charCode&&m.charCode==f.charCode)){
m.preventDefault();
if(u){
f.func.call(f.scope)
}
return true
}}
)
}}
d.onKeyUp.add(function(u,m){
r(m)
}
);
d.onKeyPress.add(function(u,m){
r(m)
}
);
d.onKeyDown.add(function(u,m){
r(m,true)
}
);
if(e.isOpera){
d.onClick.add(function(u,m){
m.preventDefault()
}
)
}}
}
)(tinymce);
(function(o){
var n=o.each,t,e=true,a=false;
o.EditorCommands=function(f){
var m=f.dom,g=f.selection,c={
state:{}
,exec:{}
,value:{}}
,d=f.settings,b=f.formatter,p;
function v(A,O,T){
var z;
A=A.toLowerCase();
if(z=c.exec[A]){
z(A,O,T);
return e
}
return a
}
function u(T){
var z;
T=T.toLowerCase();
if(z=c.state[T]){
return z(T)
}
return -1
}
function h(T){
var z;
T=T.toLowerCase();
if(z=c.value[T]){
return z(T)
}
return a
}
function j(z,T){
T=T||"exec";
n(z,function(A,O){
n(O.toLowerCase().split(","),function(W){
c[T][W]=A
}
)
}
)
}
o.extend(this,{
execCommand:v,queryCommandState:u,queryCommandValue:h,addCommands:j}
);
function s(O,T,z){
if(T===t){
T=a
}
if(z===t){
z=null
}
return f.getDoc().execCommand(O,T,z)
}
function q(z){
return b.match(z)
}
function k(z,T){
b.toggle(z,T?{
value:T}
:t)
}
function l(z){
p=g.getBookmark(z)
}
function r(){
g.moveToBookmark(p)
}
j({
"mceResetDesignMode,mceBeginUndoLevel":function(){}
,"mceEndUndoLevel,mceAddUndoLevel":function(){
f.undoManager.add()
}
,"Cut,Copy,Paste":function(A){
var O=f.getDoc(),z;
try{
s(A)
}
catch(T){
z=e
}
if(z||!O.queryCommandSupported(A)){
if(o.isGecko){
f.windowManager.confirm(f.getLang("clipboard_msg"),function(W){
if(W){
open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")
}}
)
}else{
f.windowManager.alert(f.getLang("clipboard_no_support"))
}}}
,unlink:function(z){
if(g.isCollapsed()){
g.select(g.getNode())
}
s(z);
g.collapse(a)
}
,"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(z){
var T=z.substring(7);
n("left,center,right,full".split(","),function(O){
if(T!=O){
b.remove("align"+O)
}}
);
k("align"+T);
v("mceRepaint")
}
,"InsertUnorderedList,InsertOrderedList":function(O){
var z,T;
s(O);
z=m.getParent(g.getNode(),"ol,ul");
if(z){
T=z.parentNode;
if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(T.nodeName)){
l();
m.split(T,z);
r()
}}}
,"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(z){
k(z)
}
,"ForeColor,HiliteColor,FontName":function(O,T,z){
k(O,z)
}
,FontSize:function(A,O,T){
var z,W;
if(T>=1&&T<=7){
W=o.explode(d.font_size_style_values);
z=o.explode(d.font_size_classes);
if(z){
T=z[T-1]||T
}else{
T=W[T-1]||T
}}
k(A,T)
}
,RemoveFormat:function(z){
b.remove(z)
}
,mceBlockQuote:function(z){
k("blockquote")
}
,FormatBlock:function(O,T,z){
return k(z||"p")
}
,mceCleanup:function(){
var z=g.getBookmark();
f.setContent(f.getContent({
cleanup:e}
),{
cleanup:e}
);
g.moveToBookmark(z)
}
,mceRemoveNode:function(A,O,T){
var z=T||g.getNode();
if(z!=f.getBody()){
l();
f.dom.remove(z,e);
r()
}}
,mceSelectNodeDepth:function(A,O,T){
var z=0;
m.getParent(g.getNode(),function(W){
if(W.nodeType==1&&z++==T){
g.select(W);
return a
}}
,f.getBody())
}
,mceSelectNode:function(O,T,z){
g.select(z)
}
,mceInsertContent:function(B,H,Y){
var O,I,S,A,F,M,D,C,E,T,W,G,z,R;
O=f.parser;
I=new o.html.Serializer({}
,f.schema);
z='<span id="mce_marker" data-mce-type="bookmark">\uFEFF</span>';
M={
content:Y,format:"html"};
g.onBeforeSetContent.dispatch(g,M);
Y=M.content;
if(Y.indexOf("{$caret}")==-1){
Y+="{$caret}"
}
Y=Y.replace(/\{\$caret\}/,z);
if(!g.isCollapsed()){
f.getDoc().execCommand("Delete",false,null)
}
S=g.getNode();
M={
context:S.nodeName.toLowerCase()};
F=O.parse(Y,M);
W=F.lastChild;
if(W.attr("id")=="mce_marker"){
D=W;
for(W=W.prev;
W;
W=W.walk(true)){
if(W.type==3||!m.isBlock(W.name)){
W.parent.insert(D,W,W.name==="br");
break
}}}
if(!M.invalid){
Y=I.serialize(F);
W=S.firstChild;
G=S.lastChild;
if(!W||(W===G&&W.nodeName==="BR")){
m.setHTML(S,Y)
}else{
g.setContent(Y)
}}else{
g.setContent(z);
S=f.selection.getNode();
A=f.getBody();
if(S.nodeType==9){
S=W=A
}else{
W=S
}
while(W!==A){
S=W;
W=W.parentNode
}
Y=S==A?A.innerHTML:m.getOuterHTML(S);
Y=I.serialize(O.parse(Y.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){
return I.serialize(F)
}
)));
if(S==A){
m.setHTML(A,Y)
}else{
m.setOuterHTML(S,Y)
}}
D=m.get("mce_marker");
C=m.getRect(D);
E=m.getViewPort(f.getWin());
if((C.y+C.h>E.y+E.h||C.y<E.y)||(C.x>E.x+E.w||C.x<E.x)){
R=o.isIE?f.getDoc().documentElement:f.getBody();
R.scrollLeft=C.x;
R.scrollTop=C.y-E.h+25
}
T=m.createRng();
W=D.previousSibling;
if(W&&W.nodeType==3){
T.setStart(W,W.nodeValue.length)
}else{
T.setStartBefore(D);
T.setEndBefore(D)
}
m.remove(D);
g.setRng(T);
g.onSetContent.dispatch(g,M);
f.addVisual()
}
,mceInsertRawHTML:function(O,T,z){
g.setContent("tiny_mce_marker");
f.setContent(f.getContent().replace(/tiny_mce_marker/g,function(){
return z
}
))
}
,mceToggleFormat:function(O,T,z){
k(z)
}
,mceSetContent:function(O,T,z){
f.setContent(z)
}
,"Indent,Outdent":function(A){
var T,z,O;
T=d.indentation;
z=/[a-z%]+$/i.exec(T);
T=parseInt(T);
if(!u("InsertUnorderedList")&&!u("InsertOrderedList")){
if(!d.forced_root_block&&!m.getParent(g.getNode(),m.isBlock)){
b.apply("div")
}
n(g.getSelectedBlocks(),function(W){
if(A=="outdent"){
O=Math.max(0,parseInt(W.style.paddingLeft||0)-T);
m.setStyle(W,"paddingLeft",O?O+z:"")
}else{
m.setStyle(W,"paddingLeft",(parseInt(W.style.paddingLeft||0)+T)+z)
}}
)
}else{
s(A)
}}
,mceRepaint:function(){
var T;
if(o.isGecko){
try{
l(e);
if(g.getSel()){
g.getSel().selectAllChildren(f.getBody())
}
g.collapse(e);
r()
}
catch(z){}}}
,mceToggleFormat:function(O,T,z){
b.toggle(z)
}
,InsertHorizontalRule:function(){
f.execCommand("mceInsertContent",false,"<hr />")
}
,mceToggleVisualAid:function(){
f.hasVisual=!f.hasVisual;
f.addVisual()
}
,mceReplaceContent:function(O,T,z){
f.execCommand("mceInsertContent",false,z.replace(/\{\$selection\}/g,g.getContent({
format:"text"}
)))
}
,mceInsertLink:function(A,O,T){
var z;
if(typeof(T)=="string"){
T={
href:T}
}
z=m.getParent(g.getNode(),"a");
T.href=T.href.replace(" ","%20");
if(!z||!T.href){
b.remove("link")
}
if(T.href){
b.apply("link",T,z)
}}
,selectAll:function(){
var T=m.getRoot(),z=m.createRng();
z.setStart(T,0);
z.setEnd(T,T.childNodes.length);
f.selection.setRng(z)
}}
);
j({
"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(A){
var T="align"+A.substring(7);
var z=g.isCollapsed()?[m.getParent(g.getNode(),m.isBlock)]:g.getSelectedBlocks();
var O=o.map(z,function(W){
return !!b.matchNode(W,T)
}
);
return o.inArray(O,e)!==-1
}
,"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(z){
return q(z)
}
,mceBlockQuote:function(){
return q("blockquote")
}
,Outdent:function(){
var z;
if(d.inline_styles){
if((z=m.getParent(g.getStart(),m.isBlock))&&parseInt(z.style.paddingLeft)>0){
return e
}
if((z=m.getParent(g.getEnd(),m.isBlock))&&parseInt(z.style.paddingLeft)>0){
return e
}}
return u("InsertUnorderedList")||u("InsertOrderedList")||(!d.inline_styles&&!!m.getParent(g.getNode(),"BLOCKQUOTE"))
}
,"InsertUnorderedList,InsertOrderedList":function(z){
return m.getParent(g.getNode(),z=="insertunorderedlist"?"UL":"OL")
}}
,"state");
j({
"FontSize,FontName":function(O){
var T=0,z;
if(z=m.getParent(g.getNode(),"span")){
if(O=="fontsize"){
T=z.style.fontSize
}else{
T=z.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()
}}
return T
}}
,"value");
j({
Undo:function(){
f.undoManager.undo()
}
,Redo:function(){
f.undoManager.redo()
}}
)
}
}
)(tinymce);
(function(t){
var e=t.util.Dispatcher;
t.UndoManager=function(h){
var u,l=0,n=[],r,d,c,s;
function a(){
return t.trim(h.getContent({
format:"raw",no_events:1}
).replace(/<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\/span>/g,""))
}
function o(){
u.typing=false;
u.add()
}
onBeforeAdd=new e(u);
d=new e(u);
c=new e(u);
s=new e(u);
d.add(function(m,f){
if(m.hasUndo()){
return h.onChange.dispatch(h,f,m)
}}
);
c.add(function(m,f){
return h.onUndo.dispatch(h,f,m)
}
);
s.add(function(m,f){
return h.onRedo.dispatch(h,f,m)
}
);
h.onInit.add(function(){
u.add()
}
);
h.onBeforeExecCommand.add(function(m,g,p,b,f){
if(g!="Undo"&&g!="Redo"&&g!="mceRepaint"&&(!f||!f.skip_undo)){
u.beforeChange()
}}
);
h.onExecCommand.add(function(m,g,p,b,f){
if(g!="Undo"&&g!="Redo"&&g!="mceRepaint"&&(!f||!f.skip_undo)){
u.add()
}}
);
h.onSaveContent.add(o);
h.dom.bind(h.dom.getRoot(),"dragend",o);
h.dom.bind(h.getDoc(),t.isGecko?"blur":"focusout",function(m){
if(!h.removed&&u.typing){
o()
}}
);
h.onKeyUp.add(function(m,p){
var f=p.keyCode;
if((f>=33&&f<=36)||(f>=37&&f<=40)||f==45||f==13||p.ctrlKey){
o()
}}
);
h.onKeyDown.add(function(m,p){
var f=p.keyCode;
if((f>=33&&f<=36)||(f>=37&&f<=40)||f==45){
if(u.typing){
o()
}
return
}
if((f<16||f>20)&&f!=224&&f!=91&&!u.typing){
u.beforeChange();
u.typing=true;
u.add()
}}
);
h.onMouseDown.add(function(m,f){
if(u.typing){
o()
}}
);
h.addShortcut("ctrl+z","undo_desc","Undo");
h.addShortcut("ctrl+y","redo_desc","Redo");
u={
data:n,typing:false,onBeforeAdd:onBeforeAdd,onAdd:d,onUndo:c,onRedo:s,beforeChange:function(){
r=h.selection.getBookmark(2,true)
}
,add:function(g){
var m,f=h.settings,p;
g=g||{};
g.content=a();
u.onBeforeAdd.dispatch(u,g);
p=n[l];
if(p&&p.content==g.content){
return null
}
if(n[l]){
n[l].beforeBookmark=r
}
if(f.custom_undo_redo_levels){
if(n.length>f.custom_undo_redo_levels){
for(m=0;
m<n.length-1;
m++){
n[m]=n[m+1]
}
n.length--;
l=n.length
}}
g.bookmark=h.selection.getBookmark(2,true);
if(l<n.length-1){
n.length=l+1
}
n.push(g);
l=n.length-1;
u.onAdd.dispatch(u,g);
h.isNotDirty=0;
return g
}
,undo:function(){
var f,m;
if(u.typing){
u.add();
u.typing=false
}
if(l>0){
f=n[--l];
h.setContent(f.content,{
format:"raw"}
);
h.selection.moveToBookmark(f.beforeBookmark);
u.onUndo.dispatch(u,f)
}
return f
}
,redo:function(){
var m;
if(l<n.length-1){
m=n[++l];
h.setContent(m.content,{
format:"raw"}
);
h.selection.moveToBookmark(m.bookmark);
u.onRedo.dispatch(u,m)
}
return m
}
,clear:function(){
n=[];
l=0;
u.typing=false
}
,hasUndo:function(){
return l>0||this.typing
}
,hasRedo:function(){
return l<n.length-1&&!this.typing
}};
return u
}
}
)(tinymce);
tinymce.ForceBlocks=function(a){
var t=a.settings,n=a.dom,e=a.selection,o=a.schema.getBlockElements();
function s(){
var c=e.getStart(),h=a.getBody(),r,d,p,k,b,l,u,m=-16777215,g,v;
if(!c||c.nodeType!==1||!t.forced_root_block){
return
}
while(c&&c!=h){
if(o[c.nodeName]){
return
}
c=c.parentNode
}
r=e.getRng();
if(r.setStart){
d=r.startContainer;
p=r.startOffset;
k=r.endContainer;
b=r.endOffset
}else{
if(r.item){
c=r.item(0);
r=a.getDoc().body.createTextRange();
r.moveToElementText(c)
}
v=r.parentElement().ownerDocument===a.getDoc();
tmpRng=r.duplicate();
tmpRng.collapse(true);
p=tmpRng.move("character",m)*-1;
if(!tmpRng.collapsed){
tmpRng=r.duplicate();
tmpRng.collapse(false);
b=(tmpRng.move("character",m)*-1)-p
}}
c=h.firstChild;
while(c){
if(c.nodeType===3||(c.nodeType==1&&!o[c.nodeName])){
if(!l){
l=n.create(t.forced_root_block);
c.parentNode.insertBefore(l,c);
g=true
}
u=c;
c=c.nextSibling;
l.appendChild(u)
}else{
l=null;
c=c.nextSibling
}}
if(g){
if(r.setStart){
r.setStart(d,p);
r.setEnd(k,b);
e.setRng(r)
}else{
if(v){
try{
r=a.getDoc().body.createTextRange();
r.moveToElementText(h);
r.collapse(true);
r.moveStart("character",p);
if(b>0){
r.moveEnd("character",b)
}
r.select()
}
catch(f){}}}
a.nodeChanged()
}}
if(t.forced_root_block){
a.onKeyUp.add(s);
a.onNodeChange.add(s)
}};
(function(a){
var t=a.DOM,e=a.dom.Event,o=a.each,n=a.extend;
a.create("tinymce.ControlManager",{
ControlManager:function(r,c){
var l=this,h;
c=c||{};
l.editor=r;
l.controls={};
l.onAdd=new a.util.Dispatcher(l);
l.onPostRender=new a.util.Dispatcher(l);
l.prefix=c.prefix||r.id+"_";
l._cls={};
l.onPostRender.add(function(){
o(l.controls,function(s){
s.postRender()
}
)
}
)
}
,get:function(s){
return this.controls[this.prefix+s]||this.controls[s]
}
,setActive:function(l,r){
var h=null;
if(h=this.get(l)){
h.setActive(r)
}
return h
}
,setDisabled:function(l,r){
var h=null;
if(h=this.get(l)){
h.setDisabled(r)
}
return h
}
,add:function(r){
var s=this;
if(r){
s.controls[r.id]=r;
s.onAdd.dispatch(r,s)
}
return r
}
,createControl:function(c){
var f,d,r,h=this,u=h.editor,m,s;
if(!h.controlFactories){
h.controlFactories=[];
o(u.plugins,function(l){
if(l.createControl){
h.controlFactories.push(l)
}}
)
}
m=h.controlFactories;
for(d=0,r=m.length;
d<r;
d++){
f=m[d].createControl(c,h);
if(f){
return h.add(f)
}}
if(c==="|"||c==="separator"){
return h.createSeparator()
}
if(u.buttons&&(f=u.buttons[c])){
return h.createButton(c,f)
}
return h.add(f)
}
,createDropMenu:function(r,g,l){
var p=this,d=p.editor,u,h,m,f;
g=n({
"class":"mceDropDown",constrain:d.settings.constrain_menus}
,g);
g["class"]=g["class"]+" "+d.getParam("skin")+"Skin";
if(m=d.getParam("skin_variant")){
g["class"]+=" "+d.getParam("skin")+"Skin"+m.substring(0,1).toUpperCase()+m.substring(1)
}
g["class"]+=d.settings.directionality=="rtl"?" mceRtl":"";
r=p.prefix+r;
f=l||p._cls.dropmenu||a.ui.DropMenu;
u=p.controls[r]=new f(r,g);
u.onAddItem.add(function(k,v){
var b=v.settings;
b.title=d.getLang(b.title,b.title);
if(!b.onclick){
b.onclick=function(s){
if(b.cmd){
d.execCommand(b.cmd,b.ui||false,b.value)
}}
}}
);
d.onRemove.add(function(){
u.destroy()
}
);
if(a.isIE){
u.onShowMenu.add(function(){
d.focus();
h=d.selection.getBookmark(1)
}
);
u.onHideMenu.add(function(){
if(h){
d.selection.moveToBookmark(h);
h=0
}}
)
}
return p.add(u)
}
,createListBox:function(r,g,l){
var f=this,u=f.editor,d,m,p;
if(f.get(r)){
return null
}
g.title=u.translate(g.title);
g.scope=g.scope||u;
if(!g.onselect){
g.onselect=function(s){
u.execCommand(g.cmd,g.ui||false,s||g.value)
}
}
g=n({
title:g.title,"class":"mce_"+r,scope:g.scope,control_manager:f}
,g);
r=f.prefix+r;
function h(s){
return s.settings.use_accessible_selects&&!a.isGecko
}
if(u.settings.use_native_selects||h(u)){
m=new a.ui.NativeListBox(r,g)
}else{
p=l||f._cls.listbox||a.ui.ListBox;
m=new p(r,g,u)
}
f.controls[r]=m;
if(a.isWebKit){
m.onPostRender.add(function(b,s){
e.add(s,"mousedown",function(){
u.bookmark=u.selection.getBookmark(1)
}
);
e.add(s,"focus",function(){
u.selection.moveToBookmark(u.bookmark);
u.bookmark=null
}
)
}
)
}
if(m.hideMenu){
u.onMouseDown.add(m.hideMenu,m)
}
return f.add(m)
}
,createButton:function(p,d,f){
var l=this,h=l.editor,u,m,r;
if(l.get(p)){
return null
}
d.title=h.translate(d.title);
d.label=h.translate(d.label);
d.scope=d.scope||h;
if(!d.onclick&&!d.menu_button){
d.onclick=function(){
h.execCommand(d.cmd,d.ui||false,d.value)
}
}
d=n({
title:d.title,"class":"mce_"+p,unavailable_prefix:h.getLang("unavailable",""),scope:d.scope,control_manager:l}
,d);
p=l.prefix+p;
if(d.menu_button){
r=f||l._cls.menubutton||a.ui.MenuButton;
m=new r(p,d,h);
h.onMouseDown.add(m.hideMenu,m)
}else{
r=l._cls.button||a.ui.Button;
m=new r(p,d,h)
}
return l.add(m)
}
,createMenuButton:function(l,r,h){
r=r||{};
r.menu_button=1;
return this.createButton(l,r,h)
}
,createSplitButton:function(p,d,f){
var l=this,h=l.editor,u,m,r;
if(l.get(p)){
return null
}
d.title=h.translate(d.title);
d.scope=d.scope||h;
if(!d.onclick){
d.onclick=function(s){
h.execCommand(d.cmd,d.ui||false,s||d.value)
}
}
if(!d.onselect){
d.onselect=function(s){
h.execCommand(d.cmd,d.ui||false,s||d.value)
}
}
d=n({
title:d.title,"class":"mce_"+p,scope:d.scope,control_manager:l}
,d);
p=l.prefix+p;
r=f||l._cls.splitbutton||a.ui.SplitButton;
m=l.add(new r(p,d,h));
h.onMouseDown.add(m.hideMenu,m);
return m
}
,createColorSplitButton:function(r,g,l){
var f=this,u=f.editor,d,m,p,h;
if(f.get(r)){
return null
}
g.title=u.translate(g.title);
g.scope=g.scope||u;
if(!g.onclick){
g.onclick=function(s){
if(a.isIE){
h=u.selection.getBookmark(1)
}
u.execCommand(g.cmd,g.ui||false,s||g.value)
}
}
if(!g.onselect){
g.onselect=function(s){
u.execCommand(g.cmd,g.ui||false,s||g.value)
}
}
g=n({
title:g.title,"class":"mce_"+r,menu_class:u.getParam("skin")+"Skin",scope:g.scope,more_colors_title:u.getLang("more_colors")}
,g);
r=f.prefix+r;
p=l||f._cls.colorsplitbutton||a.ui.ColorSplitButton;
m=new p(r,g,u);
u.onMouseDown.add(m.hideMenu,m);
u.onRemove.add(function(){
m.destroy()
}
);
if(a.isIE){
m.onShowMenu.add(function(){
u.focus();
h=u.selection.getBookmark(1)
}
);
m.onHideMenu.add(function(){
if(h){
u.selection.moveToBookmark(h);
h=0
}}
)
}
return f.add(m)
}
,createToolbar:function(m,l,u){
var d,h=this,r;
m=h.prefix+m;
r=u||h._cls.toolbar||a.ui.Toolbar;
d=new r(m,l,h.editor);
if(h.get(m)){
return null
}
return h.add(d)
}
,createToolbarGroup:function(m,l,u){
var d,h=this,r;
m=h.prefix+m;
r=u||this._cls.toolbarGroup||a.ui.ToolbarGroup;
d=new r(m,l,h.editor);
if(h.get(m)){
return null
}
return h.add(d)
}
,createSeparator:function(r){
var s=r||this._cls.separator||a.ui.Separator;
return new s()
}
,setControlType:function(r,s){
return this._cls[r.toLowerCase()]=s
}
,destroy:function(){
o(this.controls,function(s){
s.destroy()
}
);
this.controls=null
}}
)
}
)(tinymce);
(function(o){
var e=o.util.Dispatcher,n=o.each,a=o.isIE,t=o.isOpera;
o.create("tinymce.WindowManager",{
WindowManager:function(s){
var r=this;
r.editor=s;
r.onOpen=new e(r);
r.onClose=new e(r);
r.params={};
r.features={}
}
,open:function(z,h){
var j=this,d="",b,g,l=j.editor.settings.dialog_type=="modal",k,v,c,r=o.DOM.getViewPort(),q;
z=z||{};
h=h||{};
v=t?r.w:screen.width;
c=t?r.h:screen.height;
z.name=z.name||"mc_"+new Date().getTime();
z.width=parseInt(z.width||320);
z.height=parseInt(z.height||240);
z.resizable=true;
z.left=z.left||parseInt(v/2)-(z.width/2);
z.top=z.top||parseInt(c/2)-(z.height/2);
h.inline=false;
h.mce_width=z.width;
h.mce_height=z.height;
h.mce_auto_focus=z.auto_focus;
if(l){
if(a){
z.center=true;
z.help=false;
z.dialogWidth=z.width+"px";
z.dialogHeight=z.height+"px";
z.scroll=z.scrollbars||false
}}
n(z,function(u,s){
if(o.is(u,"boolean")){
u=u?"yes":"no"
}
if(!/^(name|url)$/.test(s)){
if(a&&l){
d+=(d?";":"")+s+":"+u
}else{
d+=(d?",":"")+s+"="+u
}}}
);
j.features=z;
j.params=h;
j.onOpen.dispatch(j,z,h);
q=z.url||z.file;
q=o._addVer(q);
try{
if(a&&l){
k=1;
window.showModalDialog(q,window,d)
}else{
k=window.open(q,z.name,d)
}}
catch(m){}
if(!k){
alert(j.editor.getLang("popup_blocked"))
}}
,close:function(s){
s.close();
this.onClose.dispatch(this)
}
,createInstance:function(h,r,s,p,m,u){
var l=o.resolve(h);
return new l(r,s,p,m,u)
}
,confirm:function(l,r,c,h){
h=h||window;
r.call(c||this,h.confirm(this._decode(this.editor.getLang(l,l))))
}
,alert:function(l,r,d,h){
var c=this;
h=h||window;
h.alert(c._decode(c.editor.getLang(l,l)));
if(r){
r.call(d||c)
}}
,resizeBy:function(s,r,h){
h.resizeBy(s,r)
}
,_decode:function(r){
return o.DOM.decode(r).replace(/\\n/g,"\n")
}}
)
}
(tinymce));
(function(e){
e.Formatter=function(_i){
var U={}
,Q=e.each,a=_i.dom,v=_i.selection,q=e.dom.TreeWalker,L=new e.dom.RangeUtils(a),o=_i.schema.isValidChild,R=a.isBlock,m=_i.settings.forced_root_block,k=a.nodeIndex,M=e.isGecko?"\u200B":"\uFEFF",n=/^(src|href|style)$/,_e=false,C=true,P,D,T=a.getContentEditable;
function W(_o){
return _o instanceof Array
}
function f(_n,_o){
return a.getParents(_n,_o,a.getRoot())
}
function t(_o){
return _o.nodeType===1&&_o.id==="_mce_caret"
}
function c(){
u({
alignleft:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{
textAlign:"left"}
,defaultBlock:"div"}
,{
selector:"img,table",collapsed:false,styles:{
"float":"left"}}
],aligncenter:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{
textAlign:"center"}
,defaultBlock:"div"}
,{
selector:"img",collapsed:false,styles:{
display:"block",marginLeft:"auto",marginRight:"auto"}}
,{
selector:"table",collapsed:false,styles:{
marginLeft:"auto",marginRight:"auto"}}
],alignright:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{
textAlign:"right"}
,defaultBlock:"div"}
,{
selector:"img,table",collapsed:false,styles:{
"float":"right"}}
],alignfull:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{
textAlign:"justify"}
,defaultBlock:"div"}
],bold:[{
inline:"strong",remove:"all"}
,{
inline:"span",styles:{
fontWeight:"bold"}}
,{
inline:"b",remove:"all"}
],italic:[{
inline:"em",remove:"all"}
,{
inline:"span",styles:{
fontStyle:"italic"}}
,{
inline:"i",remove:"all"}
],underline:[{
inline:"span",styles:{
textDecoration:"underline"}
,exact:true}
,{
inline:"u",remove:"all"}
],strikethrough:[{
inline:"span",styles:{
textDecoration:"line-through"}
,exact:true}
,{
inline:"strike",remove:"all"}
],forecolor:{
inline:"span",styles:{
color:"%value"}
,wrap_links:false}
,hilitecolor:{
inline:"span",styles:{
backgroundColor:"%value"}
,wrap_links:false}
,fontname:{
inline:"span",styles:{
fontFamily:"%value"}}
,fontsize:{
inline:"span",styles:{
fontSize:"%value"}}
,fontsize_class:{
inline:"span",attributes:{
"class":"%value"}}
,blockquote:{
block:"blockquote",wrapper:1,remove:"all"}
,subscript:{
inline:"sub"}
,superscript:{
inline:"sup"}
,link:{
inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(_o){
return true
}
,onformat:function(_s,_o,_n){
Q(_n,function(_h,_r){
a.setAttrib(_s,_r,_h)
}
)
}}
,removeformat:[{
selector:"b,strong,em,i,font,u,strike",remove:"all",split:true,expand:false,block_expand:true,deep:true}
,{
selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true}
,{
selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}
]}
);
Q("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(_o){
u(_o,{
block:_o,remove:"all"}
)
}
);
u(_i.settings.formats)
}
function X(){
_i.addShortcut("ctrl+b","bold_desc","Bold");
_i.addShortcut("ctrl+i","italic_desc","Italic");
_i.addShortcut("ctrl+u","underline_desc","Underline");
for(var _o=1;
_o<=6;
_o++){
_i.addShortcut("ctrl+"+_o,"",["FormatBlock",false,"h"+_o])
}
_i.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);
_i.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);
_i.addShortcut("ctrl+9","",["FormatBlock",false,"address"])
}
function Z(_o){
return _o?U[_o]:U
}
function u(_o,_n){
if(_o){
if(typeof(_o)!=="string"){
Q(_o,function(_r,_s){
u(_s,_r)
}
)
}else{
_n=_n.length?_n:[_n];
Q(_n,function(_s){
if(_s.deep===D){
_s.deep=!_s.selector
}
if(_s.split===D){
_s.split=!_s.selector||_s.inline
}
if(_s.remove===D&&_s.selector&&!_s.inline){
_s.remove="none"
}
if(_s.selector&&_s.inline){
_s.mixed=true;
_s.block_expand=true
}
if(typeof(_s.classes)==="string"){
_s.classes=_s.classes.split(/\s+/)
}}
);
U[_o]=_n
}}}
var l=function(_n){
var _o;
_i.dom.getParent(_n,function(_s){
_o=_i.dom.getStyle(_s,"text-decoration");
return _o&&_o!=="none"
}
);
return _o
};
var E=function(_o){
var _n;
if(_o.nodeType===1&&_o.parentNode&&_o.parentNode.nodeType===1){
_n=l(_o.parentNode);
if(_i.dom.getStyle(_o,"color")&&_n){
_i.dom.setStyle(_o,"text-decoration",_n)
}else{
if(_i.dom.getStyle(_o,"textdecoration")===_n){
_i.dom.setStyle(_o,"text-decoration",null)
}}}};
function _t(_r,_f,_l){
var _c=Z(_r),_p=_c[0],_m,_n,_u,_d=v.isCollapsed();
function _o(_w,_b){
_b=_b||_p;
if(_w){
if(_b.onformat){
_b.onformat(_w,_b,_f,_l)
}
Q(_b.styles,function(_k,_v){
a.setStyle(_w,_v,b(_k,_f))
}
);
Q(_b.attributes,function(_k,_v){
a.setAttrib(_w,_v,b(_k,_f))
}
);
Q(_b.classes,function(_v){
_v=b(_v,_f);
if(!a.hasClass(_w,_v)){
a.addClass(_w,_v)
}}
)
}}
function _h(){
function _v(_T,_j){
var _z=new q(_j);
for(_l=_z.current();
_l;
_l=_z.prev()){
if(_l.childNodes.length>1||_l==_T||_l.tagName=="BR"){
return _l
}}}
var _w=_i.selection.getRng();
var _q=_w.startContainer;
var _b=_w.endContainer;
if(_q!=_b&&_w.endOffset===0){
var _x=_v(_q,_b);
var _k=_x.nodeType==3?_x.length:_x.childNodes.length;
_w.setEnd(_x,_k)
}
return _w
}
function _s(_k,_T,_j,_q,_w){
var _b=[],_v=-1,_z,_A=-1,_x=-1,_O;
Q(_k.childNodes,function(_B,_W){
if(_B.nodeName==="UL"||_B.nodeName==="OL"){
_v=_W;
_z=_B;
return false
}}
);
Q(_k.childNodes,function(_B,_W){
if(_B.nodeName==="SPAN"&&a.getAttrib(_B,"data-mce-type")=="bookmark"){
if(_B.id==_T.id+"_start"){
_A=_W
}else{
if(_B.id==_T.id+"_end"){
_x=_W
}}}}
);
if(_v<=0||(_A<_v&&_x>_v)){
Q(e.grep(_k.childNodes),_w);
return 0
}else{
_O=a.clone(_j,_e);
Q(e.grep(_k.childNodes),function(_B,_W){
if((_A<_v&&_W<_v)||(_A>_v&&_W>_v)){
_b.push(_B);
_B.parentNode.removeChild(_B)
}}
);
if(_A<_v){
_k.insertBefore(_O,_z)
}else{
if(_A>_v){
_k.insertBefore(_O,_z.nextSibling)
}}
_q.push(_O);
Q(_b,function(_W){
_O.appendChild(_W)
}
);
return _O
}}
function _g(_w,_k,_j){
var _b=[],_q,_v,_x=true;
_q=_p.inline||_p.block;
_v=a.create(_q);
_o(_v);
L.walk(_w,function(_z){
var _T;
function _O(_A){
var _S,_C,_W,_B,_D;
_D=_x;
_S=_A.nodeName.toLowerCase();
_C=_A.parentNode.nodeName.toLowerCase();
if(_A.nodeType===1&&T(_A)){
_D=_x;
_x=T(_A)==="true";
_B=true
}
if(r(_S,"br")){
_T=0;
if(_p.block){
a.remove(_A)
}
return
}
if(_p.wrapper&&O(_A,_r,_f)){
_T=0;
return
}
if(_x&&!_B&&_p.block&&!_p.wrapper&&H(_S)){
_A=a.rename(_A,_q);
_o(_A);
_b.push(_A);
_T=0;
return
}
if(_p.selector){
Q(_c,function(_F){
if("collapsed" in _F&&_F.collapsed!==_d){
return
}
if(a.is(_A,_F.selector)&&!t(_A)){
_o(_A,_F);
_W=true
}}
);
if(!_p.inline||_W){
_T=0;
return
}}
if(_x&&!_B&&o(_q,_S)&&o(_C,_q)&&!(!_j&&_A.nodeType===3&&_A.nodeValue.length===1&&_A.nodeValue.charCodeAt(0)===65279)&&!t(_A)){
if(!_T){
_T=a.clone(_v,_e);
_A.parentNode.insertBefore(_T,_A);
_b.push(_T)
}
_T.appendChild(_A)
}else{
if(_S=="li"&&_k){
_T=_s(_A,_k,_v,_b,_O)
}else{
_T=0;
Q(e.grep(_A.childNodes),_O);
if(_B){
_x=_D
}
_T=0
}}}
Q(_z,_O)
}
);
if(_p.wrap_links===false){
Q(_b,function(_z){
function _T(_B){
var _W,_A,_O;
if(_B.nodeName==="A"){
_A=a.clone(_v,_e);
_b.push(_A);
_O=e.grep(_B.childNodes);
for(_W=0;
_W<_O.length;
_W++){
_A.appendChild(_O[_W])
}
_B.appendChild(_A)
}
Q(e.grep(_B.childNodes),_T)
}
_T(_z)
}
)
}
Q(_b,function(_O){
var _z;
function _A(_B){
var _W=0;
Q(_B.childNodes,function(_C){
if(!s(_C)&&!Y(_C)){
_W++
}}
);
return _W
}
function _T(_W){
var _C,_B;
Q(_W.childNodes,function(_D){
if(_D.nodeType==1&&!Y(_D)&&!t(_D)){
_C=_D;
return _e
}}
);
if(_C&&h(_C,_p)){
_B=a.clone(_C,_e);
_o(_B);
a.replace(_B,_W,C);
a.remove(_C,1)
}
return _B||_W
}
_z=_A(_O);
if((_b.length>1||!R(_O))&&_z===0){
a.remove(_O,1);
return
}
if(_p.inline||_p.wrapper){
if(!_p.exact&&_z===1){
_O=_T(_O)
}
Q(_c,function(_W){
Q(a.select(_W.inline,_O),function(_C){
var _B;
if(_W.wrap_links===false){
_B=_C.parentNode;
do{
if(_B.nodeName==="A"){
return
}}
while(_B=_B.parentNode)
}
_a(_W,_f,_C,_W.exact?_C:null)
}
)
}
);
if(O(_O.parentNode,_r,_f)){
a.remove(_O,1);
_O=0;
return C
}
if(_p.merge_with_parents){
a.getParent(_O.parentNode,function(_W){
if(O(_W,_r,_f)){
a.remove(_O,1);
_O=0;
return C
}}
)
}
if(_O&&_p.merge_siblings!==false){
_O=j(S(_O),_O);
_O=j(_O,S(_O,C))
}}}
)
}
if(_p){
if(_l){
if(_l.nodeType){
_n=a.createRng();
_n.setStartBefore(_l);
_n.setEndAfter(_l);
_g(g(_n,_c),null,true)
}else{
_g(_l,null,true)
}}else{
if(!_d||!_p.inline||a.select("td.mceSelected,th.mceSelected").length){
var _y=_i.selection.getNode();
if(!m&&_c[0].defaultBlock&&!a.getParent(_y,a.isBlock)){
_t(_c[0].defaultBlock)
}
_i.selection.setRng(_h());
_m=v.getBookmark();
_g(g(v.getRng(C),_c),_m);
if(_p.styles&&(_p.styles.color||_p.styles.textDecoration)){
e.walk(_y,E,"childNodes");
E(_y)
}
v.moveToBookmark(_m);
J(v.getRng(C));
_i.nodeChanged()
}else{
V("apply",_r,_f)
}}}}
function B(_s,_p,_h){
var _l=Z(_s),_y=_l[0],_m,_u,_n,_f=true;
function _r(_q){
var _x,_k,_v,_w,_z,_j;
if(_q.nodeType===1&&T(_q)){
_z=_f;
_f=T(_q)==="true";
_j=true
}
_x=e.grep(_q.childNodes);
if(_f&&!_j){
for(_k=0,_v=_l.length;
_k<_v;
_k++){
if(_a(_l[_k],_p,_q,_q)){
break
}}}
if(_y.deep){
if(_x.length){
for(_k=0,_v=_x.length;
_k<_v;
_k++){
_r(_x[_k])
}
if(_j){
_f=_z
}}}}
function _c(_w){
var _v;
Q(f(_w.parentNode).reverse(),function(_k){
var _x;
if(!_v&&_k.id!="_start"&&_k.id!="_end"){
_x=O(_k,_s,_p);
if(_x&&_x.split!==false){
_v=_k
}}}
);
return _v
}
function _o(_x,_w,_j,_O){
var _A,_T,_z,_k,_q,_v;
if(_x){
_v=_x.parentNode;
for(_A=_w.parentNode;
_A&&_A!=_v;
_A=_A.parentNode){
_T=a.clone(_A,_e);
for(_q=0;
_q<_l.length;
_q++){
if(_a(_l[_q],_p,_T,_T)){
_T=0;
break
}}
if(_T){
if(_z){
_T.appendChild(_z)
}
if(!_k){
_k=_T
}
_z=_T
}}
if(_O&&(!_y.mixed||!R(_x))){
_w=a.split(_x,_w)
}
if(_z){
_j.parentNode.insertBefore(_z,_j);
_k.appendChild(_j)
}}
return _w
}
function _g(_w){
return _o(_c(_w),_w,_w,true)
}
function _d(_k){
var _v=a.get(_k?"_start":"_end"),_w=_v[_k?"firstChild":"lastChild"];
if(Y(_w)){
_w=_w[_k?"firstChild":"lastChild"]
}
a.remove(_v,true);
return _w
}
function _b(_w){
var _k,_x,_v;
_w=g(_w,_l,C);
if(_y.split){
_k=G(_w,C);
_x=G(_w);
if(_k!=_x){
if(/^(TR|TD)$/.test(_k.nodeName)&&_k.firstChild){
_k=(_k.nodeName=="TD"?_k.firstChild:_k.firstChild.firstChild)||_k
}
_k=K(_k,"span",{
id:"_start","data-mce-type":"bookmark"}
);
_x=K(_x,"span",{
id:"_end","data-mce-type":"bookmark"}
);
_g(_k);
_g(_x);
_k=_d(C);
_x=_d()
}else{
_k=_x=_g(_k)
}
_w.startContainer=_k.parentNode;
_w.startOffset=k(_k);
_w.endContainer=_x.parentNode;
_w.endOffset=k(_x)+1
}
L.walk(_w,function(_q){
Q(_q,function(_j){
_r(_j);
if(_j.nodeType===1&&_i.dom.getStyle(_j,"text-decoration")==="underline"&&_j.parentNode&&l(_j.parentNode)==="underline"){
_a({
deep:false,exact:true,inline:"span",styles:{
textDecoration:"underline"}}
,null,_j)
}}
)
}
)
}
if(_h){
if(_h.nodeType){
_n=a.createRng();
_n.setStartBefore(_h);
_n.setEndAfter(_h);
_b(_n)
}else{
_b(_h)
}
return
}
if(!v.isCollapsed()||!_y.inline||a.select("td.mceSelected,th.mceSelected").length){
_m=v.getBookmark();
_b(v.getRng(C));
v.moveToBookmark(_m);
if(_y.inline&&d(_s,_p,v.getStart())){
J(v.getRng(true))
}
_i.nodeChanged()
}else{
V("remove",_s,_p)
}}
function F(_n,_r,_s){
var _o=Z(_n);
if(d(_n,_r,_s)&&(!("toggle" in _o[0])||_o[0].toggle)){
B(_n,_r,_s)
}else{
_t(_n,_r,_s)
}}
function O(_n,_o,_c,_h){
var _s=Z(_o),_d,_l,_r;
function _u(_g,_b,_w){
var _p,_y,_m=_b[_w],_f;
if(_b.onmatch){
return _b.onmatch(_g,_b,_w)
}
if(_m){
if(_m.length===D){
for(_p in _m){
if(_m.hasOwnProperty(_p)){
if(_w==="attributes"){
_y=a.getAttrib(_g,_p)
}else{
_y=N(_g,_p)
}
if(_h&&!_y&&!_b.exact){
return
}
if((!_h||_b.exact)&&!r(_y,b(_m[_p],_c))){
return
}}}}else{
for(_f=0;
_f<_m.length;
_f++){
if(_w==="attributes"?a.getAttrib(_g,_m[_f]):N(_g,_m[_f])){
return _b
}}}}
return _b
}
if(_s&&_n){
for(_l=0;
_l<_s.length;
_l++){
_d=_s[_l];
if(h(_n,_d)&&_u(_n,_d,"attributes")&&_u(_n,_d,"styles")){
if(_r=_d.classes){
for(_l=0;
_l<_r.length;
_l++){
if(!a.hasClass(_n,_r[_l])){
return
}}}
return _d
}}}}
function d(_s,_h,_r){
var _n;
function _o(_l){
_l=a.getParent(_l,function(_c){
return !!O(_c,_s,_h,true)
}
);
return O(_l,_s,_h)
}
if(_r){
return _o(_r)
}
_r=v.getNode();
if(_o(_r)){
return C
}
_n=v.getStart();
if(_n!=_r){
if(_o(_n)){
return C
}}
return _e
}
function z(_d,_c){
var _h,_l=[],_r={}
,_s,_n,_o;
_h=v.getStart();
a.getParent(_h,function(_f){
var _m,_u;
for(_m=0;
_m<_d.length;
_m++){
_u=_d[_m];
if(!_r[_u]&&O(_f,_u,_c)){
_r[_u]=true;
_l.push(_u)
}}}
,a.getRoot());
return _l
}
function A(_h){
var _c=Z(_h),_r,_s,_l,_n,_o;
if(_c){
_r=v.getStart();
_s=f(_r);
for(_n=_c.length-1;
_n>=0;
_n--){
_o=_c[_n].selector;
if(!_o){
return C
}
for(_l=_s.length-1;
_l>=0;
_l--){
if(a.is(_s[_l],_o)){
return C
}}}}
return _e
}
function I(_o,_s){
var _n;
if(!P){
P={};
_n={};
_i.onNodeChange.addToTop(function(_h,_r,_c){
var _l=f(_c),_d={};
Q(P,function(_u,_m){
Q(_l,function(_f){
if(O(_f,_m,{}
,true)){
if(!_n[_m]){
Q(_u,function(_p){
_p(true,{
node:_f,format:_m,parents:_l}
)
}
);
_n[_m]=_u
}
_d[_m]=_u;
return false
}}
)
}
);
Q(_n,function(_u,_m){
if(!_d[_m]){
delete _n[_m];
Q(_u,function(_f){
_f(false,{
node:_c,format:_m,parents:_l}
)
}
)
}}
)
}
)
}
Q(_o.split(","),function(_r){
if(!P[_r]){
P[_r]=[]
}
P[_r].push(_s)
}
);
return this
}
e.extend(this,{
get:Z,register:u,apply:_t,remove:B,toggle:F,match:d,matchAll:z,matchNode:O,canApply:A,formatChanged:I}
);
c();
X();
function h(_o,_n){
if(r(_o,_n.inline)){
return C
}
if(r(_o,_n.block)){
return C
}
if(_n.selector){
return a.is(_o,_n.selector)
}}
function r(_n,_o){
_n=_n||"";
_o=_o||"";
_n=""+(_n.nodeName||_n);
_o=""+(_o.nodeName||_o);
return _n.toLowerCase()==_o.toLowerCase()
}
function N(_n,_o){
var _s=a.getStyle(_n,_o);
if(_o=="color"||_o=="backgroundColor"){
_s=a.toHex(_s)
}
if(_o=="fontWeight"&&_s==700){
_s="bold"
}
return""+_s
}
function b(_o,_n){
if(typeof(_o)!="string"){
_o=_o(_n)
}else{
if(_n){
_o=_o.replace(/%(\w+)/g,function(_r,_s){
return _n[_s]||_r
}
)
}}
return _o
}
function s(_o){
return _o&&_o.nodeType===3&&/^([\t \r\n]+|)$/.test(_o.nodeValue)
}
function K(_s,_n,_o){
var _r=a.create(_n,_o);
_s.parentNode.insertBefore(_r,_s);
_r.appendChild(_s);
return _r
}
function g(_o,_p,_r){
var _b,_g,_c,_f,_s=_o.startContainer,_d=_o.startOffset,_v=_o.endContainer,_m=_o.endOffset;
function _y(_O){
var _x,_z,_T,_j,_q,_k;
_x=_z=_O?_s:_v;
_q=_O?"previousSibling":"nextSibling";
_k=a.getRoot();
if(_x.nodeType==3&&!s(_x)){
if(_O?_d>0:_m<_x.nodeValue.length){
return _x
}}
for(;
;
){
if(!_p[0].block_expand&&R(_z)){
return _z
}
for(_j=_z[_q];
_j;
_j=_j[_q]){
if(!Y(_j)&&!s(_j)){
return _z
}}
if(_z.parentNode==_k){
_x=_z;
break
}
_z=_z.parentNode
}
return _x
}
function _l(_k,_x){
if(_x===D){
_x=_k.nodeType===3?_k.length:_k.childNodes.length
}
while(_k&&_k.hasChildNodes()){
_k=_k.childNodes[_x];
if(_k){
_x=_k.nodeType===3?_k.length:_k.childNodes.length
}}
return{
node:_k,offset:_x}
}
if(_s.nodeType==1&&_s.hasChildNodes()){
_g=_s.childNodes.length-1;
_s=_s.childNodes[_d>_g?_g:_d];
if(_s.nodeType==3){
_d=0
}}
if(_v.nodeType==1&&_v.hasChildNodes()){
_g=_v.childNodes.length-1;
_v=_v.childNodes[_m>_g?_g:_m-1];
if(_v.nodeType==3){
_m=_v.nodeValue.length
}}
function _w(_x){
var _k=_x;
while(_k){
if(_k.nodeType===1&&T(_k)){
return T(_k)==="false"?_k:_x
}
_k=_k.parentNode
}
return _x
}
function _u(_x,_T,_A){
var _z,_q,_O,_k;
function _j(_B,_D){
var _S,_W,_C=_B.nodeValue;
if(typeof(_D)=="undefined"){
_D=_A?_C.length:0
}
if(_A){
_S=_C.lastIndexOf(" ",_D);
_W=_C.lastIndexOf("\u00a0",_D);
_S=_S>_W?_S:_W;
if(_S!==-1&&!_r){
_S++
}}else{
_S=_C.indexOf(" ",_D);
_W=_C.indexOf("\u00a0",_D);
_S=_S!==-1&&(_W===-1||_S<_W)?_S:_W
}
return _S
}
if(_x.nodeType===3){
_O=_j(_x,_T);
if(_O!==-1){
return{
container:_x,offset:_O}
}
_k=_x
}
_z=new q(_x,a.getParent(_x,R)||_i.getBody());
while(_q=_z[_A?"prev":"next"]()){
if(_q.nodeType===3){
_k=_q;
_O=_j(_q);
if(_O!==-1){
return{
container:_q,offset:_O}
}}else{
if(R(_q)){
break
}}}
if(_k){
if(_A){
_T=0
}else{
_T=_k.length
}
return{
container:_k,offset:_T}
}}
function _h(_x,_k){
var _q,_j,_T,_z;
if(_x.nodeType==3&&_x.nodeValue.length===0&&_x[_k]){
_x=_x[_k]
}
_q=f(_x);
for(_j=0;
_j<_q.length;
_j++){
for(_T=0;
_T<_p.length;
_T++){
_z=_p[_T];
if("collapsed" in _z&&_z.collapsed!==_o.collapsed){
continue
}
if(a.is(_q[_j],_z.selector)){
return _q[_j]
}}}
return _x
}
function _n(_x,_k,_j){
var _q;
if(!_p[0].wrapper){
_q=a.getParent(_x,_p[0].block)
}
if(!_q){
_q=a.getParent(_x.nodeType==3?_x.parentNode:_x,R)
}
if(_q&&_p[0].wrapper){
_q=f(_q,"ul,ol").reverse()[0]||_q
}
if(!_q){
_q=_x;
while(_q[_k]&&!R(_q[_k])){
_q=_q[_k];
if(r(_q,"br")){
break
}}}
return _q||_x
}
_s=_w(_s);
_v=_w(_v);
if(Y(_s.parentNode)||Y(_s)){
_s=Y(_s)?_s:_s.parentNode;
_s=_s.nextSibling||_s;
if(_s.nodeType==3){
_d=0
}}
if(Y(_v.parentNode)||Y(_v)){
_v=Y(_v)?_v:_v.parentNode;
_v=_v.previousSibling||_v;
if(_v.nodeType==3){
_m=_v.length
}}
if(_p[0].inline){
if(_o.collapsed){
_f=_u(_s,_d,true);
if(_f){
_s=_f.container;
_d=_f.offset
}
_f=_u(_v,_m);
if(_f){
_v=_f.container;
_m=_f.offset
}}
_c=_l(_v,_m);
if(_c.node){
while(_c.node&&_c.offset===0&&_c.node.previousSibling){
_c=_l(_c.node.previousSibling)
}
if(_c.node&&_c.offset>0&&_c.node.nodeType===3&&_c.node.nodeValue.charAt(_c.offset-1)===" "){
if(_c.offset>1){
_v=_c.node;
_v.splitText(_c.offset-1)
}}}}
if(_p[0].inline||_p[0].block_expand){
if(!_p[0].inline||(_s.nodeType!=3||_d===0)){
_s=_y(true)
}
if(!_p[0].inline||(_v.nodeType!=3||_m===_v.nodeValue.length)){
_v=_y()
}}
if(_p[0].selector&&_p[0].expand!==_e&&!_p[0].inline){
_s=_h(_s,"previousSibling");
_v=_h(_v,"nextSibling")
}
if(_p[0].block||_p[0].selector){
_s=_n(_s,"previousSibling");
_v=_n(_v,"nextSibling");
if(_p[0].block){
if(!R(_s)){
_s=_y(true)
}
if(!R(_v)){
_v=_y()
}}}
if(_s.nodeType==1){
_d=k(_s);
_s=_s.parentNode
}
if(_v.nodeType==1){
_m=k(_v)+1;
_v=_v.parentNode
}
return{
startContainer:_s,startOffset:_d,endContainer:_v,endOffset:_m}
}
function _a(_c,_l,_r,_o){
var _s,_n,_h;
if(!h(_r,_c)){
return _e
}
if(_c.remove!="all"){
Q(_c.styles,function(_u,_d){
_u=b(_u,_l);
if(typeof(_d)==="number"){
_d=_u;
_o=0
}
if(!_o||r(N(_o,_d),_u)){
a.setStyle(_r,_d,"")
}
_h=1
}
);
if(_h&&a.getAttrib(_r,"style")==""){
_r.removeAttribute("style");
_r.removeAttribute("data-mce-style")
}
Q(_c.attributes,function(_m,_d){
var _u;
_m=b(_m,_l);
if(typeof(_d)==="number"){
_d=_m;
_o=0
}
if(!_o||r(a.getAttrib(_o,_d),_m)){
if(_d=="class"){
_m=a.getAttrib(_r,_d);
if(_m){
_u="";
Q(_m.split(/\s+/),function(_f){
if(/mce\w+/.test(_f)){
_u+=(_u?" ":"")+_f
}}
);
if(_u){
a.setAttrib(_r,_d,_u);
return
}}}
if(_d=="class"){
_r.removeAttribute("className")
}
if(n.test(_d)){
_r.removeAttribute("data-mce-"+_d)
}
_r.removeAttribute(_d)
}}
);
Q(_c.classes,function(_d){
_d=b(_d,_l);
if(!_o||a.hasClass(_o,_d)){
a.removeClass(_r,_d)
}}
);
_n=a.getAttribs(_r);
for(_s=0;
_s<_n.length;
_s++){
if(_n[_s].nodeName.indexOf("_")!==0){
return _e
}}}
if(_c.remove!="none"){
p(_r,_c);
return C
}}
function p(_s,_r){
var _o=_s.parentNode,_n;
function _h(_c,_l,_d){
_c=S(_c,_l,_d);
return !_c||(_c.nodeName=="BR"||R(_c))
}
if(_r.block){
if(!m){
if(R(_s)&&!R(_o)){
if(!_h(_s,_e)&&!_h(_s.firstChild,C,1)){
_s.insertBefore(a.create("br"),_s.firstChild)
}
if(!_h(_s,C)&&!_h(_s.lastChild,_e,1)){
_s.appendChild(a.create("br"))
}}}else{
if(_o==a.getRoot()){
if(!_r.list_block||!r(_s,_r.list_block)){
Q(e.grep(_s.childNodes),function(_l){
if(o(m,_l.nodeName.toLowerCase())){
if(!_n){
_n=K(_l,m)
}else{
_n.appendChild(_l)
}}else{
_n=0
}}
)
}}}}
if(_r.selector&&_r.inline&&!r(_r.inline,_s)){
return
}
a.remove(_s,1)
}
function S(_n,_o,_s){
if(_n){
_o=_o?"nextSibling":"previousSibling";
for(_n=_s?_n:_n[_o];
_n;
_n=_n[_o]){
if(_n.nodeType==1||!s(_n)){
return _n
}}}}
function Y(_o){
return _o&&_o.nodeType==1&&_o.getAttribute("data-mce-type")=="bookmark"
}
function j(_h,_r){
var _o,_s,_n;
function _c(_m,_u){
if(_m.nodeName!=_u.nodeName){
return _e
}
function _d(_p){
var _g={};
Q(a.getAttribs(_p),function(_y){
var _b=_y.nodeName.toLowerCase();
if(_b.indexOf("_")!==0&&_b!=="style"){
_g[_b]=a.getAttrib(_p,_b)
}}
);
return _g
}
function _f(_b,_y){
var _g,_p;
for(_p in _b){
if(_b.hasOwnProperty(_p)){
_g=_y[_p];
if(_g===D){
return _e
}
if(_b[_p]!=_g){
return _e
}
delete _y[_p]
}}
for(_p in _y){
if(_y.hasOwnProperty(_p)){
return _e
}}
return C
}
if(!_f(_d(_m),_d(_u))){
return _e
}
if(!_f(a.parseStyle(a.getAttrib(_m,"style")),a.parseStyle(a.getAttrib(_u,"style")))){
return _e
}
return C
}
function _l(_u,_d){
for(_s=_u;
_s;
_s=_s[_d]){
if(_s.nodeType==3&&_s.nodeValue.length!==0){
return _u
}
if(_s.nodeType==1&&!Y(_s)){
return _s
}}
return _u
}
if(_h&&_r){
_h=_l(_h,"previousSibling");
_r=_l(_r,"nextSibling");
if(_c(_h,_r)){
for(_s=_h.nextSibling;
_s&&_s!=_r;
){
_n=_s;
_s=_s.nextSibling;
_h.appendChild(_n)
}
a.remove(_r);
Q(e.grep(_r.childNodes),function(_d){
_h.appendChild(_d)
}
);
return _h
}}
return _r
}
function H(_o){
return/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(_o)
}
function G(_n,_l){
var _o,_h,_s,_r;
_o=_n[_l?"startContainer":"endContainer"];
_h=_n[_l?"startOffset":"endOffset"];
if(_o.nodeType==1){
_s=_o.childNodes.length-1;
if(!_l&&_h){
_h--
}
_o=_o.childNodes[_h>_s?_s:_h]
}
if(_o.nodeType===3&&_l&&_h>=_o.nodeValue.length){
_o=new q(_o,_i.getBody()).next()||_o
}
if(_o.nodeType===3&&!_l&&_h===0){
_o=new q(_o,_i.getBody()).prev()||_o
}
return _o
}
function V(_m,_o,_d){
var _f="_mce_caret",_n=_i.settings.caret_debug;
function _s(_b){
var _y=a.create("span",{
id:_f,"data-mce-bogus":true,style:_n?"color:red":""}
);
if(_b){
_y.appendChild(_i.getDoc().createTextNode(M))
}
return _y
}
function _u(_b,_y){
while(_b){
if((_b.nodeType===3&&_b.nodeValue!==M)||_b.childNodes.length>1){
return false
}
if(_y&&_b.nodeType===1){
_y.push(_b)
}
_b=_b.firstChild
}
return true
}
function _l(_y){
while(_y){
if(_y.id===_f){
return _y
}
_y=_y.parentNode
}}
function _h(_y){
var _b;
if(_y){
_b=new q(_y,_y);
for(_y=_b.current();
_y;
_y=_b.next()){
if(_y.nodeType===3){
return _y
}}}}
function _r(_w,_b){
var _v,_y;
if(!_w){
_w=_l(v.getStart());
if(!_w){
while(_w=a.get(_f)){
_r(_w,false)
}}}else{
_y=v.getRng(true);
if(_u(_w)){
if(_b!==false){
_y.setStartBefore(_w);
_y.setEndBefore(_w)
}
a.remove(_w)
}else{
_v=_h(_w);
if(_v.nodeValue.charAt(0)===M){
_v=_v.deleteData(0,1)
}
a.remove(_w,1)
}
v.setRng(_y)
}}
function _c(){
var _w,_y,_q,_x,_v,_b,_k;
_w=v.getRng(true);
_x=_w.startOffset;
_b=_w.startContainer;
_k=_b.nodeValue;
_y=_l(v.getStart());
if(_y){
_q=_h(_y)
}
if(_k&&_x>0&&_x<_k.length&&/\w/.test(_k.charAt(_x))&&/\w/.test(_k.charAt(_x-1))){
_v=v.getBookmark();
_w.collapse(true);
_w=g(_w,Z(_o));
_w=L.split(_w);
_t(_o,_d,_w);
v.moveToBookmark(_v)
}else{
if(!_y||_q.nodeValue!==M){
_y=_s(true);
_q=_y.firstChild;
_w.insertNode(_y);
_x=1;
_t(_o,_d,_y)
}else{
_t(_o,_d,_y)
}
v.setCursorLocation(_q,_x)
}}
function _p(){
var _y=v.getRng(true),_b,_v,_q,_x,_w,_T,_z=[],_k,_j;
_b=_y.startContainer;
_v=_y.startOffset;
_w=_b;
if(_b.nodeType==3){
if(_v!=_b.nodeValue.length||_b.nodeValue===M){
_x=true
}
_w=_w.parentNode
}
while(_w){
if(O(_w,_o,_d)){
_T=_w;
break
}
if(_w.nextSibling){
_x=true
}
_z.push(_w);
_w=_w.parentNode
}
if(!_T){
return
}
if(_x){
_q=v.getBookmark();
_y.collapse(true);
_y=g(_y,Z(_o),true);
_y=L.split(_y);
B(_o,_d,_y);
v.moveToBookmark(_q)
}else{
_j=_s();
_w=_j;
for(_k=_z.length-1;
_k>=0;
_k--){
_w.appendChild(a.clone(_z[_k],false));
_w=_w.firstChild
}
_w.appendChild(a.doc.createTextNode(M));
_w=_w.firstChild;
a.insertAfter(_j,_T);
v.setCursorLocation(_w,1)
}}
function _g(){
var _b,_y,_w;
_y=_l(v.getStart());
if(_y&&!a.isEmpty(_y)){
e.walk(_y,function(_v){
if(_v.nodeType==1&&_v.id!==_f&&!a.isEmpty(_v)){
a.setAttrib(_v,"data-mce-bogus",null)
}}
,"childNodes")
}}
if(!self._hasCaretEvents){
_i.onBeforeGetContent.addToTop(function(){
var _y=[],_b;
if(_u(_l(v.getStart()),_y)){
_b=_y.length;
while(_b--){
a.setAttrib(_y[_b],"data-mce-bogus","1")
}}}
);
e.each("onMouseUp onKeyUp".split(" "),function(_y){
_i[_y].addToTop(function(){
_r();
_g()
}
)
}
);
_i.onKeyDown.addToTop(function(_y,_w){
var _b=_w.keyCode;
if(_b==8||_b==37||_b==39){
_r(_l(v.getStart()))
}
_g()
}
);
v.onSetContent.add(_g);
self._hasCaretEvents=true
}
if(_m=="apply"){
_c()
}else{
_p()
}}
function J(_n){
var _o=_n.startContainer,_d=_n.startOffset,_r,_c,_l,_s,_h;
if(_o.nodeType==3&&_d>=_o.nodeValue.length){
_d=k(_o);
_o=_o.parentNode;
_r=true
}
if(_o.nodeType==1){
_s=_o.childNodes;
_o=_s[Math.min(_d,_s.length-1)];
_c=new q(_o,a.getParent(_o,a.isBlock));
if(_d>_s.length-1||_r){
_c.next()
}
for(_l=_c.current();
_l;
_l=_c.next()){
if(_l.nodeType==3&&!s(_l)){
_h=a.create("a",null,M);
_l.parentNode.insertBefore(_h,_l);
_n.setStart(_l,0);
v.setRng(_n);
a.remove(_h);
return
}}}}}
}
)(tinymce);
tinymce.onAddEditor.add(function(n,e){
var o,h,r,a=e.settings;
function t(c,l){
n.each(l,function(u,d){
if(u){
r.setStyle(c,d,u)
}}
);
r.rename(c,"span")
}
function s(l,c){
r=l.dom;
if(a.convert_fonts_to_spans){
n.each(r.select("font,u,strike",c.node),function(d){
o[d.nodeName.toLowerCase()](e.dom,d)
}
)
}}
if(a.inline_styles){
h=n.explode(a.font_size_legacy_values);
o={
font:function(c,l){
t(l,{
backgroundColor:l.style.backgroundColor,color:l.color,fontFamily:l.face,fontSize:h[parseInt(l.size,10)-1]}
)
}
,u:function(c,l){
t(l,{
textDecoration:"underline"}
)
}
,strike:function(c,l){
t(l,{
textDecoration:"line-through"}
)
}};
e.onPreProcess.add(s);
e.onSetContent.add(s);
e.onInit.add(function(){
e.selection.onSetContent.add(s)
}
)
}}
);
(function(t){
var e=t.dom.TreeWalker;
t.EnterKey=function(s){
var l=s.dom,n=s.selection,o=s.settings,h=s.undoManager,a=s.schema.getNonEmptyElements();
function r(W){
var z=n.getRng(true),S,c,A,j,g,E,p,d,f,q,H,T,B;
function D(G){
return G&&l.isBlock(G)&&!/^(TD|TH|CAPTION|FORM)$/.test(G.nodeName)&&!/^(fixed|absolute)/i.test(G.style.position)&&l.getContentEditable(G)!=="true"
}
function F(L){
var G;
if(t.isIE&&l.isBlock(L)){
G=n.getRng();
L.appendChild(l.create("span",null,"\u00a0"));
n.select(L);
L.lastChild.outerHTML="";
n.setRng(G)
}}
function O(N){
var L=N,P=[],G;
while(L=L.firstChild){
if(l.isBlock(L)){
return
}
if(L.nodeType==1&&!a[L.nodeName.toLowerCase()]){
P.push(L)
}}
G=P.length;
while(G--){
L=P[G];
if(!L.hasChildNodes()||(L.firstChild==L.lastChild&&L.firstChild.nodeValue==="")){
l.remove(L)
}}}
function m(L){
var K,U,G,Q,J,P=L,N;
G=l.createRng();
if(L.hasChildNodes()){
K=new e(L,L);
while(U=K.current()){
if(U.nodeType==3){
G.setStart(U,0);
G.setEnd(U,0);
break
}
if(a[U.nodeName.toLowerCase()]){
G.setStartBefore(U);
G.setEndBefore(U);
break
}
P=U;
U=K.next()
}
if(!U){
G.setStart(P,0);
G.setEnd(P,0)
}}else{
if(L.nodeName=="BR"){
if(L.nextSibling&&l.isBlock(L.nextSibling)){
if(!E||E<9){
N=l.create("br");
L.parentNode.insertBefore(N,L)
}
G.setStartBefore(L);
G.setEndBefore(L)
}else{
G.setStartAfter(L);
G.setEndAfter(L)
}}else{
G.setStart(L,0);
G.setEnd(L,0)
}}
n.setRng(G);
l.remove(N);
J=l.getViewPort(s.getWin());
Q=l.getPos(L).y;
if(Q<J.y||Q+25>J.y+J.h){
s.getWin().scrollTo(0,Q<J.y?Q:Q-J.h+25)
}}
function v(L){
var N=A,U,P,G;
U=L||q=="TABLE"?l.create(L||T):g.cloneNode(false);
G=U;
if(o.keep_styles!==false){
do{
if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(N.nodeName)){
P=N.cloneNode(false);
l.setAttrib(P,"id","");
if(U.hasChildNodes()){
P.appendChild(U.firstChild);
U.appendChild(P)
}else{
G=P;
U.appendChild(P)
}}}
while(N=N.parentNode)
}
if(!t.isIE){
G.innerHTML="<br>"
}
return U
}
function b(P){
var N,L,G;
if(A.nodeType==3&&(P?j>0:j<A.nodeValue.length)){
return false
}
if(A.parentNode==g&&B&&!P){
return true
}
if(P&&A.nodeType==1&&A==g.firstChild){
return true
}
if(A.nodeName==="TABLE"||(A.previousSibling&&A.previousSibling.nodeName=="TABLE")){
return(B&&!P)||(!B&&P)
}
N=new e(A,g);
if(A.nodeType==3){
if(P&&j==0){
N.prev()
}else{
if(!P&&j==A.nodeValue.length){
N.next()
}}}
while(L=N.current()){
if(L.nodeType===1){
if(!L.getAttribute("data-mce-bogus")){
G=L.nodeName.toLowerCase();
if(a[G]&&G!=="br"){
return false
}}}else{
if(L.nodeType===3&&!/^[ \t\r\n]*$/.test(L.nodeValue)){
return false
}}
if(P){
N.prev()
}else{
N.next()
}}
return true
}
function u(G,K){
var Q,J,N,U,P,L=T||"P";
J=l.getParent(G,l.isBlock);
if(!J||!D(J)){
J=J||c;
if(!J.hasChildNodes()){
Q=l.create(L);
J.appendChild(Q);
z.setStart(Q,0);
z.setEnd(Q,0);
return Q
}
U=G;
while(U.parentNode!=J){
U=U.parentNode
}
while(U&&!l.isBlock(U)){
N=U;
U=U.previousSibling
}
if(N){
Q=l.create(L);
N.parentNode.insertBefore(Q,N);
U=N;
while(U&&!l.isBlock(U)){
P=U.nextSibling;
Q.appendChild(U);
U=P
}
z.setStart(G,K);
z.setEnd(G,K)
}}
return G
}
function M(){
function G(N){
var L=f[N?"firstChild":"lastChild"];
while(L){
if(L.nodeType==1){
break
}
L=L[N?"nextSibling":"previousSibling"]
}
return L===g
}
p=T?v(T):l.create("BR");
if(G(true)&&G()){
l.replace(p,f)
}else{
if(G(true)){
f.parentNode.insertBefore(p,f)
}else{
if(G()){
l.insertAfter(p,f);
F(p)
}else{
S=z.cloneRange();
S.setStartAfter(g);
S.setEndAfter(f);
d=S.extractContents();
l.insertAfter(d,f);
l.insertAfter(p,f)
}}}
l.remove(g);
m(p);
h.add()
}
function C(){
var L=new e(A,g),G;
while(G=L.current()){
if(G.nodeName=="BR"){
return true
}
G=L.next()
}}
function Y(){
var L,G;
if(A&&A.nodeType==3&&j>=A.nodeValue.length){
if(!t.isIE&&!C()){
L=l.create("br");
z.insertNode(L);
z.setStartAfter(L);
z.setEndAfter(L);
G=true
}}
L=l.create("br");
z.insertNode(L);
if(t.isIE&&q=="PRE"&&(!E||E<8)){
L.parentNode.insertBefore(l.doc.createTextNode("\r"),L)
}
if(!G){
z.setStartAfter(L);
z.setEndAfter(L)
}else{
z.setStartBefore(L);
z.setEndBefore(L)
}
n.setRng(z);
h.add()
}
function k(G){
do{
if(G.nodeType===3){
G.nodeValue=G.nodeValue.replace(/^[\r\n]+/,"")
}
G=G.firstChild
}
while(G)
}
function I(N){
var G=l.getRoot(),L,P;
L=N;
while(L!==G&&l.getContentEditable(L)!=="false"){
if(l.getContentEditable(L)==="true"){
P=L
}
L=L.parentNode
}
return L!==G?P:G
}
function R(L){
var G;
if(!t.isIE){
L.normalize();
G=L.lastChild;
if(!G||(/^(left|right)$/gi.test(l.getStyle(G,"float",true)))){
l.add(L,"br")
}}}
if(!z.collapsed){
s.execCommand("Delete");
return
}
if(W.isDefaultPrevented()){
return
}
A=z.startContainer;
j=z.startOffset;
T=o.forced_root_block;
T=T?T.toUpperCase():"";
E=l.doc.documentMode;
if(A.nodeType==1&&A.hasChildNodes()){
B=j>A.childNodes.length-1;
A=A.childNodes[Math.min(j,A.childNodes.length-1)]||A;
if(B&&A.nodeType==3){
j=A.nodeValue.length
}else{
j=0
}}
c=I(A);
if(!c){
return
}
h.beforeChange();
if(!l.isBlock(c)&&c!=l.getRoot()){
if(!T||W.shiftKey){
Y()
}
return
}
if((T&&!W.shiftKey)||(!T&&W.shiftKey)){
A=u(A,j)
}
g=l.getParent(A,l.isBlock);
f=g?l.getParent(g.parentNode,l.isBlock):null;
q=g?g.nodeName.toUpperCase():"";
H=f?f.nodeName.toUpperCase():"";
if(q=="LI"&&l.isEmpty(g)){
if(/^(UL|OL|LI)$/.test(f.parentNode.nodeName)){
return false
}
M();
return
}
if(q=="PRE"&&o.br_in_pre!==false){
if(!W.shiftKey){
Y();
return
}}else{
if((!T&&!W.shiftKey&&q!="LI")||(T&&W.shiftKey)){
Y();
return
}}
T=T||"P";
if(b()){
if(/^(H[1-6]|PRE)$/.test(q)&&H!="HGROUP"){
p=v(T)
}else{
p=v()
}
if(o.end_container_on_empty_block&&D(f)&&l.isEmpty(g)){
p=l.split(f,g)
}else{
l.insertAfter(p,g)
}
m(p)
}else{
if(b(true)){
p=g.parentNode.insertBefore(v(),g);
F(p)
}else{
S=z.cloneRange();
S.setEndAfter(g);
d=S.extractContents();
k(d);
p=d.firstChild;
l.insertAfter(d,g);
O(p);
R(g);
m(p)
}}
l.setAttrib(p,"id","");
h.add()
}
s.onKeyDown.add(function(d,c){
if(c.keyCode==13){
if(r(c)!==false){
c.preventDefault()
}}}
)
}
}
)(tinymce)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.themes.advanced.editor_template_src")){
(function(h){
var l=h.DOM,r=h.dom.Event,a=h.extend,s=h.each,e=h.util.Cookie,n,o=h.explode;
function t(m,d){
var b,g=m.dom,f="",p,u;
previewStyles=m.settings.preview_styles;
if(previewStyles===false){
return""
}
if(!previewStyles){
previewStyles="font-family font-size font-weight text-decoration text-transform color background-color"
}
function c(v){
return v.replace(/%(\w+)/g,"")
}
name=d.block||d.inline||"span";
b=g.create(name);
s(d.styles,function(k,v){
k=c(k);
if(k){
g.setStyle(b,v,k)
}}
);
s(d.attributes,function(k,v){
k=c(k);
if(k){
g.setAttrib(b,v,k)
}}
);
s(d.classes,function(v){
v=c(v);
if(!g.hasClass(b,v)){
g.addClass(b,v)
}}
);
g.setStyles(b,{
position:"absolute",left:-65535}
);
m.getBody().appendChild(b);
p=g.getStyle(m.getBody(),"fontSize",true);
p=/px$/.test(p)?parseInt(p,10):0;
s(previewStyles.split(" "),function(v){
var k=g.getStyle(b,v,true);
if(v=="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(k)){
k=g.getStyle(m.getBody(),v,true);
if(g.toHex(k).toLowerCase()=="#ffffff"){
return
}}
if(v=="font-size"){
if(/em|%$/.test(k)){
if(p===0){
return
}
k=parseFloat(k,10)/(/%$/.test(k)?100:1);
k=(k*p)+"px"
}}
f+=v+":"+k+";"
}
);
g.remove(b);
return f
}
h.ThemeManager.requireLangPack("advanced");
h.create("tinymce.themes.AdvancedTheme",{
sizes:[8,10,12,14,18,24,36],controls:{
bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]}
,stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(d,u){
var m=this,f,c,p;
m.editor=d;
m.url=u;
m.onResolveName=new h.util.Dispatcher(this);
f=d.settings;
d.forcedHighContrastMode=d.settings.detect_highcontrast&&m._isHighContrast();
d.settings.skin=d.forcedHighContrastMode?"highcontrast":d.settings.skin;
if(!f.theme_advanced_buttons1){
f=a({
theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap"}
,f)
}
m.settings=f=a({
theme_advanced_path:true,theme_advanced_toolbar_location:"top",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:d.settings.readonly}
,f);
if(!f.font_size_style_values){
f.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"
}
if(h.is(f.theme_advanced_font_sizes,"string")){
f.font_size_style_values=h.explode(f.font_size_style_values);
f.font_size_classes=h.explode(f.font_size_classes||"");
p={};
d.settings.theme_advanced_font_sizes=f.theme_advanced_font_sizes;
s(d.getParam("theme_advanced_font_sizes","","hash"),function(q,b){
var g;
if(b==q&&q>=1&&q<=7){
b=q+" ("+m.sizes[q-1]+"pt)";
g=f.font_size_classes[q-1];
q=f.font_size_style_values[q-1]||(m.sizes[q-1]+"pt")
}
if(/^\s*\./.test(q)){
g=q.replace(/\./g,"")
}
p[b]=g?{
"class":g}
:{
fontSize:q}
}
);
f.theme_advanced_font_sizes=p
}
if((c=f.theme_advanced_path_location)&&c!="none"){
f.theme_advanced_statusbar_location=f.theme_advanced_path_location
}
if(f.theme_advanced_statusbar_location=="none"){
f.theme_advanced_statusbar_location=0
}
if(d.settings.content_css!==false){
d.contentCSS.push(d.baseURI.toAbsolute(u+"/skins/"+d.settings.skin+"/content.css"))
}
d.onInit.add(function(){
if(!d.settings.readonly){
d.onNodeChange.add(m._nodeChanged,m);
d.onKeyUp.add(m._updateUndoStatus,m);
d.onMouseUp.add(m._updateUndoStatus,m);
d.dom.bind(d.dom.getRoot(),"dragend",function(){
m._updateUndoStatus(d)
}
)
}}
);
d.onSetProgressState.add(function(k,g,q){
var j,z=k.id,v;
if(g){
m.progressTimer=setTimeout(function(){
j=k.getContainer();
j=j.insertBefore(l.create("DIV",{
style:"position:relative"}
),j.firstChild);
v=l.get(k.id+"_tbl");
l.add(j,"div",{
id:z+"_blocker","class":"mceBlocker",style:{
width:v.clientWidth+2,height:v.clientHeight+2}}
);
l.add(j,"div",{
id:z+"_progress","class":"mceProgress",style:{
left:v.clientWidth/2,top:v.clientHeight/2}}
)
}
,q||0)
}else{
l.remove(z+"_blocker");
l.remove(z+"_progress");
clearTimeout(m.progressTimer)
}}
);
l.loadCSS(f.editor_css?d.documentBaseURI.toAbsolute(f.editor_css):u+"/skins/"+d.settings.skin+"/ui.css");
if(f.skin_variant){
l.loadCSS(u+"/skins/"+d.settings.skin+"/ui_"+f.skin_variant+".css")
}}
,_isHighContrast:function(){
var c,d=l.add(l.getRoot(),"div",{
style:"background-color: rgb(171,239,86);"}
);
c=(l.getStyle(d,"background-color",true)+"").toLowerCase().replace(/ /g,"");
l.remove(d);
return c!="rgb(171,239,86)"&&c!="#abef56"
}
,createControl:function(f,d){
var u,m;
if(m=d.createControl(f)){
return m
}
switch(f){
case"styleselect":return this._createStyleSelect();
case"formatselect":return this._createBlockFormats();
case"fontselect":return this._createFontSelect();
case"fontsizeselect":return this._createFontSizeSelect();
case"forecolor":return this._createForeColorMenu();
case"backcolor":return this._createBackColorMenu()
}
if((u=this.controls[f])){
return d.createButton(f,{
title:"advanced."+u[0],cmd:u[1],ui:u[2],value:u[3]}
)
}}
,execCommand:function(u,d,m){
var c=this["_"+u];
if(c){
c.call(this,d,m);
return true
}
return false
}
,_importClasses:function(u){
var c=this.editor,d=c.controlManager.get("styleselect");
if(d.getLength()==0){
s(c.dom.getClasses(),function(g,m){
var p="style_"+m,f;
f={
inline:"span",attributes:{
"class":g["class"]}
,selector:"*"};
c.formatter.register(p,f);
d.add(g["class"],p,{
style:function(){
return t(c,f)
}}
)
}
)
}}
,_createStyleSelect:function(f){
var u=this,c=u.editor,d=c.controlManager,m;
m=d.createListBox("styleselect",{
title:"advanced.style_select",onselect:function(b){
var v,p=[],g;
s(m.items,function(k){
p.push(k.value)
}
);
c.focus();
c.undoManager.add();
v=c.formatter.matchAll(p);
h.each(v,function(k){
if(!b||k==b){
if(k){
c.formatter.remove(k)
}
g=true
}}
);
if(!g){
c.formatter.apply(b)
}
c.undoManager.add();
c.nodeChanged();
return false
}}
);
c.onPreInit.add(function(){
var g=0,p=c.getParam("style_formats");
if(p){
s(p,function(b){
var v,k=0;
s(b,function(){
k++
}
);
if(k>1){
v=b.name=b.name||"style_"+(g++);
c.formatter.register(v,b);
m.add(b.title,v,{
style:function(){
return t(c,b)
}}
)
}else{
m.add(b.title)
}}
)
}else{
s(c.getParam("theme_advanced_styles","","hash"),function(q,k){
var v,b;
if(q){
v="style_"+(g++);
b={
inline:"span",classes:q,selector:"*"};
c.formatter.register(v,b);
m.add(u.editor.translate(k),v,{
style:function(){
return t(c,b)
}}
)
}}
)
}}
);
if(m.getLength()==0){
m.onPostRender.add(function(p,g){
if(!m.NativeListBox){
r.add(g.id+"_text","focus",u._importClasses,u);
r.add(g.id+"_text","mousedown",u._importClasses,u);
r.add(g.id+"_open","focus",u._importClasses,u);
r.add(g.id+"_open","mousedown",u._importClasses,u)
}else{
r.add(g.id,"focus",u._importClasses,u)
}}
)
}
return m
}
,_createFontSelect:function(){
var m,u=this,d=u.editor;
m=d.controlManager.createListBox("fontselect",{
title:"advanced.fontdefault",onselect:function(c){
var f=m.items[m.selectedIndex];
if(!c&&f){
d.execCommand("FontName",false,f.value);
return
}
d.execCommand("FontName",false,c);
m.select(function(p){
return c==p
}
);
if(f&&f.value==c){
m.select(null)
}
return false
}}
);
if(m){
s(d.getParam("theme_advanced_fonts",u.settings.theme_advanced_fonts,"hash"),function(f,c){
m.add(d.translate(c),f,{
style:f.indexOf("dings")==-1?"font-family:"+f:""}
)
}
)
}
return m
}
,_createFontSizeSelect:function(){
var f=this,u=f.editor,p,m=0,d=[];
p=u.controlManager.createListBox("fontsizeselect",{
title:"advanced.font_size",onselect:function(c){
var g=p.items[p.selectedIndex];
if(!c&&g){
g=g.value;
if(g["class"]){
u.formatter.toggle("fontsize_class",{
value:g["class"]}
);
u.undoManager.add();
u.nodeChanged()
}else{
u.execCommand("FontSize",false,g.fontSize)
}
return
}
if(c["class"]){
u.focus();
u.undoManager.add();
u.formatter.toggle("fontsize_class",{
value:c["class"]}
);
u.undoManager.add();
u.nodeChanged()
}else{
u.execCommand("FontSize",false,c.fontSize)
}
p.select(function(b){
return c==b
}
);
if(g&&(g.value.fontSize==c.fontSize||g.value["class"]&&g.value["class"]==c["class"])){
p.select(null)
}
return false
}}
);
if(p){
s(f.settings.theme_advanced_font_sizes,function(g,c){
var b=g.fontSize;
if(b>=1&&b<=7){
b=f.sizes[parseInt(b)-1]+"pt"
}
p.add(c,g,{
style:"font-size:"+b,"class":"mceFontSize"+(m++)+(" "+(g["class"]||""))}
)
}
)
}
return p
}
,_createBlockFormats:function(){
var m,d={
p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"}
,u=this;
m=u.editor.controlManager.createListBox("formatselect",{
title:"advanced.block",onselect:function(c){
u.editor.execCommand("FormatBlock",false,c);
return false
}}
);
if(m){
s(u.editor.getParam("theme_advanced_blockformats",u.settings.theme_advanced_blockformats,"hash"),function(f,c){
m.add(u.editor.translate(c!=f?c:d[f]),f,{
"class":"mce_formatPreview mce_"+f,style:function(){
return t(u.editor,{
block:f}
)
}}
)
}
)
}
return m
}
,_createForeColorMenu:function(){
var p,u=this,m=u.settings,f={}
,d;
if(m.theme_advanced_more_colors){
f.more_colors_func=function(){
u._mceColorPicker(0,{
color:p.value,func:function(c){
p.setColor(c)
}}
)
}
}
if(d=m.theme_advanced_text_colors){
f.colors=d
}
if(m.theme_advanced_default_foreground_color){
f.default_color=m.theme_advanced_default_foreground_color
}
f.title="advanced.forecolor_desc";
f.cmd="ForeColor";
f.scope=this;
p=u.editor.controlManager.createColorSplitButton("forecolor",f);
return p
}
,_createBackColorMenu:function(){
var p,u=this,m=u.settings,f={}
,d;
if(m.theme_advanced_more_colors){
f.more_colors_func=function(){
u._mceColorPicker(0,{
color:p.value,func:function(c){
p.setColor(c)
}}
)
}
}
if(d=m.theme_advanced_background_colors){
f.colors=d
}
if(m.theme_advanced_default_background_color){
f.default_color=m.theme_advanced_default_background_color
}
f.title="advanced.backcolor_desc";
f.cmd="HiliteColor";
f.scope=this;
p=u.editor.controlManager.createColorSplitButton("backcolor",f);
return p
}
,renderUI:function(u){
var f,m,g,k=this,b=k.editor,q=k.settings,v,d,c;
if(b.settings){
b.settings.aria_label=q.aria_label+b.getLang("advanced.help_shortcut")
}
f=d=l.create("span",{
role:"application","aria-labelledby":b.id+"_voice",id:b.id+"_parent","class":"mceEditor "+b.settings.skin+"Skin"+(q.skin_variant?" "+b.settings.skin+"Skin"+k._ufirst(q.skin_variant):"")+(b.settings.directionality=="rtl"?" mceRtl":"")}
);
l.add(f,"span",{
"class":"mceVoiceLabel",style:"display:none;",id:b.id+"_voice"}
,q.aria_label);
if(!l.boxModel){
f=l.add(f,"div",{
"class":"mceOldBoxModel"}
)
}
f=v=l.add(f,"table",{
role:"presentation",id:b.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0}
);
f=g=l.add(f,"tbody");
switch((q.theme_advanced_layout_manager||"").toLowerCase()){
case"rowlayout":m=k._rowLayout(q,g,u);
break;
case"customlayout":m=b.execCallback("theme_advanced_custom_layout",q,g,u,d);
break;
default:m=k._simpleLayout(q,g,u,d)
}
f=u.targetNode;
c=v.rows;
l.addClass(c[0],"mceFirst");
l.addClass(c[c.length-1],"mceLast");
s(l.select("tr",g),function(p){
l.addClass(p.firstChild,"mceFirst");
l.addClass(p.childNodes[p.childNodes.length-1],"mceLast")
}
);
if(l.get(q.theme_advanced_toolbar_container)){
l.get(q.theme_advanced_toolbar_container).appendChild(d)
}else{
l.insertAfter(d,f)
}
r.add(b.id+"_path_row","click",function(p){
p=p.target;
if(p.nodeName=="A"){
k._sel(p.className.replace(/^.*mcePath_([0-9]+).*$/,"$1"));
return false
}}
);
if(!b.getParam("accessibility_focus")){
r.add(l.add(d,"a",{
href:"#"}
,"<!-- IE -->"),"focus",function(){
tinyMCE.get(b.id).focus()
}
)
}
if(q.theme_advanced_toolbar_location=="external"){
u.deltaHeight=0
}
k.deltaHeight=u.deltaHeight;
u.targetNode=null;
b.onKeyDown.add(function(z,p){
var T=121,j=122;
if(p.altKey){
if(p.keyCode===T){
if(h.isWebKit){
window.focus()
}
k.toolbarGroup.focus();
return r.cancel(p)
}else{
if(p.keyCode===j){
l.get(z.id+"_path_row").focus();
return r.cancel(p)
}}}}
);
b.addShortcut("alt+0","","mceShortcuts",k);
return{
iframeContainer:m,editorContainer:b.id+"_parent",sizeContainer:v,deltaHeight:u.deltaHeight}
}
,getInfo:function(){
return{
longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:h.majorVersion+"."+h.minorVersion}
}
,resizeBy:function(c,d){
var u=l.get(this.editor.id+"_ifr");
this.resizeTo(u.clientWidth+c,u.clientHeight+d)
}
,resizeTo:function(c,f,u){
var d=this.editor,m=this.settings,p=l.get(d.id+"_tbl"),g=l.get(d.id+"_ifr");
c=Math.max(m.theme_advanced_resizing_min_width||100,c);
f=Math.max(m.theme_advanced_resizing_min_height||100,f);
c=Math.min(m.theme_advanced_resizing_max_width||65535,c);
f=Math.min(m.theme_advanced_resizing_max_height||65535,f);
l.setStyle(p,"height","");
l.setStyle(g,"height",f);
if(m.theme_advanced_resize_horizontal){
l.setStyle(p,"width","");
l.setStyle(g,"width",c);
if(c<p.clientWidth){
c=p.clientWidth;
l.setStyle(g,"width",p.clientWidth)
}}
if(u&&m.theme_advanced_resizing_use_cookie){
e.setHash("TinyMCE_"+d.id+"_size",{
cw:c,ch:f}
)
}}
,destroy:function(){
var c=this.editor.id;
r.clear(c+"_resize");
r.clear(c+"_path_row");
r.clear(c+"_external_close")
}
,_simpleLayout:function(T,v,m,d){
var z=this,k=z.editor,q=T.theme_advanced_toolbar_location,g=T.theme_advanced_statusbar_location,f,u,b,j;
if(T.readonly){
f=l.add(v,"tr");
f=u=l.add(f,"td",{
"class":"mceIframeContainer"}
);
return u
}
if(q=="top"){
z._addToolbars(v,m)
}
if(q=="external"){
f=j=l.create("div",{
style:"position:relative"}
);
f=l.add(f,"div",{
id:k.id+"_external","class":"mceExternalToolbar"}
);
l.add(f,"a",{
id:k.id+"_external_close",href:"javascript:;","class":"mceExternalClose"}
);
f=l.add(f,"table",{
id:k.id+"_tblext",cellSpacing:0,cellPadding:0}
);
b=l.add(f,"tbody");
if(d.firstChild.className=="mceOldBoxModel"){
d.firstChild.appendChild(j)
}else{
d.insertBefore(j,d.firstChild)
}
z._addToolbars(b,m);
k.onMouseUp.add(function(){
var p=l.get(k.id+"_external");
l.show(p);
l.hide(n);
var c=r.add(k.id+"_external_close","click",function(){
l.hide(k.id+"_external");
r.remove(k.id+"_external_close","click",c)
}
);
l.show(p);
l.setStyle(p,"top",0-l.getRect(k.id+"_tblext").h-1);
l.hide(p);
l.show(p);
p.style.filter="";
n=k.id+"_external";
p=null
}
)
}
if(g=="top"){
z._addStatusBar(v,m)
}
if(!T.theme_advanced_toolbar_container){
f=l.add(v,"tr");
f=u=l.add(f,"td",{
"class":"mceIframeContainer"}
)
}
if(q=="bottom"){
z._addToolbars(v,m)
}
if(g=="bottom"){
z._addStatusBar(v,m)
}
return u
}
,_rowLayout:function(q,f,u){
var k=this,p=k.editor,v,j,c=p.controlManager,m,d,b,g;
v=q.theme_advanced_containers_default_class||"";
j=q.theme_advanced_containers_default_align||"center";
s(o(q.theme_advanced_containers||""),function(O,T){
var z=q["theme_advanced_container_"+O]||"";
switch(O.toLowerCase()){
case"mceeditor":m=l.add(f,"tr");
m=d=l.add(m,"td",{
"class":"mceIframeContainer"}
);
break;
case"mceelementpath":k._addStatusBar(f,u);
break;
default:g=(q["theme_advanced_container_"+O+"_align"]||j).toLowerCase();
g="mce"+k._ufirst(g);
m=l.add(l.add(f,"tr"),"td",{
"class":"mceToolbar "+(q["theme_advanced_container_"+O+"_class"]||v)+" "+g||j}
);
b=c.createToolbar("toolbar"+T);
k._addControls(z,b);
l.setHTML(m,b.renderHTML());
u.deltaHeight-=q.theme_advanced_row_height
}}
);
return d
}
,_addControls:function(d,c){
var u=this,m=u.settings,f,p=u.editor.controlManager;
if(m.theme_advanced_disable&&!u._disabled){
f={};
s(o(m.theme_advanced_disable),function(g){
f[g]=1
}
);
u._disabled=f
}else{
f=u._disabled
}
s(o(d),function(b){
var g;
if(f&&f[b]){
return
}
if(b=="tablecontrols"){
s(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(v){
v=u.createControl(v,p);
if(v){
c.add(v)
}}
);
return
}
g=u.createControl(b,p);
if(g){
c.add(g)
}}
)
}
,_addToolbars:function(z,u){
var A=this,g,p,k=A.editor,W=A.settings,O,d=k.controlManager,q,m,b=[],T,j,f=false;
j=d.createToolbarGroup("toolbargroup",{
name:k.getLang("advanced.toolbar"),tab_focus_toolbar:k.getParam("theme_advanced_tab_focus_toolbar")}
);
A.toolbarGroup=j;
T=W.theme_advanced_toolbar_align.toLowerCase();
T="mce"+A._ufirst(T);
m=l.add(l.add(z,"tr",{
role:"presentation"}
),"td",{
"class":"mceToolbar "+T,role:"presentation"}
);
for(g=1;
(O=W["theme_advanced_buttons"+g]);
g++){
f=true;
p=d.createToolbar("toolbar"+g,{
"class":"mceToolbarRow"+g}
);
if(W["theme_advanced_buttons"+g+"_add"]){
O+=","+W["theme_advanced_buttons"+g+"_add"]
}
if(W["theme_advanced_buttons"+g+"_add_before"]){
O=W["theme_advanced_buttons"+g+"_add_before"]+","+O
}
A._addControls(O,p);
j.add(p);
u.deltaHeight-=W.theme_advanced_row_height
}
if(!f){
u.deltaHeight-=W.theme_advanced_row_height
}
b.push(j.renderHTML());
b.push(l.createHTML("a",{
href:"#",accesskey:"z",title:k.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+k.id+"').focus();"}
,"<!-- IE -->"));
l.setHTML(m,b.join(""))
}
,_addStatusBar:function(f,d){
var u,v=this,p=v.editor,k=v.settings,c,g,b,m;
u=l.add(f,"tr");
u=m=l.add(u,"td",{
"class":"mceStatusbar"}
);
u=l.add(u,"div",{
id:p.id+"_path_row",role:"group","aria-labelledby":p.id+"_path_voice"}
);
if(k.theme_advanced_path){
l.add(u,"span",{
id:p.id+"_path_voice"}
,p.translate("advanced.path"));
l.add(u,"span",{}
,": ")
}else{
l.add(u,"span",{}
,"&#160;")
}
if(k.theme_advanced_resizing){
l.add(m,"a",{
id:p.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize",tabIndex:"-1"}
);
if(k.theme_advanced_resizing_use_cookie){
p.onPostRender.add(function(){
var q=e.getHash("TinyMCE_"+p.id+"_size"),j=l.get(p.id+"_tbl");
if(!q){
return
}
v.resizeTo(q.cw,q.ch)
}
)
}
p.onPostRender.add(function(){
r.add(p.id+"_resize","click",function(q){
q.preventDefault()
}
);
r.add(p.id+"_resize","mousedown",function(F){
var O,z,T,j,S,B,C,R,q,M,A;
function W(H){
H.preventDefault();
q=C+(H.screenX-S);
M=R+(H.screenY-B);
v.resizeTo(q,M)
}
function D(H){
r.remove(l.doc,"mousemove",O);
r.remove(p.getDoc(),"mousemove",z);
r.remove(l.doc,"mouseup",T);
r.remove(p.getDoc(),"mouseup",j);
q=C+(H.screenX-S);
M=R+(H.screenY-B);
v.resizeTo(q,M,true)
}
F.preventDefault();
S=F.screenX;
B=F.screenY;
A=l.get(v.editor.id+"_ifr");
C=q=A.clientWidth;
R=M=A.clientHeight;
O=r.add(l.doc,"mousemove",W);
z=r.add(p.getDoc(),"mousemove",W);
T=r.add(l.doc,"mouseup",D);
j=r.add(p.getDoc(),"mouseup",D)
}
)
}
)
}
d.deltaHeight-=21;
u=f=null
}
,_updateUndoStatus:function(d){
var c=d.controlManager,u=d.undoManager;
c.setDisabled("undo",!u.hasUndo()&&!u.typing);
c.setDisabled("redo",!u.hasRedo())
}
,_nodeChanged:function(g,q,D,k,S){
var O=this,C,F=0,T,M,A=O.settings,z,m,j,B,f,u,d;
h.each(O.stateControls,function(p){
q.setActive(p,g.queryCommandState(O.controls[p][1]))
}
);
function b(p){
var v,c=S.parents,R=p;
if(typeof(p)=="string"){
R=function(H){
return H.nodeName==p
}
}
for(v=0;
v<c.length;
v++){
if(R(c[v])){
return c[v]
}}}
q.setActive("visualaid",g.hasVisual);
O._updateUndoStatus(g);
q.setDisabled("outdent",!g.queryCommandState("Outdent"));
C=b("A");
if(M=q.get("link")){
M.setDisabled((!C&&k)||(C&&!C.href));
M.setActive(!!C&&(!C.name&&!C.id))
}
if(M=q.get("unlink")){
M.setDisabled(!C&&k);
M.setActive(!!C&&!C.name&&!C.id)
}
if(M=q.get("anchor")){
M.setActive(!k&&!!C&&(C.name||(C.id&&!C.href)))
}
C=b("IMG");
if(M=q.get("image")){
M.setActive(!k&&!!C&&D.className.indexOf("mceItem")==-1)
}
if(M=q.get("styleselect")){
O._importClasses();
u=[];
s(M.items,function(c){
u.push(c.value)
}
);
d=g.formatter.matchAll(u);
M.select(d[0]);
h.each(d,function(p,c){
if(c>0){
M.mark(p)
}}
)
}
if(M=q.get("formatselect")){
C=b(g.dom.isBlock);
if(C){
M.select(C.nodeName.toLowerCase())
}}
b(function(c){
if(c.nodeName==="SPAN"){
if(!z&&c.className){
z=c.className
}}
if(g.dom.is(c,A.theme_advanced_font_selector)){
if(!m&&c.style.fontSize){
m=c.style.fontSize
}
if(!j&&c.style.fontFamily){
j=c.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()
}
if(!B&&c.style.color){
B=c.style.color
}
if(!f&&c.style.backgroundColor){
f=c.style.backgroundColor
}}
return false
}
);
if(M=q.get("fontselect")){
M.select(function(c){
return c.replace(/^([^,]+).*/,"$1").toLowerCase()==j
}
)
}
if(M=q.get("fontsizeselect")){
if(A.theme_advanced_runtime_fontsize&&!m&&!z){
m=g.dom.getStyle(D,"fontSize",true)
}
M.select(function(c){
if(c.fontSize&&c.fontSize===m){
return true
}
if(c["class"]&&c["class"]===z){
return true
}}
)
}
if(A.theme_advanced_show_current_color){
function W(p,c){
if(M=q.get(p)){
if(!c){
c=M.settings.default_color
}
if(c!==M.value){
M.displayColor(c)
}}}
W("forecolor",B);
W("backcolor",f)
}
if(A.theme_advanced_show_current_color){
function W(p,c){
if(M=q.get(p)){
if(!c){
c=M.settings.default_color
}
if(c!==M.value){
M.displayColor(c)
}}}
W("forecolor",B);
W("backcolor",f)
}
if(A.theme_advanced_path&&A.theme_advanced_statusbar_location){
C=l.get(g.id+"_path")||l.add(g.id+"_path_row","span",{
id:g.id+"_path"}
);
if(O.statusKeyboardNavigation){
O.statusKeyboardNavigation.destroy();
O.statusKeyboardNavigation=null
}
l.setHTML(C,"");
b(function(H){
var c=H.nodeName.toLowerCase(),p,R,v="";
if(H.nodeType!=1||c==="br"||H.getAttribute("data-mce-bogus")||l.hasClass(H,"mceItemHidden")||l.hasClass(H,"mceItemRemoved")){
return
}
if(h.isIE&&H.scopeName!=="HTML"&&H.scopeName){
c=H.scopeName+":"+c
}
c=c.replace(/mce\:/g,"");
switch(c){
case"b":c="strong";
break;
case"i":c="em";
break;
case"img":if(T=l.getAttrib(H,"src")){
v+="src: "+T+" "
}
break;
case"a":if(T=l.getAttrib(H,"name")){
v+="name: "+T+" ";
c+="#"+T
}
if(T=l.getAttrib(H,"href")){
v+="href: "+T+" "
}
break;
case"font":if(T=l.getAttrib(H,"face")){
v+="font: "+T+" "
}
if(T=l.getAttrib(H,"size")){
v+="size: "+T+" "
}
if(T=l.getAttrib(H,"color")){
v+="color: "+T+" "
}
break;
case"span":if(T=l.getAttrib(H,"style")){
v+="style: "+T+" "
}
break
}
if(T=l.getAttrib(H,"id")){
v+="id: "+T+" "
}
if(T=H.className){
T=T.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");
if(T){
v+="class: "+T+" ";
if(g.dom.isBlock(H)||c=="img"||c=="span"){
c+="."+T
}}}
c=c.replace(/(html:)/g,"");
c={
name:c,node:H,title:v};
O.onResolveName.dispatch(O,c);
v=c.title;
c=c.name;
R=l.create("a",{
href:"javascript:;",role:"button",onmousedown:"return false;",title:v,"class":"mcePath_"+(F++)}
,c);
if(C.hasChildNodes()){
C.insertBefore(l.create("span",{
"aria-hidden":"true"}
,"\u00a0\u00bb "),C.firstChild);
C.insertBefore(R,C.firstChild)
}else{
C.appendChild(R)
}}
,g.getBody());
if(l.select("a",C).length>0){
O.statusKeyboardNavigation=new h.ui.KeyboardNavigation({
root:g.id+"_path_row",items:l.select("a",C),excludeFromTabOrder:true,onCancel:function(){
g.focus()
}}
,l)
}}}
,_sel:function(c){
this.editor.execCommand("mceSelectNodeDepth",false,c)
}
,_mceInsertAnchor:function(u,d){
var c=this.editor;
c.windowManager.open({
url:this.url+"/anchor.htm",width:320+parseInt(c.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(c.getLang("advanced.anchor_delta_height",0)),inline:true}
,{
theme_url:this.url}
)
}
,_mceCharMap:function(){
var c=this.editor;
c.windowManager.open({
url:this.url+"/charmap.htm",width:550+parseInt(c.getLang("advanced.charmap_delta_width",0)),height:265+parseInt(c.getLang("advanced.charmap_delta_height",0)),inline:true}
,{
theme_url:this.url}
)
}
,_mceHelp:function(){
var c=this.editor;
c.windowManager.open({
url:this.url+"/about.htm",width:480,height:380,inline:true}
,{
theme_url:this.url}
)
}
,_mceShortcuts:function(){
var c=this.editor;
c.windowManager.open({
url:this.url+"/shortcuts.htm",width:480,height:380,inline:true}
,{
theme_url:this.url}
)
}
,_mceColorPicker:function(m,d){
var c=this.editor;
d=d||{};
c.windowManager.open({
url:this.url+"/color_picker.htm",width:375+parseInt(c.getLang("advanced.colorpicker_delta_width",0)),height:250+parseInt(c.getLang("advanced.colorpicker_delta_height",0)),close_previous:false,inline:true}
,{
input_color:d.color,func:d.func,theme_url:this.url}
)
}
,_mceCodeEditor:function(d,u){
var c=this.editor;
c.windowManager.open({
url:this.url+"/source_editor.htm",width:parseInt(c.getParam("theme_advanced_source_editor_width",720)),height:parseInt(c.getParam("theme_advanced_source_editor_height",580)),inline:true,resizable:true,maximizable:true}
,{
theme_url:this.url}
)
}
,_mceImage:function(d,u){
var c=this.editor;
if(c.dom.getAttrib(c.selection.getNode(),"class","").indexOf("mceItem")!=-1){
return
}
c.windowManager.open({
url:this.url+"/image.htm",width:355+parseInt(c.getLang("advanced.image_delta_width",0)),height:275+parseInt(c.getLang("advanced.image_delta_height",0)),inline:true}
,{
theme_url:this.url}
)
}
,_mceLink:function(d,u){
var c=this.editor;
c.windowManager.open({
url:this.url+"/link.htm",width:310+parseInt(c.getLang("advanced.link_delta_width",0)),height:200+parseInt(c.getLang("advanced.link_delta_height",0)),inline:true}
,{
theme_url:this.url}
)
}
,_mceNewDocument:function(){
var c=this.editor;
c.windowManager.confirm("advanced.newdocument",function(d){
if(d){
c.execCommand("mceSetContent",false,"")
}}
)
}
,_mceForeColor:function(){
var c=this;
this._mceColorPicker(0,{
color:c.fgColor,func:function(d){
c.fgColor=d;
c.editor.execCommand("ForeColor",false,d)
}}
)
}
,_mceBackColor:function(){
var c=this;
this._mceColorPicker(0,{
color:c.bgColor,func:function(d){
c.bgColor=d;
c.editor.execCommand("HiliteColor",false,d)
}}
)
}
,_ufirst:function(c){
return c.substring(0,1).toUpperCase()+c.substring(1)
}}
);
h.ThemeManager.add("advanced",h.themes.AdvancedTheme)
}
(tinymce))
}
if(AjxPackage.define("ajax.3rdparty.tinymce.themes.advanced.Zmeditor_template")){
Zmeditor_template=function(){};
Zmeditor_template.getFontSize=function(e){
if(!e){
return
}
e=(e+"").toLowerCase();
if(e.indexOf("px")!==-1){
e=e.replace("px","");
if(e<12){
return"xx-small"
}else{
if(e>=12&&e<15){
return"x-small"
}else{
if(e>=15&&e<17){
return"small"
}else{
if(e>=17&&e<23){
return"medium"
}else{
if(e>=23&&e<28){
return"large"
}else{
if(e>=28&&e<37){
return"x-large"
}else{
return"xx-large"
}}}}}}}else{
if(e.indexOf("pt")!==-1){
e=e.replace("pt","");
if(e<9){
return"xx-small"
}else{
if(e>=9&&e<11){
return"x-small"
}else{
if(e>=11&&e<13){
return"small"
}else{
if(e>=13&&e<17){
return"medium"
}else{
if(e>=17&&e<22){
return"large"
}else{
if(e>=22&&e<30){
return"x-large"
}else{
return"xx-large"
}}}}}}}}
return({
1:"xx-small",2:"x-small",3:"small",4:"medium",5:"large",6:"x-large",7:"xx-large"}
)[e]||e
};
(function(n){
var h={
_nodeChanged:function(b,j,F,q,M){
var W=this,S,I=0,A,Y,B=W.settings,T,m,z,D,g,u,d,H=n.DOM,f=n.each,E=b.getDoc(),O=E.body;
n.each(W.stateControls,function(p){
j.setActive(p,b.queryCommandState(W.controls[p][1]))
}
);
function k(p){
var v,c=M.parents,G=p;
if(typeof(p)=="string"){
G=function(L){
return L.nodeName==p
}
}
for(v=0;
v<c.length;
v++){
if(G(c[v])){
return c[v]
}}}
j.setActive("visualaid",b.hasVisual);
W._updateUndoStatus(b);
j.setDisabled("outdent",!b.queryCommandState("Outdent"));
S=k("A");
if(Y=j.get("link")){
if(!S||!S.name){
Y.setDisabled(!S&&q);
Y.setActive(!!S)
}}
if(Y=j.get("unlink")){
Y.setDisabled(!S&&q);
Y.setActive(!!S&&!S.name)
}
if(Y=j.get("anchor")){
Y.setActive(!q&&!!S&&S.name)
}
S=k("IMG");
if(Y=j.get("image")){
Y.setActive(!q&&!!S&&F.className.indexOf("mceItem")==-1)
}
if(Y=j.get("styleselect")){
W._importClasses();
u=[];
f(Y.items,function(c){
u.push(c.value)
}
);
d=b.formatter.matchAll(u);
Y.select(d[0])
}
if(Y=j.get("formatselect")){
S=k(H.isBlock);
if(S){
Y.select(S.nodeName.toLowerCase())
}}
k(function(c){
if(c.nodeName==="SPAN"){
if(!T&&c.className){
T=c.className
}}
if(!m&&(c.style.fontSize||c.size)){
m=c.style.fontSize||c.size
}
if(!z&&(c.style.fontFamily||c.face)){
z=(c.style.fontFamily||c.face).replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()
}
if(!D&&c.style.color){
D=c.style.color
}
if(!g&&c.style.backgroundColor){
g=c.style.backgroundColor
}
return false
}
);
if(Y=j.get("fontselect")){
if(!z){
try{
z=E.queryCommandValue("fontname")
}
catch(R){}}
z=z||O.style.fontFamily;
if(z){
z=z.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()
}
Y.select(function(c){
return c.replace(/^([^,]+).*/,"$1").toLowerCase()==z
}
)
}
if(Y=j.get("fontsizeselect")){
if(!m){
try{
m=E.queryCommandValue("fontsize")
}
catch(R){}}
m=m||O.style.fontSize;
if(m){
m=Zmeditor_template.getFontSize(m)
}
Y.select(function(c){
if(c.fontSize&&c.fontSize===m){
return true
}
if(c["class"]&&c["class"]===T){
return true
}}
)
}
if(B.theme_advanced_show_current_color){
function C(p,c){
if(Y=j.get(p)){
if(!c){
c=Y.settings.default_color
}
if(c!==Y.value){
Y.displayColor(c)
}}}
if(n.isIE){
if(!D){
D=b.getDoc().queryCommandValue("forecolor");
if(D){
D="rgb("+(D&255)+","+((D>>8)&255)+","+((D>>16)&255)+")"
}}
if(!g){
g=b.getDoc().queryCommandValue("backcolor");
if(g){
g="rgb("+(g&255)+","+((g>>8)&255)+","+((g>>16)&255)+")"
}}}else{
if(!D){
try{
D=E.queryCommandValue("forecolor")
}
catch(R){}}
D=D||O.style.color;
if(!g){
try{
g=E.queryCommandValue("backcolor")
}
catch(R){}}
g=g||"white"
}
C("forecolor",D);
C("backcolor",g)
}
if(B.theme_advanced_path&&B.theme_advanced_statusbar_location){
S=H.get(b.id+"_path")||H.add(b.id+"_path_row","span",{
id:b.id+"_path"}
);
if(W.statusKeyboardNavigation){
W.statusKeyboardNavigation.destroy();
W.statusKeyboardNavigation=null
}
H.setHTML(S,"");
k(function(L){
var c=L.nodeName.toLowerCase(),p,G,v="";
if(L.nodeType!=1||c==="br"||L.getAttribute("data-mce-bogus")||H.hasClass(L,"mceItemHidden")||H.hasClass(L,"mceItemRemoved")){
return
}
if(n.isIE&&L.scopeName!=="HTML"){
c=L.scopeName+":"+c
}
c=c.replace(/mce\:/g,"");
switch(c){
case"b":c="strong";
break;
case"i":c="em";
break;
case"img":if(A=H.getAttrib(L,"src")){
v+="src: "+A+" "
}
break;
case"a":if(A=H.getAttrib(L,"name")){
v+="name: "+A+" ";
c+="#"+A
}
if(A=H.getAttrib(L,"href")){
v+="href: "+A+" "
}
break;
case"font":if(A=H.getAttrib(L,"face")){
v+="font: "+A+" "
}
if(A=H.getAttrib(L,"size")){
v+="size: "+A+" "
}
if(A=H.getAttrib(L,"color")){
v+="color: "+A+" "
}
break;
case"span":if(A=H.getAttrib(L,"style")){
v+="style: "+A+" "
}
break
}
if(A=H.getAttrib(L,"id")){
v+="id: "+A+" "
}
if(A=L.className){
A=A.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");
if(A){
v+="class: "+A+" ";
if(H.isBlock(L)||c=="img"||c=="span"){
c+="."+A
}}}
c=c.replace(/(html:)/g,"");
c={
name:c,node:L,title:v};
W.onResolveName.dispatch(W,c);
v=c.title;
c=c.name;
G=H.create("a",{
href:"javascript:;",role:"button",onmousedown:"return false;",title:v,"class":"mcePath_"+(I++)}
,c);
if(S.hasChildNodes()){
S.insertBefore(H.create("span",{
"aria-hidden":"true"}
,"\u00a0\u00bb "),S.firstChild);
S.insertBefore(G,S.firstChild)
}else{
S.appendChild(G)
}}
,b.getBody());
if(H.select("a",S).length>0){
W.statusKeyboardNavigation=new n.ui.KeyboardNavigation({
root:b.id+"_path_row",items:H.select("a",S),excludeFromTabOrder:true,onCancel:function(){
b.focus()
}}
,H)
}}}};
n.extend(n.themes.AdvancedTheme.prototype,h);
n.extend(n.dom.DOMUtils.prototype,{
uniqueId:function(c){
var d=(!c?"mce_":c)+this.counter++;
if(document.getElementById(d)){
return this.uniqueId(c)
}
return d
}}
);
n.extend(n.Editor.prototype,{
saveHTML:function(){
var c=this.getElement();
if(c&&c.nodeName==="TEXTAREA"){
c.value=this.getContent()
}}}
);
var e=n.ScriptLoader,o;
if(e&&e.load&&typeof ZmAdvancedHtmlEditor!=="undefined"){
o=ZmAdvancedHtmlEditor.LOCALE;
if(o&&o!=="en"){
e.load("../js/ajax/3rdparty/tinymce/themes/advanced/langs/"+o+".js")
}}
n.create("tinymce.plugins.onEditorEvent",{
init:function(c){
c.onBeforeSetContent.add(function(d,u){
u.content=u.content.replace(/<br><br>/ig,"<br><div><br></div>")
}
)
}}
);
n.PluginManager.add("zimbraplugin",n.plugins.onEditorEvent);
if(typeof ZmAdvancedHtmlEditor!=="undefined"){
var l=n.ui,r=l.DropMenu.prototype,t=l.ColorSplitButton.prototype,s,a;
s=function(){
this.defaultShowMenu.apply(this,arguments);
ZmAdvancedHtmlEditor.onShowMenu(this)
};
a=function(){
this.defaultHideMenu.apply(this,arguments);
ZmAdvancedHtmlEditor.onHideMenu(this)
};
n.extend(r,{
defaultShowMenu:r.showMenu,defaultHideMenu:r.hideMenu,showMenu:s,hideMenu:a}
);
n.extend(t,{
defaultShowMenu:t.showMenu,defaultHideMenu:t.hideMenu,showMenu:s,hideMenu:a}
)
}}
(tinymce))
}
if(AjxPackage.define("ajax.3rdparty.tinymce.langs.en")){
tinyMCE.addI18n({
en:{
common:{
more_colors:"More Colors...",invalid_data:"Error: Invalid values entered, these are marked in red.",popup_blocked:"Sorry, but we have noticed that your popup-blocker has disabled a window that provides application functionality. You will need to disable popup blocking on this site in order to fully utilize this tool.",clipboard_no_support:"Currently not supported by your browser, use keyboard shortcuts instead.",clipboard_msg:"Copy/Cut/Paste is not available in Mozilla and Firefox.\nDo you want more information about this issue?",not_set:"-- Not Set --",class_name:"Class",browse:"Browse",close:"Close",cancel:"Cancel",update:"Update",insert:"Insert",apply:"Apply",edit_confirm:"Do you want to use the WYSIWYG mode for this textarea?",invalid_data_number:"{#field} must be a number",invalid_data_min:"{#field} must be a number greater than {#min}",invalid_data_size:"{#field} must be a number or percentage",value:"(value)"}
,contextmenu:{
full:"Full",right:"Right",center:"Center",left:"Left",align:"Alignment"}
,insertdatetime:{
day_short:"Sun,Mon,Tue,Wed,Thu,Fri,Sat,Sun",day_long:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday",months_short:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",months_long:"January,February,March,April,May,June,July,August,September,October,November,December",inserttime_desc:"Insert Time",insertdate_desc:"Insert Date",time_fmt:"%H:%M:%S",date_fmt:"%Y-%m-%d"}
,print:{
print_desc:"Print"}
,preview:{
preview_desc:"Preview"}
,directionality:{
rtl_desc:"Direction Right to Left",ltr_desc:"Direction Left to Right"}
,layer:{
content:"New layer...",absolute_desc:"Toggle Absolute Positioning",backward_desc:"Move Backward",forward_desc:"Move Forward",insertlayer_desc:"Insert New Layer"}
,save:{
save_desc:"Save",cancel_desc:"Cancel All Changes"}
,nonbreaking:{
nonbreaking_desc:"Insert Non-Breaking Space Character"}
,iespell:{
download:"ieSpell not detected. Do you want to install it now?",iespell_desc:"Check Spelling"}
,advhr:{
delta_height:"",delta_width:"",advhr_desc:"Insert Horizontal Line"}
,emotions:{
delta_height:"",delta_width:"",emotions_desc:"Emotions"}
,searchreplace:{
replace_desc:"Find/Replace",delta_width:"",delta_height:"",search_desc:"Find"}
,advimage:{
delta_width:"",image_desc:"Insert/Edit Image",delta_height:""}
,advlink:{
delta_height:"",delta_width:"",link_desc:"Insert/Edit Link"}
,xhtmlxtras:{
attribs_delta_height:"",attribs_delta_width:"",ins_delta_height:"",ins_delta_width:"",del_delta_height:"",del_delta_width:"",acronym_delta_height:"",acronym_delta_width:"",abbr_delta_height:"",abbr_delta_width:"",cite_delta_height:"",cite_delta_width:"",attribs_desc:"Insert/Edit Attributes",ins_desc:"Insertion",del_desc:"Deletion",acronym_desc:"Acronym",abbr_desc:"Abbreviation",cite_desc:"Citation"}
,style:{
delta_height:"",delta_width:"",desc:"Edit CSS Style"}
,paste:{
plaintext_mode:"Paste is now in plain text mode. Click again to toggle back to regular paste mode.",plaintext_mode_sticky:"Paste is now in plain text mode. Click again to toggle back to regular paste mode. After you paste something you will be returned to regular paste mode.",selectall_desc:"Select All",paste_word_desc:"Paste from Word",paste_text_desc:"Paste as Plain Text"}
,paste_dlg:{
word_title:"Use Ctrl+V on your keyboard to paste the text into the window.",text_linebreaks:"Keep Linebreaks",text_title:"Use Ctrl+V on your keyboard to paste the text into the window."}
,table:{
merge_cells_delta_height:"",merge_cells_delta_width:"",table_delta_height:"",table_delta_width:"",cellprops_delta_height:"",cellprops_delta_width:"",rowprops_delta_height:"",rowprops_delta_width:"",cell:"Cell",col:"Column",row:"Row",del:"Delete Table",copy_row_desc:"Copy Table Row",cut_row_desc:"Cut Table Row",paste_row_after_desc:"Paste Table Row After",paste_row_before_desc:"Paste Table Row Before",props_desc:"Table Properties",cell_desc:"Table Cell Properties",row_desc:"Table Row Properties",merge_cells_desc:"Merge Table Cells",split_cells_desc:"Split Merged Table Cells",delete_col_desc:"Delete Column",col_after_desc:"Insert Column After",col_before_desc:"Insert Column Before",delete_row_desc:"Delete Row",row_after_desc:"Insert Row After",row_before_desc:"Insert Row Before",desc:"Insert/Edit Table"}
,autosave:{
warning_message:"If you restore the saved content, you will lose all the content that is currently in the editor.\n\nAre you sure you want to restore the saved content?",restore_content:"Restore auto-saved content.",unload_msg:"The changes you made will be lost if you navigate away from this page."}
,fullscreen:{
desc:"Toggle Full Screen Mode"}
,media:{
delta_height:"",delta_width:"",edit:"Edit Embedded Media",desc:"Insert/Edit Embedded Media"}
,fullpage:{
desc:"Document Properties",delta_width:"",delta_height:""}
,template:{
desc:"Insert Predefined Template Content"}
,visualchars:{
desc:"Show/Hide Visual Control Characters"}
,spellchecker:{
desc:"Toggle Spell Checker",menu:"Spell Checker Settings",ignore_word:"Ignore Word",ignore_words:"Ignore All",langs:"Languages",wait:"Please wait...",sug:"Suggestions",no_sug:"No Suggestions",no_mpell:"No misspellings found.",learn_word:"Learn word"}
,pagebreak:{
desc:"Insert Page Break for Printing"}
,advlist:{
types:"Types",def:"Default",lower_alpha:"Lower Alpha",lower_greek:"Lower Greek",lower_roman:"Lower Roman",upper_alpha:"Upper Alpha",upper_roman:"Upper Roman",circle:"Circle",disc:"Disc",square:"Square"}
,colors:{
"333300":"Dark olive","993300":"Burnt orange","000000":"Black","003300":"Dark green","003366":"Dark azure","000080":"Navy Blue","333399":"Indigo","333333":"Very dark gray","800000":"Maroon",FF6600:"Orange","808000":"Olive","008000":"Green","008080":"Teal","0000FF":"Blue","666699":"Grayish blue","808080":"Gray",FF0000:"Red",FF9900:"Amber","99CC00":"Yellow green","339966":"Sea green","33CCCC":"Turquoise","3366FF":"Royal blue","800080":"Purple","999999":"Medium gray",FF00FF:"Magenta",FFCC00:"Gold",FFFF00:"Yellow","00FF00":"Lime","00FFFF":"Aqua","00CCFF":"Sky blue","993366":"Brown",C0C0C0:"Silver",FF99CC:"Pink",FFCC99:"Peach",FFFF99:"Light yellow",CCFFCC:"Pale green",CCFFFF:"Pale cyan","99CCFF":"Light sky blue",CC99FF:"Plum",FFFFFF:"White"}
,aria:{
rich_text_area:"Rich Text Area"}
,wordcount:{
words:"Words:"}}}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.themes.advanced.langs.en")){
tinyMCE.addI18n("en.advanced",{
underline_desc:"Underline (Ctrl+U)",italic_desc:"Italic (Ctrl+I)",bold_desc:"Bold (Ctrl+B)",dd:"Definition Description",dt:"Definition Term ",samp:"Code Sample",code:"Code",blockquote:"Block Quote",h6:"Heading 6",h5:"Heading 5",h4:"Heading 4",h3:"Heading 3",h2:"Heading 2",h1:"Heading 1",pre:"Preformatted",address:"Address",div:"DIV",paragraph:"Paragraph",block:"Format",fontdefault:"Font Family",font_size:"Font Size",style_select:"Styles",anchor_delta_height:"",anchor_delta_width:"",charmap_delta_height:"",charmap_delta_width:"",colorpicker_delta_height:"",colorpicker_delta_width:"",link_delta_height:"",link_delta_width:"",image_delta_height:"",image_delta_width:"",more_colors:"More Colors...",toolbar_focus:"Jump to tool buttons - Alt+Q, Jump to editor - Alt-Z, Jump to element path - Alt-X",newdocument:"Are you sure you want clear all contents?",path:"Path",clipboard_msg:"Copy/Cut/Paste is not available in Mozilla and Firefox.\nDo you want more information about this issue?",blockquote_desc:"Block Quote",help_desc:"Help",newdocument_desc:"New Document",image_props_desc:"Image Properties",paste_desc:"Paste (Ctrl+V)",copy_desc:"Copy (Ctrl+C)",cut_desc:"Cut (Ctrl+X)",anchor_desc:"Insert/Edit Anchor",visualaid_desc:"show/Hide Guidelines/Invisible Elements",charmap_desc:"Insert Special Character",backcolor_desc:"Select Background Color",forecolor_desc:"Select Text Color",custom1_desc:"Your Custom Description Here",removeformat_desc:"Remove Formatting",hr_desc:"Insert Horizontal Line",sup_desc:"Superscript",sub_desc:"Subscript",code_desc:"Edit HTML Source",cleanup_desc:"Cleanup Messy Code",image_desc:"Insert/Edit Image",unlink_desc:"Unlink",link_desc:"Insert/Edit Link",redo_desc:"Redo (Ctrl+Y)",undo_desc:"Undo (Ctrl+Z)",indent_desc:"Increase Indent",outdent_desc:"Decrease Indent",numlist_desc:"Insert/Remove Numbered List",bullist_desc:"Insert/Remove Bulleted List",justifyfull_desc:"Align Full",justifyright_desc:"Align Right",justifycenter_desc:"Align Center",justifyleft_desc:"Align Left",striketrough_desc:"Strikethrough",help_shortcut:"Press ALT-F10 for toolbar. Press ALT-0 for help",rich_text_area:"Rich Text Area",shortcuts_desc:"Accessability Help",toolbar:"Toolbar"}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.autolink.editor_plugin_src")){
(function(){
tinymce.create("tinymce.plugins.AutolinkPlugin",{
init:function(e,a){
var o=this;
e.onKeyDown.addToTop(function(t,n){
if(n.keyCode==13){
return o.handleEnter(t)
}}
);
if(tinyMCE.isIE){
return
}
e.onKeyPress.add(function(t,n){
if(n.which==41){
return o.handleEclipse(t)
}}
);
e.onKeyUp.add(function(t,n){
if(n.keyCode==32){
return o.handleSpacebar(t)
}}
)
}
,handleEclipse:function(e){
this.parseCurrentLine(e,-1,"(",true)
}
,handleSpacebar:function(e){
this.parseCurrentLine(e,0,"",true)
}
,handleEnter:function(e){
this.parseCurrentLine(e,-1,"",false)
}
,parseCurrentLine:function(c,o,t,h){
var e,s,a,p,u,f,l,n,d;
e=c.selection.getRng(true).cloneRange();
if(e.startOffset<5){
n=e.endContainer.previousSibling;
if(n==null){
if(e.endContainer.firstChild==null||e.endContainer.firstChild.nextSibling==null){
return
}
n=e.endContainer.firstChild.nextSibling
}
d=n.length;
e.setStart(n,d);
e.setEnd(n,d);
if(e.endOffset<5){
return
}
s=e.endOffset;
p=n
}else{
p=e.endContainer;
if(p.nodeType!=3&&p.firstChild){
while(p.nodeType!=3&&p.firstChild){
p=p.firstChild
}
if(p.nodeType!==3){
return
}
e.setStart(p,0);
e.setEnd(p,p.nodeValue.length)
}
if(e.endOffset==1){
s=2
}else{
s=e.endOffset-1-o
}}
a=s;
do{
e.setStart(p,s-2);
e.setEnd(p,s-1);
s-=1
}
while(e.toString()!=" "&&e.toString()!=""&&e.toString().charCodeAt(0)!=160&&(s-2)>=0&&e.toString()!=t);
if(e.toString()==t||e.toString().charCodeAt(0)==160){
e.setStart(p,s);
e.setEnd(p,a);
s+=1
}else{
if(e.startOffset==0){
e.setStart(p,0);
e.setEnd(p,a)
}else{
e.setStart(p,s);
e.setEnd(p,a)
}}
var f=e.toString();
if(f.charAt(f.length-1)=="."){
e.setEnd(p,a-1)
}
f=e.toString();
l=f.match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|[A-Z0-9._%+-]+@)(.+)$/i);
if(l){
if(l[1]=="www."){
l[1]="http://www."
}else{
if(/@$/.test(l[1])){
l[1]="mailto:"+l[1]
}}
u=c.selection.getBookmark();
c.selection.setRng(e);
tinyMCE.execCommand("createlink",false,l[1]+l[2]);
c.selection.moveToBookmark(u);
if(tinyMCE.isWebKit){
c.selection.collapse(false);
var m=Math.min(p.length,a+1);
e.setStart(p,m);
e.setEnd(p,m);
c.selection.setRng(e)
}}}
,getInfo:function(){
return{
longname:"Autolink",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autolink",version:tinymce.majorVersion+"."+tinymce.minorVersion}
}}
);
tinymce.PluginManager.add("autolink",tinymce.plugins.AutolinkPlugin)
}
)()
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.advlist.editor_plugin_src")){
(function(){
var e=tinymce.each;
tinymce.create("tinymce.plugins.AdvListPlugin",{
init:function(a,o){
var n=this;
n.editor=a;
function s(r){
var t=[];
e(r.split(/,/),function(h){
t.push({
title:"advlist."+(h=="default"?"def":h.replace(/-/g,"_")),styles:{
listStyleType:h=="default"?"":h}}
)
}
);
return t
}
n.numlist=a.getParam("advlist_number_styles")||s("default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman");
n.bullist=a.getParam("advlist_bullet_styles")||s("default,circle,disc,square");
if(tinymce.isIE&&/MSIE [2-7]/.test(navigator.userAgent)){
n.isIE7=true
}}
,createControl:function(n,a){
var r=this,s,c,h=r.editor;
if(n=="numlist"||n=="bullist"){
if(r[n][0].title=="advlist.def"){
c=r[n][0]
}
function o(t,u){
var d=true;
e(u.styles,function(f,m){
if(h.dom.getStyle(t,m)!=f){
d=false;
return false
}}
);
return d
}
function l(){
var d,u=h.dom,t=h.selection;
d=u.getParent(t.getNode(),"ol,ul");
if(!d||d.nodeName==(n=="bullist"?"OL":"UL")||o(d,c)){
h.execCommand(n=="bullist"?"InsertUnorderedList":"InsertOrderedList")
}
if(c){
d=u.getParent(t.getNode(),"ol,ul");
if(d){
u.setStyles(d,c.styles);
d.removeAttribute("data-mce-style")
}}
h.focus()
}
s=a.createSplitButton(n,{
title:"advanced."+n+"_desc","class":"mce_"+n,onclick:function(){
l()
}}
);
s.onRenderMenu.add(function(t,d){
d.onHideMenu.add(function(){
if(r.bookmark){
h.selection.moveToBookmark(r.bookmark);
r.bookmark=0
}}
);
d.onShowMenu.add(function(){
var f=h.dom,m=f.getParent(h.selection.getNode(),"ol,ul"),u;
if(m||c){
u=r[n];
e(d.items,function(p){
var g=true;
p.setSelected(0);
if(m&&!p.isDisabled()){
e(u,function(b){
if(b.id==p.id){
if(!o(m,b)){
g=false;
return false
}}}
);
if(g){
p.setSelected(1)
}}}
);
if(!m){
d.items[c.id].setSelected(1)
}}
h.focus();
if(tinymce.isIE){
r.bookmark=h.selection.getBookmark(1)
}}
);
d.add({
id:h.dom.uniqueId(),title:"advlist.types","class":"mceMenuItemTitle",titleItem:true}
).setDisabled(1);
e(r[n],function(u){
if(r.isIE7&&u.styles.listStyleType=="lower-greek"){
return
}
u.id=h.dom.uniqueId();
d.add({
id:u.id,title:u.title,onclick:function(){
c=u;
l()
}}
)
}
)
}
);
return s
}}
,getInfo:function(){
return{
longname:"Advanced lists",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/advlist",version:tinymce.majorVersion+"."+tinymce.minorVersion}
}}
);
tinymce.PluginManager.add("advlist",tinymce.plugins.AdvListPlugin)
}
)()
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.inlinepopups.editor_plugin_src")){
(function(){
var o=tinymce.DOM,t=tinymce.dom.Element,e=tinymce.dom.Event,n=tinymce.each,a=tinymce.is;
tinymce.create("tinymce.plugins.InlinePopups",{
init:function(s,r){
s.onBeforeRenderUI.add(function(){
s.windowManager=new tinymce.InlineWindowManager(s);
o.loadCSS(r+"/skins/"+(s.settings.inlinepopups_skin||"clearlooks2")+"/window.css")
}
)
}
,getInfo:function(){
return{
longname:"InlinePopups",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/inlinepopups",version:tinymce.majorVersion+"."+tinymce.minorVersion}
}}
);
tinymce.create("tinymce.InlineWindowManager:tinymce.WindowManager",{
InlineWindowManager:function(s){
var r=this;
r.parent(s);
r.zIndex=300000;
r.count=0;
r.windows={}
}
,open:function(q,l){
var O=this,h,c="",k=O.editor,s=0,j=0,r,m,b,v,d,z,T,g;
q=q||{};
l=l||{};
if(!q.inline){
return O.parent(q,l)
}
g=O._frontWindow();
if(g&&o.get(g.id+"_ifr")){
g.focussedElement=o.get(g.id+"_ifr").contentWindow.document.activeElement
}
if(!q.type){
O.bookmark=k.selection.getBookmark(1)
}
h=o.uniqueId();
r=o.getViewPort();
q.width=parseInt(q.width||320);
q.height=parseInt(q.height||240)+(tinymce.isIE?8:0);
q.min_width=parseInt(q.min_width||150);
q.min_height=parseInt(q.min_height||100);
q.max_width=parseInt(q.max_width||2000);
q.max_height=parseInt(q.max_height||2000);
q.left=q.left||Math.round(Math.max(r.x,r.x+(r.w/2)-(q.width/2)));
q.top=q.top||Math.round(Math.max(r.y,r.y+(r.h/2)-(q.height/2)));
q.movable=q.resizable=true;
l.mce_width=q.width;
l.mce_height=q.height;
l.mce_inline=true;
l.mce_window_id=h;
l.mce_auto_focus=q.auto_focus;
O.features=q;
O.params=l;
O.onOpen.dispatch(O,q,l);
if(q.type){
c+=" mceModal";
if(q.type){
c+=" mce"+q.type.substring(0,1).toUpperCase()+q.type.substring(1)
}
q.resizable=false
}
if(q.statusbar){
c+=" mceStatusbar"
}
if(q.resizable){
c+=" mceResizable"
}
if(q.minimizable){
c+=" mceMinimizable"
}
if(q.maximizable){
c+=" mceMaximizable"
}
if(q.movable){
c+=" mceMovable"
}
O._addAll(o.doc.body,["div",{
id:h,role:"dialog","aria-labelledby":q.type?h+"_content":h+"_title","class":(k.settings.inlinepopups_skin||"clearlooks2")+(tinymce.isIE&&window.getSelection?" ie9":""),style:"width:100px;height:100px"}
,["div",{
id:h+"_wrapper","class":"mceWrapper"+c}
,["div",{
id:h+"_top","class":"mceTop"}
,["div",{
"class":"mceLeft"}
],["div",{
"class":"mceCenter"}
],["div",{
"class":"mceRight"}
],["span",{
id:h+"_title"}
,q.title||""]],["div",{
id:h+"_middle","class":"mceMiddle"}
,["div",{
id:h+"_left","class":"mceLeft",tabindex:"0"}
],["span",{
id:h+"_content"}
],["div",{
id:h+"_right","class":"mceRight",tabindex:"0"}
]],["div",{
id:h+"_bottom","class":"mceBottom"}
,["div",{
"class":"mceLeft"}
],["div",{
"class":"mceCenter"}
],["div",{
"class":"mceRight"}
],["span",{
id:h+"_status"}
,"Content"]],["a",{
"class":"mceMove",tabindex:"-1",href:"javascript:;"}
],["a",{
"class":"mceMin",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}
],["a",{
"class":"mceMax",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}
],["a",{
"class":"mceMed",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}
],["a",{
"class":"mceClose",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}
],["a",{
id:h+"_resize_n","class":"mceResize mceResizeN",tabindex:"-1",href:"javascript:;"}
],["a",{
id:h+"_resize_s","class":"mceResize mceResizeS",tabindex:"-1",href:"javascript:;"}
],["a",{
id:h+"_resize_w","class":"mceResize mceResizeW",tabindex:"-1",href:"javascript:;"}
],["a",{
id:h+"_resize_e","class":"mceResize mceResizeE",tabindex:"-1",href:"javascript:;"}
],["a",{
id:h+"_resize_nw","class":"mceResize mceResizeNW",tabindex:"-1",href:"javascript:;"}
],["a",{
id:h+"_resize_ne","class":"mceResize mceResizeNE",tabindex:"-1",href:"javascript:;"}
],["a",{
id:h+"_resize_sw","class":"mceResize mceResizeSW",tabindex:"-1",href:"javascript:;"}
],["a",{
id:h+"_resize_se","class":"mceResize mceResizeSE",tabindex:"-1",href:"javascript:;"}
]]]);
o.setStyles(h,{
top:-10000,left:-10000}
);
if(tinymce.isGecko){
o.setStyle(h,"overflow","auto")
}
if(!q.type){
s+=o.get(h+"_left").clientWidth;
s+=o.get(h+"_right").clientWidth;
j+=o.get(h+"_top").clientHeight;
j+=o.get(h+"_bottom").clientHeight
}
o.setStyles(h,{
top:q.top,left:q.left,width:q.width+s,height:q.height+j}
);
T=q.url||q.file;
if(T){
if(tinymce.relaxedDomain){
T+=(T.indexOf("?")==-1?"?":"&")+"mce_rdomain="+tinymce.relaxedDomain
}
T=tinymce._addVer(T)
}
if(!q.type){
o.add(h+"_content","iframe",{
id:h+"_ifr",src:'javascript:""',frameBorder:0,style:"border:0;width:10px;height:10px"}
);
o.setStyles(h+"_ifr",{
width:q.width,height:q.height}
);
o.setAttrib(h+"_ifr","src",T)
}else{
o.add(h+"_wrapper","a",{
id:h+"_ok","class":"mceButton mceOk",href:"javascript:;",onmousedown:"return false;"}
,"Ok");
if(q.type=="confirm"){
o.add(h+"_wrapper","a",{
"class":"mceButton mceCancel",href:"javascript:;",onmousedown:"return false;"}
,"Cancel")
}
o.add(h+"_middle","div",{
"class":"mceIcon"}
);
o.setHTML(h+"_content",q.content.replace("\n","<br />"));
e.add(h,"keyup",function(u){
var f=27;
if(u.keyCode===f){
q.button_func(false);
return e.cancel(u)
}}
);
e.add(h,"keydown",function(u){
var p,f=9;
if(u.keyCode===f){
p=o.select("a.mceCancel",h+"_wrapper")[0];
if(p&&p!==u.target){
p.focus()
}else{
o.get(h+"_ok").focus()
}
return e.cancel(u)
}}
)
}
b=e.add(h,"mousedown",function(p){
var A=p.target,u,f;
u=O.windows[h];
O.focus(h);
if(A.nodeName=="A"||A.nodeName=="a"){
if(A.className=="mceClose"){
O.close(null,h);
return e.cancel(p)
}else{
if(A.className=="mceMax"){
u.oldPos=u.element.getXY();
u.oldSize=u.element.getSize();
f=o.getViewPort();
f.w-=2;
f.h-=2;
u.element.moveTo(f.x,f.y);
u.element.resizeTo(f.w,f.h);
o.setStyles(h+"_ifr",{
width:f.w-u.deltaWidth,height:f.h-u.deltaHeight}
);
o.addClass(h+"_wrapper","mceMaximized")
}else{
if(A.className=="mceMed"){
u.element.moveTo(u.oldPos.x,u.oldPos.y);
u.element.resizeTo(u.oldSize.w,u.oldSize.h);
u.iframeElement.resizeTo(u.oldSize.w-u.deltaWidth,u.oldSize.h-u.deltaHeight);
o.removeClass(h+"_wrapper","mceMaximized")
}else{
if(A.className=="mceMove"){
return O._startDrag(h,p,A.className)
}else{
if(o.hasClass(A,"mceResize")){
return O._startDrag(h,p,A.className.substring(13))
}}}}}}}
);
v=e.add(h,"click",function(u){
var f=u.target;
O.focus(h);
if(f.nodeName=="A"||f.nodeName=="a"){
switch(f.className){
case"mceClose":O.close(null,h);
return e.cancel(u);
case"mceButton mceOk":case"mceButton mceCancel":q.button_func(f.className=="mceButton mceOk");
return e.cancel(u)
}}}
);
e.add([h+"_left",h+"_right"],"focus",function(f){
var p=o.get(h+"_ifr");
if(p){
var u=p.contentWindow.document.body;
var A=o.select(":input:enabled,*[tabindex=0]",u);
if(f.target.id===(h+"_left")){
A[A.length-1].focus()
}else{
A[0].focus()
}}else{
o.get(h+"_ok").focus()
}}
);
z=O.windows[h]={
id:h,mousedown_func:b,click_func:v,element:new t(h,{
blocker:1,container:k.getContainer()}
),iframeElement:new t(h+"_ifr"),features:q,deltaWidth:s,deltaHeight:j};
z.iframeElement.on("focus",function(){
O.focus(h)
}
);
if(O.count==0&&O.editor.getParam("dialog_type","modal")=="modal"){
o.add(o.doc.body,"div",{
id:"mceModalBlocker","class":(O.editor.settings.inlinepopups_skin||"clearlooks2")+"_modalBlocker",style:{
zIndex:O.zIndex-1}}
);
o.show("mceModalBlocker");
o.setAttrib(o.doc.body,"aria-hidden","true")
}else{
o.setStyle("mceModalBlocker","z-index",O.zIndex-1)
}
if(tinymce.isIE6||/Firefox\/2\./.test(navigator.userAgent)||(tinymce.isIE&&!o.boxModel)){
o.setStyles("mceModalBlocker",{
position:"absolute",left:r.x,top:r.y,width:r.w-2,height:r.h-2}
)
}
o.setAttrib(h,"aria-hidden","false");
O.focus(h);
O._fixIELayout(h,1);
if(o.get(h+"_ok")){
o.get(h+"_ok").focus()
}
O.count++;
return z
}
,focus:function(h){
var r=this,s;
if(s=r.windows[h]){
s.zIndex=this.zIndex++;
s.element.setStyle("zIndex",s.zIndex);
s.element.update();
h=h+"_wrapper";
o.removeClass(r.lastId,"mceFocus");
o.addClass(h,"mceFocus");
r.lastId=h;
if(s.focussedElement){
s.focussedElement.focus()
}else{
if(o.get(h+"_ok")){
o.get(s.id+"_ok").focus()
}else{
if(o.get(s.id+"_ifr")){
o.get(s.id+"_ifr").focus()
}}}}}
,_addAll:function(c,h){
var r,d,s=this,l=tinymce.DOM;
if(a(h,"string")){
c.appendChild(l.doc.createTextNode(h))
}else{
if(h.length){
c=c.appendChild(l.create(h[0],h[1]));
for(r=2;
r<h.length;
r++){
s._addAll(c,h[r])
}}}}
,_startDrag:function(z,M,S){
var b=this,j,A,C=o.doc,s,m=b.windows[z],h=m.element,O=h.getXY(),T,v,F,r,W,q,k,c,l,f,u,g,B;
r={
x:0,y:0};
W=o.getViewPort();
W.w-=2;
W.h-=2;
c=M.screenX;
l=M.screenY;
f=u=g=B=0;
j=e.add(C,"mouseup",function(d){
e.remove(C,"mouseup",j);
e.remove(C,"mousemove",A);
if(s){
s.remove()
}
h.moveBy(f,u);
h.resizeBy(g,B);
v=h.getSize();
o.setStyles(z+"_ifr",{
width:v.w-m.deltaWidth,height:v.h-m.deltaHeight}
);
b._fixIELayout(z,1);
return e.cancel(d)
}
);
if(S!="Move"){
D()
}
function D(){
if(s){
return
}
b._fixIELayout(z,0);
o.add(C.body,"div",{
id:"mceEventBlocker","class":"mceEventBlocker "+(b.editor.settings.inlinepopups_skin||"clearlooks2"),style:{
zIndex:b.zIndex+1}}
);
if(tinymce.isIE6||(tinymce.isIE&&!o.boxModel)){
o.setStyles("mceEventBlocker",{
position:"absolute",left:W.x,top:W.y,width:W.w-2,height:W.h-2}
)
}
s=new t("mceEventBlocker");
s.update();
T=h.getXY();
v=h.getSize();
q=r.x+T.x-W.x;
k=r.y+T.y-W.y;
o.add(s.get(),"div",{
id:"mcePlaceHolder","class":"mcePlaceHolder",style:{
left:q,top:k,width:v.w,height:v.h}}
);
F=new t("mcePlaceHolder")
}
A=e.add(C,"mousemove",function(R){
var d,H,p;
D();
d=R.screenX-c;
H=R.screenY-l;
switch(S){
case"ResizeW":f=d;
g=0-d;
break;
case"ResizeE":g=d;
break;
case"ResizeN":case"ResizeNW":case"ResizeNE":if(S=="ResizeNW"){
f=d;
g=0-d
}else{
if(S=="ResizeNE"){
g=d
}}
u=H;
B=0-H;
break;
case"ResizeS":case"ResizeSW":case"ResizeSE":if(S=="ResizeSW"){
f=d;
g=0-d
}else{
if(S=="ResizeSE"){
g=d
}}
B=H;
break;
case"mceMove":f=d;
u=H;
break
}
if(g<(p=m.features.min_width-v.w)){
if(f!==0){
f+=g-p
}
g=p
}
if(B<(p=m.features.min_height-v.h)){
if(u!==0){
u+=B-p
}
B=p
}
g=Math.min(g,m.features.max_width-v.w);
B=Math.min(B,m.features.max_height-v.h);
f=Math.max(f,W.x-(q+W.x));
u=Math.max(u,W.y-(k+W.y));
f=Math.min(f,(W.w+W.x)-(q+v.w+W.x));
u=Math.min(u,(W.h+W.y)-(k+v.h+W.y));
if(f+u!==0){
if(q+f<0){
f=0
}
if(k+u<0){
u=0
}
F.moveTo(q+f,k+u)
}
if(g+B!==0){
F.resizeTo(v.w+g,v.h+B)
}
return e.cancel(R)
}
);
return e.cancel(M)
}
,resizeBy:function(r,h,l){
var s=this.windows[l];
if(s){
s.element.resizeBy(r,h);
s.iframeElement.resizeBy(r,h)
}}
,close:function(l,u){
var r=this,s,c=o.doc,h,u;
u=r._findId(u||l);
if(!r.windows[u]){
r.parent(l);
return
}
r.count--;
if(r.count==0){
o.remove("mceModalBlocker");
o.setAttrib(o.doc.body,"aria-hidden","false");
r.editor.focus()
}
if(s=r.windows[u]){
r.onClose.dispatch(r);
e.remove(c,"mousedown",s.mousedownFunc);
e.remove(c,"click",s.clickFunc);
e.clear(u);
e.clear(u+"_ifr");
o.setAttrib(u+"_ifr","src",'javascript:""');
s.element.remove();
delete r.windows[u];
h=r._frontWindow();
if(h){
r.focus(h.id)
}}}
,_frontWindow:function(){
var r,s=0;
n(this.windows,function(h){
if(h.zIndex>s){
r=h;
s=h.zIndex
}}
);
return r
}
,setTitle:function(s,r){
var h;
s=this._findId(s);
if(h=o.get(s+"_title")){
h.innerHTML=o.encode(r)
}}
,alert:function(h,r,d){
var c=this,l;
l=c.open({
title:c,type:"alert",button_func:function(u){
if(r){
r.call(u||c,u)
}
c.close(null,l.id)
}
,content:o.encode(c.editor.getLang(h,h)),inline:1,width:400,height:130}
)
}
,confirm:function(h,r,d){
var c=this,l;
l=c.open({
title:c,type:"confirm",button_func:function(u){
if(r){
r.call(u||c,u)
}
c.close(null,l.id)
}
,content:o.encode(c.editor.getLang(h,h)),inline:1,width:400,height:130}
)
}
,_findId:function(s){
var r=this;
if(typeof(s)=="string"){
return s
}
n(r.windows,function(h){
var l=o.get(h.id+"_ifr");
if(l&&s==l.contentWindow){
s=h.id;
return false
}}
);
return s
}
,_fixIELayout:function(c,l){
var r,h;
if(!tinymce.isIE6){
return
}
n(["n","s","w","e","nw","ne","sw","se"],function(s){
var d=o.get(c+"_resize_"+s);
o.setStyles(d,{
width:l?d.clientWidth:"",height:l?d.clientHeight:"",cursor:o.getStyle(d,"cursor",1)}
);
o.setStyle(c+"_bottom","bottom","-1px");
d=0
}
);
if(r=this.windows[c]){
r.element.hide();
r.element.show();
n(o.select("div,a",c),function(d,s){
if(d.currentStyle.backgroundImage!="none"){
h=new Image();
h.src=d.currentStyle.backgroundImage.replace(/url\(\"(.+)\"\)/,"$1")
}}
);
o.get(c).style.filter=""
}}}
);
tinymce.PluginManager.add("inlinepopups",tinymce.plugins.InlinePopups)
}
)()
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.table.editor_plugin_src")){
(function(o){
var n=o.each;
function a(r,h){
var l=h.ownerDocument,s=l.createRange(),c;
s.setStartBefore(h);
s.setEnd(r.endContainer,r.endOffset);
c=l.createElement("body");
c.appendChild(s.cloneContents());
return c.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length==0
}
function e(r,s){
return parseInt(r.getAttribute(s)||1)
}
function t(F,S,H){
var r,I,B,f;
k();
f=S.getParent(H.getStart(),"th,td");
if(f){
I=D(f);
B=M();
f=T(I.x,I.y)
}
function O(E,Y){
E=E.cloneNode(Y);
E.removeAttribute("id");
return E
}
function k(){
var Y=0;
r=[];
n(["thead","tbody","tfoot"],function(E){
var G=S.select("> "+E+" tr",F);
n(G,function(L,N){
N+=Y;
n(S.select("> td, > th",L),function(V,P){
var U,J,K,Q;
if(r[N]){
while(r[N][P]){
P++
}}
K=e(V,"rowspan");
Q=e(V,"colspan");
for(J=N;
J<N+K;
J++){
if(!r[J]){
r[J]=[]
}
for(U=P;
U<P+Q;
U++){
r[J][U]={
part:E,real:J==N&&U==P,elm:V,rowspan:K,colspan:Q}
}}}
)
}
);
Y+=G.length
}
)
}
function T(Y,G){
var E;
E=r[G];
if(E){
return E[Y]
}}
function v(G,Y,E){
if(G){
E=parseInt(E);
if(E===1){
G.removeAttribute(Y,1)
}else{
G.setAttribute(Y,E,1)
}}}
function l(Y){
return Y&&(S.hasClass(Y.elm,"mceSelected")||Y==f)
}
function c(){
var Y=[];
n(F.rows,function(E){
n(E.cells,function(G){
if(S.hasClass(G,"mceSelected")||G==f.elm){
Y.push(E);
return false
}}
)
}
);
return Y
}
function b(){
var Y=S.createRng();
Y.setStartAfter(F);
Y.setEndAfter(F);
H.setRng(Y);
S.remove(F)
}
function s(Y){
var E;
o.walk(Y,function(L){
var G;
if(L.nodeType==3){
n(S.getParents(L.parentNode,null,Y).reverse(),function(N){
N=O(N,false);
if(!E){
E=G=N
}else{
if(G){
G.appendChild(N)
}}
G=N
}
);
if(G){
G.innerHTML=o.isIE?"&nbsp;":'<br data-mce-bogus="1" />'
}
return false
}}
,"childNodes");
Y=O(Y,false);
v(Y,"rowSpan",1);
v(Y,"colSpan",1);
if(E){
Y.appendChild(E)
}else{
if(!o.isIE){
Y.innerHTML='<br data-mce-bogus="1" />'
}}
return Y
}
function g(){
var Y=S.createRng();
n(S.select("tr",F),function(E){
if(E.cells.length==0){
S.remove(E)
}}
);
if(S.select("tr",F).length==0){
Y.setStartAfter(F);
Y.setEndAfter(F);
H.setRng(Y);
S.remove(F);
return
}
n(S.select("thead,tbody,tfoot",F),function(E){
if(E.rows.length==0){
S.remove(E)
}}
);
k();
row=r[Math.min(r.length-1,I.y)];
if(row){
H.select(row[Math.min(row.length-1,I.x)].elm,true);
H.collapse(true)
}}
function q(U,N,K,P){
var L,E,Y,G,J;
L=r[N][U].elm.parentNode;
for(Y=1;
Y<=K;
Y++){
L=S.getNext(L,"tr");
if(L){
for(E=U;
E>=0;
E--){
J=r[N+Y][E].elm;
if(J.parentNode==L){
for(G=1;
G<=P;
G++){
S.insertAfter(s(J),J)
}
break
}}
if(E==-1){
for(G=1;
G<=P;
G++){
L.insertBefore(s(L.cells[0]),L.cells[0])
}}}}}
function W(){
n(r,function(Y,E){
n(Y,function(L,G){
var U,P,J,N;
if(l(L)){
L=L.elm;
U=e(L,"colspan");
P=e(L,"rowspan");
if(U>1||P>1){
v(L,"rowSpan",1);
v(L,"colSpan",1);
for(N=0;
N<U-1;
N++){
S.insertAfter(s(L),L)
}
q(G,E,P-1,U)
}}}
)
}
)
}
function p(Q,U,X){
var L,G,Z,V,K,P,J,Y,Q,E,N;
if(Q){
pos=D(Q);
L=pos.x;
G=pos.y;
Z=L+(U-1);
V=G+(X-1)
}else{
I=B=null;
n(r,function(_e,_t){
n(_e,function(_i,_a){
if(l(_i)){
if(!I){
I={
x:_a,y:_t}
}
B={
x:_a,y:_t}
}}
)
}
);
L=I.x;
G=I.y;
Z=B.x;
V=B.y
}
J=T(L,G);
Y=T(Z,V);
if(J&&Y&&J.part==Y.part){
W();
k();
J=T(L,G).elm;
v(J,"colSpan",(Z-L)+1);
v(J,"rowSpan",(V-G)+1);
for(P=G;
P<=V;
P++){
for(K=L;
K<=Z;
K++){
if(!r[P]||!r[P][K]){
continue
}
Q=r[P][K].elm;
if(Q!=J){
E=o.grep(Q.childNodes);
n(E,function(_e){
J.appendChild(_e)
}
);
if(E.length){
E=o.grep(J.childNodes);
N=0;
n(E,function(_e){
if(_e.nodeName=="BR"&&S.getAttrib(_e,"data-mce-bogus")&&N++<E.length-1){
J.removeChild(_e)
}}
)
}
S.remove(Q)
}}}
g()
}}
function d(N){
var Y,U,L,P,J,K,E,Q,G;
n(r,function(V,Z){
n(V,function(_e,X){
if(l(_e)){
_e=_e.elm;
J=_e.parentNode;
K=O(J,false);
Y=Z;
if(N){
return false
}}}
);
if(N){
return !Y
}}
);
for(P=0;
P<r[0].length;
P++){
if(!r[Y][P]){
continue
}
U=r[Y][P].elm;
if(U!=L){
if(!N){
G=e(U,"rowspan");
if(G>1){
v(U,"rowSpan",G+1);
continue
}}else{
if(Y>0&&r[Y-1][P]){
Q=r[Y-1][P].elm;
G=e(Q,"rowSpan");
if(G>1){
v(Q,"rowSpan",G+1);
continue
}}}
E=s(U);
v(E,"colSpan",U.colSpan);
K.appendChild(E);
L=U
}}
if(K.hasChildNodes()){
if(!N){
S.insertAfter(K,J)
}else{
J.parentNode.insertBefore(K,J)
}}}
function h(E){
var G,Y;
n(r,function(L,N){
n(L,function(U,P){
if(l(U)){
G=P;
if(E){
return false
}}}
);
if(E){
return !G
}}
);
n(r,function(U,J){
var L,N,P;
if(!U[G]){
return
}
L=U[G].elm;
if(L!=Y){
P=e(L,"colspan");
N=e(L,"rowspan");
if(P==1){
if(!E){
S.insertAfter(s(L),L);
q(G,J,N-1,P)
}else{
L.parentNode.insertBefore(s(L),L);
q(G,J,N-1,P)
}}else{
v(L,"colSpan",L.colSpan+1)
}
Y=L
}}
)
}
function m(){
var Y=[];
n(r,function(E,G){
n(E,function(N,L){
if(l(N)&&o.inArray(Y,L)===-1){
n(r,function(J){
var P=J[L].elm,U;
U=e(P,"colSpan");
if(U>1){
v(P,"colSpan",U-1)
}else{
S.remove(P)
}}
);
Y.push(L)
}}
)
}
);
g()
}
function u(){
var E;
function Y(N){
var L,P,G;
L=S.getNext(N,"tr");
n(N.cells,function(U){
var J=e(U,"rowSpan");
if(J>1){
v(U,"rowSpan",J-1);
P=D(U);
q(P.x,P.y,1,1)
}}
);
P=D(N.cells[0]);
n(r[P.y],function(U){
var J;
U=U.elm;
if(U!=G){
J=e(U,"rowSpan");
if(J<=1){
S.remove(U)
}else{
v(U,"rowSpan",J-1)
}
G=U
}}
)
}
E=c();
n(E.reverse(),function(G){
Y(G)
}
);
g()
}
function C(){
var Y=c();
S.remove(Y);
g();
return Y
}
function R(){
var Y=c();
n(Y,function(G,E){
Y[E]=O(G,true)
}
);
return Y
}
function A(G,E){
var L=c(),Y=L[E?0:L.length-1],N=Y.cells.length;
n(r,function(U){
var P;
N=0;
n(U,function(K,J){
if(K.real){
N+=K.colspan
}
if(K.elm.parentNode==Y){
P=1
}}
);
if(P){
return false
}}
);
if(!E){
G.reverse()
}
n(G,function(J){
var U=J.cells.length,P;
for(i=0;
i<U;
i++){
P=J.cells[i];
v(P,"colSpan",1);
v(P,"rowSpan",1)
}
for(i=U;
i<N;
i++){
J.appendChild(s(J.cells[U-1]))
}
for(i=N;
i<U;
i++){
S.remove(J.cells[i])
}
if(E){
Y.parentNode.insertBefore(J,Y)
}else{
S.insertAfter(J,Y)
}}
);
S.removeClass(S.select("td.mceSelected,th.mceSelected"),"mceSelected")
}
function D(Y){
var E;
n(r,function(G,L){
n(G,function(P,N){
if(P.elm==Y){
E={
x:N,y:L};
return false
}}
);
return !E
}
);
return E
}
function z(Y){
I=D(Y)
}
function M(){
var G,E,Y;
E=Y=0;
n(r,function(L,N){
n(L,function(U,P){
var K,J;
if(l(U)){
U=r[N][P];
if(P>E){
E=P
}
if(N>Y){
Y=N
}
if(U.real){
K=U.colspan-1;
J=U.rowspan-1;
if(K){
if(P+K>E){
E=P+K
}}
if(J){
if(N+J>Y){
Y=N+J
}}}}}
)
}
);
return{
x:E,y:Y}
}
function j(U){
var L,G,K,J,E,Y,N,P;
B=D(U);
if(I&&B){
L=Math.min(I.x,B.x);
G=Math.min(I.y,B.y);
K=Math.max(I.x,B.x);
J=Math.max(I.y,B.y);
E=K;
Y=J;
for(y=G;
y<=Y;
y++){
U=r[y][L];
if(!U.real){
if(L-(U.colspan-1)<L){
L-=U.colspan-1
}}}
for(x=L;
x<=E;
x++){
U=r[G][x];
if(!U.real){
if(G-(U.rowspan-1)<G){
G-=U.rowspan-1
}}}
for(y=G;
y<=J;
y++){
for(x=L;
x<=K;
x++){
U=r[y][x];
if(U.real){
N=U.colspan-1;
P=U.rowspan-1;
if(N){
if(x+N>E){
E=x+N
}}
if(P){
if(y+P>Y){
Y=y+P
}}}}}
S.removeClass(S.select("td.mceSelected,th.mceSelected"),"mceSelected");
for(y=G;
y<=Y;
y++){
for(x=L;
x<=E;
x++){
if(r[y][x]){
S.addClass(r[y][x].elm,"mceSelected")
}}}}}
o.extend(this,{
deleteTable:b,split:W,merge:p,insertRow:d,insertCol:h,deleteCols:m,deleteRows:u,cutRows:C,copyRows:R,pasteRows:A,getPos:D,setStartCell:z,setEndCell:j}
)
}
o.create("tinymce.plugins.TablePlugin",{
init:function(r,h){
var s,u,l=true;
function d(p){
var f=r.selection,m=r.dom.getParent(p||f.getNode(),"table");
if(m){
return new t(m,r.dom,f)
}}
function c(){
r.getBody().style.webkitUserSelect="";
if(l){
r.dom.removeClass(r.dom.select("td.mceSelected,th.mceSelected"),"mceSelected");
l=false
}}
n([["table","table.desc","mceInsertTable",true],["delete_table","table.del","mceTableDelete"],["delete_col","table.delete_col_desc","mceTableDeleteCol"],["delete_row","table.delete_row_desc","mceTableDeleteRow"],["col_after","table.col_after_desc","mceTableInsertColAfter"],["col_before","table.col_before_desc","mceTableInsertColBefore"],["row_after","table.row_after_desc","mceTableInsertRowAfter"],["row_before","table.row_before_desc","mceTableInsertRowBefore"],["row_props","table.row_desc","mceTableRowProps",true],["cell_props","table.cell_desc","mceTableCellProps",true],["split_cells","table.split_cells_desc","mceTableSplitCells",true],["merge_cells","table.merge_cells_desc","mceTableMergeCells",true]],function(m){
r.addButton(m[0],{
title:m[1],cmd:m[2],ui:m[3]}
)
}
);
if(!o.isIE){
r.onClick.add(function(m,f){
f=f.target;
if(f.nodeName==="TABLE"){
m.selection.select(f);
m.nodeChanged()
}}
)
}
r.onPreProcess.add(function(f,p){
var m,g,b,k=f.dom,v;
m=k.select("table",p.node);
g=m.length;
while(g--){
b=m[g];
k.setAttrib(b,"data-mce-style","");
if((v=k.getAttrib(b,"width"))){
k.setStyle(b,"width",v);
k.setAttrib(b,"width","")
}
if((v=k.getAttrib(b,"height"))){
k.setStyle(b,"height",v);
k.setAttrib(b,"height","")
}}}
);
r.onNodeChange.add(function(f,m,b){
var g;
b=f.selection.getStart();
g=f.dom.getParent(b,"td,th,caption");
m.setActive("table",b.nodeName==="TABLE"||!!g);
if(g&&g.nodeName==="CAPTION"){
g=0
}
m.setDisabled("delete_table",!g);
m.setDisabled("delete_col",!g);
m.setDisabled("delete_table",!g);
m.setDisabled("delete_row",!g);
m.setDisabled("col_after",!g);
m.setDisabled("col_before",!g);
m.setDisabled("row_after",!g);
m.setDisabled("row_before",!g);
m.setDisabled("row_props",!g);
m.setDisabled("cell_props",!g);
m.setDisabled("split_cells",!g);
m.setDisabled("merge_cells",!g)
}
);
r.onInit.add(function(b){
var p,k,g=b.dom,q;
s=b.windowManager;
b.onMouseDown.add(function(z,T){
if(T.button!=2){
c();
k=g.getParent(T.target,"td,th");
p=g.getParent(k,"table")
}}
);
g.bind(b.getDoc(),"mouseover",function(W){
var O,T,A=W.target;
if(k&&(q||A!=k)&&(A.nodeName=="TD"||A.nodeName=="TH")){
T=g.getParent(A,"table");
if(T==p){
if(!q){
q=d(T);
q.setStartCell(k);
b.getBody().style.webkitUserSelect="none"
}
q.setEndCell(A);
l=true
}
O=b.selection.getSel();
try{
if(O.removeAllRanges){
O.removeAllRanges()
}else{
O.empty()
}}
catch(z){}
W.preventDefault()
}}
);
b.onMouseUp.add(function(D,S){
var T,A=D.selection,F,M=A.getSel(),z,W,O,C;
if(k){
if(q){
D.getBody().style.webkitUserSelect=""
}
function B(R,I){
var H=new o.dom.TreeWalker(R,R);
do{
if(R.nodeType==3&&o.trim(R.nodeValue).length!=0){
if(I){
T.setStart(R,0)
}else{
T.setEnd(R,R.nodeValue.length)
}
return
}
if(R.nodeName=="BR"){
if(I){
T.setStartBefore(R)
}else{
T.setEndBefore(R)
}
return
}}
while(R=(I?H.next():H.prev()))
}
F=g.select("td.mceSelected,th.mceSelected");
if(F.length>0){
T=g.createRng();
W=F[0];
C=F[F.length-1];
T.setStartBefore(W);
T.setEndAfter(W);
B(W,1);
z=new o.dom.TreeWalker(W,g.getParent(F[0],"table"));
do{
if(W.nodeName=="TD"||W.nodeName=="TH"){
if(!g.hasClass(W,"mceSelected")){
break
}
O=W
}}
while(W=z.next());
B(O);
A.setRng(T)
}
D.nodeChanged();
k=q=p=null
}}
);
b.onKeyUp.add(function(z,T){
c()
}
);
b.onKeyDown.add(function(z,T){
m(z)
}
);
b.onMouseDown.add(function(z,T){
if(T.button!=2){
m(z)
}}
);
function f(B,T,O,D){
var A=3,S=B.dom.getParent(T.startContainer,"TABLE"),W,z,C;
if(S){
W=S.parentNode
}
z=T.startContainer.nodeType==A&&T.startOffset==0&&T.endOffset==0&&D&&(O.nodeName=="TR"||O==W);
C=(O.nodeName=="TD"||O.nodeName=="TH")&&!D;
return z||C
}
function m(O){
if(!o.isWebKit){
return
}
var T=O.selection.getRng();
var W=O.selection.getNode();
var A=O.dom.getParent(T.startContainer,"TD,TH");
if(!f(O,T,W,A)){
return
}
if(!A){
A=W
}
var z=A.lastChild;
while(z.lastChild){
z=z.lastChild
}
T.setEnd(z,z.nodeValue.length);
O.selection.setRng(T)
}
b.plugins.table.fixTableCellSelection=m;
if(b&&b.plugins.contextmenu){
b.plugins.contextmenu.onContextMenu.add(function(O,z,W){
var B,A=b.selection,T=A.getNode()||b.getBody();
if(b.dom.getParent(W,"td")||b.dom.getParent(W,"th")||b.dom.select("td.mceSelected,th.mceSelected").length){
z.removeAll();
if(T.nodeName=="A"&&!b.dom.getAttrib(T,"name")){
z.add({
title:"advanced.link_desc",icon:"link",cmd:b.plugins.advlink?"mceAdvLink":"mceLink",ui:true}
);
z.add({
title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"}
);
z.addSeparator()
}
if(T.nodeName=="IMG"&&T.className.indexOf("mceItem")==-1){
z.add({
title:"advanced.image_desc",icon:"image",cmd:b.plugins.advimage?"mceAdvImage":"mceImage",ui:true}
);
z.addSeparator()
}
z.add({
title:"table.desc",icon:"table",cmd:"mceInsertTable",value:{
action:"insert"}}
);
z.add({
title:"table.props_desc",icon:"table_props",cmd:"mceInsertTable"}
);
z.add({
title:"table.del",icon:"delete_table",cmd:"mceTableDelete"}
);
z.addSeparator();
B=z.addMenu({
title:"table.cell"}
);
B.add({
title:"table.cell_desc",icon:"cell_props",cmd:"mceTableCellProps"}
);
B.add({
title:"table.split_cells_desc",icon:"split_cells",cmd:"mceTableSplitCells"}
);
B.add({
title:"table.merge_cells_desc",icon:"merge_cells",cmd:"mceTableMergeCells"}
);
B=z.addMenu({
title:"table.row"}
);
B.add({
title:"table.row_desc",icon:"row_props",cmd:"mceTableRowProps"}
);
B.add({
title:"table.row_before_desc",icon:"row_before",cmd:"mceTableInsertRowBefore"}
);
B.add({
title:"table.row_after_desc",icon:"row_after",cmd:"mceTableInsertRowAfter"}
);
B.add({
title:"table.delete_row_desc",icon:"delete_row",cmd:"mceTableDeleteRow"}
);
B.addSeparator();
B.add({
title:"table.cut_row_desc",icon:"cut",cmd:"mceTableCutRow"}
);
B.add({
title:"table.copy_row_desc",icon:"copy",cmd:"mceTableCopyRow"}
);
B.add({
title:"table.paste_row_before_desc",icon:"paste",cmd:"mceTablePasteRowBefore"}
).setDisabled(!u);
B.add({
title:"table.paste_row_after_desc",icon:"paste",cmd:"mceTablePasteRowAfter"}
).setDisabled(!u);
B=z.addMenu({
title:"table.col"}
);
B.add({
title:"table.col_before_desc",icon:"col_before",cmd:"mceTableInsertColBefore"}
);
B.add({
title:"table.col_after_desc",icon:"col_after",cmd:"mceTableInsertColAfter"}
);
B.add({
title:"table.delete_col_desc",icon:"delete_col",cmd:"mceTableDeleteCol"}
)
}else{
z.add({
title:"table.desc",icon:"table",cmd:"mceInsertTable"}
)
}}
)
}
if(o.isWebKit){
function j(W,E){
var I=o.VK;
var N=E.keyCode;
function G(X,K,U){
var J=X?"previousSibling":"nextSibling";
var _e=W.dom.getParent(K,"tr");
var Z=_e[J];
if(Z){
T(W,K,Z,X);
o.dom.Event.cancel(U);
return true
}else{
var _t=W.dom.getParent(_e,"table");
var V=_e.parentNode;
var P=V.nodeName.toLowerCase();
if(P==="tbody"||P===(X?"tfoot":"thead")){
var Q=z(X,_t,V,"tbody");
if(Q!==null){
return H(X,Q,K,U)
}}
return Y(X,_e,J,_t,U)
}}
function z(Q,J,K,Z){
var U=W.dom.select(">"+Z,J);
var P=U.indexOf(K);
if(Q&&P===0||!Q&&P===U.length-1){
return A(Q,J)
}else{
if(P===-1){
var V=K.tagName.toLowerCase()==="thead"?0:U.length-1;
return U[V]
}else{
return U[P+(Q?-1:1)]
}}}
function A(K,J){
var U=K?"thead":"tfoot";
var P=W.dom.select(">"+U,J);
return P.length!==0?P[0]:null
}
function H(Q,J,U,K){
var P=R(J,Q);
P&&T(W,U,P,Q);
o.dom.Event.cancel(K);
return true
}
function Y(X,K,P,Z,V){
var U=Z[P];
if(U){
D(U);
return true
}else{
var Q=W.dom.getParent(Z,"td,th");
if(Q){
return G(X,Q,V)
}else{
var J=R(K,!X);
D(J);
return o.dom.Event.cancel(V)
}}}
function R(U,P){
var J=U&&U[P?"lastChild":"firstChild"];
return J&&J.nodeName==="BR"?W.dom.getParent(J,"td,th"):J
}
function D(P){
W.selection.setCursorLocation(P,0)
}
function O(){
return N==I.UP||N==I.DOWN
}
function B(P){
var J=P.selection.getNode();
var U=P.dom.getParent(J,"tr");
return U!==null
}
function L(U){
var P=0;
var J=U;
while(J.previousSibling){
J=J.previousSibling;
P=P+e(J,"colspan")
}
return P
}
function C(J,P){
var K=0;
var U=0;
n(J.children,function(Q,V){
K=K+e(Q,"colspan");
U=V;
if(K>P){
return false
}}
);
return U
}
function T(J,V,X,Q){
var Z=L(J.dom.getParent(V,"td,th"));
var U=C(X,Z);
var P=X.childNodes[U];
var K=R(P,Q);
D(K||P)
}
function F(P){
var J=W.selection.getNode();
var K=W.dom.getParent(J,"td,th");
var U=W.dom.getParent(P,"td,th");
return K&&K!==U&&M(K,U)
}
function M(U,P){
return W.dom.getParent(U,"TABLE")===W.dom.getParent(P,"TABLE")
}
if(O()&&B(W)){
var S=W.selection.getNode();
setTimeout(function(){
if(F(S)){
G(!E.shiftKey&&N===I.UP,S,E)
}}
,0)
}}
b.onKeyDown.add(j)
}
function v(){
var z;
for(z=b.getBody().lastChild;
z&&z.nodeType==3&&!z.nodeValue.length;
z=z.previousSibling){}
if(z&&z.nodeName=="TABLE"){
if(b.settings.forced_root_block){
b.dom.add(b.getBody(),b.settings.forced_root_block,null,o.isIE?"&nbsp;":'<br data-mce-bogus="1" />')
}else{
b.dom.add(b.getBody(),"br",{
"data-mce-bogus":"1"}
)
}}}
if(o.isGecko){
b.onKeyDown.add(function(T,A){
var z,O,W=T.dom;
if(A.keyCode==37||A.keyCode==38){
z=T.selection.getRng();
O=W.getParent(z.startContainer,"table");
if(O&&T.getBody().firstChild==O){
if(a(z,O)){
z=W.createRng();
z.setStartBefore(O);
z.setEndBefore(O);
T.selection.setRng(z);
A.preventDefault()
}}}}
)
}
b.onKeyUp.add(v);
b.onSetContent.add(v);
b.onVisualAid.add(v);
b.onPreProcess.add(function(z,O){
var T=O.node.lastChild;
if(T&&(T.nodeName=="BR"||(T.childNodes.length==1&&(T.firstChild.nodeName=="BR"||T.firstChild.nodeValue=="\u00a0")))&&T.previousSibling&&T.previousSibling.nodeName=="TABLE"){
z.dom.remove(T)
}}
);
if(o.isGecko){
b.onKeyDown.add(function(T,A){
if(A.keyCode===o.VK.ENTER&&A.shiftKey){
var O=T.selection.getRng().startContainer;
var W=g.getParent(O,"td,th");
if(W){
var z=T.getDoc().createTextNode("\uFEFF");
g.insertAfter(z,O)
}}}
)
}
v();
b.startContent=b.getContent({
format:"raw"}
)
}
);
n({
mceTableSplitCells:function(m){
m.split()
}
,mceTableMergeCells:function(f){
var p,g,m;
m=r.dom.getParent(r.selection.getNode(),"th,td");
if(m){
p=m.rowSpan;
g=m.colSpan
}
if(!r.dom.select("td.mceSelected,th.mceSelected").length){
s.open({
url:h+"/merge_cells.htm",width:240+parseInt(r.getLang("table.merge_cells_delta_width",0)),height:110+parseInt(r.getLang("table.merge_cells_delta_height",0)),inline:1}
,{
rows:p,cols:g,onaction:function(b){
f.merge(m,b.cols,b.rows)
}
,plugin_url:h}
)
}else{
f.merge()
}}
,mceTableInsertRowBefore:function(m){
m.insertRow(true)
}
,mceTableInsertRowAfter:function(m){
m.insertRow()
}
,mceTableInsertColBefore:function(m){
m.insertCol(true)
}
,mceTableInsertColAfter:function(m){
m.insertCol()
}
,mceTableDeleteCol:function(m){
m.deleteCols()
}
,mceTableDeleteRow:function(m){
m.deleteRows()
}
,mceTableCutRow:function(m){
u=m.cutRows()
}
,mceTableCopyRow:function(m){
u=m.copyRows()
}
,mceTablePasteRowBefore:function(m){
m.pasteRows(u,true)
}
,mceTablePasteRowAfter:function(m){
m.pasteRows(u)
}
,mceTableDelete:function(m){
m.deleteTable()
}}
,function(f,m){
r.addCommand(m,function(){
var p=d();
if(p){
f(p);
r.execCommand("mceRepaint");
c()
}}
)
}
);
n({
mceInsertTable:function(m){
s.open({
url:h+"/table.htm",width:400+parseInt(r.getLang("table.table_delta_width",0)),height:320+parseInt(r.getLang("table.table_delta_height",0)),inline:1}
,{
plugin_url:h,action:m?m.action:0}
)
}
,mceTableRowProps:function(){
s.open({
url:h+"/row.htm",width:400+parseInt(r.getLang("table.rowprops_delta_width",0)),height:295+parseInt(r.getLang("table.rowprops_delta_height",0)),inline:1}
,{
plugin_url:h}
)
}
,mceTableCellProps:function(){
s.open({
url:h+"/cell.htm",width:400+parseInt(r.getLang("table.cellprops_delta_width",0)),height:295+parseInt(r.getLang("table.cellprops_delta_height",0)),inline:1}
,{
plugin_url:h}
)
}}
,function(f,m){
r.addCommand(m,function(p,g){
f(g)
}
)
}
)
}}
);
o.PluginManager.add("table",o.plugins.TablePlugin)
}
)(tinymce)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.paste.editor_plugin_src")){
(function(){
var a=tinymce.each,e={
paste_auto_cleanup_on_paste:true,paste_enable_default_filters:true,paste_block_drop:false,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:false,paste_remove_styles:false,paste_remove_styles_if_webkit:true,paste_convert_middot_lists:true,paste_convert_headers_to_strong:false,paste_dialog_width:"450",paste_dialog_height:"400",paste_text_use_dialog:false,paste_text_sticky:false,paste_text_sticky_default:false,paste_text_notifyalways:false,paste_text_linebreaktype:"combined",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};
function t(o,n){
return o.getParam(n,e[n])
}
tinymce.create("tinymce.plugins.PastePlugin",{
init:function(o,n){
var s=this;
s.editor=o;
s.url=n;
s.onPreProcess=new tinymce.util.Dispatcher(s);
s.onPostProcess=new tinymce.util.Dispatcher(s);
s.onPreProcess.add(s._preProcess);
s.onPostProcess.add(s._postProcess);
s.onPreProcess.add(function(l,c){
o.execCallback("paste_preprocess",l,c)
}
);
s.onPostProcess.add(function(l,c){
o.execCallback("paste_postprocess",l,c)
}
);
o.onKeyDown.addToTop(function(l,c){
if(((tinymce.isMac?c.metaKey:c.ctrlKey)&&c.keyCode==86)||(c.shiftKey&&c.keyCode==45)){
return false
}}
);
o.pasteAsPlainText=t(o,"paste_text_sticky_default");
function h(u,c){
var d=o.dom,l;
s.onPreProcess.dispatch(s,u);
u.node=d.create("div",0,u.content);
if(tinymce.isGecko){
l=o.selection.getRng(true);
if(l.startContainer==l.endContainer&&l.startContainer.nodeType==3){
if(u.node.childNodes.length===1&&/^(p|h[1-6]|pre)$/i.test(u.node.firstChild.nodeName)&&u.content.indexOf("__MCE_ITEM__")===-1){
d.remove(u.node.firstChild,true)
}}}
s.onPostProcess.dispatch(s,u);
u.content=o.serializer.serialize(u.node,{
getInner:1,forced_root_block:""}
);
if((!c)&&(o.pasteAsPlainText)){
s._insertPlainText(u.content);
if(!t(o,"paste_text_sticky")){
o.pasteAsPlainText=false;
o.controlManager.setActive("pastetext",false)
}}else{
s._insert(u.content)
}}
o.addCommand("mceInsertClipboardContent",function(l,c){
h(c,true)
}
);
if(!t(o,"paste_text_use_dialog")){
o.addCommand("mcePasteText",function(c,l){
var d=tinymce.util.Cookie;
o.pasteAsPlainText=!o.pasteAsPlainText;
o.controlManager.setActive("pastetext",o.pasteAsPlainText);
if((o.pasteAsPlainText)&&(!d.get("tinymcePasteText"))){
if(t(o,"paste_text_sticky")){
o.windowManager.alert(o.translate("paste.plaintext_mode_sticky"))
}else{
o.windowManager.alert(o.translate("paste.plaintext_mode"))
}
if(!t(o,"paste_text_notifyalways")){
d.set("tinymcePasteText","1",new Date(new Date().getFullYear()+1,12,31))
}}}
)
}
o.addButton("pastetext",{
title:"paste.paste_text_desc",cmd:"mcePasteText"}
);
o.addButton("selectall",{
title:"paste.selectall_desc",cmd:"selectall"}
);
function r(v){
var u,p,c,k,d=o.selection,f=o.dom,g=o.getBody(),l,b;
if(v.clipboardData||f.doc.dataTransfer){
b=(v.clipboardData||f.doc.dataTransfer).getData("Text");
if(o.pasteAsPlainText){
v.preventDefault();
h({
content:f.encode(b).replace(/\r?\n/g,"<br />")}
);
return
}}
if(f.get("_mcePaste")){
return
}
u=f.add(g,"div",{
id:"_mcePaste","class":"mcePaste","data-mce-bogus":"1"}
,"\uFEFF\uFEFF");
if(g!=o.getDoc().body){
l=f.getPos(o.selection.getStart(),g).y
}else{
l=g.scrollTop+f.getViewPort(o.getWin()).y
}
f.setStyles(u,{
position:"absolute",left:tinymce.isGecko?-40:0,top:l-25,width:1,height:1,overflow:"hidden"}
);
if(tinymce.isIE){
k=d.getRng();
c=f.doc.body.createTextRange();
c.moveToElementText(u);
c.execCommand("Paste");
f.remove(u);
if(u.innerHTML==="\uFEFF\uFEFF"){
o.execCommand("mcePasteWord");
v.preventDefault();
return
}
d.setRng(k);
d.setContent("");
setTimeout(function(){
h({
content:u.innerHTML}
)
}
,0);
return tinymce.dom.Event.cancel(v)
}else{
function m(q){
q.preventDefault()
}
f.bind(o.getDoc(),"mousedown",m);
f.bind(o.getDoc(),"keydown",m);
p=o.selection.getRng();
u=u.firstChild;
c=o.getDoc().createRange();
c.setStart(u,0);
c.setEnd(u,2);
d.setRng(c);
window.setTimeout(function(){
var j="",q;
if(!f.select("div.mcePaste > div.mcePaste").length){
q=f.select("div.mcePaste");
a(q,function(T){
var z=T.firstChild;
if(z&&z.nodeName=="DIV"&&z.style.marginTop&&z.style.backgroundColor){
f.remove(z,1)
}
a(f.select("span.Apple-style-span",T),function(O){
f.remove(O,1)
}
);
a(f.select("br[data-mce-bogus]",T),function(O){
f.remove(O)
}
);
if(T.parentNode.className!="mcePaste"){
j+=T.innerHTML
}}
)
}else{
j="<p>"+f.encode(b).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>"
}
a(f.select("div.mcePaste"),function(z){
f.remove(z)
}
);
if(p){
d.setRng(p)
}
h({
content:j}
);
f.unbind(o.getDoc(),"mousedown",m);
f.unbind(o.getDoc(),"keydown",m)
}
,0)
}}
if(t(o,"paste_auto_cleanup_on_paste")){
if(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)){
o.onKeyDown.addToTop(function(l,c){
if(((tinymce.isMac?c.metaKey:c.ctrlKey)&&c.keyCode==86)||(c.shiftKey&&c.keyCode==45)){
r(c)
}}
)
}else{
o.onPaste.addToTop(function(l,c){
return r(c)
}
)
}}
o.onInit.add(function(){
o.controlManager.setActive("pastetext",o.pasteAsPlainText);
if(t(o,"paste_block_drop")){
o.dom.bind(o.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(l){
l.preventDefault();
l.stopPropagation();
return false
}
)
}}
);
s._legacySupport()
}
,getInfo:function(){
return{
longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}
}
,_preProcess:function(l,s){
var u=this.editor,d=s.content,g=tinymce.grep,p=tinymce.explode,r=tinymce.trim,m,c;
function n(o){
a(o,function(h){
if(h.constructor==RegExp){
d=d.replace(h,"")
}else{
d=d.replace(h[0],h[1])
}}
)
}
if(u.settings.paste_enable_default_filters==false){
return
}
if(tinymce.isIE&&document.documentMode>=9&&/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(s.content)){
n([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]);
n([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])
}
if(/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(d)||s.wordContent){
s.wordContent=true;
n([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]);
if(t(u,"paste_convert_headers_to_strong")){
d=d.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")
}
if(t(u,"paste_convert_middot_lists")){
n([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]])
}
n([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"]]);
do{
m=d.length;
d=d.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1")
}
while(m!=d.length);
if(t(u,"paste_retain_style_properties").replace(/^none$/i,"").length==0){
d=d.replace(/<\/?span[^>]*>/gi,"")
}else{
n([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(h,o){
return(o.length>0)?o.replace(/./," ").slice(Math.floor(o.length/2)).split("").join("\u00a0"):""
}
],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(k,o,v){
var q=[],h=0,b=p(r(v).replace(/&quot;/gi,"'"),";");
a(b,function(j){
var z,O,A=p(j,":");
function T(W){
return W+((W!=="0")&&(/\d$/.test(W)))?"px":""
}
if(A.length==2){
z=A[0].toLowerCase();
O=A[1].toLowerCase();
switch(z){
case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":q[h++]=z.replace(/^mso-|-alt$/g,"")+":"+T(O);
return;
case"horiz-align":q[h++]="text-align:"+O;
return;
case"vert-align":q[h++]="vertical-align:"+O;
return;
case"font-color":case"mso-foreground":q[h++]="color:"+O;
return;
case"mso-background":case"mso-highlight":q[h++]="background:"+O;
return;
case"mso-default-height":q[h++]="min-height:"+T(O);
return;
case"mso-default-width":q[h++]="min-width:"+T(O);
return;
case"mso-padding-between-alt":q[h++]="border-collapse:separate;border-spacing:"+T(O);
return;
case"text-line-through":if((O=="single")||(O=="double")){
q[h++]="text-decoration:line-through"
}
return;
case"mso-zero-height":if(O=="yes"){
q[h++]="display:none"
}
return
}
if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(z)){
return
}
q[h++]=z+":"+A[1]
}}
);
if(h>0){
return o+' style="'+q.join(";")+'"'
}else{
return o
}}
]])
}}
if(t(u,"paste_convert_headers_to_strong")){
n([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]])
}
n([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]);
c=t(u,"paste_strip_class_attributes");
if(c!=="none"){
function f(b,h){
if(c==="all"){
return""
}
var o=g(p(h.replace(/^(["'])(.*)\1$/,"$2")," "),function(k){
return(/^(?!mso)/i.test(k))
}
);
return o.length?' class="'+o.join(" ")+'"':""
}
d=d.replace(/ class="([^"]+)"/gi,f);
d=d.replace(/ class=([\-\w]+)/gi,f)
}
if(t(u,"paste_remove_spans")){
d=d.replace(/<\/?span[^>]*>/gi,"")
}
s.content=d
}
,_postProcess:function(h,c){
var r=this,s=r.editor,l=s.dom,n;
if(s.settings.paste_enable_default_filters==false){
return
}
if(c.wordContent){
a(l.select("a",c.node),function(o){
if(!o.href||o.href.indexOf("#_Toc")!=-1){
l.remove(o,1)
}}
);
if(t(s,"paste_convert_middot_lists")){
r._convertLists(h,c)
}
n=t(s,"paste_retain_style_properties");
if((tinymce.is(n,"string"))&&(n!=="all")&&(n!=="*")){
n=tinymce.explode(n.replace(/^none$/i,""));
a(l.select("*",c.node),function(m){
var f={}
,d=0,u,p,o;
if(n){
for(u=0;
u<n.length;
u++){
p=n[u];
o=l.getStyle(m,p);
if(o){
f[p]=o;
d++
}}}
l.setAttrib(m,"style","");
if(n&&d>0){
l.setStyles(m,f)
}else{
if(m.nodeName=="SPAN"&&!m.className){
l.remove(m,true)
}}}
)
}}
if(t(s,"paste_remove_styles")||(t(s,"paste_remove_styles_if_webkit")&&tinymce.isWebKit)){
a(l.select("*[style]",c.node),function(o){
o.removeAttribute("style");
o.removeAttribute("data-mce-style")
}
)
}else{
if(tinymce.isWebKit){
a(l.select("*",c.node),function(o){
o.removeAttribute("data-mce-style")
}
)
}}}
,_convertLists:function(h,s){
var c=h.editor.dom,l,m,n=-1,r,f=[],u,d;
a(c.select("p",s.node),function(q){
var b,j="",k,v,o,g;
for(b=q.firstChild;
b&&b.nodeType==3;
b=b.nextSibling){
j+=b.nodeValue
}
j=q.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g,"\u00a0");
if(/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(j)){
k="ul"
}
if(/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(j)){
k="ol"
}
if(k){
r=parseFloat(q.style.marginLeft||0);
if(r>n){
f.push(r)
}
if(!l||k!=u){
l=c.create(k);
c.insertAfter(l,q)
}else{
if(r>n){
l=m.appendChild(c.create(k))
}else{
if(r<n){
o=tinymce.inArray(f,r);
g=c.getParents(l.parentNode,k);
l=g[g.length-1-o]||l
}}}
a(c.select("span",q),function(z){
var p=z.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");
if(k=="ul"&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(p)){
c.remove(z)
}else{
if(/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(p)){
c.remove(z)
}}}
);
v=q.innerHTML;
if(k=="ul"){
v=q.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,"")
}else{
v=q.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,"")
}
m=l.appendChild(c.create("li",0,v));
c.remove(q);
n=r;
u=k
}else{
l=n=0
}}
);
d=s.node.innerHTML;
if(d.indexOf("__MCE_ITEM__")!=-1){
s.node.innerHTML=d.replace(/__MCE_ITEM__/g,"")
}}
,_insert:function(s,o){
var n=this.editor,l=n.selection.getRng();
if(!n.selection.isCollapsed()&&l.startContainer!=l.endContainer){
n.getDoc().execCommand("Delete",false,null)
}
n.execCommand("mceInsertContent",false,s,{
skip_undo:o}
)
}
,_insertPlainText:function(r){
var o=this.editor,n=t(o,"paste_text_linebreaktype"),l=t(o,"paste_text_replacements"),s=tinymce.is;
function h(c){
a(c,function(d){
if(d.constructor==RegExp){
r=r.replace(d,"")
}else{
r=r.replace(d[0],d[1])
}}
)
}
if((typeof(r)==="string")&&(r.length>0)){
if(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(r)){
h([/[\n\r]+/g])
}else{
h([/\r+/g])
}
h([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"]]);
r=o.dom.decode(tinymce.html.Entities.encodeRaw(r));
if(s(l,"array")){
h(l)
}else{
if(s(l,"string")){
h(new RegExp(l,"gi"))
}}
if(n=="none"){
h([[/\n+/g," "]])
}else{
if(n=="br"){
h([[/\n/g,"<br />"]])
}else{
if(n=="p"){
h([[/\n+/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"]])
}else{
h([[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]])
}}}
o.execCommand("mceInsertContent",false,r)
}}
,_legacySupport:function(){
var n=this,o=n.editor;
o.addCommand("mcePasteWord",function(){
o.windowManager.open({
file:n.url+"/pasteword.htm",width:parseInt(t(o,"paste_dialog_width")),height:parseInt(t(o,"paste_dialog_height")),inline:1}
)
}
);
if(t(o,"paste_text_use_dialog")){
o.addCommand("mcePasteText",function(){
o.windowManager.open({
file:n.url+"/pastetext.htm",width:parseInt(t(o,"paste_dialog_width")),height:parseInt(t(o,"paste_dialog_height")),inline:1}
)
}
)
}
o.addButton("pasteword",{
title:"paste.paste_word_desc",cmd:"mcePasteWord"}
)
}}
);
tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)
}
)()
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.directionality.editor_plugin_src")){
(function(){
tinymce.create("tinymce.plugins.Directionality",{
init:function(e,a){
var o=this;
o.editor=e;
e.addCommand("mceDirectionLTR",function(){
var t=e.dom.getParent(e.selection.getNode(),e.dom.isBlock);
if(t){
if(e.dom.getAttrib(t,"dir")!="ltr"){
e.dom.setAttrib(t,"dir","ltr")
}else{
e.dom.setAttrib(t,"dir","")
}}
e.nodeChanged()
}
);
e.addCommand("mceDirectionRTL",function(){
var t=e.dom.getParent(e.selection.getNode(),e.dom.isBlock);
if(t){
if(e.dom.getAttrib(t,"dir")!="rtl"){
e.dom.setAttrib(t,"dir","rtl")
}else{
e.dom.setAttrib(t,"dir","")
}}
e.nodeChanged()
}
);
e.addButton("ltr",{
title:"directionality.ltr_desc",cmd:"mceDirectionLTR"}
);
e.addButton("rtl",{
title:"directionality.rtl_desc",cmd:"mceDirectionRTL"}
);
e.onNodeChange.add(o._nodeChange,o)
}
,getInfo:function(){
return{
longname:"Directionality",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/directionality",version:tinymce.majorVersion+"."+tinymce.minorVersion}
}
,_nodeChange:function(t,e,s){
var o=t.dom,a;
s=o.getParent(s,o.isBlock);
if(!s){
e.setDisabled("ltr",1);
e.setDisabled("rtl",1);
return
}
a=o.getAttrib(s,"dir");
e.setActive("ltr",a=="ltr");
e.setDisabled("ltr",0);
e.setActive("rtl",a=="rtl");
e.setDisabled("rtl",0)
}}
);
tinymce.PluginManager.add("directionality",tinymce.plugins.Directionality)
}
)()
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.zbreakquote.editor_plugin")){
(function(){
tinymce.create("tinymce.plugins.BreakQuote",{
init:function(e){
e.onKeyDown.add(function(s,d){
if(d.keyCode===13){
var m,u,t,n,c,l,o,a,r;
if(d.shiftKey){
return
}
m=s.controlManager.get("blockquote");
if(!m||!m.isActive()){
return
}
u=s.selection;
t=u.getRng(true).startContainer;
if(!t){
return
}
n=s.dom;
l=n.getParents(t,"blockquote",s.getBody());
if(!l){
return
}
l=l.pop();
if(!l||!l.style.borderLeft){
return
}
c=n.uniqueId();
s.undoManager.add();
try{
u.setContent("<div id='"+c+"'><br></div>")
}
catch(h){
return
}
a=s.getDoc().getElementById(c);
if(a){
a.removeAttribute("id")
}else{
return
}
o=a.nextSibling;
if(o&&o.nodeName==="BR"){
o.parentNode.removeChild(o)
}
try{
r=n.split(l,a);
if(r){
u.select(r);
u.collapse(true);
d.preventDefault()
}}
catch(h){}}}
)
}
,getInfo:function(){
return{
longname:"ZBreakQuote to break up blockquotes when newline is entered",author:"Zimbra Inc.,",authorurl:"http://www.zimbra.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}
}}
);
tinymce.PluginManager.add("zbreakquote",tinymce.plugins.BreakQuote)
}
)(tinymce)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.emotions.editor_plugin_src")){
(function(e){
e.create("tinymce.plugins.EmotionsPlugin",{
init:function(t,a){
t.addCommand("mceEmotion",function(){
t.windowManager.open({
file:a+"/emotions.htm",width:250+parseInt(t.getLang("emotions.delta_width",0)),height:160+parseInt(t.getLang("emotions.delta_height",0)),inline:1}
,{
plugin_url:a}
)
}
);
t.addButton("emotions",{
title:"emotions.emotions_desc",cmd:"mceEmotion"}
)
}
,getInfo:function(){
return{
longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:e.majorVersion+"."+e.minorVersion}
}}
);
e.PluginManager.add("emotions",e.plugins.EmotionsPlugin)
}
)(tinymce)
}};
